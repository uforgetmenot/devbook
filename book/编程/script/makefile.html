<!DOCTYPE HTML>
<html lang="zh" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Makefile æ„å»ºç³»ç»Ÿå®Œæ•´å­¦ä¹ æŒ‡å— - å¼€å‘</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../theme/pagetoc.css">
        <link rel="stylesheet" href="../../theme/help-overlay.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>â†</kbd> or <kbd>â†’</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">å¼€å‘</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="æœç´¢æœ¬ä¹¦å†…å®¹..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <!-- Page table of contents -->
                        <div class="sidetoc"><nav class="pagetoc"></nav></div>

                        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="makefile-æ„å»ºç³»ç»Ÿå®Œæ•´å­¦ä¹ æŒ‡å—"><a class="header" href="#makefile-æ„å»ºç³»ç»Ÿå®Œæ•´å­¦ä¹ æŒ‡å—">Makefile æ„å»ºç³»ç»Ÿå®Œæ•´å­¦ä¹ æŒ‡å—</a></h1>
<h2 id="-å­¦ä¹ è·¯çº¿å›¾"><a class="header" href="#-å­¦ä¹ è·¯çº¿å›¾">ğŸ“‹ å­¦ä¹ è·¯çº¿å›¾</a></h2>
<pre><code>ç¯å¢ƒå‡†å¤‡ â†’ åŸºç¡€è¯­æ³• â†’ å˜é‡ç³»ç»Ÿ â†’ å‡½æ•°åº”ç”¨ â†’ æ¨¡å¼è§„åˆ™ â†’ æ¡ä»¶åˆ¤æ–­ â†’ é«˜çº§ç‰¹æ€§ â†’ ç”Ÿäº§å®æˆ˜
  (1å¤©)     (3å¤©)      (2å¤©)      (2å¤©)      (2å¤©)      (2å¤©)      (3å¤©)      (æŒç»­)
</code></pre>
<p><strong>ç›®æ ‡ç¾¤ä½“</strong>: C/C++å¼€å‘è€…ã€ç³»ç»Ÿç¨‹åºå‘˜ã€åµŒå…¥å¼å¼€å‘è€…
<strong>å‰ç½®è¦æ±‚</strong>: äº†è§£åŸºæœ¬çš„Linuxå‘½ä»¤è¡Œå’ŒC/C++ç¼–è¯‘æµç¨‹
<strong>å­¦ä¹ å‘¨æœŸ</strong>: 2-3å‘¨ï¼ˆæ¯å¤©2-3å°æ—¶ï¼‰</p>
<hr />
<h2 id="ç¬¬ä¸€ç« makefileåŸºç¡€ä¸ç¯å¢ƒå‡†å¤‡"><a class="header" href="#ç¬¬ä¸€ç« makefileåŸºç¡€ä¸ç¯å¢ƒå‡†å¤‡">ç¬¬ä¸€ç« ï¼šMakefileåŸºç¡€ä¸ç¯å¢ƒå‡†å¤‡</a></h2>
<h3 id="11-makefileç®€ä»‹"><a class="header" href="#11-makefileç®€ä»‹">1.1 Makefileç®€ä»‹</a></h3>
<p><strong>ä»€ä¹ˆæ˜¯Makefile</strong>
Makefileæ˜¯ä¸€ç§è‡ªåŠ¨åŒ–æ„å»ºå·¥å…·çš„é…ç½®æ–‡ä»¶ï¼Œæè¿°äº†é¡¹ç›®ä¸­æ–‡ä»¶çš„ä¾èµ–å…³ç³»å’Œæ„å»ºè§„åˆ™ã€‚Makeå·¥å…·æ ¹æ®Makefileä¸­çš„è§„åˆ™è‡ªåŠ¨ç¼–è¯‘å’Œé“¾æ¥ç¨‹åºã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆä½¿ç”¨Makefile</strong></p>
<ul>
<li>âœ… è‡ªåŠ¨åŒ–ç¼–è¯‘ï¼šé¿å…æ‰‹åŠ¨ç¼–è¯‘æ¯ä¸ªæºæ–‡ä»¶</li>
<li>âœ… å¢é‡ç¼–è¯‘ï¼šåªç¼–è¯‘ä¿®æ”¹è¿‡çš„æ–‡ä»¶</li>
<li>âœ… ä¾èµ–ç®¡ç†ï¼šè‡ªåŠ¨å¤„ç†æ–‡ä»¶ä¾èµ–å…³ç³»</li>
<li>âœ… è·¨å¹³å°ï¼šé€‚ç”¨äºå„ç§Unix/Linuxç³»ç»Ÿ</li>
<li>âœ… æ ‡å‡†åŒ–ï¼šC/C++é¡¹ç›®çš„äº‹å®æ ‡å‡†</li>
</ul>
<p><strong>Makefile vs ç°ä»£æ„å»ºå·¥å…·</strong></p>
<div class="table-wrapper"><table><thead><tr><th>ç‰¹æ€§</th><th>Makefile</th><th>CMake</th><th>Gradle</th></tr></thead><tbody>
<tr><td>å­¦ä¹ æ›²çº¿</td><td>ä¸­ç­‰</td><td>è¾ƒé™¡</td><td>è¾ƒé™¡</td></tr>
<tr><td>çµæ´»æ€§</td><td>âœ… é«˜</td><td>ä¸­ç­‰</td><td>é«˜</td></tr>
<tr><td>è·¨å¹³å°</td><td>éœ€æ‰‹åŠ¨å¤„ç†</td><td>âœ… è‡ªåŠ¨</td><td>âœ… è‡ªåŠ¨</td></tr>
<tr><td>ç”Ÿæ€ç³»ç»Ÿ</td><td>C/C++</td><td>C/C++</td><td>Java/Android</td></tr>
<tr><td>æ€§èƒ½</td><td>âœ… å¿«é€Ÿ</td><td>è¾ƒå¿«</td><td>æ…¢</td></tr>
</tbody></table>
</div>
<h3 id="12-å®‰è£…makeå·¥å…·"><a class="header" href="#12-å®‰è£…makeå·¥å…·">1.2 å®‰è£…Makeå·¥å…·</a></h3>
<p><strong>Linuxç³»ç»Ÿ</strong></p>
<pre><code class="language-bash"># Ubuntu/Debian
sudo apt-get update
sudo apt-get install build-essential

# CentOS/RHEL
sudo yum groupinstall "Development Tools"

# Arch Linux
sudo pacman -S base-devel

# éªŒè¯å®‰è£…
make --version
</code></pre>
<p><strong>macOSç³»ç»Ÿ</strong></p>
<pre><code class="language-bash"># å®‰è£…Xcode Command Line Tools
xcode-select --install

# æˆ–ä½¿ç”¨Homebrew
brew install make

# macOSè‡ªå¸¦çš„makeæ˜¯BSDç‰ˆæœ¬ï¼Œå¯èƒ½ä¸GNU makeæœ‰å·®å¼‚
# æ¨èå®‰è£…GNU make
brew install gmake

# éªŒè¯
make --version
gmake --version
</code></pre>
<p><strong>Windowsç³»ç»Ÿ</strong></p>
<pre><code class="language-powershell"># ä½¿ç”¨MinGW
# ä¸‹è½½å¹¶å®‰è£… MinGW-w64

# æˆ–ä½¿ç”¨Cygwin
# ä¸‹è½½å¹¶å®‰è£…Cygwinï¼Œé€‰æ‹©makeåŒ…

# æˆ–ä½¿ç”¨WSL (Windows Subsystem for Linux)
wsl --install

# éªŒè¯
make --version
</code></pre>
<h3 id="13-ç¬¬ä¸€ä¸ªmakefile"><a class="header" href="#13-ç¬¬ä¸€ä¸ªmakefile">1.3 ç¬¬ä¸€ä¸ªMakefile</a></h3>
<p><strong>é¡¹ç›®ç»“æ„</strong></p>
<pre><code>hello_make/
â”œâ”€â”€ Makefile
â”œâ”€â”€ main.c
â”œâ”€â”€ hello.c
â””â”€â”€ hello.h
</code></pre>
<p><strong>æºæ–‡ä»¶</strong></p>
<pre><code class="language-c">// hello.h
#ifndef HELLO_H
#define HELLO_H

void print_hello(const char *name);

#endif
</code></pre>
<pre><code class="language-c">// hello.c
#include &lt;stdio.h&gt;
#include "hello.h"

void print_hello(const char *name) {
    printf("Hello, %s!\n", name);
}
</code></pre>
<pre><code class="language-c">// main.c
#include "hello.h"

int main() {
    print_hello("Makefile");
    return 0;
}
</code></pre>
<p><strong>åŸºç¡€Makefile</strong></p>
<pre><code class="language-makefile"># æœ€ç®€å•çš„Makefile

hello: main.c hello.c hello.h
	gcc -o hello main.c hello.c

clean:
	rm -f hello
</code></pre>
<p><strong>è¿è¡Œç¤ºä¾‹</strong></p>
<pre><code class="language-bash"># æ„å»ºé¡¹ç›®
make

# æ¸…ç†æ„å»ºäº§ç‰©
make clean

# é‡æ–°æ„å»º
make clean
make
</code></pre>
<p><strong>æ”¹è¿›ç‰ˆMakefile</strong></p>
<pre><code class="language-makefile"># ç¼–è¯‘å™¨å’Œç¼–è¯‘é€‰é¡¹
CC = gcc
CFLAGS = -Wall -Wextra -std=c99

# ç›®æ ‡æ–‡ä»¶
TARGET = hello
OBJS = main.o hello.o

# é»˜è®¤ç›®æ ‡
all: $(TARGET)

# é“¾æ¥
$(TARGET): $(OBJS)
	$(CC) $(CFLAGS) -o $(TARGET) $(OBJS)

# ç¼–è¯‘
main.o: main.c hello.h
	$(CC) $(CFLAGS) -c main.c

hello.o: hello.c hello.h
	$(CC) $(CFLAGS) -c hello.c

# æ¸…ç†
clean:
	rm -f $(TARGET) $(OBJS)

# é‡æ–°æ„å»º
rebuild: clean all

.PHONY: all clean rebuild
</code></pre>
<hr />
<h2 id="ç¬¬äºŒç« makefileåŸºæœ¬è¯­æ³•"><a class="header" href="#ç¬¬äºŒç« makefileåŸºæœ¬è¯­æ³•">ç¬¬äºŒç« ï¼šMakefileåŸºæœ¬è¯­æ³•</a></h2>
<h3 id="21-è§„åˆ™ç»“æ„"><a class="header" href="#21-è§„åˆ™ç»“æ„">2.1 è§„åˆ™ç»“æ„</a></h3>
<p><strong>åŸºæœ¬è¯­æ³•</strong></p>
<pre><code class="language-makefile">target: prerequisites
&lt;TAB&gt;command1
&lt;TAB&gt;command2
</code></pre>
<p><strong>å…³é”®ç‚¹</strong>ï¼š</p>
<ul>
<li><code>target</code>: ç›®æ ‡æ–‡ä»¶ï¼Œå¯ä»¥æ˜¯å¯æ‰§è¡Œæ–‡ä»¶æˆ–ä¸­é—´æ–‡ä»¶</li>
<li><code>prerequisites</code>: ä¾èµ–æ–‡ä»¶åˆ—è¡¨</li>
<li><code>command</code>: æ„å»ºå‘½ä»¤ï¼Œ<strong>å¿…é¡»ä»¥TABå¼€å¤´</strong>ï¼ˆä¸æ˜¯ç©ºæ ¼ï¼ï¼‰</li>
</ul>
<p><strong>ç¤ºä¾‹</strong></p>
<pre><code class="language-makefile"># å•è¡Œè§„åˆ™
output.txt: input.txt
	cp input.txt output.txt

# å¤šè¡Œè§„åˆ™
app: main.o utils.o
	gcc -o app main.o utils.o
	echo "Build complete!"
	chmod +x app

# å¤šä¸ªç›®æ ‡
file1 file2 file3: source
	cp source file1
	cp source file2
	cp source file3
</code></pre>
<h3 id="22-ä¼ªç›®æ ‡-phony"><a class="header" href="#22-ä¼ªç›®æ ‡-phony">2.2 ä¼ªç›®æ ‡ (.PHONY)</a></h3>
<p><strong>ä»€ä¹ˆæ˜¯ä¼ªç›®æ ‡</strong>
ä¼ªç›®æ ‡ä¸æ˜¯å®é™…æ–‡ä»¶ï¼Œè€Œæ˜¯ä¸€ä¸ªæ ‡ç­¾ï¼Œç”¨äºæ‰§è¡Œç‰¹å®šçš„å‘½ä»¤åºåˆ—ã€‚</p>
<pre><code class="language-makefile"># å£°æ˜ä¼ªç›®æ ‡
.PHONY: clean all install test

# æ¸…ç†ç›®æ ‡ï¼ˆä¼ªç›®æ ‡ï¼‰
clean:
	rm -f *.o
	rm -f myapp

# å…¨éƒ¨æ„å»ºï¼ˆä¼ªç›®æ ‡ï¼‰
all: myapp

# å®‰è£…ï¼ˆä¼ªç›®æ ‡ï¼‰
install: myapp
	cp myapp /usr/local/bin/
	chmod 755 /usr/local/bin/myapp

# æµ‹è¯•ï¼ˆä¼ªç›®æ ‡ï¼‰
test: myapp
	./myapp --test
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆéœ€è¦.PHONY</strong></p>
<pre><code class="language-makefile"># é—®é¢˜åœºæ™¯ï¼šå¦‚æœå½“å‰ç›®å½•æœ‰åä¸º"clean"çš„æ–‡ä»¶
# make clean ä¼šè®¤ä¸ºç›®æ ‡å·²æ˜¯æœ€æ–°ï¼Œä¸æ‰§è¡Œå‘½ä»¤

# è§£å†³æ–¹æ¡ˆï¼šå£°æ˜ä¸ºä¼ªç›®æ ‡
.PHONY: clean
clean:
	rm -f *.o myapp

# è¿™æ ·make cleanæ€»æ˜¯ä¼šæ‰§è¡Œ
</code></pre>
<h3 id="23-å‘½ä»¤å‰ç¼€"><a class="header" href="#23-å‘½ä»¤å‰ç¼€">2.3 å‘½ä»¤å‰ç¼€</a></h3>
<p><strong>@ ç¬¦å·ï¼šé™é»˜æ‰§è¡Œ</strong></p>
<pre><code class="language-makefile"># ä¸ä½¿ç”¨@
hello:
	echo "Hello, World!"

# è¾“å‡ºï¼š
# echo "Hello, World!"
# Hello, World!

# ä½¿ç”¨@
hello:
	@echo "Hello, World!"

# è¾“å‡ºï¼š
# Hello, World!
</code></pre>
<p><strong>- ç¬¦å·ï¼šå¿½ç•¥é”™è¯¯</strong></p>
<pre><code class="language-makefile"># å³ä½¿å‘½ä»¤å¤±è´¥ï¼Œç»§ç»­æ‰§è¡Œ
clean:
	-rm -f *.o
	-rm -f myapp
	@echo "Cleanup attempted"

# æ²¡æœ‰-ç¬¦å·ï¼Œrmå¤±è´¥ä¼šåœæ­¢æ‰§è¡Œ
</code></pre>
<p><strong>+ ç¬¦å·ï¼šå¼ºåˆ¶æ‰§è¡Œ</strong></p>
<pre><code class="language-makefile"># å³ä½¿åœ¨ make -n (ç©ºè¿è¡Œ) æ¨¡å¼ä¸‹ä¹Ÿæ‰§è¡Œ
test:
	+./run_test.sh
</code></pre>
<p><strong>å®æˆ˜æ¡ˆä¾‹ï¼šå¸¦è¿›åº¦æç¤ºçš„æ„å»º</strong></p>
<pre><code class="language-makefile">.PHONY: build

SRCS = $(wildcard src/*.c)
OBJS = $(SRCS:.c=.o)

build: $(OBJS)
	@echo "==================================="
	@echo "Linking..."
	@gcc -o myapp $(OBJS)
	@echo "Build successful!"
	@echo "==================================="

%.o: %.c
	@echo "Compiling $&lt;..."
	@gcc -c $&lt; -o $@
</code></pre>
<hr />
<h2 id="ç¬¬ä¸‰ç« å˜é‡ç³»ç»Ÿ"><a class="header" href="#ç¬¬ä¸‰ç« å˜é‡ç³»ç»Ÿ">ç¬¬ä¸‰ç« ï¼šå˜é‡ç³»ç»Ÿ</a></h2>
<h3 id="31-å˜é‡å®šä¹‰"><a class="header" href="#31-å˜é‡å®šä¹‰">3.1 å˜é‡å®šä¹‰</a></h3>
<p><strong>é€’å½’èµ‹å€¼ (=)</strong></p>
<pre><code class="language-makefile"># å»¶è¿Ÿå±•å¼€ï¼šåœ¨ä½¿ç”¨æ—¶æ‰æ±‚å€¼
CC = gcc
CFLAGS = $(OPTIMIZATION) -Wall

# å¯ä»¥åå®šä¹‰
OPTIMIZATION = -O2

# ç»“æœï¼šCFLAGS = -O2 -Wall
</code></pre>
<p><strong>ç®€å•èµ‹å€¼ (:=)</strong></p>
<pre><code class="language-makefile"># ç«‹å³å±•å¼€ï¼šå®šä¹‰æ—¶æ±‚å€¼
CC := gcc
CFLAGS := $(OPTIMIZATION) -Wall
OPTIMIZATION := -O2

# ç»“æœï¼šCFLAGS = -Wall (OPTIMIZATIONè¿˜æœªå®šä¹‰)
</code></pre>
<p><strong>æ¡ä»¶èµ‹å€¼ (?=)</strong></p>
<pre><code class="language-makefile"># å¦‚æœå˜é‡æœªå®šä¹‰ï¼Œåˆ™èµ‹å€¼
CC ?= gcc

# ç­‰åŒäº
ifndef CC
    CC = gcc
endif
</code></pre>
<p><strong>è¿½åŠ èµ‹å€¼ (+=)</strong></p>
<pre><code class="language-makefile">CFLAGS = -Wall
CFLAGS += -Wextra
CFLAGS += -std=c99

# ç»“æœï¼šCFLAGS = -Wall -Wextra -std=c99
</code></pre>
<p><strong>å˜é‡ç±»å‹å¯¹æ¯”</strong></p>
<pre><code class="language-makefile"># ç¤ºä¾‹å¯¹æ¯”
X = foo
Y := $(X) bar
X = later

# è¾“å‡º Yï¼šfoo bar
# è¾“å‡º Xï¼šlater

A := foo
B := $(A) bar
A := later

# è¾“å‡º Bï¼šfoo bar
# è¾“å‡º Aï¼šlater
</code></pre>
<h3 id="32-è‡ªåŠ¨å˜é‡"><a class="header" href="#32-è‡ªåŠ¨å˜é‡">3.2 è‡ªåŠ¨å˜é‡</a></h3>
<p><strong>å¸¸ç”¨è‡ªåŠ¨å˜é‡</strong></p>
<pre><code class="language-makefile"># $@ : ç›®æ ‡æ–‡ä»¶å
# $&lt; : ç¬¬ä¸€ä¸ªä¾èµ–æ–‡ä»¶
# $^ : æ‰€æœ‰ä¾èµ–æ–‡ä»¶ï¼ˆå»é‡ï¼‰
# $+ : æ‰€æœ‰ä¾èµ–æ–‡ä»¶ï¼ˆä¸å»é‡ï¼‰
# $? : æ¯”ç›®æ ‡æ›´æ–°çš„ä¾èµ–æ–‡ä»¶
# $* : æ¨¡å¼åŒ¹é…çš„ä¸»å¹²éƒ¨åˆ†

# ç¤ºä¾‹
app: main.o utils.o helper.o
	@echo "Target: $@"          # app
	@echo "First dep: $&lt;"       # main.o
	@echo "All deps: $^"        # main.o utils.o helper.o
	gcc -o $@ $^

%.o: %.c
	@echo "Building $@"         # ä¾‹å¦‚ï¼šBuilding main.o
	@echo "From $&lt;"             # ä¾‹å¦‚ï¼šFrom main.c
	@echo "Stem: $*"            # ä¾‹å¦‚ï¼šmain
	gcc -c $&lt; -o $@
</code></pre>
<p><strong>è‡ªåŠ¨å˜é‡ä¿®é¥°ç¬¦</strong></p>
<pre><code class="language-makefile"># Dï¼šç›®å½•éƒ¨åˆ†
# Fï¼šæ–‡ä»¶åéƒ¨åˆ†

SRC = src/main.c

test:
	@echo "$@"      # test
	@echo "$(SRC)"  # src/main.c
	@echo "$(dir $(SRC))"     # src/
	@echo "$(notdir $(SRC))"  # main.c

# ä½¿ç”¨è‡ªåŠ¨å˜é‡çš„ä¿®é¥°ç¬¦
%.o: src/%.c
	@echo "$(@D)"   # ç›®æ ‡çš„ç›®å½•éƒ¨åˆ†
	@echo "$(@F)"   # ç›®æ ‡çš„æ–‡ä»¶åéƒ¨åˆ†
	@echo "$(&lt;D)"   # ä¾èµ–çš„ç›®å½•éƒ¨åˆ†
	@echo "$(&lt;F)"   # ä¾èµ–çš„æ–‡ä»¶åéƒ¨åˆ†
	gcc -c $&lt; -o $@
</code></pre>
<h3 id="33-ç¯å¢ƒå˜é‡"><a class="header" href="#33-ç¯å¢ƒå˜é‡">3.3 ç¯å¢ƒå˜é‡</a></h3>
<pre><code class="language-makefile"># è¯»å–ç¯å¢ƒå˜é‡
PATH_BACKUP = $(PATH)
HOME_DIR = $(HOME)

# è®¾ç½®æ„å»ºæ—¶çš„ç¯å¢ƒå˜é‡
export CC = gcc
export CFLAGS = -Wall -O2

# å–æ¶ˆç¯å¢ƒå˜é‡
unexport DEBUG

# ç¤ºä¾‹
build:
	@echo "Build path: $(PATH)"
	@echo "Home: $(HOME_DIR)"
</code></pre>
<p><strong>å®æˆ˜æ¡ˆä¾‹ï¼šå¤šé…ç½®æ„å»º</strong></p>
<pre><code class="language-makefile"># é…ç½®å˜é‡
CC = gcc
CFLAGS = -Wall -Wextra
DEBUG ?= 0
OPTIMIZE ?= 0

# æ ¹æ®é…ç½®è®¾ç½®ç¼–è¯‘é€‰é¡¹
ifeq ($(DEBUG), 1)
    CFLAGS += -g -DDEBUG
else
    CFLAGS += -DNDEBUG
endif

ifeq ($(OPTIMIZE), 1)
    CFLAGS += -O2
else
    CFLAGS += -O0
endif

# ç›®æ ‡æ–‡ä»¶
TARGET = myapp
SRCS = $(wildcard src/*.c)
OBJS = $(SRCS:.c=.o)

# æ„å»º
$(TARGET): $(OBJS)
	@echo "Compiling with flags: $(CFLAGS)"
	$(CC) $(CFLAGS) -o $@ $^

%.o: %.c
	$(CC) $(CFLAGS) -c $&lt; -o $@

# ä½¿ç”¨ç¤ºä¾‹ï¼š
# make DEBUG=1          # è°ƒè¯•ç‰ˆæœ¬
# make OPTIMIZE=1       # ä¼˜åŒ–ç‰ˆæœ¬
# make DEBUG=1 OPTIMIZE=1  # è°ƒè¯•+ä¼˜åŒ–

.PHONY: clean
clean:
	rm -f $(TARGET) $(OBJS)
</code></pre>
<hr />
<h2 id="ç¬¬å››ç« å‡½æ•°åº”ç”¨"><a class="header" href="#ç¬¬å››ç« å‡½æ•°åº”ç”¨">ç¬¬å››ç« ï¼šå‡½æ•°åº”ç”¨</a></h2>
<h3 id="41-å­—ç¬¦ä¸²å‡½æ•°"><a class="header" href="#41-å­—ç¬¦ä¸²å‡½æ•°">4.1 å­—ç¬¦ä¸²å‡½æ•°</a></h3>
<p>**<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mord mathnormal">b</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">ro</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">o</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord cjk_fallback">å­—ç¬¦ä¸²æ›¿æ¢</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord">âˆ—</span><span class="mord">â€˜â€˜â€˜</span><span class="mord mathnormal" style="margin-right:0.03148em;">mak</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.07153em;">SRC</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">h</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.01968em;">ll</span><span class="mord mathnormal">o</span><span class="mord">.</span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord mathnormal" style="margin-right:0.02778em;">or</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">d</span><span class="mord">.</span><span class="mord mathnormal">c</span><span class="mord mathnormal">t</span><span class="mord mathnormal">es</span><span class="mord mathnormal">t</span><span class="mord">.</span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right:0.05017em;">OB</span><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span></span></span></span>(subst .c,.o,$(SRC))</p>
<h1 id="ç»“æœ-helloo-worldo-testo"><a class="header" href="#ç»“æœ-helloo-worldo-testo">ç»“æœ: hello.o world.o test.o</a></h1>
<p>PATH = /usr/local/bin:/bin:/usr/bin
NEW_PATH = $(subst :, ,$(PATH))</p>
<h1 id="ç»“æœ-usrlocalbin-bin-usrbin"><a class="header" href="#ç»“æœ-usrlocalbin-bin-usrbin">ç»“æœ: /usr/local/bin /bin /usr/bin</a></h1>
<pre><code>
**$(patsubst pattern,replacement,text) - æ¨¡å¼æ›¿æ¢**
```makefile
SOURCES = main.c utils.c helper.c
OBJECTS = $(patsubst %.c,%.o,$(SOURCES))
# ç»“æœ: main.o utils.o helper.o

# ç®€å†™å½¢å¼
OBJECTS = $(SOURCES:.c=.o)
# ç­‰åŒäºä¸Šé¢çš„patsubst
</code></pre>
<p>**<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">i</span><span class="mord mathnormal">p</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">in</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord cjk_fallback">å»é™¤é¦–å°¾ç©ºæ ¼</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord">âˆ—</span><span class="mord">â€˜â€˜â€˜</span><span class="mord mathnormal" style="margin-right:0.03148em;">mak</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord">"</span><span class="mord mathnormal">h</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.01968em;">ll</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord mathnormal" style="margin-right:0.02778em;">or</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">d</span><span class="mord">"</span><span class="mord mathnormal" style="margin-right:0.00773em;">STR</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal" style="margin-right:0.05764em;">PPE</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span></span></span></span>(strip $(VAR))</p>
<h1 id="ç»“æœ-hello-world"><a class="header" href="#ç»“æœ-hello-world">ç»“æœ: "hello world"</a></h1>
<pre><code>
**$(findstring find,in) - æŸ¥æ‰¾å­—ç¬¦ä¸²**
```makefile
SRC = hello.c
ifeq ($(findstring .c,$(SRC)), .c)
    $(info Found C source file)
endif
</code></pre>
<p>**<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">i</span><span class="mord mathnormal">lt</span><span class="mord mathnormal" style="margin-right:0.02778em;">er</span><span class="mord mathnormal">p</span><span class="mord mathnormal">a</span><span class="mord mathnormal">tt</span><span class="mord mathnormal" style="margin-right:0.02778em;">er</span><span class="mord mathnormal">n</span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord cjk_fallback">è¿‡æ»¤</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord">âˆ—</span><span class="mord">â€˜â€˜â€˜</span><span class="mord mathnormal" style="margin-right:0.03148em;">mak</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal">L</span><span class="mord mathnormal" style="margin-right:0.05764em;">ES</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">main</span><span class="mord">.</span><span class="mord mathnormal">c</span><span class="mord mathnormal">t</span><span class="mord mathnormal">es</span><span class="mord mathnormal">t</span><span class="mord">.</span><span class="mord mathnormal">c</span><span class="mord mathnormal">pp</span><span class="mord mathnormal">u</span><span class="mord mathnormal">t</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">s</span><span class="mord">.</span><span class="mord mathnormal">c</span><span class="mord mathnormal">h</span><span class="mord mathnormal">e</span><span class="mord mathnormal">lp</span><span class="mord mathnormal" style="margin-right:0.02778em;">er</span><span class="mord">.</span><span class="mord mathnormal">h</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal">L</span><span class="mord mathnormal" style="margin-right:0.05764em;">ES</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span></span></span></span>(filter %.c,$(FILES))</p>
<h1 id="ç»“æœ-mainc-utilsc"><a class="header" href="#ç»“æœ-mainc-utilsc">ç»“æœ: main.c utils.c</a></h1>
<p>CPP_FILES = $(filter %.cpp,$(FILES))</p>
<h1 id="ç»“æœ-testcpp"><a class="header" href="#ç»“æœ-testcpp">ç»“æœ: test.cpp</a></h1>
<pre><code>
**$(filter-out pattern...,text) - åå‘è¿‡æ»¤**
```makefile
FILES = main.c test.o utils.c helper.o
SOURCES = $(filter-out %.o,$(FILES))
# ç»“æœ: main.c utils.c
</code></pre>
<h3 id="42-æ–‡ä»¶åå‡½æ•°"><a class="header" href="#42-æ–‡ä»¶åå‡½æ•°">4.2 æ–‡ä»¶åå‡½æ•°</a></h3>
<p>**<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">nam</span><span class="mord mathnormal">es</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord cjk_fallback">æå–ç›®å½•</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord">âˆ—</span><span class="mord">â€˜â€˜â€˜</span><span class="mord mathnormal" style="margin-right:0.03148em;">mak</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal">L</span><span class="mord mathnormal" style="margin-right:0.05764em;">ES</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">src</span><span class="mord">/</span><span class="mord mathnormal">main</span><span class="mord">.</span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">ib</span><span class="mord">/</span><span class="mord mathnormal">u</span><span class="mord mathnormal">t</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">s</span><span class="mord">.</span><span class="mord mathnormal">c</span><span class="mord mathnormal">in</span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mord">/</span><span class="mord mathnormal">h</span><span class="mord mathnormal">e</span><span class="mord mathnormal">a</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.02778em;">er</span><span class="mord">.</span><span class="mord mathnormal">h</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal" style="margin-right:0.05764em;">RS</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span></span></span></span>(dir $(FILES))</p>
<h1 id="ç»“æœ-src-lib-include"><a class="header" href="#ç»“æœ-src-lib-include">ç»“æœ: src/ lib/ include/</a></h1>
<pre><code>
**$(notdir names) - æå–æ–‡ä»¶å**
```makefile
PATHS = src/main.c lib/utils.c
FILES = $(notdir $(PATHS))
# ç»“æœ: main.c utils.c
</code></pre>
<p>**<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mord mathnormal" style="margin-right:0.10764em;">ff</span><span class="mord mathnormal">i</span><span class="mord mathnormal">x</span><span class="mord mathnormal">nam</span><span class="mord mathnormal">es</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord cjk_fallback">æå–åç¼€</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord">âˆ—</span><span class="mord">â€˜â€˜â€˜</span><span class="mord mathnormal" style="margin-right:0.03148em;">mak</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal">L</span><span class="mord mathnormal" style="margin-right:0.05764em;">ES</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">main</span><span class="mord">.</span><span class="mord mathnormal">c</span><span class="mord mathnormal">u</span><span class="mord mathnormal">t</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">s</span><span class="mord">.</span><span class="mord mathnormal">c</span><span class="mord mathnormal">pp</span><span class="mord mathnormal">h</span><span class="mord mathnormal">e</span><span class="mord mathnormal">a</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.02778em;">er</span><span class="mord">.</span><span class="mord mathnormal">h</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mord mathnormal" style="margin-right:0.13889em;">FF</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal" style="margin-right:0.05764em;">XES</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span></span></span></span>(suffix $(FILES))</p>
<h1 id="ç»“æœ-c-cpp-h"><a class="header" href="#ç»“æœ-c-cpp-h">ç»“æœ: .c .cpp .h</a></h1>
<pre><code>
**$(basename names) - å»é™¤åç¼€**
```makefile
FILES = main.c utils.o header.h
BASES = $(basename $(FILES))
# ç»“æœ: main utils header
</code></pre>
<p><strong>$(wildcard pattern) - é€šé…ç¬¦å±•å¼€</strong></p>
<pre><code class="language-makefile"># è·å–æ‰€æœ‰.cæ–‡ä»¶
C_SOURCES = $(wildcard *.c)
C_SOURCES = $(wildcard src/*.c)

# é€’å½’è·å–
C_SOURCES = $(wildcard src/**/*.c)
</code></pre>
<p><strong>$(realpath names) - è·å–ç»å¯¹è·¯å¾„</strong></p>
<pre><code class="language-makefile">ABS_PATH = &lt;span class="katex"&gt;&lt;span class="katex-html" aria-hidden="true"&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:1em;vertical-align:-0.25em;"&gt;&lt;/span&gt;&lt;span class="mopen"&gt;(&lt;/span&gt;&lt;span class="mord mathnormal"&gt;re&lt;/span&gt;&lt;span class="mord mathnormal"&gt;a&lt;/span&gt;&lt;span class="mord mathnormal"&gt;lp&lt;/span&gt;&lt;span class="mord mathnormal"&gt;a&lt;/span&gt;&lt;span class="mord mathnormal"&gt;t&lt;/span&gt;&lt;span class="mord mathnormal"&gt;h&lt;/span&gt;&lt;span class="mord"&gt;../&lt;/span&gt;&lt;span class="mord mathnormal"&gt;src&lt;/span&gt;&lt;span class="mord"&gt;/&lt;/span&gt;&lt;span class="mord mathnormal"&gt;main&lt;/span&gt;&lt;span class="mord"&gt;.&lt;/span&gt;&lt;span class="mord mathnormal"&gt;c&lt;/span&gt;&lt;span class="mclose"&gt;)&lt;/span&gt;&lt;span class="mord"&gt;â€˜â€˜â€˜&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2222em;"&gt;&lt;/span&gt;&lt;span class="mbin"&gt;âˆ—&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2222em;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:0.4653em;"&gt;&lt;/span&gt;&lt;span class="mord"&gt;âˆ—&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;(abspath names) - è·å–ç»å¯¹è·¯å¾„ï¼ˆä¸è§£æç¬¦å·é“¾æ¥ï¼‰**
```makefile
ABS_PATH = $(abspath ./src/main.c)
</code></pre>
<h3 id="43-æ¡ä»¶å‡½æ•°"><a class="header" href="#43-æ¡ä»¶å‡½æ•°">4.3 æ¡ä»¶å‡½æ•°</a></h3>
<p>**<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">co</span><span class="mord mathnormal">n</span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">t</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">h</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">se</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">t</span><span class="mclose">])</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord">âˆ—</span><span class="mord">â€˜â€˜â€˜</span><span class="mord mathnormal" style="margin-right:0.03148em;">mak</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal" style="margin-right:0.02778em;">eD</span><span class="mord mathnormal" style="margin-right:0.05017em;">EB</span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">1</span><span class="mord mathnormal" style="margin-right:0.13889em;">CF</span><span class="mord mathnormal">L</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.05764em;">GS</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span></span></span></span>(if $(DEBUG),-g -O0,-O2)</p>
<h1 id="å¦‚æœdebugä¸ºçœŸä½¿ç”¨--g--o0å¦åˆ™ä½¿ç”¨--o2"><a class="header" href="#å¦‚æœdebugä¸ºçœŸä½¿ç”¨--g--o0å¦åˆ™ä½¿ç”¨--o2">å¦‚æœDEBUGä¸ºçœŸï¼Œä½¿ç”¨ -g -O0ï¼Œå¦åˆ™ä½¿ç”¨ -O2</a></h1>
<pre><code>
**$(or condition1[,condition2...])**
```makefile
VALUE = $(or $(VAR1),$(VAR2),default)
# è¿”å›ç¬¬ä¸€ä¸ªéç©ºå€¼
</code></pre>
<p>**<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">an</span><span class="mord mathnormal">d</span><span class="mord mathnormal">co</span><span class="mord mathnormal">n</span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">t</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mord">1</span><span class="mopen">[</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">co</span><span class="mord mathnormal">n</span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">t</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mord">2...</span><span class="mclose">])</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord">âˆ—</span><span class="mord">â€˜â€˜â€˜</span><span class="mord mathnormal" style="margin-right:0.03148em;">mak</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.05764em;">RES</span><span class="mord mathnormal">UL</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span></span></span></span>(and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord">1</span><span class="mclose">)</span><span class="mpunct">,</span></span></span></span>(VAR2))</p>
<h1 id="å¦‚æœæ‰€æœ‰æ¡ä»¶éƒ½ä¸ºçœŸè¿”å›æœ€åä¸€ä¸ªå€¼"><a class="header" href="#å¦‚æœæ‰€æœ‰æ¡ä»¶éƒ½ä¸ºçœŸè¿”å›æœ€åä¸€ä¸ªå€¼">å¦‚æœæ‰€æœ‰æ¡ä»¶éƒ½ä¸ºçœŸï¼Œè¿”å›æœ€åä¸€ä¸ªå€¼</a></h1>
<pre><code>
### 4.4 å…¶ä»–é‡è¦å‡½æ•°

**$(shell command) - æ‰§è¡ŒShellå‘½ä»¤**
```makefile
# è·å–å½“å‰ç›®å½•
PWD = $(shell pwd)

# è·å–gitç‰ˆæœ¬
GIT_VERSION = $(shell git describe --tags --always)

# æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
FILE_EXISTS = $(shell test -f config.h &amp;&amp; echo yes)
</code></pre>
<p><strong>$(call variable,param1,param2,...) - è°ƒç”¨è‡ªå®šä¹‰å‡½æ•°</strong></p>
<pre><code class="language-makefile"># å®šä¹‰å‡½æ•°
reverse = $(2) $(1)

# è°ƒç”¨
RESULT = $(call reverse,hello,world)
# ç»“æœ: world hello

# å®ç”¨ç¤ºä¾‹ï¼šç¼–è¯‘å‡½æ•°
define COMPILE_C
	@echo "Compiling $(1)..."
	gcc $(CFLAGS) -c $(1) -o $(2)
endef

# ä½¿ç”¨
%.o: %.c
	$(call COMPILE_C,$&lt;,$@)
</code></pre>
<p>**<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">ore</span><span class="mord mathnormal">a</span><span class="mord mathnormal">c</span><span class="mord mathnormal">h</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord cjk_fallback">å¾ªç¯</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord">âˆ—</span><span class="mord">â€˜â€˜â€˜</span><span class="mord mathnormal" style="margin-right:0.03148em;">mak</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal" style="margin-right:0.02778em;">eD</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal" style="margin-right:0.05764em;">RS</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord mathnormal">src</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">ibin</span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mord mathnormal">A</span><span class="mord mathnormal">L</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mord mathnormal" style="margin-right:0.05764em;">RCES</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span></span></span></span>(foreach dir,<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal" style="margin-right:0.05764em;">RS</span><span class="mclose">)</span><span class="mpunct">,</span></span></span></span>(wildcard $(dir)/*.c))</p>
<h1 id="ç¤ºä¾‹2ç”Ÿæˆå¤šä¸ªç›®æ ‡"><a class="header" href="#ç¤ºä¾‹2ç”Ÿæˆå¤šä¸ªç›®æ ‡">ç¤ºä¾‹2ï¼šç”Ÿæˆå¤šä¸ªç›®æ ‡</a></h1>
<p>NUMBERS = 1 2 3 4 5
FILES = $(foreach n,<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mord mathnormal" style="margin-right:0.05764em;">MBERS</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span></span></span></span>(n).txt)</p>
<h1 id="ç»“æœ-file1txt-file2txt-file3txt-file4txt-file5txt"><a class="header" href="#ç»“æœ-file1txt-file2txt-file3txt-file4txt-file5txt">ç»“æœ: file1.txt file2.txt file3.txt file4.txt file5.txt</a></h1>
<pre><code>
**$(eval text) - åŠ¨æ€æ±‚å€¼**
```makefile
# åŠ¨æ€ç”Ÿæˆè§„åˆ™
PROGRAMS = app1 app2 app3

define PROGRAM_template
&lt;span class="katex"&gt;&lt;span class="katex-html" aria-hidden="true"&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:1em;vertical-align:-0.25em;"&gt;&lt;/span&gt;&lt;span class="mopen"&gt;(&lt;/span&gt;&lt;span class="mord"&gt;1&lt;/span&gt;&lt;span class="mclose"&gt;)&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2778em;"&gt;&lt;/span&gt;&lt;span class="mrel"&gt;:&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;(1).c
	gcc -o &lt;span class="katex"&gt;&lt;span class="katex-html" aria-hidden="true"&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:1em;vertical-align:-0.25em;"&gt;&lt;/span&gt;&lt;span class="mopen"&gt;(&lt;/span&gt;&lt;span class="mord"&gt;1&lt;/span&gt;&lt;span class="mclose"&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;(1).c
endef

&lt;span class="katex"&gt;&lt;span class="katex-html" aria-hidden="true"&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:1em;vertical-align:-0.25em;"&gt;&lt;/span&gt;&lt;span class="mopen"&gt;(&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.10764em;"&gt;f&lt;/span&gt;&lt;span class="mord mathnormal"&gt;ore&lt;/span&gt;&lt;span class="mord mathnormal"&gt;a&lt;/span&gt;&lt;span class="mord mathnormal"&gt;c&lt;/span&gt;&lt;span class="mord mathnormal"&gt;h&lt;/span&gt;&lt;span class="mord mathnormal"&gt;p&lt;/span&gt;&lt;span class="mord mathnormal"&gt;ro&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.03588em;"&gt;g&lt;/span&gt;&lt;span class="mpunct"&gt;,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;(PROGRAMS),&lt;span class="katex"&gt;&lt;span class="katex-html" aria-hidden="true"&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:1em;vertical-align:-0.25em;"&gt;&lt;/span&gt;&lt;span class="mopen"&gt;(&lt;/span&gt;&lt;span class="mord mathnormal"&gt;e&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.03588em;"&gt;v&lt;/span&gt;&lt;span class="mord mathnormal"&gt;a&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.01968em;"&gt;l&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;(call PROGRAM_template,$(prog))))

# æ•ˆæœï¼šä¸ºæ¯ä¸ªç¨‹åºç”Ÿæˆå•ç‹¬çš„è§„åˆ™
</code></pre>
<p><strong>å®æˆ˜æ¡ˆä¾‹ï¼šè‡ªåŠ¨ç”Ÿæˆä¾èµ–</strong></p>
<pre><code class="language-makefile">CC = gcc
CFLAGS = -Wall -Wextra -std=c99
DEPFLAGS = -MMD -MP

SRC_DIR = src
OBJ_DIR = obj
BIN_DIR = bin

SOURCES = $(wildcard &lt;span class="katex"&gt;&lt;span class="katex-html" aria-hidden="true"&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:1em;vertical-align:-0.25em;"&gt;&lt;/span&gt;&lt;span class="mopen"&gt;(&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.00773em;"&gt;SR&lt;/span&gt;&lt;span class="mord"&gt;&lt;span class="mord mathnormal" style="margin-right:0.07153em;"&gt;C&lt;/span&gt;&lt;span class="msupsub"&gt;&lt;span class="vlist-t vlist-t2"&gt;&lt;span class="vlist-r"&gt;&lt;span class="vlist" style="height:0.3283em;"&gt;&lt;span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"&gt;&lt;span class="pstrut" style="height:2.7em;"&gt;&lt;/span&gt;&lt;span class="sizing reset-size6 size3 mtight"&gt;&lt;span class="mord mathnormal mtight" style="margin-right:0.02778em;"&gt;D&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="vlist-s"&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class="vlist-r"&gt;&lt;span class="vlist" style="height:0.15em;"&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.07847em;"&gt;I&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.00773em;"&gt;R&lt;/span&gt;&lt;span class="mclose"&gt;)&lt;/span&gt;&lt;span class="mord"&gt;/&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2222em;"&gt;&lt;/span&gt;&lt;span class="mbin"&gt;âˆ—&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2222em;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:1em;vertical-align:-0.25em;"&gt;&lt;/span&gt;&lt;span class="mord"&gt;.&lt;/span&gt;&lt;span class="mord mathnormal"&gt;c&lt;/span&gt;&lt;span class="mclose"&gt;)&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.05017em;"&gt;OB&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.09618em;"&gt;J&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.05764em;"&gt;ECTS&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2778em;"&gt;&lt;/span&gt;&lt;span class="mrel"&gt;=&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;(patsubst &lt;span class="katex"&gt;&lt;span class="katex-html" aria-hidden="true"&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:1em;vertical-align:-0.25em;"&gt;&lt;/span&gt;&lt;span class="mopen"&gt;(&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.00773em;"&gt;SR&lt;/span&gt;&lt;span class="mord"&gt;&lt;span class="mord mathnormal" style="margin-right:0.07153em;"&gt;C&lt;/span&gt;&lt;span class="msupsub"&gt;&lt;span class="vlist-t vlist-t2"&gt;&lt;span class="vlist-r"&gt;&lt;span class="vlist" style="height:0.3283em;"&gt;&lt;span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"&gt;&lt;span class="pstrut" style="height:2.7em;"&gt;&lt;/span&gt;&lt;span class="sizing reset-size6 size3 mtight"&gt;&lt;span class="mord mathnormal mtight" style="margin-right:0.02778em;"&gt;D&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="vlist-s"&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class="vlist-r"&gt;&lt;span class="vlist" style="height:0.15em;"&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.07847em;"&gt;I&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.00773em;"&gt;R&lt;/span&gt;&lt;span class="mclose"&gt;)&lt;/span&gt;&lt;span class="mord"&gt;/&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;(OBJ_DIR)/%.o,&lt;span class="katex"&gt;&lt;span class="katex-html" aria-hidden="true"&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:1em;vertical-align:-0.25em;"&gt;&lt;/span&gt;&lt;span class="mopen"&gt;(&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.02778em;"&gt;SO&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.10903em;"&gt;U&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.05764em;"&gt;RCES&lt;/span&gt;&lt;span class="mclose"&gt;))&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.02778em;"&gt;D&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.05764em;"&gt;EPS&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2778em;"&gt;&lt;/span&gt;&lt;span class="mrel"&gt;=&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;(OBJECTS:.o=.d)
TARGET = $(BIN_DIR)/myapp

# åŒ…å«ä¾èµ–æ–‡ä»¶
-include $(DEPS)

# åˆ›å»ºç›®å½•
&lt;span class="katex"&gt;&lt;span class="katex-html" aria-hidden="true"&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:1em;vertical-align:-0.25em;"&gt;&lt;/span&gt;&lt;span class="mopen"&gt;(&lt;/span&gt;&lt;span class="mord mathnormal"&gt;s&lt;/span&gt;&lt;span class="mord mathnormal"&gt;h&lt;/span&gt;&lt;span class="mord mathnormal"&gt;e&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.01968em;"&gt;ll&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.03148em;"&gt;mk&lt;/span&gt;&lt;span class="mord mathnormal"&gt;d&lt;/span&gt;&lt;span class="mord mathnormal"&gt;i&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.02778em;"&gt;r&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2222em;"&gt;&lt;/span&gt;&lt;span class="mbin"&gt;âˆ’&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2222em;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:0.625em;vertical-align:-0.1944em;"&gt;&lt;/span&gt;&lt;span class="mord mathnormal"&gt;p&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;(OBJ_DIR) $(BIN_DIR))

# é“¾æ¥
$(TARGET): &lt;span class="katex"&gt;&lt;span class="katex-html" aria-hidden="true"&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:1em;vertical-align:-0.25em;"&gt;&lt;/span&gt;&lt;span class="mopen"&gt;(&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.05017em;"&gt;OB&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.09618em;"&gt;J&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.05764em;"&gt;ECTS&lt;/span&gt;&lt;span class="mclose"&gt;)&lt;/span&gt;&lt;span class="mord"&gt;@&lt;/span&gt;&lt;span class="mord mathnormal"&gt;ec&lt;/span&gt;&lt;span class="mord mathnormal"&gt;h&lt;/span&gt;&lt;span class="mord mathnormal"&gt;o&lt;/span&gt;&lt;span class="mord"&gt;&amp;quot;&lt;/span&gt;&lt;span class="mord mathnormal"&gt;L&lt;/span&gt;&lt;span class="mord mathnormal"&gt;inkin&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.03588em;"&gt;g&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;@..."
	@&lt;span class="katex"&gt;&lt;span class="katex-html" aria-hidden="true"&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:1em;vertical-align:-0.25em;"&gt;&lt;/span&gt;&lt;span class="mopen"&gt;(&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.07153em;"&gt;CC&lt;/span&gt;&lt;span class="mclose"&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;(CFLAGS) -o &lt;span class="katex"&gt;&lt;span class="katex-html" aria-hidden="true"&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:0.6944em;"&gt;&lt;/span&gt;&lt;span class="mord"&gt;@&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;^

# ç¼–è¯‘ï¼ˆè‡ªåŠ¨ç”Ÿæˆ.dæ–‡ä»¶ï¼‰
&lt;span class="katex"&gt;&lt;span class="katex-html" aria-hidden="true"&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:1em;vertical-align:-0.25em;"&gt;&lt;/span&gt;&lt;span class="mopen"&gt;(&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.05017em;"&gt;OB&lt;/span&gt;&lt;span class="mord"&gt;&lt;span class="mord mathnormal" style="margin-right:0.09618em;"&gt;J&lt;/span&gt;&lt;span class="msupsub"&gt;&lt;span class="vlist-t vlist-t2"&gt;&lt;span class="vlist-r"&gt;&lt;span class="vlist" style="height:0.3283em;"&gt;&lt;span style="top:-2.55em;margin-left:-0.0962em;margin-right:0.05em;"&gt;&lt;span class="pstrut" style="height:2.7em;"&gt;&lt;/span&gt;&lt;span class="sizing reset-size6 size3 mtight"&gt;&lt;span class="mord mathnormal mtight" style="margin-right:0.02778em;"&gt;D&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="vlist-s"&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class="vlist-r"&gt;&lt;span class="vlist" style="height:0.15em;"&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.07847em;"&gt;I&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.00773em;"&gt;R&lt;/span&gt;&lt;span class="mclose"&gt;)&lt;/span&gt;&lt;span class="mord"&gt;/&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;(SRC_DIR)/%.c
	@echo "Compiling &lt;span class="katex"&gt;&lt;span class="katex-html" aria-hidden="true"&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"&gt;&lt;/span&gt;&lt;span class="mrel"&gt;&amp;lt;&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2778em;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:0.6944em;"&gt;&lt;/span&gt;&lt;span class="mord"&gt;...&amp;quot;@&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;(CC) &lt;span class="katex"&gt;&lt;span class="katex-html" aria-hidden="true"&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:1em;vertical-align:-0.25em;"&gt;&lt;/span&gt;&lt;span class="mopen"&gt;(&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.13889em;"&gt;CF&lt;/span&gt;&lt;span class="mord mathnormal"&gt;L&lt;/span&gt;&lt;span class="mord mathnormal"&gt;A&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.05764em;"&gt;GS&lt;/span&gt;&lt;span class="mclose"&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;(DEPFLAGS) -c &lt;span class="katex"&gt;&lt;span class="katex-html" aria-hidden="true"&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"&gt;&lt;/span&gt;&lt;span class="mrel"&gt;&amp;lt;&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2778em;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"&gt;&lt;/span&gt;&lt;span class="mord"&gt;âˆ’&lt;/span&gt;&lt;span class="mord mathnormal"&gt;o&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;@

.PHONY: clean
clean:
	rm -rf &lt;span class="katex"&gt;&lt;span class="katex-html" aria-hidden="true"&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:1em;vertical-align:-0.25em;"&gt;&lt;/span&gt;&lt;span class="mopen"&gt;(&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.05017em;"&gt;OB&lt;/span&gt;&lt;span class="mord"&gt;&lt;span class="mord mathnormal" style="margin-right:0.09618em;"&gt;J&lt;/span&gt;&lt;span class="msupsub"&gt;&lt;span class="vlist-t vlist-t2"&gt;&lt;span class="vlist-r"&gt;&lt;span class="vlist" style="height:0.3283em;"&gt;&lt;span style="top:-2.55em;margin-left:-0.0962em;margin-right:0.05em;"&gt;&lt;span class="pstrut" style="height:2.7em;"&gt;&lt;/span&gt;&lt;span class="sizing reset-size6 size3 mtight"&gt;&lt;span class="mord mathnormal mtight" style="margin-right:0.02778em;"&gt;D&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="vlist-s"&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class="vlist-r"&gt;&lt;span class="vlist" style="height:0.15em;"&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.07847em;"&gt;I&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.00773em;"&gt;R&lt;/span&gt;&lt;span class="mclose"&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;(BIN_DIR)
</code></pre>
<hr />
<h2 id="ç¬¬äº”ç« æ¨¡å¼è§„åˆ™ä¸éšå¼è§„åˆ™"><a class="header" href="#ç¬¬äº”ç« æ¨¡å¼è§„åˆ™ä¸éšå¼è§„åˆ™">ç¬¬äº”ç« ï¼šæ¨¡å¼è§„åˆ™ä¸éšå¼è§„åˆ™</a></h2>
<h3 id="51-æ¨¡å¼è§„åˆ™"><a class="header" href="#51-æ¨¡å¼è§„åˆ™">5.1 æ¨¡å¼è§„åˆ™</a></h3>
<p><strong>åŸºæœ¬è¯­æ³•</strong></p>
<pre><code class="language-makefile"># % æ˜¯æ¨¡å¼åŒ¹é…ç¬¦
%.o: %.c
	gcc -c &lt;span class="katex"&gt;&lt;span class="katex-html" aria-hidden="true"&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"&gt;&lt;/span&gt;&lt;span class="mrel"&gt;&amp;lt;&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2778em;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"&gt;&lt;/span&gt;&lt;span class="mord"&gt;âˆ’&lt;/span&gt;&lt;span class="mord mathnormal"&gt;o&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;@

# ç­‰ä»·äºä¸ºæ¯ä¸ª.cæ–‡ä»¶å®šä¹‰ä¸€ä¸ªè§„åˆ™
# main.o: main.c
# utils.o: utils.c
# ...
</code></pre>
<p><strong>å¤šä¸ªæ¨¡å¼</strong></p>
<pre><code class="language-makefile"># ä».cæˆ–.cppç¼–è¯‘.o
%.o: %.c
	gcc -c &lt;span class="katex"&gt;&lt;span class="katex-html" aria-hidden="true"&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"&gt;&lt;/span&gt;&lt;span class="mrel"&gt;&amp;lt;&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2778em;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"&gt;&lt;/span&gt;&lt;span class="mord"&gt;âˆ’&lt;/span&gt;&lt;span class="mord mathnormal"&gt;o&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;@

%.o: %.cpp
	g++ -c &lt;span class="katex"&gt;&lt;span class="katex-html" aria-hidden="true"&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"&gt;&lt;/span&gt;&lt;span class="mrel"&gt;&amp;lt;&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2778em;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"&gt;&lt;/span&gt;&lt;span class="mord"&gt;âˆ’&lt;/span&gt;&lt;span class="mord mathnormal"&gt;o&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;@
</code></pre>
<h3 id="52-é™æ€æ¨¡å¼è§„åˆ™"><a class="header" href="#52-é™æ€æ¨¡å¼è§„åˆ™">5.2 é™æ€æ¨¡å¼è§„åˆ™</a></h3>
<p><strong>è¯­æ³•</strong></p>
<pre><code class="language-makefile">targets: target-pattern: prereq-patterns
	commands

# ç¤ºä¾‹
OBJECTS = main.o utils.o helper.o

&lt;span class="katex"&gt;&lt;span class="katex-html" aria-hidden="true"&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:1em;vertical-align:-0.25em;"&gt;&lt;/span&gt;&lt;span class="mopen"&gt;(&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.05017em;"&gt;OB&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.09618em;"&gt;J&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.05764em;"&gt;ECTS&lt;/span&gt;&lt;span class="mclose"&gt;)&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2778em;"&gt;&lt;/span&gt;&lt;span class="mrel"&gt;:&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2778em;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:0.7778em;vertical-align:-0.1944em;"&gt;&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.03588em;"&gt;g&lt;/span&gt;&lt;span class="mord mathnormal"&gt;cc&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2222em;"&gt;&lt;/span&gt;&lt;span class="mbin"&gt;âˆ’&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2222em;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:0.4306em;"&gt;&lt;/span&gt;&lt;span class="mord mathnormal"&gt;c&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt; -o $@

# åªå¯¹OBJECTSä¸­çš„æ–‡ä»¶åº”ç”¨æ­¤è§„åˆ™
</code></pre>
<p><strong>å®ç”¨ç¤ºä¾‹</strong></p>
<pre><code class="language-makefile">SRC_DIR = src
OBJ_DIR = obj

SOURCES = src/main.c src/utils.c src/helper.c
OBJECTS = obj/main.o obj/utils.o obj/helper.o

# é™æ€æ¨¡å¼è§„åˆ™
$(OBJECTS): &lt;span class="katex"&gt;&lt;span class="katex-html" aria-hidden="true"&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:1em;vertical-align:-0.25em;"&gt;&lt;/span&gt;&lt;span class="mopen"&gt;(&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.05017em;"&gt;OB&lt;/span&gt;&lt;span class="mord"&gt;&lt;span class="mord mathnormal" style="margin-right:0.09618em;"&gt;J&lt;/span&gt;&lt;span class="msupsub"&gt;&lt;span class="vlist-t vlist-t2"&gt;&lt;span class="vlist-r"&gt;&lt;span class="vlist" style="height:0.3283em;"&gt;&lt;span style="top:-2.55em;margin-left:-0.0962em;margin-right:0.05em;"&gt;&lt;span class="pstrut" style="height:2.7em;"&gt;&lt;/span&gt;&lt;span class="sizing reset-size6 size3 mtight"&gt;&lt;span class="mord mathnormal mtight" style="margin-right:0.02778em;"&gt;D&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="vlist-s"&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class="vlist-r"&gt;&lt;span class="vlist" style="height:0.15em;"&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.07847em;"&gt;I&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.00773em;"&gt;R&lt;/span&gt;&lt;span class="mclose"&gt;)&lt;/span&gt;&lt;span class="mord"&gt;/&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;(SRC_DIR)/%.c
	@mkdir -p &lt;span class="katex"&gt;&lt;span class="katex-html" aria-hidden="true"&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:1em;vertical-align:-0.25em;"&gt;&lt;/span&gt;&lt;span class="mopen"&gt;(&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.05017em;"&gt;OB&lt;/span&gt;&lt;span class="mord"&gt;&lt;span class="mord mathnormal" style="margin-right:0.09618em;"&gt;J&lt;/span&gt;&lt;span class="msupsub"&gt;&lt;span class="vlist-t vlist-t2"&gt;&lt;span class="vlist-r"&gt;&lt;span class="vlist" style="height:0.3283em;"&gt;&lt;span style="top:-2.55em;margin-left:-0.0962em;margin-right:0.05em;"&gt;&lt;span class="pstrut" style="height:2.7em;"&gt;&lt;/span&gt;&lt;span class="sizing reset-size6 size3 mtight"&gt;&lt;span class="mord mathnormal mtight" style="margin-right:0.02778em;"&gt;D&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="vlist-s"&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class="vlist-r"&gt;&lt;span class="vlist" style="height:0.15em;"&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.07847em;"&gt;I&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.00773em;"&gt;R&lt;/span&gt;&lt;span class="mclose"&gt;)&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.03588em;"&gt;g&lt;/span&gt;&lt;span class="mord mathnormal"&gt;cc&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2222em;"&gt;&lt;/span&gt;&lt;span class="mbin"&gt;âˆ’&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2222em;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:0.4306em;"&gt;&lt;/span&gt;&lt;span class="mord mathnormal"&gt;c&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt; -o $@
</code></pre>
<h3 id="53-å†…ç½®éšå¼è§„åˆ™"><a class="header" href="#53-å†…ç½®éšå¼è§„åˆ™">5.3 å†…ç½®éšå¼è§„åˆ™</a></h3>
<p><strong>å¸¸ç”¨å†…ç½®è§„åˆ™</strong></p>
<pre><code class="language-makefile"># Makeå†…ç½®çš„ä¸€äº›è§„åˆ™

# .c -&gt; .o
# ç­‰åŒäº
%.o: %.c
	$(CC) &lt;span class="katex"&gt;&lt;span class="katex-html" aria-hidden="true"&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:1em;vertical-align:-0.25em;"&gt;&lt;/span&gt;&lt;span class="mopen"&gt;(&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.13889em;"&gt;CPPF&lt;/span&gt;&lt;span class="mord mathnormal"&gt;L&lt;/span&gt;&lt;span class="mord mathnormal"&gt;A&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.05764em;"&gt;GS&lt;/span&gt;&lt;span class="mclose"&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;(CFLAGS) -c &lt;span class="katex"&gt;&lt;span class="katex-html" aria-hidden="true"&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"&gt;&lt;/span&gt;&lt;span class="mrel"&gt;&amp;lt;&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2778em;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"&gt;&lt;/span&gt;&lt;span class="mord"&gt;âˆ’&lt;/span&gt;&lt;span class="mord mathnormal"&gt;o&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;@

# .cpp -&gt; .o
%.o: %.cpp
	&lt;span class="katex"&gt;&lt;span class="katex-html" aria-hidden="true"&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:1em;vertical-align:-0.25em;"&gt;&lt;/span&gt;&lt;span class="mopen"&gt;(&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.07847em;"&gt;CXX&lt;/span&gt;&lt;span class="mclose"&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;(CPPFLAGS) &lt;span class="katex"&gt;&lt;span class="katex-html" aria-hidden="true"&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:1em;vertical-align:-0.25em;"&gt;&lt;/span&gt;&lt;span class="mopen"&gt;(&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.13889em;"&gt;CXXF&lt;/span&gt;&lt;span class="mord mathnormal"&gt;L&lt;/span&gt;&lt;span class="mord mathnormal"&gt;A&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.05764em;"&gt;GS&lt;/span&gt;&lt;span class="mclose"&gt;)&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2222em;"&gt;&lt;/span&gt;&lt;span class="mbin"&gt;âˆ’&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2222em;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:0.4306em;"&gt;&lt;/span&gt;&lt;span class="mord mathnormal"&gt;c&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt; -o $@

# .o -&gt; å¯æ‰§è¡Œæ–‡ä»¶
%: %.o
	$(CC) &lt;span class="katex"&gt;&lt;span class="katex-html" aria-hidden="true"&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:1em;vertical-align:-0.25em;"&gt;&lt;/span&gt;&lt;span class="mopen"&gt;(&lt;/span&gt;&lt;span class="mord mathnormal"&gt;L&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.02778em;"&gt;D&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.13889em;"&gt;F&lt;/span&gt;&lt;span class="mord mathnormal"&gt;L&lt;/span&gt;&lt;span class="mord mathnormal"&gt;A&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.05764em;"&gt;GS&lt;/span&gt;&lt;span class="mclose"&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;^ &lt;span class="katex"&gt;&lt;span class="katex-html" aria-hidden="true"&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:1em;vertical-align:-0.25em;"&gt;&lt;/span&gt;&lt;span class="mopen"&gt;(&lt;/span&gt;&lt;span class="mord mathnormal"&gt;L&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.02778em;"&gt;O&lt;/span&gt;&lt;span class="mord mathnormal"&gt;A&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.02778em;"&gt;D&lt;/span&gt;&lt;span class="mord mathnormal"&gt;L&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.07847em;"&gt;I&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.05764em;"&gt;BES&lt;/span&gt;&lt;span class="mclose"&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;(LDLIBS) -o $@
</code></pre>
<p><strong>æŸ¥çœ‹å†…ç½®è§„åˆ™</strong></p>
<pre><code class="language-bash"># æŸ¥çœ‹æ‰€æœ‰å†…ç½®è§„åˆ™
make -p

# æŸ¥çœ‹ç‰¹å®šç›®æ ‡çš„è§„åˆ™
make -p -f /dev/null target
</code></pre>
<p><strong>ç¦ç”¨å†…ç½®è§„åˆ™</strong></p>
<pre><code class="language-makefile"># ç¦ç”¨æ‰€æœ‰éšå¼è§„åˆ™
.SUFFIXES:

# æˆ–ä½¿ç”¨å‘½ä»¤è¡Œ
make -r
</code></pre>
<p><strong>è¦†ç›–å†…ç½®è§„åˆ™</strong></p>
<pre><code class="language-makefile"># è‡ªå®šä¹‰.c -&gt; .oè§„åˆ™
%.o: %.c
	@echo "Custom compilation: $&lt;"
	&lt;span class="katex"&gt;&lt;span class="katex-html" aria-hidden="true"&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:1em;vertical-align:-0.25em;"&gt;&lt;/span&gt;&lt;span class="mopen"&gt;(&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.07153em;"&gt;CC&lt;/span&gt;&lt;span class="mclose"&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;(CFLAGS) -c &lt;span class="katex"&gt;&lt;span class="katex-html" aria-hidden="true"&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"&gt;&lt;/span&gt;&lt;span class="mrel"&gt;&amp;lt;&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2778em;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"&gt;&lt;/span&gt;&lt;span class="mord"&gt;âˆ’&lt;/span&gt;&lt;span class="mord mathnormal"&gt;o&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;@
</code></pre>
<hr />
<h2 id="ç¬¬å…­ç« æ¡ä»¶åˆ¤æ–­"><a class="header" href="#ç¬¬å…­ç« æ¡ä»¶åˆ¤æ–­">ç¬¬å…­ç« ï¼šæ¡ä»¶åˆ¤æ–­</a></h2>
<h3 id="61-æ¡ä»¶è¯­æ³•"><a class="header" href="#61-æ¡ä»¶è¯­æ³•">6.1 æ¡ä»¶è¯­æ³•</a></h3>
<p><strong>ifeq / ifneq - å­—ç¬¦ä¸²æ¯”è¾ƒ</strong></p>
<pre><code class="language-makefile"># ifeqè¯­æ³•
ifeq (arg1,arg2)
    # ç›¸ç­‰æ—¶æ‰§è¡Œ
endif

# ifneqè¯­æ³•
ifneq (arg1,arg2)
    # ä¸ç›¸ç­‰æ—¶æ‰§è¡Œ
endif

# ç¤ºä¾‹
CC = gcc
ifeq ($(CC),gcc)
    CFLAGS += -fPIC
endif

# ä½¿ç”¨å¼•å·é¿å…ç©ºæ ¼é—®é¢˜
ifeq "$(DEBUG)" "1"
    CFLAGS += -g
endif
</code></pre>
<p><strong>ifdef / ifndef - å˜é‡æ˜¯å¦å®šä¹‰</strong></p>
<pre><code class="language-makefile">ifdef VARIABLE
    # å˜é‡å·²å®šä¹‰
endif

ifndef VARIABLE
    # å˜é‡æœªå®šä¹‰
endif

# ç¤ºä¾‹
ifdef DEBUG
    CFLAGS += -g -DDEBUG
else
    CFLAGS += -O2 -DNDEBUG
endif
</code></pre>
<p><strong>å®Œæ•´ç¤ºä¾‹</strong></p>
<pre><code class="language-makefile"># å¹³å°æ£€æµ‹
UNAME := &lt;span class="katex"&gt;&lt;span class="katex-html" aria-hidden="true"&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:1em;vertical-align:-0.25em;"&gt;&lt;/span&gt;&lt;span class="mopen"&gt;(&lt;/span&gt;&lt;span class="mord mathnormal"&gt;s&lt;/span&gt;&lt;span class="mord mathnormal"&gt;h&lt;/span&gt;&lt;span class="mord mathnormal"&gt;e&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.01968em;"&gt;ll&lt;/span&gt;&lt;span class="mord mathnormal"&gt;u&lt;/span&gt;&lt;span class="mord mathnormal"&gt;nam&lt;/span&gt;&lt;span class="mord mathnormal"&gt;e&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2222em;"&gt;&lt;/span&gt;&lt;span class="mbin"&gt;âˆ’&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2222em;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:1em;vertical-align:-0.25em;"&gt;&lt;/span&gt;&lt;span class="mord mathnormal"&gt;s&lt;/span&gt;&lt;span class="mclose"&gt;)&lt;/span&gt;&lt;span class="mord mathnormal"&gt;i&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.10764em;"&gt;f&lt;/span&gt;&lt;span class="mord mathnormal"&gt;e&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.03588em;"&gt;q&lt;/span&gt;&lt;span class="mopen"&gt;(&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;(UNAME),Linux)
    PLATFORM = linux
    CFLAGS += -DLINUX
    LDFLAGS += -lpthread
else ifeq (&lt;span class="katex"&gt;&lt;span class="katex-html" aria-hidden="true"&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:1em;vertical-align:-0.25em;"&gt;&lt;/span&gt;&lt;span class="mopen"&gt;(&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.10903em;"&gt;U&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.10903em;"&gt;N&lt;/span&gt;&lt;span class="mord mathnormal"&gt;A&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.05764em;"&gt;ME&lt;/span&gt;&lt;span class="mclose"&gt;)&lt;/span&gt;&lt;span class="mpunct"&gt;,&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.1667em;"&gt;&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.02778em;"&gt;D&lt;/span&gt;&lt;span class="mord mathnormal"&gt;a&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.02778em;"&gt;r&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.02691em;"&gt;w&lt;/span&gt;&lt;span class="mord mathnormal"&gt;in&lt;/span&gt;&lt;span class="mclose"&gt;)&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.13889em;"&gt;P&lt;/span&gt;&lt;span class="mord mathnormal"&gt;L&lt;/span&gt;&lt;span class="mord mathnormal"&gt;A&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.10903em;"&gt;TFORM&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2778em;"&gt;&lt;/span&gt;&lt;span class="mrel"&gt;=&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2778em;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"&gt;&lt;/span&gt;&lt;span class="mord mathnormal"&gt;ma&lt;/span&gt;&lt;span class="mord mathnormal"&gt;cos&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.13889em;"&gt;CF&lt;/span&gt;&lt;span class="mord mathnormal"&gt;L&lt;/span&gt;&lt;span class="mord mathnormal"&gt;A&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.05764em;"&gt;GS&lt;/span&gt;&lt;span class="mord"&gt;+&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2778em;"&gt;&lt;/span&gt;&lt;span class="mrel"&gt;=&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2778em;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"&gt;&lt;/span&gt;&lt;span class="mord"&gt;âˆ’&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.02778em;"&gt;D&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.10903em;"&gt;M&lt;/span&gt;&lt;span class="mord mathnormal"&gt;A&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.05764em;"&gt;COS&lt;/span&gt;&lt;span class="mord mathnormal"&gt;e&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.01968em;"&gt;l&lt;/span&gt;&lt;span class="mord mathnormal"&gt;se&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.13889em;"&gt;P&lt;/span&gt;&lt;span class="mord mathnormal"&gt;L&lt;/span&gt;&lt;span class="mord mathnormal"&gt;A&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.10903em;"&gt;TFORM&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2778em;"&gt;&lt;/span&gt;&lt;span class="mrel"&gt;=&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2778em;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:0.6944em;"&gt;&lt;/span&gt;&lt;span class="mord mathnormal"&gt;u&lt;/span&gt;&lt;span class="mord mathnormal"&gt;nkn&lt;/span&gt;&lt;span class="mord mathnormal"&gt;o&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.02691em;"&gt;w&lt;/span&gt;&lt;span class="mord mathnormal"&gt;n&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;(warning Unknown platform: $(UNAME))
endif

# ç¼–è¯‘å™¨æ£€æµ‹
CC ?= gcc

ifeq ($(CC),gcc)
    CFLAGS += -Wno-unused-result
else ifeq ($(CC),clang)
    CFLAGS += -Wno-format-security
endif

# è°ƒè¯•æ¨¡å¼
DEBUG ?= 0
ifeq ($(DEBUG),1)
    CFLAGS += -g -O0 -DDEBUG
    TARGET_SUFFIX = _debug
else
    CFLAGS += -O2 -DNDEBUG
    TARGET_SUFFIX = _release
endif

TARGET = myapp&lt;span class="katex"&gt;&lt;span class="katex-html" aria-hidden="true"&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:1em;vertical-align:-0.25em;"&gt;&lt;/span&gt;&lt;span class="mopen"&gt;(&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.13889em;"&gt;T&lt;/span&gt;&lt;span class="mord mathnormal"&gt;A&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.05764em;"&gt;RGE&lt;/span&gt;&lt;span class="mord"&gt;&lt;span class="mord mathnormal" style="margin-right:0.13889em;"&gt;T&lt;/span&gt;&lt;span class="msupsub"&gt;&lt;span class="vlist-t vlist-t2"&gt;&lt;span class="vlist-r"&gt;&lt;span class="vlist" style="height:0.3283em;"&gt;&lt;span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"&gt;&lt;span class="pstrut" style="height:2.7em;"&gt;&lt;/span&gt;&lt;span class="sizing reset-size6 size3 mtight"&gt;&lt;span class="mord mathnormal mtight" style="margin-right:0.05764em;"&gt;S&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="vlist-s"&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class="vlist-r"&gt;&lt;span class="vlist" style="height:0.15em;"&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.10903em;"&gt;U&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.13889em;"&gt;FF&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.07847em;"&gt;I&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.07847em;"&gt;X&lt;/span&gt;&lt;span class="mclose"&gt;)&lt;/span&gt;&lt;span class="mord mathnormal"&gt;b&lt;/span&gt;&lt;span class="mord mathnormal"&gt;u&lt;/span&gt;&lt;span class="mord mathnormal"&gt;i&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.01968em;"&gt;l&lt;/span&gt;&lt;span class="mord mathnormal"&gt;d&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2778em;"&gt;&lt;/span&gt;&lt;span class="mrel"&gt;:&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2778em;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"&gt;&lt;/span&gt;&lt;span class="mord"&gt;@&lt;/span&gt;&lt;span class="mord mathnormal"&gt;ec&lt;/span&gt;&lt;span class="mord mathnormal"&gt;h&lt;/span&gt;&lt;span class="mord mathnormal"&gt;o&lt;/span&gt;&lt;span class="mord"&gt;&amp;quot;&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.05017em;"&gt;B&lt;/span&gt;&lt;span class="mord mathnormal"&gt;u&lt;/span&gt;&lt;span class="mord mathnormal"&gt;i&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.01968em;"&gt;l&lt;/span&gt;&lt;span class="mord mathnormal"&gt;d&lt;/span&gt;&lt;span class="mord mathnormal"&gt;in&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.03588em;"&gt;g&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.10764em;"&gt;f&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.02778em;"&gt;or&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;(PLATFORM)"
	@echo "Compiler: &lt;span class="katex"&gt;&lt;span class="katex-html" aria-hidden="true"&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:1em;vertical-align:-0.25em;"&gt;&lt;/span&gt;&lt;span class="mopen"&gt;(&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.07153em;"&gt;CC&lt;/span&gt;&lt;span class="mclose"&gt;)&lt;/span&gt;&lt;span class="mord"&gt;&amp;quot;@&lt;/span&gt;&lt;span class="mord mathnormal"&gt;ec&lt;/span&gt;&lt;span class="mord mathnormal"&gt;h&lt;/span&gt;&lt;span class="mord mathnormal"&gt;o&lt;/span&gt;&lt;span class="mord"&gt;&amp;quot;&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.01968em;"&gt;Fl&lt;/span&gt;&lt;span class="mord mathnormal"&gt;a&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.03588em;"&gt;g&lt;/span&gt;&lt;span class="mord mathnormal"&gt;s&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2778em;"&gt;&lt;/span&gt;&lt;span class="mrel"&gt;:&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;(CFLAGS)"
	@echo "Target: $(TARGET)"
</code></pre>
<h3 id="62-åµŒå¥—æ¡ä»¶"><a class="header" href="#62-åµŒå¥—æ¡ä»¶">6.2 åµŒå¥—æ¡ä»¶</a></h3>
<pre><code class="language-makefile">OS = linux
ARCH = x86_64
DEBUG = 1

ifeq ($(OS),linux)
    CFLAGS += -DLINUX
    ifeq (&lt;span class="katex"&gt;&lt;span class="katex-html" aria-hidden="true"&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:1em;vertical-align:-0.25em;"&gt;&lt;/span&gt;&lt;span class="mopen"&gt;(&lt;/span&gt;&lt;span class="mord mathnormal"&gt;A&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.07153em;"&gt;RC&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.08125em;"&gt;H&lt;/span&gt;&lt;span class="mclose"&gt;)&lt;/span&gt;&lt;span class="mpunct"&gt;,&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.1667em;"&gt;&lt;/span&gt;&lt;span class="mord mathnormal"&gt;x&lt;/span&gt;&lt;span class="mord"&gt;8&lt;/span&gt;&lt;span class="mord"&gt;&lt;span class="mord"&gt;6&lt;/span&gt;&lt;span class="msupsub"&gt;&lt;span class="vlist-t vlist-t2"&gt;&lt;span class="vlist-r"&gt;&lt;span class="vlist" style="height:0.3011em;"&gt;&lt;span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"&gt;&lt;span class="pstrut" style="height:2.7em;"&gt;&lt;/span&gt;&lt;span class="sizing reset-size6 size3 mtight"&gt;&lt;span class="mord mtight"&gt;6&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="vlist-s"&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class="vlist-r"&gt;&lt;span class="vlist" style="height:0.15em;"&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="mord"&gt;4&lt;/span&gt;&lt;span class="mclose"&gt;)&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.13889em;"&gt;CF&lt;/span&gt;&lt;span class="mord mathnormal"&gt;L&lt;/span&gt;&lt;span class="mord mathnormal"&gt;A&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.05764em;"&gt;GS&lt;/span&gt;&lt;span class="mord"&gt;+&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2778em;"&gt;&lt;/span&gt;&lt;span class="mrel"&gt;=&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2778em;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:1em;vertical-align:-0.25em;"&gt;&lt;/span&gt;&lt;span class="mord"&gt;âˆ’&lt;/span&gt;&lt;span class="mord mathnormal"&gt;m&lt;/span&gt;&lt;span class="mord"&gt;64&lt;/span&gt;&lt;span class="mord mathnormal"&gt;e&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.01968em;"&gt;l&lt;/span&gt;&lt;span class="mord mathnormal"&gt;se&lt;/span&gt;&lt;span class="mord mathnormal"&gt;i&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.10764em;"&gt;f&lt;/span&gt;&lt;span class="mord mathnormal"&gt;e&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.03588em;"&gt;q&lt;/span&gt;&lt;span class="mopen"&gt;(&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;(ARCH),i386)
        CFLAGS += -m32
    endif

    ifdef DEBUG
        CFLAGS += -g
    endif
else ifeq ($(OS),windows)
    CFLAGS += -DWINDOWS
endif
</code></pre>
<hr />
<h2 id="ç¬¬ä¸ƒç« é«˜çº§ç‰¹æ€§"><a class="header" href="#ç¬¬ä¸ƒç« é«˜çº§ç‰¹æ€§">ç¬¬ä¸ƒç« ï¼šé«˜çº§ç‰¹æ€§</a></h2>
<h3 id="71-å¹¶è¡Œç¼–è¯‘"><a class="header" href="#71-å¹¶è¡Œç¼–è¯‘">7.1 å¹¶è¡Œç¼–è¯‘</a></h3>
<p><strong>ä½¿ç”¨-jå‚æ•°</strong></p>
<pre><code class="language-bash"># å¹¶è¡Œç¼–è¯‘ï¼ˆè‡ªåŠ¨æ£€æµ‹CPUæ ¸å¿ƒæ•°ï¼‰
make -j

# æŒ‡å®šå¹¶è¡Œä»»åŠ¡æ•°
make -j4

# æ— é™å¹¶è¡Œï¼ˆä¸æ¨èï¼‰
make -j$(nproc)
</code></pre>
<p><strong>æ§åˆ¶å¹¶è¡Œ</strong></p>
<pre><code class="language-makefile"># æŒ‡å®šä¸èƒ½å¹¶è¡Œçš„ç›®æ ‡
.NOTPARALLEL: target1 target2

# ç¤ºä¾‹ï¼šå®‰è£…å¿…é¡»ä¸²è¡Œ
.NOTPARALLEL: install

install: build
	@echo "Installing..."
	cp myapp /usr/local/bin/
</code></pre>
<h3 id="72-é€’å½’make"><a class="header" href="#72-é€’å½’make">7.2 é€’å½’Make</a></h3>
<p><strong>è°ƒç”¨å­ç›®å½•çš„Makefile</strong></p>
<pre><code class="language-makefile">SUBDIRS = src lib tests

.PHONY: subdirs &lt;span class="katex"&gt;&lt;span class="katex-html" aria-hidden="true"&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:1em;vertical-align:-0.25em;"&gt;&lt;/span&gt;&lt;span class="mopen"&gt;(&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.05764em;"&gt;S&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.10903em;"&gt;U&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.05017em;"&gt;B&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.02778em;"&gt;D&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.07847em;"&gt;I&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.05764em;"&gt;RS&lt;/span&gt;&lt;span class="mclose"&gt;)&lt;/span&gt;&lt;span class="mord mathnormal"&gt;s&lt;/span&gt;&lt;span class="mord mathnormal"&gt;u&lt;/span&gt;&lt;span class="mord mathnormal"&gt;b&lt;/span&gt;&lt;span class="mord mathnormal"&gt;d&lt;/span&gt;&lt;span class="mord mathnormal"&gt;i&lt;/span&gt;&lt;span class="mord mathnormal"&gt;rs&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2778em;"&gt;&lt;/span&gt;&lt;span class="mrel"&gt;:&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;(SUBDIRS)

&lt;span class="katex"&gt;&lt;span class="katex-html" aria-hidden="true"&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:1em;vertical-align:-0.25em;"&gt;&lt;/span&gt;&lt;span class="mopen"&gt;(&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.05764em;"&gt;S&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.10903em;"&gt;U&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.05017em;"&gt;B&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.02778em;"&gt;D&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.07847em;"&gt;I&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.05764em;"&gt;RS&lt;/span&gt;&lt;span class="mclose"&gt;)&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2778em;"&gt;&lt;/span&gt;&lt;span class="mrel"&gt;:&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;(MAKE) -C $@

# æ¸…ç†æ‰€æœ‰å­ç›®å½•
clean:
	for dir in $(SUBDIRS); do \
		&lt;span class="katex"&gt;&lt;span class="katex-html" aria-hidden="true"&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:1em;vertical-align:-0.25em;"&gt;&lt;/span&gt;&lt;span class="mopen"&gt;(&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.10903em;"&gt;M&lt;/span&gt;&lt;span class="mord mathnormal"&gt;A&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.07153em;"&gt;K&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.05764em;"&gt;E&lt;/span&gt;&lt;span class="mclose"&gt;)&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2222em;"&gt;&lt;/span&gt;&lt;span class="mbin"&gt;âˆ’&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2222em;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:0.6833em;"&gt;&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.07153em;"&gt;C&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="katex"&gt;&lt;span class="katex-html" aria-hidden="true"&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"&gt;&lt;/span&gt;&lt;span class="mord mathnormal"&gt;d&lt;/span&gt;&lt;span class="mord mathnormal"&gt;i&lt;/span&gt;&lt;span class="mord mathnormal"&gt;rc&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.01968em;"&gt;l&lt;/span&gt;&lt;span class="mord mathnormal"&gt;e&lt;/span&gt;&lt;span class="mord mathnormal"&gt;an&lt;/span&gt;&lt;span class="mpunct"&gt;;&lt;/span&gt;&lt;span class="mspace"&gt;Â &lt;/span&gt;&lt;span class="mspace" style="margin-right:0.1667em;"&gt;&lt;/span&gt;&lt;span class="mord mathnormal"&gt;d&lt;/span&gt;&lt;span class="mord mathnormal"&gt;o&lt;/span&gt;&lt;span class="mord mathnormal"&gt;n&lt;/span&gt;&lt;span class="mord mathnormal"&gt;e&lt;/span&gt;&lt;span class="mord"&gt;â€˜â€˜â€˜&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2222em;"&gt;&lt;/span&gt;&lt;span class="mbin"&gt;âˆ—&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2222em;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:0.6944em;"&gt;&lt;/span&gt;&lt;span class="mord"&gt;âˆ—&lt;/span&gt;&lt;span class="mord cjk_fallback"&gt;ä¼ é€’å˜é‡ç»™å­&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.10903em;"&gt;M&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.03148em;"&gt;ak&lt;/span&gt;&lt;span class="mord mathnormal"&gt;e&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2222em;"&gt;&lt;/span&gt;&lt;span class="mbin"&gt;âˆ—&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2222em;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"&gt;&lt;/span&gt;&lt;span class="mord"&gt;âˆ—&lt;/span&gt;&lt;span class="mord"&gt;â€˜â€˜â€˜&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.03148em;"&gt;mak&lt;/span&gt;&lt;span class="mord mathnormal"&gt;e&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.10764em;"&gt;f&lt;/span&gt;&lt;span class="mord mathnormal"&gt;i&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.01968em;"&gt;l&lt;/span&gt;&lt;span class="mord mathnormal"&gt;ee&lt;/span&gt;&lt;span class="mord mathnormal"&gt;x&lt;/span&gt;&lt;span class="mord mathnormal"&gt;p&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.02778em;"&gt;or&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.07153em;"&gt;tCC&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2778em;"&gt;&lt;/span&gt;&lt;span class="mrel"&gt;=&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2778em;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"&gt;&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.03588em;"&gt;g&lt;/span&gt;&lt;span class="mord mathnormal"&gt;cce&lt;/span&gt;&lt;span class="mord mathnormal"&gt;x&lt;/span&gt;&lt;span class="mord mathnormal"&gt;p&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.02778em;"&gt;or&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.13889em;"&gt;tCF&lt;/span&gt;&lt;span class="mord mathnormal"&gt;L&lt;/span&gt;&lt;span class="mord mathnormal"&gt;A&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.05764em;"&gt;GS&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2778em;"&gt;&lt;/span&gt;&lt;span class="mrel"&gt;=&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2778em;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"&gt;&lt;/span&gt;&lt;span class="mord"&gt;âˆ’&lt;/span&gt;&lt;span class="mord mathnormal"&gt;Wa&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.01968em;"&gt;ll&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2222em;"&gt;&lt;/span&gt;&lt;span class="mbin"&gt;âˆ’&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2222em;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:0.6944em;"&gt;&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.02778em;"&gt;O&lt;/span&gt;&lt;span class="mord"&gt;2&lt;/span&gt;&lt;span class="mord mathnormal"&gt;s&lt;/span&gt;&lt;span class="mord mathnormal"&gt;u&lt;/span&gt;&lt;span class="mord mathnormal"&gt;b&lt;/span&gt;&lt;span class="mord mathnormal"&gt;d&lt;/span&gt;&lt;span class="mord mathnormal"&gt;i&lt;/span&gt;&lt;span class="mord mathnormal"&gt;rs&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2778em;"&gt;&lt;/span&gt;&lt;span class="mrel"&gt;:&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;(MAKE) -C src
	$(MAKE) -C lib
</code></pre>
<p><strong>å®æˆ˜æ¡ˆä¾‹ï¼šå¤šç›®å½•é¡¹ç›®</strong></p>
<pre><code class="language-makefile"># æ ¹Makefile
PROJECT_ROOT = $(shell pwd)
export PROJECT_ROOT

export CC = gcc
export CFLAGS = -Wall -Wextra -std=c99 -I&lt;span class="katex"&gt;&lt;span class="katex-html" aria-hidden="true"&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:1em;vertical-align:-0.25em;"&gt;&lt;/span&gt;&lt;span class="mopen"&gt;(&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.02778em;"&gt;PRO&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.09618em;"&gt;J&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.07153em;"&gt;EC&lt;/span&gt;&lt;span class="mord"&gt;&lt;span class="mord mathnormal" style="margin-right:0.13889em;"&gt;T&lt;/span&gt;&lt;span class="msupsub"&gt;&lt;span class="vlist-t vlist-t2"&gt;&lt;span class="vlist-r"&gt;&lt;span class="vlist" style="height:0.3283em;"&gt;&lt;span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"&gt;&lt;span class="pstrut" style="height:2.7em;"&gt;&lt;/span&gt;&lt;span class="sizing reset-size6 size3 mtight"&gt;&lt;span class="mord mathnormal mtight" style="margin-right:0.00773em;"&gt;R&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="vlist-s"&gt;â€‹&lt;/span&gt;&lt;/span&gt;&lt;span class="vlist-r"&gt;&lt;span class="vlist" style="height:0.15em;"&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.13889em;"&gt;OOT&lt;/span&gt;&lt;span class="mclose"&gt;)&lt;/span&gt;&lt;span class="mord"&gt;/&lt;/span&gt;&lt;span class="mord mathnormal"&gt;in&lt;/span&gt;&lt;span class="mord mathnormal"&gt;c&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.01968em;"&gt;l&lt;/span&gt;&lt;span class="mord mathnormal"&gt;u&lt;/span&gt;&lt;span class="mord mathnormal"&gt;d&lt;/span&gt;&lt;span class="mord mathnormal"&gt;ee&lt;/span&gt;&lt;span class="mord mathnormal"&gt;x&lt;/span&gt;&lt;span class="mord mathnormal"&gt;p&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.02778em;"&gt;or&lt;/span&gt;&lt;span class="mord mathnormal"&gt;t&lt;/span&gt;&lt;span class="mord mathnormal"&gt;L&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.02778em;"&gt;D&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.13889em;"&gt;F&lt;/span&gt;&lt;span class="mord mathnormal"&gt;L&lt;/span&gt;&lt;span class="mord mathnormal"&gt;A&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.05764em;"&gt;GS&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2778em;"&gt;&lt;/span&gt;&lt;span class="mrel"&gt;=&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2778em;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"&gt;&lt;/span&gt;&lt;span class="mord"&gt;âˆ’&lt;/span&gt;&lt;span class="mord mathnormal"&gt;L&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;(PROJECT_ROOT)/lib

SUBDIRS = lib src tests

.PHONY: all clean &lt;span class="katex"&gt;&lt;span class="katex-html" aria-hidden="true"&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:1em;vertical-align:-0.25em;"&gt;&lt;/span&gt;&lt;span class="mopen"&gt;(&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.05764em;"&gt;S&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.10903em;"&gt;U&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.05017em;"&gt;B&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.02778em;"&gt;D&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.07847em;"&gt;I&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.05764em;"&gt;RS&lt;/span&gt;&lt;span class="mclose"&gt;)&lt;/span&gt;&lt;span class="mord mathnormal"&gt;a&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.01968em;"&gt;ll&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2778em;"&gt;&lt;/span&gt;&lt;span class="mrel"&gt;:&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;(SUBDIRS)

lib:
	@echo "Building library..."
	@&lt;span class="katex"&gt;&lt;span class="katex-html" aria-hidden="true"&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:1em;vertical-align:-0.25em;"&gt;&lt;/span&gt;&lt;span class="mopen"&gt;(&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.10903em;"&gt;M&lt;/span&gt;&lt;span class="mord mathnormal"&gt;A&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.07153em;"&gt;K&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.05764em;"&gt;E&lt;/span&gt;&lt;span class="mclose"&gt;)&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2222em;"&gt;&lt;/span&gt;&lt;span class="mbin"&gt;âˆ’&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2222em;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:0.6833em;"&gt;&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.07153em;"&gt;C&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;@

src: lib
	@echo "Building application..."
	@&lt;span class="katex"&gt;&lt;span class="katex-html" aria-hidden="true"&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:1em;vertical-align:-0.25em;"&gt;&lt;/span&gt;&lt;span class="mopen"&gt;(&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.10903em;"&gt;M&lt;/span&gt;&lt;span class="mord mathnormal"&gt;A&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.07153em;"&gt;K&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.05764em;"&gt;E&lt;/span&gt;&lt;span class="mclose"&gt;)&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2222em;"&gt;&lt;/span&gt;&lt;span class="mbin"&gt;âˆ’&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2222em;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:0.6833em;"&gt;&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.07153em;"&gt;C&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;@

tests: lib src
	@echo "Building tests..."
	@&lt;span class="katex"&gt;&lt;span class="katex-html" aria-hidden="true"&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:1em;vertical-align:-0.25em;"&gt;&lt;/span&gt;&lt;span class="mopen"&gt;(&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.10903em;"&gt;M&lt;/span&gt;&lt;span class="mord mathnormal"&gt;A&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.07153em;"&gt;K&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.05764em;"&gt;E&lt;/span&gt;&lt;span class="mclose"&gt;)&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2222em;"&gt;&lt;/span&gt;&lt;span class="mbin"&gt;âˆ’&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.2222em;"&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:0.6833em;"&gt;&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.07153em;"&gt;C&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;@

clean:
	@for dir in &lt;span class="katex"&gt;&lt;span class="katex-html" aria-hidden="true"&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:1em;vertical-align:-0.25em;"&gt;&lt;/span&gt;&lt;span class="mopen"&gt;(&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.05764em;"&gt;S&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.10903em;"&gt;U&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.05017em;"&gt;B&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.02778em;"&gt;D&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.07847em;"&gt;I&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.05764em;"&gt;RS&lt;/span&gt;&lt;span class="mclose"&gt;)&lt;/span&gt;&lt;span class="mpunct"&gt;;&lt;/span&gt;&lt;span class="mspace" style="margin-right:0.1667em;"&gt;&lt;/span&gt;&lt;span class="mord mathnormal"&gt;d&lt;/span&gt;&lt;span class="mord mathnormal"&gt;o&lt;/span&gt;&lt;span class="mspace"&gt;Â &lt;/span&gt;&lt;span class="mord mathnormal"&gt;ec&lt;/span&gt;&lt;span class="mord mathnormal"&gt;h&lt;/span&gt;&lt;span class="mord mathnormal"&gt;o&lt;/span&gt;&lt;span class="mord"&gt;&amp;quot;&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.01968em;"&gt;Cl&lt;/span&gt;&lt;span class="mord mathnormal"&gt;e&lt;/span&gt;&lt;span class="mord mathnormal"&gt;anin&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.03588em;"&gt;g&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="katex"&gt;&lt;span class="katex-html" aria-hidden="true"&gt;&lt;span class="base"&gt;&lt;span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"&gt;&lt;/span&gt;&lt;span class="mord mathnormal"&gt;d&lt;/span&gt;&lt;span class="mord mathnormal"&gt;i&lt;/span&gt;&lt;span class="mord mathnormal" style="margin-right:0.02778em;"&gt;r&lt;/span&gt;&lt;span class="mord"&gt;...&amp;quot;&lt;/span&gt;&lt;span class="mpunct"&gt;;&lt;/span&gt;&lt;span class="mspace"&gt;Â &lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;(MAKE) -C $$dir clean; \
	done
	@echo "Clean complete!"

install: all
	@echo "Installing..."
	@cp src/myapp /usr/local/bin/
</code></pre>
<h3 id="73-è°ƒè¯•æŠ€å·§"><a class="header" href="#73-è°ƒè¯•æŠ€å·§">7.3 è°ƒè¯•æŠ€å·§</a></h3>
<p><strong>è¯•è¿è¡Œ (-n)</strong></p>
<pre><code class="language-bash"># æ˜¾ç¤ºå°†è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œä½†ä¸æ‰§è¡Œ
make -n

# ç»“åˆå…¶ä»–é€‰é¡¹
make -n clean
</code></pre>
<p><strong>æ‰“å°è°ƒè¯•ä¿¡æ¯ (-d)</strong></p>
<pre><code class="language-bash"># æ˜¾ç¤ºè¯¦ç»†çš„è°ƒè¯•ä¿¡æ¯
make -d

# ä»…æ˜¾ç¤ºéšå¼è§„åˆ™
make -d --debug=implicit
</code></pre>
<p><strong>Makefileå†…éƒ¨è°ƒè¯•</strong></p>
<pre><code class="language-makefile"># $(info text) - è¾“å‡ºä¿¡æ¯
$(info Building project...)
$(info CC = $(CC))
$(info CFLAGS = $(CFLAGS))

# $(warning text) - è¾“å‡ºè­¦å‘Š
ifndef DEBUG
    $(warning DEBUG not set, using release mode)
endif

# $(error text) - è¾“å‡ºé”™è¯¯å¹¶åœæ­¢
ifeq ($(CC),)
    $(error CC is not defined!)
endif

# è°ƒè¯•å˜é‡
debug:
	@echo "=== Debug Information ==="
	@echo "CC: $(CC)"
	@echo "CFLAGS: $(CFLAGS)"
	@echo "SOURCES: $(SOURCES)"
	@echo "OBJECTS: $(OBJECTS)"
	@echo "========================="
</code></pre>
<h3 id="74-åŒ…å«å…¶ä»–makefile"><a class="header" href="#74-åŒ…å«å…¶ä»–makefile">7.4 åŒ…å«å…¶ä»–Makefile</a></h3>
<p><strong>includeæŒ‡ä»¤</strong></p>
<pre><code class="language-makefile"># åŒ…å«å…¶ä»–Makefile
include config.mk
include rules/*.mk

# å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ä¼šæŠ¥é”™
</code></pre>
<p><strong>-includeæŒ‡ä»¤ï¼ˆæ¨èï¼‰</strong></p>
<pre><code class="language-makefile"># å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œä¸æŠ¥é”™
-include config.mk
-include $(DEPS)
</code></pre>
<p><strong>å®æˆ˜æ¡ˆä¾‹ï¼šé…ç½®åˆ†ç¦»</strong></p>
<pre><code class="language-makefile"># Makefile
-include config.mk

CC ?= gcc
CFLAGS ?= -Wall -Wextra

# config.mk (å¯é€‰é…ç½®æ–‡ä»¶)
CC = clang
CFLAGS = -Wall -Wextra -O2
DEBUG = 1
</code></pre>
<hr />
<h2 id="ç¬¬å…«ç« å®è·µåº”ç”¨"><a class="header" href="#ç¬¬å…«ç« å®è·µåº”ç”¨">ç¬¬å…«ç« ï¼šå®è·µåº”ç”¨</a></h2>
<h3 id="81-ccé¡¹ç›®å®Œæ•´ç¤ºä¾‹"><a class="header" href="#81-ccé¡¹ç›®å®Œæ•´ç¤ºä¾‹">8.1 C/C++é¡¹ç›®å®Œæ•´ç¤ºä¾‹</a></h3>
<p><strong>é¡¹ç›®ç»“æ„</strong></p>
<pre><code>myproject/
â”œâ”€â”€ Makefile
â”œâ”€â”€ include/
â”‚   â”œâ”€â”€ module1.h
â”‚   â””â”€â”€ module2.h
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.c
â”‚   â”œâ”€â”€ module1.c
â”‚   â””â”€â”€ module2.c
â”œâ”€â”€ obj/          # è‡ªåŠ¨åˆ›å»º
â””â”€â”€ bin/          # è‡ªåŠ¨åˆ›å»º
</code></pre>
<p><strong>å®Œæ•´Makefile</strong></p>
<pre><code class="language-makefile"># ========================================
# é¡¹ç›®é…ç½®
# ========================================
PROJECT = myproject
VERSION = 1.0.0

# ç¼–è¯‘å™¨å’Œé€‰é¡¹
CC = gcc
CFLAGS = -Wall -Wextra -std=c11 -Iinclude
LDFLAGS =
LIBS = -lm -lpthread

# è°ƒè¯•/å‘å¸ƒæ¨¡å¼
DEBUG ?= 0
ifeq ($(DEBUG), 1)
    CFLAGS += -g -O0 -DDEBUG
else
    CFLAGS += -O2 -DNDEBUG
endif

# ç›®å½•ç»“æ„
SRC_DIR = src
INC_DIR = include
OBJ_DIR = obj
BIN_DIR = bin

# æºæ–‡ä»¶å’Œç›®æ ‡æ–‡ä»¶
SOURCES = $(wildcard $(SRC_DIR)/*.c)
OBJECTS = $(patsubst $(SRC_DIR)/%.c,$(OBJ_DIR)/%.o,$(SOURCES))
DEPS = $(OBJECTS:.o=.d)
TARGET = $(BIN_DIR)/$(PROJECT)

# ä¾èµ–æ–‡ä»¶è‡ªåŠ¨ç”Ÿæˆ
DEPFLAGS = -MMD -MP

# ========================================
# é»˜è®¤ç›®æ ‡
# ========================================
.DEFAULT_GOAL := all

# ========================================
# ä¼ªç›®æ ‡
# ========================================
.PHONY: all clean rebuild run install uninstall help

# ========================================
# ä¸»è¦ç›®æ ‡
# ========================================
all: $(TARGET)
	@echo "==================================="
	@echo "Build complete: $(TARGET)"
	@echo "Version: $(VERSION)"
	@echo "==================================="

# é“¾æ¥
$(TARGET): $(OBJECTS) | $(BIN_DIR)
	@echo "Linking $@..."
	@$(CC) $(LDFLAGS) -o $@ $^ $(LIBS)

# ç¼–è¯‘
$(OBJ_DIR)/%.o: $(SRC_DIR)/%.c | $(OBJ_DIR)
	@echo "Compiling $&lt;..."
	@$(CC) $(CFLAGS) $(DEPFLAGS) -c $&lt; -o $@

# åˆ›å»ºç›®å½•
$(OBJ_DIR) $(BIN_DIR):
	@mkdir -p $@

# åŒ…å«ä¾èµ–æ–‡ä»¶
-include $(DEPS)

# ========================================
# è¾…åŠ©ç›®æ ‡
# ========================================
clean:
	@echo "Cleaning..."
	@rm -rf $(OBJ_DIR) $(BIN_DIR)
	@echo "Clean complete!"

rebuild: clean all

run: $(TARGET)
	@echo "Running $(TARGET)..."
	@$(TARGET)

install: $(TARGET)
	@echo "Installing to /usr/local/bin..."
	@install -m 755 $(TARGET) /usr/local/bin/
	@echo "Install complete!"

uninstall:
	@echo "Uninstalling..."
	@rm -f /usr/local/bin/$(PROJECT)
	@echo "Uninstall complete!"

help:
	@echo "Available targets:"
	@echo "  all       - Build the project (default)"
	@echo "  clean     - Remove build artifacts"
	@echo "  rebuild   - Clean and rebuild"
	@echo "  run       - Build and run the program"
	@echo "  install   - Install to /usr/local/bin"
	@echo "  uninstall - Remove from /usr/local/bin"
	@echo "  help      - Show this help message"
	@echo ""
	@echo "Options:"
	@echo "  DEBUG=1   - Build with debug symbols"
	@echo ""
	@echo "Examples:"
	@echo "  make              # Build release version"
	@echo "  make DEBUG=1      # Build debug version"
	@echo "  make run DEBUG=1  # Build and run debug version"
</code></pre>
<h3 id="82-åº“é¡¹ç›®ç¤ºä¾‹"><a class="header" href="#82-åº“é¡¹ç›®ç¤ºä¾‹">8.2 åº“é¡¹ç›®ç¤ºä¾‹</a></h3>
<p><strong>é™æ€åº“å’ŒåŠ¨æ€åº“</strong></p>
<pre><code class="language-makefile"># åº“åç§°
LIB_NAME = mylib
LIB_VERSION = 1.0.0

# ç¼–è¯‘é€‰é¡¹
CC = gcc
CFLAGS = -Wall -Wextra -fPIC -Iinclude
AR = ar
ARFLAGS = rcs

# ç›®å½•
SRC_DIR = src
INC_DIR = include
OBJ_DIR = obj
LIB_DIR = lib

# æºæ–‡ä»¶
SOURCES = $(wildcard $(SRC_DIR)/*.c)
OBJECTS = $(patsubst $(SRC_DIR)/%.c,$(OBJ_DIR)/%.o,$(SOURCES))

# ç›®æ ‡åº“
STATIC_LIB = $(LIB_DIR)/lib$(LIB_NAME).a
SHARED_LIB = $(LIB_DIR)/lib$(LIB_NAME).so.$(LIB_VERSION)
SHARED_LIB_LINK = $(LIB_DIR)/lib$(LIB_NAME).so

.PHONY: all static shared clean install

all: static shared

static: $(STATIC_LIB)

shared: $(SHARED_LIB)

# é™æ€åº“
$(STATIC_LIB): $(OBJECTS) | $(LIB_DIR)
	@echo "Creating static library $@..."
	@$(AR) $(ARFLAGS) $@ $^

# åŠ¨æ€åº“
$(SHARED_LIB): $(OBJECTS) | $(LIB_DIR)
	@echo "Creating shared library $@..."
	@$(CC) -shared -Wl,-soname,lib$(LIB_NAME).so.1 -o $@ $^
	@ln -sf $(notdir $(SHARED_LIB)) $(SHARED_LIB_LINK)

# ç¼–è¯‘
$(OBJ_DIR)/%.o: $(SRC_DIR)/%.c | $(OBJ_DIR)
	@echo "Compiling $&lt;..."
	@$(CC) $(CFLAGS) -c $&lt; -o $@

# åˆ›å»ºç›®å½•
$(OBJ_DIR) $(LIB_DIR):
	@mkdir -p $@

# æ¸…ç†
clean:
	@rm -rf $(OBJ_DIR) $(LIB_DIR)

# å®‰è£…
install: all
	@install -d /usr/local/lib
	@install -m 644 $(STATIC_LIB) /usr/local/lib/
	@install -m 755 $(SHARED_LIB) /usr/local/lib/
	@ln -sf lib$(LIB_NAME).so.$(LIB_VERSION) /usr/local/lib/lib$(LIB_NAME).so
	@install -d /usr/local/include/$(LIB_NAME)
	@install -m 644 $(INC_DIR)/*.h /usr/local/include/$(LIB_NAME)/
	@ldconfig
	@echo "Library installed!"
</code></pre>
<h3 id="83-äº¤å‰ç¼–è¯‘é…ç½®"><a class="header" href="#83-äº¤å‰ç¼–è¯‘é…ç½®">8.3 äº¤å‰ç¼–è¯‘é…ç½®</a></h3>
<pre><code class="language-makefile"># äº¤å‰ç¼–è¯‘å·¥å…·é“¾
CROSS_COMPILE ?= arm-linux-gnueabihf-

# ç¼–è¯‘å™¨
CC = $(CROSS_COMPILE)gcc
CXX = $(CROSS_COMPILE)g++
AR = $(CROSS_COMPILE)ar
LD = $(CROSS_COMPILE)ld
STRIP = $(CROSS_COMPILE)strip

# ç›®æ ‡æ¶æ„
ARCH ?= arm
PLATFORM ?= linux

# ç¼–è¯‘é€‰é¡¹
CFLAGS = -Wall -Wextra
CFLAGS += -march=armv7-a -mfpu=neon

# é“¾æ¥é€‰é¡¹
LDFLAGS = -L/path/to/cross/lib
LIBS = -lpthread -lrt

# æ ¹æ–‡ä»¶ç³»ç»Ÿè·¯å¾„
SYSROOT = /path/to/sysroot

# ç›®æ ‡
TARGET = myapp

SOURCES = $(wildcard src/*.c)
OBJECTS = $(SOURCES:.c=.o)

$(TARGET): $(OBJECTS)
	@echo "Cross-compiling for $(ARCH)..."
	$(CC) $(CFLAGS) $(LDFLAGS) -o $@ $^ $(LIBS)
	$(STRIP) $@
	@echo "Build complete: $@"

%.o: %.c
	$(CC) $(CFLAGS) -c $&lt; -o $@

.PHONY: clean deploy

clean:
	rm -f $(TARGET) $(OBJECTS)

# éƒ¨ç½²åˆ°ç›®æ ‡è®¾å¤‡
deploy: $(TARGET)
	@echo "Deploying to target..."
	scp $(TARGET) root@target-device:/usr/bin/
	@echo "Deploy complete!"
</code></pre>
<hr />
<h2 id="ç¬¬ä¹ç« æœ€ä½³å®è·µä¸æŠ€å·§"><a class="header" href="#ç¬¬ä¹ç« æœ€ä½³å®è·µä¸æŠ€å·§">ç¬¬ä¹ç« ï¼šæœ€ä½³å®è·µä¸æŠ€å·§</a></h2>
<h3 id="91-å¸¸è§é™·é˜±"><a class="header" href="#91-å¸¸è§é™·é˜±">9.1 å¸¸è§é™·é˜±</a></h3>
<p><strong>âŒ é”™è¯¯1ï¼šä½¿ç”¨ç©ºæ ¼è€ŒéTAB</strong></p>
<pre><code class="language-makefile"># é”™è¯¯ï¼å‘½ä»¤å¿…é¡»ä»¥TABå¼€å¤´
target:
    echo "This will fail!"  # ä½¿ç”¨äº†ç©ºæ ¼

# æ­£ç¡®
target:
	echo "This works!"  # ä½¿ç”¨äº†TAB
</code></pre>
<p><strong>âŒ é”™è¯¯2ï¼šå˜é‡åæ‹¼å†™é”™è¯¯</strong></p>
<pre><code class="language-makefile">CFLAGS = -Wall
# æ³¨æ„å˜é‡åå¤§å°å†™
target:
	gcc $(CFLAG) main.c  # é”™è¯¯ï¼šCFLAGè€ŒéCFLAGS
</code></pre>
<p><strong>âŒ é”™è¯¯3ï¼šé€’å½’å˜é‡å¯¼è‡´æ— é™å¾ªç¯</strong></p>
<pre><code class="language-makefile"># é”™è¯¯ï¼
CFLAGS = $(CFLAGS) -Wall  # æ— é™é€’å½’

# æ­£ç¡®
CFLAGS = -Wall
CFLAGS += -Wextra  # ä½¿ç”¨+=è¿½åŠ 
</code></pre>
<h3 id="92-æ€§èƒ½ä¼˜åŒ–"><a class="header" href="#92-æ€§èƒ½ä¼˜åŒ–">9.2 æ€§èƒ½ä¼˜åŒ–</a></h3>
<p><strong>æŠ€å·§1ï¼šé¿å…ä¸å¿…è¦çš„Shellè°ƒç”¨</strong></p>
<pre><code class="language-makefile"># âŒ æ…¢
FILES = $(shell find src -name '*.c')

# âœ… å¿«
FILES = $(wildcard src/*.c)
</code></pre>
<p><strong>æŠ€å·§2ï¼šä½¿ç”¨å¹¶è¡Œç¼–è¯‘</strong></p>
<pre><code class="language-bash">make -j$(nproc)
</code></pre>
<p><strong>æŠ€å·§3ï¼šåˆç†ä½¿ç”¨ä¾èµ–</strong></p>
<pre><code class="language-makefile"># é¿å…æ¯æ¬¡éƒ½é‡æ–°ç¼–è¯‘æ‰€æœ‰æ–‡ä»¶
# ä½¿ç”¨è‡ªåŠ¨ä¾èµ–ç”Ÿæˆ
DEPFLAGS = -MMD -MP
</code></pre>
<h3 id="93-å¯ç»´æŠ¤æ€§å»ºè®®"><a class="header" href="#93-å¯ç»´æŠ¤æ€§å»ºè®®">9.3 å¯ç»´æŠ¤æ€§å»ºè®®</a></h3>
<p><strong>âœ… ä½¿ç”¨å˜é‡ç®¡ç†é…ç½®</strong></p>
<pre><code class="language-makefile"># é›†ä¸­ç®¡ç†é…ç½®
CC = gcc
CFLAGS = -Wall -Wextra -std=c11
LDFLAGS =
LIBS = -lm

# è€Œä¸æ˜¯åœ¨è§„åˆ™ä¸­ç¡¬ç¼–ç 
</code></pre>
<p><strong>âœ… æ·»åŠ æ³¨é‡Š</strong></p>
<pre><code class="language-makefile"># ========================================
# ç¼–è¯‘å™¨é…ç½®
# ========================================
CC = gcc  # Cç¼–è¯‘å™¨
</code></pre>
<p><strong>âœ… æä¾›helpç›®æ ‡</strong></p>
<pre><code class="language-makefile">.PHONY: help
help:
	@echo "Available targets:"
	@echo "  all     - Build project"
	@echo "  clean   - Remove build artifacts"
	@echo "  test    - Run tests"
</code></pre>
<p><strong>âœ… ä½¿ç”¨.PHONYå£°æ˜ä¼ªç›®æ ‡</strong></p>
<pre><code class="language-makefile">.PHONY: all clean install test
</code></pre>
<hr />
<h2 id="ç¬¬åç« å­¦ä¹ éªŒè¯ä¸è¿›é˜¶"><a class="header" href="#ç¬¬åç« å­¦ä¹ éªŒè¯ä¸è¿›é˜¶">ç¬¬åç« ï¼šå­¦ä¹ éªŒè¯ä¸è¿›é˜¶</a></h2>
<h3 id="å­¦ä¹ æˆæœéªŒè¯æ ‡å‡†"><a class="header" href="#å­¦ä¹ æˆæœéªŒè¯æ ‡å‡†">å­¦ä¹ æˆæœéªŒè¯æ ‡å‡†</a></h3>
<p>å®Œæˆæœ¬è¯¾ç¨‹åï¼Œä½ åº”è¯¥èƒ½å¤Ÿç‹¬ç«‹å®Œæˆä»¥ä¸‹ä»»åŠ¡ï¼š</p>
<ol>
<li>
<p><strong>åŸºç¡€èƒ½åŠ›</strong>ï¼ˆå¿…é¡»æŒæ¡ï¼‰</p>
<ul>
<li><input disabled="" type="checkbox"/>
ç¼–å†™åŸºæœ¬çš„Makefileè§„åˆ™</li>
<li><input disabled="" type="checkbox"/>
ä½¿ç”¨å˜é‡å’Œè‡ªåŠ¨å˜é‡</li>
<li><input disabled="" type="checkbox"/>
ç†è§£ä¾èµ–å…³ç³»å’Œå¢é‡ç¼–è¯‘</li>
<li><input disabled="" type="checkbox"/>
ä½¿ç”¨.PHONYå£°æ˜ä¼ªç›®æ ‡</li>
</ul>
</li>
<li>
<p><strong>è¿›é˜¶èƒ½åŠ›</strong>ï¼ˆé‡è¦ï¼‰</p>
<ul>
<li><input disabled="" type="checkbox"/>
ä½¿ç”¨æ¨¡å¼è§„åˆ™å’Œéšå¼è§„åˆ™</li>
<li><input disabled="" type="checkbox"/>
æŒæ¡å¸¸ç”¨å‡½æ•°ï¼ˆwildcard, patsubstç­‰ï¼‰</li>
<li><input disabled="" type="checkbox"/>
å®ç°æ¡ä»¶ç¼–è¯‘</li>
<li><input disabled="" type="checkbox"/>
é…ç½®å¹¶è¡Œç¼–è¯‘</li>
</ul>
</li>
<li>
<p><strong>é«˜çº§èƒ½åŠ›</strong>ï¼ˆè¿›é˜¶ï¼‰</p>
<ul>
<li><input disabled="" type="checkbox"/>
è‡ªåŠ¨ç”Ÿæˆä¾èµ–æ–‡ä»¶</li>
<li><input disabled="" type="checkbox"/>
ç®¡ç†å¤šç›®å½•é¡¹ç›®</li>
<li><input disabled="" type="checkbox"/>
ç¼–å†™åº“é¡¹ç›®Makefile</li>
<li><input disabled="" type="checkbox"/>
é…ç½®äº¤å‰ç¼–è¯‘</li>
</ul>
</li>
<li>
<p><strong>ç”Ÿäº§èƒ½åŠ›</strong>ï¼ˆéªŒè¯ï¼‰</p>
<ul>
<li><input disabled="" type="checkbox"/>
ç¼–å†™å¯ç§»æ¤çš„Makefile</li>
<li><input disabled="" type="checkbox"/>
ä¼˜åŒ–ç¼–è¯‘æ€§èƒ½</li>
<li><input disabled="" type="checkbox"/>
å®ç°å¤æ‚çš„æ„å»ºæµç¨‹</li>
<li><input disabled="" type="checkbox"/>
é›†æˆæµ‹è¯•å’Œéƒ¨ç½²</li>
</ul>
</li>
</ol>
<h2 id="å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ"><a class="header" href="#å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ">å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</a></h2>
<div class="table-wrapper"><table><thead><tr><th>é—®é¢˜</th><th>åŸå› </th><th>è§£å†³æ–¹æ¡ˆ</th></tr></thead><tbody>
<tr><td>make: *** missing separator</td><td>å‘½ä»¤æœªä½¿ç”¨TAB</td><td>ç¡®ä¿å‘½ä»¤è¡Œä»¥TABå¼€å¤´</td></tr>
<tr><td>No rule to make target</td><td>ç›®æ ‡æˆ–ä¾èµ–ä¸å­˜åœ¨</td><td>æ£€æŸ¥æ–‡ä»¶åå’Œè·¯å¾„</td></tr>
<tr><td>é‡å¤ç¼–è¯‘æ‰€æœ‰æ–‡ä»¶</td><td>ä¾èµ–å…³ç³»é”™è¯¯</td><td>ä½¿ç”¨è‡ªåŠ¨ä¾èµ–ç”Ÿæˆ</td></tr>
<tr><td>å¹¶è¡Œç¼–è¯‘å¤±è´¥</td><td>ä¾èµ–é¡ºåºé—®é¢˜</td><td>æ­£ç¡®å£°æ˜ç›®æ ‡ä¾èµ–</td></tr>
<tr><td>å˜é‡æœªå±•å¼€</td><td>ä½¿ç”¨äº†é”™è¯¯çš„èµ‹å€¼</td><td>ç†è§£=å’Œ:=çš„åŒºåˆ«</td></tr>
</tbody></table>
</div>
<h2 id="æœ€ä½³å®è·µæ¸…å•"><a class="header" href="#æœ€ä½³å®è·µæ¸…å•">æœ€ä½³å®è·µæ¸…å•</a></h2>
<ul>
<li>âœ… å‘½ä»¤å§‹ç»ˆä½¿ç”¨TABç¼©è¿›</li>
<li>âœ… ä½¿ç”¨å˜é‡é›†ä¸­ç®¡ç†é…ç½®</li>
<li>âœ… å£°æ˜.PHONYä¼ªç›®æ ‡</li>
<li>âœ… ä½¿ç”¨è‡ªåŠ¨å˜é‡($@, $&lt;, $^)</li>
<li>âœ… å®ç°è‡ªåŠ¨ä¾èµ–ç”Ÿæˆ</li>
<li>âœ… æä¾›cleanã€installç­‰æ ‡å‡†ç›®æ ‡</li>
<li>âœ… æ”¯æŒDEBUGç­‰ç¼–è¯‘é€‰é¡¹</li>
<li>âœ… æ·»åŠ è¯¦ç»†æ³¨é‡Šå’Œhelpç›®æ ‡</li>
<li>âœ… é¿å…ç¡¬ç¼–ç è·¯å¾„å’Œæ–‡ä»¶å</li>
<li>âœ… æµ‹è¯•è·¨å¹³å°å…¼å®¹æ€§</li>
</ul>
<h2 id="makefile-vs-å…¶ä»–æ„å»ºå·¥å…·"><a class="header" href="#makefile-vs-å…¶ä»–æ„å»ºå·¥å…·">Makefile vs å…¶ä»–æ„å»ºå·¥å…·</a></h2>
<div class="table-wrapper"><table><thead><tr><th>ç‰¹æ€§</th><th>Makefile</th><th>CMake</th><th>Autotools</th></tr></thead><tbody>
<tr><td>å­¦ä¹ æ›²çº¿</td><td>ä¸­ç­‰</td><td>è¾ƒé™¡</td><td>é™¡å³­</td></tr>
<tr><td>è·¨å¹³å°</td><td>æ‰‹åŠ¨</td><td>âœ… è‡ªåŠ¨</td><td>âœ… è‡ªåŠ¨</td></tr>
<tr><td>C/C++æ”¯æŒ</td><td>âœ… ä¼˜ç§€</td><td>âœ… ä¼˜ç§€</td><td>âœ… ä¼˜ç§€</td></tr>
<tr><td>çµæ´»æ€§</td><td>âœ… é«˜</td><td>ä¸­ç­‰</td><td>ä½</td></tr>
<tr><td>ç”Ÿæ€ç³»ç»Ÿ</td><td>âœ… æˆç†Ÿ</td><td>ç°ä»£åŒ–</td><td>ä¼ ç»Ÿ</td></tr>
<tr><td>æ¨èåœºæ™¯</td><td>å°å‹é¡¹ç›®ã€åµŒå…¥å¼</td><td>ä¸­å¤§å‹C++é¡¹ç›®</td><td>GNUé¡¹ç›®</td></tr>
</tbody></table>
</div>
<h2 id="è¿›é˜¶å­¦ä¹ èµ„æº"><a class="header" href="#è¿›é˜¶å­¦ä¹ èµ„æº">è¿›é˜¶å­¦ä¹ èµ„æº</a></h2>
<p><strong>å®˜æ–¹æ–‡æ¡£</strong></p>
<ul>
<li><a href="https://www.gnu.org/software/make/manual/">GNU Make Manual</a></li>
<li><a href="https://pubs.opengroup.org/onlinepubs/9699919799/utilities/make.html">POSIX Make</a></li>
</ul>
<p><strong>æ¨èä¹¦ç±</strong></p>
<ul>
<li>ã€ŠManaging Projects with GNU Makeã€‹</li>
<li>ã€ŠGNU Makeé¡¹ç›®ç®¡ç†ã€‹</li>
</ul>
<p><strong>åœ¨çº¿èµ„æº</strong></p>
<ul>
<li><a href="https://makefiletutorial.com/">Makefile Tutorial</a></li>
<li><a href="https://cmake.org/cmake/help/latest/manual/cmake.1.html">CMake vs Make</a></li>
</ul>
<h2 id="ä¸‹ä¸€æ­¥å­¦ä¹ å»ºè®®"><a class="header" href="#ä¸‹ä¸€æ­¥å­¦ä¹ å»ºè®®">ä¸‹ä¸€æ­¥å­¦ä¹ å»ºè®®</a></h2>
<ol>
<li>
<p><strong>æ·±å…¥ç³»ç»Ÿç¼–ç¨‹</strong></p>
<ul>
<li>å­¦ä¹ é“¾æ¥å™¨å’ŒåŠ è½½å™¨åŸç†</li>
<li>ç†è§£åŠ¨æ€åº“å’Œé™æ€åº“</li>
<li>æŒæ¡ç¼–è¯‘å™¨ä¼˜åŒ–é€‰é¡¹</li>
</ul>
</li>
<li>
<p><strong>ç°ä»£æ„å»ºå·¥å…·</strong></p>
<ul>
<li>CMakeï¼ˆæ¨èç”¨äºæ–°é¡¹ç›®ï¼‰</li>
<li>Mesonï¼ˆæ›´ç°ä»£çš„é€‰æ‹©ï¼‰</li>
<li>Bazelï¼ˆå¤§å‹é¡¹ç›®ï¼‰</li>
</ul>
</li>
<li>
<p><strong>æŒç»­é›†æˆ</strong></p>
<ul>
<li>Jenkinsé›†æˆ</li>
<li>GitLab CI/CDé…ç½®</li>
<li>GitHub Actionså·¥ä½œæµ</li>
</ul>
</li>
</ol>
<hr />
<h2 id="æ€»ç»“"><a class="header" href="#æ€»ç»“">æ€»ç»“</a></h2>
<p>Makefileæ˜¯Unix/Linuxç³»ç»Ÿä¸‹C/C++é¡¹ç›®çš„ç»å…¸æ„å»ºå·¥å…·ã€‚é€šè¿‡æœ¬æ•™ç¨‹çš„å­¦ä¹ ï¼Œä½ åº”è¯¥å·²ç»æŒæ¡äº†ï¼š</p>
<ul>
<li>âœ… Makefileçš„åŸºæœ¬è¯­æ³•å’Œè§„åˆ™</li>
<li>âœ… å˜é‡ç³»ç»Ÿå’Œè‡ªåŠ¨å˜é‡</li>
<li>âœ… å‡½æ•°å’Œæ¨¡å¼è§„åˆ™</li>
<li>âœ… æ¡ä»¶åˆ¤æ–­å’Œé«˜çº§ç‰¹æ€§</li>
<li>âœ… å®é™…é¡¹ç›®çš„æ„å»ºå®è·µ</li>
</ul>
<p><strong>è®°ä½</strong>ï¼šMakefileçš„ç²¾é«“åœ¨äºä¾èµ–ç®¡ç†å’Œå¢é‡ç¼–è¯‘ã€‚è™½ç„¶CMakeç­‰ç°ä»£å·¥å…·æä¾›äº†æ›´å¥½çš„è·¨å¹³å°æ”¯æŒï¼Œä½†ç†è§£Makefileå¯¹äºç³»ç»Ÿç¼–ç¨‹å’ŒåµŒå…¥å¼å¼€å‘ä»ç„¶è‡³å…³é‡è¦ï¼</p>
<p><strong>ç¥ä½ å­¦ä¹ é¡ºåˆ©ï¼</strong> ğŸš€</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../ç¼–ç¨‹/script/gradle.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../ç¼–ç¨‹/script/powershell.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../ç¼–ç¨‹/script/gradle.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../ç¼–ç¨‹/script/powershell.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../theme/segmentit.umd.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../theme/searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../../theme/pagetoc.js"></script>



    </div>
    </body>
</html>

