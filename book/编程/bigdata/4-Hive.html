<!DOCTYPE HTML>
<html lang="zh" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Apache Hive å­¦ä¹ ç¬”è®° - å¼€å‘</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../theme/pagetoc.css">
        <link rel="stylesheet" href="../../theme/help-overlay.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>â†</kbd> or <kbd>â†’</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">å¼€å‘</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="æœç´¢æœ¬ä¹¦å†…å®¹..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <!-- Page table of contents -->
                        <div class="sidetoc"><nav class="pagetoc"></nav></div>

                        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="apache-hive-å­¦ä¹ ç¬”è®°"><a class="header" href="#apache-hive-å­¦ä¹ ç¬”è®°">Apache Hive å­¦ä¹ ç¬”è®°</a></h1>
<h2 id="-å­¦ä¹ ç›®æ ‡"><a class="header" href="#-å­¦ä¹ ç›®æ ‡">ğŸ“‹ å­¦ä¹ ç›®æ ‡</a></h2>
<ul>
<li>æ·±å…¥ç†è§£Hiveæ¶æ„å’Œæ•°æ®ä»“åº“åŸç†</li>
<li>æŒæ¡HiveQLè¯­æ³•å’Œæ•°æ®æ“ä½œ</li>
<li>ç†Ÿç»ƒä½¿ç”¨Hiveè¿›è¡Œæ•°æ®åˆ†æ</li>
<li>ç†è§£Hiveå­˜å‚¨æ ¼å¼å’Œä¼˜åŒ–æŠ€å·§</li>
<li>æŒæ¡UDF/UDAF/UDTFè‡ªå®šä¹‰å‡½æ•°å¼€å‘</li>
<li>å…·å¤‡Hiveç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å’Œè°ƒä¼˜èƒ½åŠ›</li>
</ul>
<h2 id="1-hive-åŸºç¡€æ¦‚å¿µ"><a class="header" href="#1-hive-åŸºç¡€æ¦‚å¿µ">1. Hive åŸºç¡€æ¦‚å¿µ</a></h2>
<h3 id="11-ä»€ä¹ˆæ˜¯-apache-hive"><a class="header" href="#11-ä»€ä¹ˆæ˜¯-apache-hive">1.1 ä»€ä¹ˆæ˜¯ Apache Hive</a></h3>
<p>Apache Hiveæ˜¯å»ºç«‹åœ¨Hadoopä¹‹ä¸Šçš„æ•°æ®ä»“åº“åŸºç¡€è®¾æ–½,æä¾›æ•°æ®çš„æ±‡æ€»ã€æŸ¥è¯¢å’Œåˆ†æåŠŸèƒ½ã€‚</p>
<p><strong>æ ¸å¿ƒç‰¹ç‚¹:</strong></p>
<ul>
<li>SQL-likeæŸ¥è¯¢è¯­è¨€(HiveQL)</li>
<li>åŸºäºHadoopçš„åˆ†å¸ƒå¼å­˜å‚¨å’Œè®¡ç®—</li>
<li>æ”¯æŒå¤§è§„æ¨¡æ•°æ®åˆ†æ</li>
<li>å¯æ‰©å±•çš„æ¶æ„è®¾è®¡</li>
<li>ä¸°å¯Œçš„æ•°æ®æ ¼å¼æ”¯æŒ</li>
</ul>
<p><strong>åº”ç”¨åœºæ™¯:</strong></p>
<ul>
<li>æ•°æ®ä»“åº“æ„å»º</li>
<li>å¤§æ•°æ®ETLå¤„ç†</li>
<li>æ—¥å¿—åˆ†æ</li>
<li>æ•°æ®æŒ–æ˜</li>
<li>æŠ¥è¡¨ç»Ÿè®¡åˆ†æ</li>
</ul>
<h3 id="12-hive-vs-ä¼ ç»Ÿæ•°æ®åº“"><a class="header" href="#12-hive-vs-ä¼ ç»Ÿæ•°æ®åº“">1.2 Hive vs ä¼ ç»Ÿæ•°æ®åº“</a></h3>
<div class="table-wrapper"><table><thead><tr><th>ç‰¹æ€§</th><th>Hive</th><th>MySQL</th><th>Oracle</th></tr></thead><tbody>
<tr><td>æ•°æ®è§„æ¨¡</td><td>PBçº§</td><td>TBçº§</td><td>TBçº§</td></tr>
<tr><td>æŸ¥è¯¢å»¶è¿Ÿ</td><td>ç§’-åˆ†é’Ÿçº§</td><td>æ¯«ç§’çº§</td><td>æ¯«ç§’çº§</td></tr>
<tr><td>é€‚ç”¨åœºæ™¯</td><td>OLAP</td><td>OLTP</td><td>OLTP/OLAP</td></tr>
<tr><td>äº‹åŠ¡æ”¯æŒ</td><td>æœ‰é™æ”¯æŒ</td><td>å®Œæ•´æ”¯æŒ</td><td>å®Œæ•´æ”¯æŒ</td></tr>
<tr><td>æ›´æ–°æ“ä½œ</td><td>ä¸é€‚åˆ</td><td>é«˜æ•ˆ</td><td>é«˜æ•ˆ</td></tr>
<tr><td>æ‰©å±•æ€§</td><td>æ°´å¹³æ‰©å±•</td><td>å‚ç›´æ‰©å±•</td><td>å‚ç›´æ‰©å±•</td></tr>
</tbody></table>
</div>
<h3 id="13-hive-æ¶æ„"><a class="header" href="#13-hive-æ¶æ„">1.3 Hive æ¶æ„</a></h3>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Hive Client (CLI/JDBC)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Hive Server (HS2)             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚      Driver (ç¼–è¯‘å™¨/ä¼˜åŒ–å™¨)      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚           â”‚           â”‚
â”Œâ”€â”€â”€â–¼â”€â”€â”€â”  â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Metastoreâ”‚ â”‚Execution â”‚ â”‚  HDFS     â”‚
â”‚(MySQL)  â”‚ â”‚ Engine   â”‚ â”‚ Storage   â”‚
â”‚         â”‚ â”‚(MR/Tez/  â”‚ â”‚           â”‚
â”‚         â”‚ â”‚ Spark)   â”‚ â”‚           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>æ ¸å¿ƒç»„ä»¶:</strong></p>
<ul>
<li><strong>Hive Client</strong>: CLIã€JDBC/ODBCã€Web UI</li>
<li><strong>HiveServer2</strong>: å¤„ç†å®¢æˆ·ç«¯è¯·æ±‚çš„æœåŠ¡</li>
<li><strong>Metastore</strong>: å…ƒæ•°æ®å­˜å‚¨(è¡¨ç»“æ„ã€åˆ†åŒºä¿¡æ¯ç­‰)</li>
<li><strong>Driver</strong>: ç¼–è¯‘å™¨ã€ä¼˜åŒ–å™¨ã€æ‰§è¡Œå™¨</li>
<li><strong>Execution Engine</strong>: MapReduce/Tez/Spark</li>
</ul>
<h2 id="2-hive-å®‰è£…ä¸é…ç½®"><a class="header" href="#2-hive-å®‰è£…ä¸é…ç½®">2. Hive å®‰è£…ä¸é…ç½®</a></h2>
<h3 id="21-ç¯å¢ƒå‡†å¤‡"><a class="header" href="#21-ç¯å¢ƒå‡†å¤‡">2.1 ç¯å¢ƒå‡†å¤‡</a></h3>
<p><strong>ç³»ç»Ÿè¦æ±‚:</strong></p>
<ul>
<li>Java 8+</li>
<li>Hadoop 2.x/3.x</li>
<li>MySQL/PostgreSQL(ç”¨äºMetastore)</li>
</ul>
<p><strong>ä¸‹è½½å®‰è£…:</strong></p>
<pre><code class="language-bash"># 1. ä¸‹è½½Hive
wget https://dlcdn.apache.org/hive/hive-3.1.3/apache-hive-3.1.3-bin.tar.gz

# 2. è§£å‹
tar -xzvf apache-hive-3.1.3-bin.tar.gz
cd apache-hive-3.1.3-bin

# 3. é…ç½®ç¯å¢ƒå˜é‡
export HIVE_HOME=/opt/apache-hive-3.1.3-bin
export PATH=$PATH:$HIVE_HOME/bin
</code></pre>
<h3 id="22-é…ç½®æ–‡ä»¶"><a class="header" href="#22-é…ç½®æ–‡ä»¶">2.2 é…ç½®æ–‡ä»¶</a></h3>
<p><strong>hive-site.xml:</strong></p>
<pre><code class="language-xml">&lt;configuration&gt;
  &lt;!-- Metastoreé…ç½® --&gt;
  &lt;property&gt;
    &lt;name&gt;javax.jdo.option.ConnectionURL&lt;/name&gt;
    &lt;value&gt;jdbc:mysql://localhost:3306/hive_metastore?createDatabaseIfNotExist=true&lt;/value&gt;
  &lt;/property&gt;

  &lt;property&gt;
    &lt;name&gt;javax.jdo.option.ConnectionDriverName&lt;/name&gt;
    &lt;value&gt;com.mysql.cj.jdbc.Driver&lt;/value&gt;
  &lt;/property&gt;

  &lt;property&gt;
    &lt;name&gt;javax.jdo.option.ConnectionUserName&lt;/name&gt;
    &lt;value&gt;hive&lt;/value&gt;
  &lt;/property&gt;

  &lt;property&gt;
    &lt;name&gt;javax.jdo.option.ConnectionPassword&lt;/name&gt;
    &lt;value&gt;hive123&lt;/value&gt;
  &lt;/property&gt;

  &lt;!-- HiveServer2é…ç½® --&gt;
  &lt;property&gt;
    &lt;name&gt;hive.server2.thrift.port&lt;/name&gt;
    &lt;value&gt;10000&lt;/value&gt;
  &lt;/property&gt;

  &lt;property&gt;
    &lt;name&gt;hive.server2.webui.port&lt;/name&gt;
    &lt;value&gt;10002&lt;/value&gt;
  &lt;/property&gt;

  &lt;!-- æ‰§è¡Œå¼•æ“é…ç½® --&gt;
  &lt;property&gt;
    &lt;name&gt;hive.execution.engine&lt;/name&gt;
    &lt;value&gt;tez&lt;/value&gt;  &lt;!-- mr/tez/spark --&gt;
  &lt;/property&gt;

  &lt;!-- å…ƒæ•°æ®å­˜å‚¨è·¯å¾„ --&gt;
  &lt;property&gt;
    &lt;name&gt;hive.metastore.warehouse.dir&lt;/name&gt;
    &lt;value&gt;/user/hive/warehouse&lt;/value&gt;
  &lt;/property&gt;
&lt;/configuration&gt;
</code></pre>
<h3 id="23-åˆå§‹åŒ–metastore"><a class="header" href="#23-åˆå§‹åŒ–metastore">2.3 åˆå§‹åŒ–Metastore</a></h3>
<pre><code class="language-bash"># åˆå§‹åŒ–Metastore schema
schematool -dbType mysql -initSchema

# å¯åŠ¨MetastoreæœåŠ¡
hive --service metastore &amp;

# å¯åŠ¨HiveServer2
hive --service hiveserver2 &amp;

# å¯åŠ¨Hive CLI
hive
</code></pre>
<h2 id="3-hive-æ•°æ®ç±»å‹"><a class="header" href="#3-hive-æ•°æ®ç±»å‹">3. Hive æ•°æ®ç±»å‹</a></h2>
<h3 id="31-åŸºæœ¬æ•°æ®ç±»å‹"><a class="header" href="#31-åŸºæœ¬æ•°æ®ç±»å‹">3.1 åŸºæœ¬æ•°æ®ç±»å‹</a></h3>
<pre><code class="language-sql">-- æ•°å€¼ç±»å‹
TINYINT   -- 1å­—èŠ‚æœ‰ç¬¦å·æ•´æ•°
SMALLINT  -- 2å­—èŠ‚æœ‰ç¬¦å·æ•´æ•°
INT       -- 4å­—èŠ‚æœ‰ç¬¦å·æ•´æ•°
BIGINT    -- 8å­—èŠ‚æœ‰ç¬¦å·æ•´æ•°
FLOAT     -- å•ç²¾åº¦æµ®ç‚¹æ•°
DOUBLE    -- åŒç²¾åº¦æµ®ç‚¹æ•°
DECIMAL(precision, scale)  -- é«˜ç²¾åº¦åè¿›åˆ¶

-- å­—ç¬¦ä¸²ç±»å‹
STRING    -- å¯å˜é•¿åº¦å­—ç¬¦ä¸²
VARCHAR(n) -- å¯å˜é•¿åº¦å­—ç¬¦ä¸²,æœ€å¤§é•¿åº¦n
CHAR(n)   -- å›ºå®šé•¿åº¦å­—ç¬¦ä¸²

-- æ—¥æœŸæ—¶é—´ç±»å‹
DATE      -- æ—¥æœŸ YYYY-MM-DD
TIMESTAMP -- æ—¶é—´æˆ³
INTERVAL  -- æ—¶é—´é—´éš”

-- å¸ƒå°”ç±»å‹
BOOLEAN   -- true/false
</code></pre>
<h3 id="32-å¤æ‚æ•°æ®ç±»å‹"><a class="header" href="#32-å¤æ‚æ•°æ®ç±»å‹">3.2 å¤æ‚æ•°æ®ç±»å‹</a></h3>
<pre><code class="language-sql">-- ARRAYæ•°ç»„
ARRAY&lt;data_type&gt;
ç¤ºä¾‹: ARRAY&lt;STRING&gt;

-- MAPæ˜ å°„
MAP&lt;primitive_type, data_type&gt;
ç¤ºä¾‹: MAP&lt;STRING, INT&gt;

-- STRUCTç»“æ„ä½“
STRUCT&lt;col_name:data_type, ...&gt;
ç¤ºä¾‹: STRUCT&lt;name:STRING, age:INT&gt;

-- UNIONè”åˆ
UNIONTYPE&lt;data_type, data_type, ...&gt;
</code></pre>
<p><strong>å¤æ‚ç±»å‹ä½¿ç”¨ç¤ºä¾‹:</strong></p>
<pre><code class="language-sql">CREATE TABLE complex_table (
    id INT,
    name STRING,
    hobbies ARRAY&lt;STRING&gt;,
    scores MAP&lt;STRING, INT&gt;,
    address STRUCT&lt;city:STRING, street:STRING&gt;
);

-- æ’å…¥æ•°æ®
INSERT INTO complex_table VALUES (
    1,
    'Alice',
    ARRAY('reading', 'music'),
    MAP('math', 95, 'english', 88),
    NAMED_STRUCT('city', 'Beijing', 'street', 'Chaoyang')
);

-- æŸ¥è¯¢æ•°ç»„å…ƒç´ 
SELECT hobbies[0] FROM complex_table;

-- æŸ¥è¯¢Mapå€¼
SELECT scores['math'] FROM complex_table;

-- æŸ¥è¯¢Structå­—æ®µ
SELECT address.city FROM complex_table;
</code></pre>
<h2 id="4-hive-è¡¨ç±»å‹"><a class="header" href="#4-hive-è¡¨ç±»å‹">4. Hive è¡¨ç±»å‹</a></h2>
<h3 id="41-å†…éƒ¨è¡¨-managed-table"><a class="header" href="#41-å†…éƒ¨è¡¨-managed-table">4.1 å†…éƒ¨è¡¨ (Managed Table)</a></h3>
<pre><code class="language-sql">-- åˆ›å»ºå†…éƒ¨è¡¨
CREATE TABLE employees (
    id INT,
    name STRING,
    age INT,
    department STRING
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
STORED AS TEXTFILE;

-- åŠ è½½æ•°æ®
LOAD DATA LOCAL INPATH '/tmp/employees.csv' INTO TABLE employees;

-- åˆ é™¤è¡¨(æ•°æ®å’Œå…ƒæ•°æ®éƒ½ä¼šåˆ é™¤)
DROP TABLE employees;
</code></pre>
<h3 id="42-å¤–éƒ¨è¡¨-external-table"><a class="header" href="#42-å¤–éƒ¨è¡¨-external-table">4.2 å¤–éƒ¨è¡¨ (External Table)</a></h3>
<pre><code class="language-sql">-- åˆ›å»ºå¤–éƒ¨è¡¨
CREATE EXTERNAL TABLE external_employees (
    id INT,
    name STRING,
    age INT,
    department STRING
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
STORED AS TEXTFILE
LOCATION '/user/hive/external/employees';

-- åˆ é™¤è¡¨(åªåˆ é™¤å…ƒæ•°æ®,æ•°æ®ä¿ç•™åœ¨HDFS)
DROP TABLE external_employees;
</code></pre>
<h3 id="43-åˆ†åŒºè¡¨-partitioned-table"><a class="header" href="#43-åˆ†åŒºè¡¨-partitioned-table">4.3 åˆ†åŒºè¡¨ (Partitioned Table)</a></h3>
<pre><code class="language-sql">-- åˆ›å»ºåˆ†åŒºè¡¨
CREATE TABLE sales (
    id INT,
    product STRING,
    amount DOUBLE
)
PARTITIONED BY (year INT, month INT)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ',';

-- æ·»åŠ åˆ†åŒº
ALTER TABLE sales ADD PARTITION (year=2024, month=1);

-- åŠ è½½æ•°æ®åˆ°åˆ†åŒº
LOAD DATA LOCAL INPATH '/tmp/sales_202401.csv'
INTO TABLE sales PARTITION (year=2024, month=1);

-- æŸ¥è¯¢æŒ‡å®šåˆ†åŒº
SELECT * FROM sales WHERE year=2024 AND month=1;

-- åŠ¨æ€åˆ†åŒºæ’å…¥
SET hive.exec.dynamic.partition=true;
SET hive.exec.dynamic.partition.mode=nonstrict;

INSERT INTO TABLE sales PARTITION (year, month)
SELECT id, product, amount, year, month FROM temp_sales;

-- æŸ¥çœ‹åˆ†åŒº
SHOW PARTITIONS sales;

-- åˆ é™¤åˆ†åŒº
ALTER TABLE sales DROP PARTITION (year=2024, month=1);
</code></pre>
<h3 id="44-åˆ†æ¡¶è¡¨-bucketed-table"><a class="header" href="#44-åˆ†æ¡¶è¡¨-bucketed-table">4.4 åˆ†æ¡¶è¡¨ (Bucketed Table)</a></h3>
<pre><code class="language-sql">-- åˆ›å»ºåˆ†æ¡¶è¡¨
CREATE TABLE bucketed_users (
    id INT,
    name STRING,
    age INT
)
CLUSTERED BY (id) INTO 4 BUCKETS
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ',';

-- æ’å…¥æ•°æ®åˆ°åˆ†æ¡¶è¡¨
SET hive.enforce.bucketing=true;

INSERT INTO bucketed_users
SELECT id, name, age FROM users;

-- åˆ†æ¡¶è¡¨ä¼˜åŠ¿: é«˜æ•ˆé‡‡æ ·å’ŒJOIN
SELECT * FROM bucketed_users TABLESAMPLE(BUCKET 1 OUT OF 4);
</code></pre>
<h2 id="5-hiveql-æŸ¥è¯¢è¯­è¨€"><a class="header" href="#5-hiveql-æŸ¥è¯¢è¯­è¨€">5. HiveQL æŸ¥è¯¢è¯­è¨€</a></h2>
<h3 id="51-åŸºç¡€æŸ¥è¯¢"><a class="header" href="#51-åŸºç¡€æŸ¥è¯¢">5.1 åŸºç¡€æŸ¥è¯¢</a></h3>
<pre><code class="language-sql">-- SELECTåŸºæœ¬è¯­æ³•
SELECT * FROM employees;

-- åˆ—é€‰æ‹©å’Œåˆ«å
SELECT id, name AS employee_name, age
FROM employees;

-- DISTINCTå»é‡
SELECT DISTINCT department FROM employees;

-- WHEREæ¡ä»¶æŸ¥è¯¢
SELECT * FROM employees
WHERE age &gt; 30 AND department = 'IT';

-- LIMITé™åˆ¶ç»“æœ
SELECT * FROM employees LIMIT 10;

-- ORDER BYæ’åº(å…¨å±€æ’åº)
SELECT * FROM employees
ORDER BY age DESC
LIMIT 10;

-- SORT BYæ’åº(åˆ†åŒºå†…æ’åº)
SELECT * FROM employees
SORT BY age DESC;

-- DISTRIBUTE BY + SORT BY
SELECT * FROM employees
DISTRIBUTE BY department
SORT BY age DESC;
</code></pre>
<h3 id="52-èšåˆæŸ¥è¯¢"><a class="header" href="#52-èšåˆæŸ¥è¯¢">5.2 èšåˆæŸ¥è¯¢</a></h3>
<pre><code class="language-sql">-- åŸºç¡€èšåˆå‡½æ•°
SELECT
    department,
    COUNT(*) as emp_count,
    AVG(age) as avg_age,
    MAX(salary) as max_salary,
    MIN(salary) as min_salary,
    SUM(salary) as total_salary
FROM employees
GROUP BY department;

-- HAVINGè¿‡æ»¤
SELECT department, AVG(age) as avg_age
FROM employees
GROUP BY department
HAVING avg_age &gt; 30;

-- GROUPING SETSå¤šç»´èšåˆ
SELECT department, job_level, COUNT(*) as cnt
FROM employees
GROUP BY department, job_level
GROUPING SETS (
    (department, job_level),
    (department),
    (job_level),
    ()
);

-- ROLLUPå±‚æ¬¡èšåˆ
SELECT year, month, SUM(amount) as total
FROM sales
GROUP BY year, month
WITH ROLLUP;

-- CUBEç«‹æ–¹ä½“èšåˆ
SELECT year, month, product, SUM(amount)
FROM sales
GROUP BY year, month, product
WITH CUBE;
</code></pre>
<h3 id="53-çª—å£å‡½æ•°"><a class="header" href="#53-çª—å£å‡½æ•°">5.3 çª—å£å‡½æ•°</a></h3>
<pre><code class="language-sql">-- ROW_NUMBERè¡Œå·
SELECT
    name,
    department,
    salary,
    ROW_NUMBER() OVER (PARTITION BY department ORDER BY salary DESC) as rn
FROM employees;

-- RANKå’ŒDENSE_RANKæ’å
SELECT
    name,
    department,
    salary,
    RANK() OVER (PARTITION BY department ORDER BY salary DESC) as rank,
    DENSE_RANK() OVER (PARTITION BY department ORDER BY salary DESC) as dense_rank
FROM employees;

-- LAG/LEADå‰åå€¼
SELECT
    date,
    sales_amount,
    LAG(sales_amount, 1) OVER (ORDER BY date) as prev_day_sales,
    LEAD(sales_amount, 1) OVER (ORDER BY date) as next_day_sales
FROM daily_sales;

-- SUM/AVGç´¯è®¡èšåˆ
SELECT
    date,
    amount,
    SUM(amount) OVER (ORDER BY date ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) as cumulative_sum,
    AVG(amount) OVER (ORDER BY date ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) as moving_avg_3
FROM sales;

-- NTILEåˆ†ç»„
SELECT
    name,
    salary,
    NTILE(4) OVER (ORDER BY salary DESC) as quartile
FROM employees;
</code></pre>
<h3 id="54-è¿æ¥æŸ¥è¯¢"><a class="header" href="#54-è¿æ¥æŸ¥è¯¢">5.4 è¿æ¥æŸ¥è¯¢</a></h3>
<pre><code class="language-sql">-- INNER JOINå†…è¿æ¥
SELECT e.name, e.department, d.location
FROM employees e
INNER JOIN departments d ON e.department = d.dept_name;

-- LEFT JOINå·¦è¿æ¥
SELECT e.name, e.department, d.location
FROM employees e
LEFT JOIN departments d ON e.department = d.dept_name;

-- RIGHT JOINå³è¿æ¥
SELECT e.name, e.department, d.location
FROM employees e
RIGHT JOIN departments d ON e.department = d.dept_name;

-- FULL OUTER JOINå…¨å¤–è¿æ¥
SELECT e.name, e.department, d.location
FROM employees e
FULL OUTER JOIN departments d ON e.department = d.dept_name;

-- CROSS JOINäº¤å‰è¿æ¥
SELECT e.name, d.dept_name
FROM employees e
CROSS JOIN departments d;

-- LEFT SEMI JOINåŠè¿æ¥(ç±»ä¼¼INå­æŸ¥è¯¢)
SELECT e.name, e.department
FROM employees e
LEFT SEMI JOIN high_performers hp ON e.id = hp.emp_id;

-- Map-side JOINä¼˜åŒ–
SELECT /*+ MAPJOIN(d) */ e.name, d.location
FROM employees e
JOIN departments d ON e.department = d.dept_name;
</code></pre>
<h2 id="6-hive-å†…ç½®å‡½æ•°"><a class="header" href="#6-hive-å†…ç½®å‡½æ•°">6. Hive å†…ç½®å‡½æ•°</a></h2>
<h3 id="61-å­—ç¬¦ä¸²å‡½æ•°"><a class="header" href="#61-å­—ç¬¦ä¸²å‡½æ•°">6.1 å­—ç¬¦ä¸²å‡½æ•°</a></h3>
<pre><code class="language-sql">-- å­—ç¬¦ä¸²æ“ä½œ
SELECT
    CONCAT('Hello', ' ', 'World') as concat_str,
    CONCAT_WS(',', 'a', 'b', 'c') as concat_ws,
    SUBSTR('Hello World', 1, 5) as substr,
    SUBSTRING_INDEX('a-b-c', '-', 2) as substring_index,
    LENGTH('Hello') as str_length,
    UPPER('hello') as upper_str,
    LOWER('HELLO') as lower_str,
    TRIM(' hello ') as trimmed,
    LTRIM(' hello') as ltrimmed,
    RTRIM('hello ') as rtrimmed,
    REVERSE('hello') as reversed,
    SPLIT('a,b,c', ',') as split_array,
    REGEXP_REPLACE('hello123', '[0-9]', '') as regex_replace,
    REGEXP_EXTRACT('price: $100', '\\$([0-9]+)', 1) as regex_extract;
</code></pre>
<h3 id="62-æ—¥æœŸå‡½æ•°"><a class="header" href="#62-æ—¥æœŸå‡½æ•°">6.2 æ—¥æœŸå‡½æ•°</a></h3>
<pre><code class="language-sql">-- æ—¥æœŸæ—¶é—´æ“ä½œ
SELECT
    CURRENT_DATE() as cur_date,
    CURRENT_TIMESTAMP() as cur_timestamp,
    UNIX_TIMESTAMP() as unix_ts,
    FROM_UNIXTIME(1609459200) as from_unix,
    TO_DATE('2024-01-01 12:00:00') as to_date,
    YEAR('2024-01-01') as year,
    MONTH('2024-01-01') as month,
    DAY('2024-01-01') as day,
    HOUR('2024-01-01 12:00:00') as hour,
    MINUTE('2024-01-01 12:30:00') as minute,
    SECOND('2024-01-01 12:30:45') as second,
    DATE_ADD('2024-01-01', 7) as date_add_7,
    DATE_SUB('2024-01-01', 7) as date_sub_7,
    DATEDIFF('2024-01-10', '2024-01-01') as date_diff,
    LAST_DAY('2024-01-15') as last_day_of_month,
    NEXT_DAY('2024-01-01', 'Monday') as next_monday;
</code></pre>
<h3 id="63-æ•°å­¦å‡½æ•°"><a class="header" href="#63-æ•°å­¦å‡½æ•°">6.3 æ•°å­¦å‡½æ•°</a></h3>
<pre><code class="language-sql">-- æ•°å­¦è¿ç®—
SELECT
    ROUND(3.14159, 2) as rounded,
    FLOOR(3.9) as floored,
    CEIL(3.1) as ceiled,
    ABS(-10) as absolute,
    POW(2, 3) as power,
    SQRT(16) as square_root,
    RAND() as random,
    RAND(42) as random_seeded;
</code></pre>
<h3 id="64-æ¡ä»¶å‡½æ•°"><a class="header" href="#64-æ¡ä»¶å‡½æ•°">6.4 æ¡ä»¶å‡½æ•°</a></h3>
<pre><code class="language-sql">-- æ¡ä»¶åˆ¤æ–­
SELECT
    id,
    name,
    age,
    CASE
        WHEN age &lt; 30 THEN 'Young'
        WHEN age BETWEEN 30 AND 50 THEN 'Middle'
        ELSE 'Senior'
    END as age_group,
    IF(age &gt; 35, 'Above 35', 'Below 35') as age_check,
    COALESCE(department, 'Unknown') as dept,
    NVL(salary, 0) as salary_nvl,
    NULLIF(salary, 0) as salary_nullif;
</code></pre>
<h3 id="65-é›†åˆå‡½æ•°"><a class="header" href="#65-é›†åˆå‡½æ•°">6.5 é›†åˆå‡½æ•°</a></h3>
<pre><code class="language-sql">-- æ•°ç»„æ“ä½œ
SELECT
    SIZE(hobbies) as hobby_count,
    ARRAY_CONTAINS(hobbies, 'reading') as has_reading,
    SORT_ARRAY(hobbies) as sorted_hobbies,
    hobbies[0] as first_hobby;

-- Mapæ“ä½œ
SELECT
    SIZE(scores) as subject_count,
    MAP_KEYS(scores) as subjects,
    MAP_VALUES(scores) as score_values,
    scores['math'] as math_score;

-- å¤æ‚ç±»å‹å±•å¼€
SELECT
    id,
    hobby
FROM employees
LATERAL VIEW EXPLODE(hobbies) h AS hobby;

-- å¤šçº§å±•å¼€
SELECT
    id,
    subject,
    score
FROM students
LATERAL VIEW EXPLODE(scores) s AS subject, score;
</code></pre>
<h2 id="7-ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°-udf"><a class="header" href="#7-ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°-udf">7. ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•° (UDF)</a></h2>
<h3 id="71-udfå¼€å‘"><a class="header" href="#71-udfå¼€å‘">7.1 UDFå¼€å‘</a></h3>
<p><strong>Mavenä¾èµ–:</strong></p>
<pre><code class="language-xml">&lt;dependency&gt;
    &lt;groupId&gt;org.apache.hive&lt;/groupId&gt;
    &lt;artifactId&gt;hive-exec&lt;/artifactId&gt;
    &lt;version&gt;3.1.3&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
<p><strong>ç®€å•UDFç¤ºä¾‹:</strong></p>
<pre><code class="language-java">import org.apache.hadoop.hive.ql.exec.UDF;
import org.apache.hadoop.io.Text;

public class ToUpperCaseUDF extends UDF {
    public Text evaluate(Text input) {
        if (input == null) {
            return null;
        }
        return new Text(input.toString().toUpperCase());
    }
}
</code></pre>
<p><strong>ä½¿ç”¨UDF:</strong></p>
<pre><code class="language-sql">-- æ·»åŠ JAR
ADD JAR /path/to/my-udf.jar;

-- åˆ›å»ºä¸´æ—¶å‡½æ•°
CREATE TEMPORARY FUNCTION to_upper AS 'com.example.ToUpperCaseUDF';

-- ä½¿ç”¨å‡½æ•°
SELECT to_upper(name) FROM employees;

-- åˆ›å»ºæ°¸ä¹…å‡½æ•°
CREATE FUNCTION to_upper AS 'com.example.ToUpperCaseUDF'
USING JAR 'hdfs:///user/hive/udf/my-udf.jar';
</code></pre>
<h3 id="72-udafå¼€å‘-èšåˆå‡½æ•°"><a class="header" href="#72-udafå¼€å‘-èšåˆå‡½æ•°">7.2 UDAFå¼€å‘ (èšåˆå‡½æ•°)</a></h3>
<pre><code class="language-java">import org.apache.hadoop.hive.ql.exec.UDAF;
import org.apache.hadoop.hive.ql.exec.UDAFEvaluator;

public class AverageUDAF extends UDAF {

    public static class AverageEvaluator implements UDAFEvaluator {

        public static class PartialResult {
            long sum;
            long count;
        }

        private PartialResult partial;

        @Override
        public void init() {
            partial = null;
        }

        public boolean iterate(Long value) {
            if (value == null) return true;

            if (partial == null) {
                partial = new PartialResult();
            }
            partial.sum += value;
            partial.count++;
            return true;
        }

        public PartialResult terminatePartial() {
            return partial;
        }

        public boolean merge(PartialResult other) {
            if (other == null) return true;

            if (partial == null) {
                partial = new PartialResult();
            }
            partial.sum += other.sum;
            partial.count += other.count;
            return true;
        }

        public Double terminate() {
            if (partial == null) return null;
            return (double) partial.sum / partial.count;
        }
    }
}
</code></pre>
<h3 id="73-udtfå¼€å‘-è¡¨ç”Ÿæˆå‡½æ•°"><a class="header" href="#73-udtfå¼€å‘-è¡¨ç”Ÿæˆå‡½æ•°">7.3 UDTFå¼€å‘ (è¡¨ç”Ÿæˆå‡½æ•°)</a></h3>
<pre><code class="language-java">import org.apache.hadoop.hive.ql.exec.UDFArgumentException;
import org.apache.hadoop.hive.ql.metadata.HiveException;
import org.apache.hadoop.hive.ql.udf.generic.GenericUDTF;
import org.apache.hadoop.hive.serde2.objectinspector.*;
import org.apache.hadoop.hive.serde2.objectinspector.primitive.PrimitiveObjectInspectorFactory;

import java.util.ArrayList;
import java.util.List;

public class SplitUDTF extends GenericUDTF {

    @Override
    public StructObjectInspector initialize(ObjectInspector[] args)
            throws UDFArgumentException {

        List&lt;String&gt; fieldNames = new ArrayList&lt;&gt;();
        List&lt;ObjectInspector&gt; fieldOIs = new ArrayList&lt;&gt;();

        fieldNames.add("word");
        fieldOIs.add(PrimitiveObjectInspectorFactory.javaStringObjectInspector);

        return ObjectInspectorFactory.getStandardStructObjectInspector(
            fieldNames, fieldOIs
        );
    }

    @Override
    public void process(Object[] args) throws HiveException {
        String input = args[0].toString();
        String[] words = input.split(" ");

        for (String word : words) {
            forward(new Object[]{word});
        }
    }

    @Override
    public void close() throws HiveException {
    }
}
</code></pre>
<p><strong>ä½¿ç”¨UDTF:</strong></p>
<pre><code class="language-sql">CREATE TEMPORARY FUNCTION split_words AS 'com.example.SplitUDTF';

SELECT word
FROM sentences
LATERAL VIEW split_words(sentence) w AS word;
</code></pre>
<h2 id="8-hive-å­˜å‚¨æ ¼å¼"><a class="header" href="#8-hive-å­˜å‚¨æ ¼å¼">8. Hive å­˜å‚¨æ ¼å¼</a></h2>
<h3 id="81-æ–‡ä»¶æ ¼å¼å¯¹æ¯”"><a class="header" href="#81-æ–‡ä»¶æ ¼å¼å¯¹æ¯”">8.1 æ–‡ä»¶æ ¼å¼å¯¹æ¯”</a></h3>
<div class="table-wrapper"><table><thead><tr><th>æ ¼å¼</th><th>å‹ç¼©æ¯”</th><th>æŸ¥è¯¢æ€§èƒ½</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody>
<tr><td>TextFile</td><td>ä½</td><td>å·®</td><td>æµ‹è¯•ç¯å¢ƒ</td></tr>
<tr><td>SequenceFile</td><td>ä¸­</td><td>ä¸­</td><td>ä¸­é—´æ•°æ®</td></tr>
<tr><td>ORC</td><td>é«˜</td><td>ä¼˜</td><td>OLAPæŸ¥è¯¢</td></tr>
<tr><td>Parquet</td><td>é«˜</td><td>ä¼˜</td><td>å¤æ‚åµŒå¥—æ•°æ®</td></tr>
<tr><td>Avro</td><td>ä¸­</td><td>ä¸­</td><td>Schemaæ¼”è¿›</td></tr>
</tbody></table>
</div>
<h3 id="82-orcæ ¼å¼"><a class="header" href="#82-orcæ ¼å¼">8.2 ORCæ ¼å¼</a></h3>
<pre><code class="language-sql">-- åˆ›å»ºORCè¡¨
CREATE TABLE orc_table (
    id INT,
    name STRING,
    salary DOUBLE
)
STORED AS ORC
TBLPROPERTIES (
    "orc.compress"="SNAPPY",
    "orc.create.index"="true",
    "orc.stripe.size"="67108864",
    "orc.row.index.stride"="10000"
);

-- ä»å…¶ä»–è¡¨å¯¼å…¥æ•°æ®
INSERT INTO TABLE orc_table
SELECT * FROM text_table;
</code></pre>
<p><strong>ORCä¼˜åŠ¿:</strong></p>
<ul>
<li>é«˜å‹ç¼©æ¯”(æ¯”TextFileå°60-70%)</li>
<li>åˆ—å¼å­˜å‚¨,æ”¯æŒè°“è¯ä¸‹æ¨</li>
<li>å†…ç½®ç´¢å¼•,åŠ é€ŸæŸ¥è¯¢</li>
<li>æ”¯æŒACIDäº‹åŠ¡</li>
</ul>
<h3 id="83-parquetæ ¼å¼"><a class="header" href="#83-parquetæ ¼å¼">8.3 Parquetæ ¼å¼</a></h3>
<pre><code class="language-sql">-- åˆ›å»ºParquetè¡¨
CREATE TABLE parquet_table (
    id INT,
    name STRING,
    address STRUCT&lt;city:STRING, street:STRING&gt;
)
STORED AS PARQUET
TBLPROPERTIES (
    "parquet.compression"="SNAPPY"
);
</code></pre>
<p><strong>Parquetä¼˜åŠ¿:</strong></p>
<ul>
<li>ä¼˜ç§€çš„åµŒå¥—æ•°æ®æ”¯æŒ</li>
<li>ä¸Sparkã€Impalaå…¼å®¹æ€§å¥½</li>
<li>åˆ—å¼å­˜å‚¨,é«˜å‹ç¼©æ¯”</li>
<li>æ”¯æŒå¤æ‚æ•°æ®ç±»å‹</li>
</ul>
<h3 id="84-å‹ç¼©ç®—æ³•"><a class="header" href="#84-å‹ç¼©ç®—æ³•">8.4 å‹ç¼©ç®—æ³•</a></h3>
<pre><code class="language-sql">-- è®¾ç½®å‹ç¼©ç®—æ³•
SET hive.exec.compress.output=true;
SET mapreduce.output.fileoutputformat.compress.codec=org.apache.hadoop.io.compress.SnappyCodec;

-- ä¸­é—´ç»“æœå‹ç¼©
SET hive.exec.compress.intermediate=true;
SET hive.intermediate.compression.codec=org.apache.hadoop.io.compress.SnappyCodec;
</code></pre>
<p><strong>å‹ç¼©ç®—æ³•å¯¹æ¯”:</strong></p>
<div class="table-wrapper"><table><thead><tr><th>ç®—æ³•</th><th>å‹ç¼©æ¯”</th><th>å‹ç¼©é€Ÿåº¦</th><th>è§£å‹é€Ÿåº¦</th><th>å¯åˆ†å‰²</th></tr></thead><tbody>
<tr><td>Gzip</td><td>é«˜</td><td>æ…¢</td><td>ä¸­</td><td>å¦</td></tr>
<tr><td>Bzip2</td><td>å¾ˆé«˜</td><td>å¾ˆæ…¢</td><td>æ…¢</td><td>æ˜¯</td></tr>
<tr><td>Snappy</td><td>ä¸­</td><td>å¾ˆå¿«</td><td>å¾ˆå¿«</td><td>å¦</td></tr>
<tr><td>LZO</td><td>ä¸­</td><td>å¿«</td><td>å¿«</td><td>æ˜¯(éœ€ç´¢å¼•)</td></tr>
<tr><td>Zstd</td><td>é«˜</td><td>å¿«</td><td>å¿«</td><td>å¦</td></tr>
</tbody></table>
</div>
<h2 id="9-hive-æ€§èƒ½ä¼˜åŒ–"><a class="header" href="#9-hive-æ€§èƒ½ä¼˜åŒ–">9. Hive æ€§èƒ½ä¼˜åŒ–</a></h2>
<h3 id="91-æŸ¥è¯¢ä¼˜åŒ–"><a class="header" href="#91-æŸ¥è¯¢ä¼˜åŒ–">9.1 æŸ¥è¯¢ä¼˜åŒ–</a></h3>
<p><strong>è°“è¯ä¸‹æ¨:</strong></p>
<pre><code class="language-sql">-- è‡ªåŠ¨å¼€å¯
SET hive.optimize.ppd=true;

-- è°“è¯ä¼šè¢«ä¸‹æ¨åˆ°å­˜å‚¨å±‚
SELECT * FROM employees
WHERE department = 'IT' AND age &gt; 30;
</code></pre>
<p><strong>åˆ—è£å‰ª:</strong></p>
<pre><code class="language-sql">-- è‡ªåŠ¨å¼€å¯
SET hive.optimize.cp=true;

-- åªè¯»å–éœ€è¦çš„åˆ—
SELECT name, age FROM employees;
</code></pre>
<p><strong>åˆ†åŒºè£å‰ª:</strong></p>
<pre><code class="language-sql">-- ä¸¥æ ¼æ¨¡å¼(å¿…é¡»ä½¿ç”¨åˆ†åŒºè¿‡æ»¤)
SET hive.mapred.mode=strict;

-- åˆ†åŒºè£å‰ªæŸ¥è¯¢
SELECT * FROM sales
WHERE year=2024 AND month=1;
</code></pre>
<p><strong>å°æ–‡ä»¶åˆå¹¶:</strong></p>
<pre><code class="language-sql">-- Mapç«¯åˆå¹¶å°æ–‡ä»¶
SET hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;

-- Reduceç«¯åˆå¹¶å°æ–‡ä»¶
SET hive.merge.mapfiles=true;
SET hive.merge.mapredfiles=true;
SET hive.merge.size.per.task=256000000;
SET hive.merge.smallfiles.avgsize=16000000;
</code></pre>
<h3 id="92-joinä¼˜åŒ–"><a class="header" href="#92-joinä¼˜åŒ–">9.2 Joinä¼˜åŒ–</a></h3>
<p><strong>Map Join:</strong></p>
<pre><code class="language-sql">-- è‡ªåŠ¨è½¬æ¢ä¸ºMap Join(å°è¡¨&lt;25MB)
SET hive.auto.convert.join=true;
SET hive.mapjoin.smalltable.filesize=25000000;

-- æ˜¾å¼æŒ‡å®šMap Join
SELECT /*+ MAPJOIN(d) */ e.name, d.location
FROM employees e
JOIN departments d ON e.department = d.dept_name;
</code></pre>
<p><strong>Bucket Map Join:</strong></p>
<pre><code class="language-sql">SET hive.optimize.bucketmapjoin=true;

-- åˆ†æ¡¶è¡¨JOIN
SELECT /*+ MAPJOIN(b) */ a.id, b.name
FROM bucketed_table_a a
JOIN bucketed_table_b b ON a.id = b.id;
</code></pre>
<p><strong>Sort Merge Bucket Join:</strong></p>
<pre><code class="language-sql">SET hive.optimize.bucketmapjoin=true;
SET hive.optimize.bucketmapjoin.sortedmerge=true;
SET hive.input.format=org.apache.hadoop.hive.ql.io.BucketizedHiveInputFormat;
</code></pre>
<p><strong>å€¾æ–œJOINä¼˜åŒ–:</strong></p>
<pre><code class="language-sql">-- å¼€å¯å€¾æ–œJOINä¼˜åŒ–
SET hive.optimize.skewjoin=true;
SET hive.skewjoin.key=100000;
</code></pre>
<h3 id="93-æ‰§è¡Œå¼•æ“ä¼˜åŒ–"><a class="header" href="#93-æ‰§è¡Œå¼•æ“ä¼˜åŒ–">9.3 æ‰§è¡Œå¼•æ“ä¼˜åŒ–</a></h3>
<p><strong>Tezå¼•æ“:</strong></p>
<pre><code class="language-sql">-- ä½¿ç”¨Tezå¼•æ“
SET hive.execution.engine=tez;

-- Tezé…ç½®ä¼˜åŒ–
SET tez.queue.name=default;
SET tez.am.resource.memory.mb=4096;
SET tez.task.resource.memory.mb=2048;
</code></pre>
<p><strong>å‘é‡åŒ–æ‰§è¡Œ:</strong></p>
<pre><code class="language-sql">-- å¼€å¯å‘é‡åŒ–
SET hive.vectorized.execution.enabled=true;
SET hive.vectorized.execution.reduce.enabled=true;
</code></pre>
<p><strong>å¹¶è¡Œæ‰§è¡Œ:</strong></p>
<pre><code class="language-sql">-- å¼€å¯å¹¶è¡Œæ‰§è¡Œ
SET hive.exec.parallel=true;
SET hive.exec.parallel.thread.number=8;
</code></pre>
<h3 id="94-æ•°æ®å€¾æ–œå¤„ç†"><a class="header" href="#94-æ•°æ®å€¾æ–œå¤„ç†">9.4 æ•°æ®å€¾æ–œå¤„ç†</a></h3>
<p><strong>æ–¹æ³•1: å‚æ•°è°ƒä¼˜</strong></p>
<pre><code class="language-sql">SET hive.groupby.skewindata=true;
SET hive.optimize.skewjoin=true;
</code></pre>
<p><strong>æ–¹æ³•2: SQLæ”¹å†™</strong></p>
<pre><code class="language-sql">-- åŸå§‹æŸ¥è¯¢(å­˜åœ¨å€¾æ–œ)
SELECT department, COUNT(*) as cnt
FROM employees
GROUP BY department;

-- ä¼˜åŒ–: ä¸¤é˜¶æ®µèšåˆ
SELECT department, SUM(cnt) as total_cnt
FROM (
    SELECT department, COUNT(*) as cnt
    FROM employees
    GROUP BY department, CAST(RAND() * 10 AS INT)
) tmp
GROUP BY department;
</code></pre>
<p><strong>æ–¹æ³•3: å¢åŠ éšæœºå‰ç¼€</strong></p>
<pre><code class="language-sql">-- æ•°æ®è†¨èƒ€
SELECT
    CONCAT(department, '_', CAST(RAND() * 10 AS INT)) as dept_key,
    COUNT(*) as cnt
FROM employees
GROUP BY CONCAT(department, '_', CAST(RAND() * 10 AS INT));
</code></pre>
<h2 id="10-hive-äº‹åŠ¡æ”¯æŒ"><a class="header" href="#10-hive-äº‹åŠ¡æ”¯æŒ">10. Hive äº‹åŠ¡æ”¯æŒ</a></h2>
<h3 id="101-acidé…ç½®"><a class="header" href="#101-acidé…ç½®">10.1 ACIDé…ç½®</a></h3>
<pre><code class="language-sql">-- å¼€å¯äº‹åŠ¡æ”¯æŒ
SET hive.support.concurrency=true;
SET hive.enforce.bucketing=true;
SET hive.exec.dynamic.partition.mode=nonstrict;
SET hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DbTxnManager;
SET hive.compactor.initiator.on=true;
SET hive.compactor.worker.threads=1;
</code></pre>
<h3 id="102-äº‹åŠ¡è¡¨åˆ›å»º"><a class="header" href="#102-äº‹åŠ¡è¡¨åˆ›å»º">10.2 äº‹åŠ¡è¡¨åˆ›å»º</a></h3>
<pre><code class="language-sql">-- åˆ›å»ºæ”¯æŒACIDçš„è¡¨
CREATE TABLE acid_table (
    id INT,
    name STRING,
    balance DOUBLE
)
CLUSTERED BY (id) INTO 4 BUCKETS
STORED AS ORC
TBLPROPERTIES (
    'transactional'='true',
    'orc.compress'='SNAPPY'
);
</code></pre>
<h3 id="103-acidæ“ä½œ"><a class="header" href="#103-acidæ“ä½œ">10.3 ACIDæ“ä½œ</a></h3>
<pre><code class="language-sql">-- INSERT
INSERT INTO acid_table VALUES (1, 'Alice', 1000.0);

-- UPDATE
UPDATE acid_table
SET balance = balance + 100
WHERE id = 1;

-- DELETE
DELETE FROM acid_table
WHERE id = 1;

-- MERGE
MERGE INTO acid_table AS target
USING updates AS source
ON target.id = source.id
WHEN MATCHED THEN UPDATE SET balance = source.balance
WHEN NOT MATCHED THEN INSERT VALUES (source.id, source.name, source.balance);
</code></pre>
<h2 id="11-hive-é«˜çº§ç‰¹æ€§"><a class="header" href="#11-hive-é«˜çº§ç‰¹æ€§">11. Hive é«˜çº§ç‰¹æ€§</a></h2>
<h3 id="111-è§†å›¾"><a class="header" href="#111-è§†å›¾">11.1 è§†å›¾</a></h3>
<pre><code class="language-sql">-- åˆ›å»ºè§†å›¾
CREATE VIEW high_salary_employees AS
SELECT id, name, department, salary
FROM employees
WHERE salary &gt; 10000;

-- æŸ¥è¯¢è§†å›¾
SELECT * FROM high_salary_employees;

-- åˆ é™¤è§†å›¾
DROP VIEW high_salary_employees;
</code></pre>
<h3 id="112-ç‰©åŒ–è§†å›¾"><a class="header" href="#112-ç‰©åŒ–è§†å›¾">11.2 ç‰©åŒ–è§†å›¾</a></h3>
<pre><code class="language-sql">-- åˆ›å»ºç‰©åŒ–è§†å›¾
CREATE MATERIALIZED VIEW mv_dept_stats AS
SELECT
    department,
    COUNT(*) as emp_count,
    AVG(salary) as avg_salary
FROM employees
GROUP BY department;

-- åˆ·æ–°ç‰©åŒ–è§†å›¾
ALTER MATERIALIZED VIEW mv_dept_stats REBUILD;

-- æŸ¥è¯¢è‡ªåŠ¨ä½¿ç”¨ç‰©åŒ–è§†å›¾
SELECT department, COUNT(*)
FROM employees
GROUP BY department;

-- åˆ é™¤ç‰©åŒ–è§†å›¾
DROP MATERIALIZED VIEW mv_dept_stats;
</code></pre>
<h3 id="113-ç´¢å¼•-å·²åºŸå¼ƒå»ºè®®ä½¿ç”¨orcç´¢å¼•"><a class="header" href="#113-ç´¢å¼•-å·²åºŸå¼ƒå»ºè®®ä½¿ç”¨orcç´¢å¼•">11.3 ç´¢å¼• (å·²åºŸå¼ƒ,å»ºè®®ä½¿ç”¨ORCç´¢å¼•)</a></h3>
<pre><code class="language-sql">-- åˆ›å»ºç´¢å¼•(Hive 3.xå·²åºŸå¼ƒ)
-- å»ºè®®ä½¿ç”¨ORCæ–‡ä»¶æ ¼å¼çš„å†…ç½®ç´¢å¼•
CREATE TABLE orc_indexed_table (
    id INT,
    name STRING
)
STORED AS ORC
TBLPROPERTIES (
    "orc.create.index"="true",
    "orc.bloom.filter.columns"="name"
);
</code></pre>
<h3 id="114-åŠ¨æ€åˆ†åŒº"><a class="header" href="#114-åŠ¨æ€åˆ†åŒº">11.4 åŠ¨æ€åˆ†åŒº</a></h3>
<pre><code class="language-sql">-- å¼€å¯åŠ¨æ€åˆ†åŒº
SET hive.exec.dynamic.partition=true;
SET hive.exec.dynamic.partition.mode=nonstrict;
SET hive.exec.max.dynamic.partitions=1000;
SET hive.exec.max.dynamic.partitions.pernode=100;

-- åŠ¨æ€åˆ†åŒºæ’å…¥
INSERT INTO TABLE sales PARTITION (year, month)
SELECT id, product, amount, year, month
FROM temp_sales;
</code></pre>
<h2 id="12-hive-ä¸å…¶ä»–ç»„ä»¶é›†æˆ"><a class="header" href="#12-hive-ä¸å…¶ä»–ç»„ä»¶é›†æˆ">12. Hive ä¸å…¶ä»–ç»„ä»¶é›†æˆ</a></h2>
<h3 id="121-hiveä¸hbaseé›†æˆ"><a class="header" href="#121-hiveä¸hbaseé›†æˆ">12.1 Hiveä¸HBaseé›†æˆ</a></h3>
<pre><code class="language-sql">-- åˆ›å»ºHBaseæ˜ å°„è¡¨
CREATE EXTERNAL TABLE hbase_table (
    key STRING,
    name STRING,
    age INT,
    city STRING
)
STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'
WITH SERDEPROPERTIES (
    "hbase.columns.mapping" = ":key,info:name,info:age,address:city"
)
TBLPROPERTIES (
    "hbase.table.name" = "users",
    "hbase.zookeeper.quorum" = "localhost:2181"
);

-- æŸ¥è¯¢HBaseæ•°æ®
SELECT * FROM hbase_table WHERE key = 'user001';
</code></pre>
<h3 id="122-hiveä¸kafkaé›†æˆ"><a class="header" href="#122-hiveä¸kafkaé›†æˆ">12.2 Hiveä¸Kafkaé›†æˆ</a></h3>
<pre><code class="language-sql">-- åˆ›å»ºKafkaè¡¨
CREATE EXTERNAL TABLE kafka_table (
    `timestamp` BIGINT,
    message STRING
)
STORED BY 'org.apache.hadoop.hive.kafka.KafkaStorageHandler'
TBLPROPERTIES (
    "kafka.topic" = "test-topic",
    "kafka.bootstrap.servers" = "localhost:9092"
);
</code></pre>
<h3 id="123-ä½¿ç”¨sparkå¼•æ“"><a class="header" href="#123-ä½¿ç”¨sparkå¼•æ“">12.3 ä½¿ç”¨Sparkå¼•æ“</a></h3>
<pre><code class="language-sql">-- é…ç½®Sparkä¸ºæ‰§è¡Œå¼•æ“
SET hive.execution.engine=spark;
SET spark.master=yarn;
SET spark.executor.memory=4g;
SET spark.executor.cores=2;
</code></pre>
<h2 id="13-ç›‘æ§ä¸è¿ç»´"><a class="header" href="#13-ç›‘æ§ä¸è¿ç»´">13. ç›‘æ§ä¸è¿ç»´</a></h2>
<h3 id="131-æŸ¥è¯¢æ—¥å¿—"><a class="header" href="#131-æŸ¥è¯¢æ—¥å¿—">13.1 æŸ¥è¯¢æ—¥å¿—</a></h3>
<pre><code class="language-bash"># HiveServer2æ—¥å¿—
tail -f $HIVE_HOME/logs/hiveserver2.log

# Metastoreæ—¥å¿—
tail -f $HIVE_HOME/logs/metastore.log

# æŸ¥è¯¢å†å²
SELECT * FROM sys.query_log;
</code></pre>
<h3 id="132-æ€§èƒ½åˆ†æ"><a class="header" href="#132-æ€§èƒ½åˆ†æ">13.2 æ€§èƒ½åˆ†æ</a></h3>
<pre><code class="language-sql">-- æŸ¥çœ‹æ‰§è¡Œè®¡åˆ’
EXPLAIN SELECT * FROM employees WHERE department = 'IT';

-- è¯¦ç»†æ‰§è¡Œè®¡åˆ’
EXPLAIN EXTENDED SELECT * FROM employees WHERE department = 'IT';

-- ä¾èµ–åˆ†æ
EXPLAIN DEPENDENCY SELECT * FROM employees;

-- æŸ¥è¯¢ç»Ÿè®¡
ANALYZE TABLE employees COMPUTE STATISTICS;
ANALYZE TABLE employees COMPUTE STATISTICS FOR COLUMNS;

-- æŸ¥çœ‹ç»Ÿè®¡ä¿¡æ¯
DESCRIBE FORMATTED employees;
</code></pre>
<h3 id="133-å¸¸è§é—®é¢˜æ’æŸ¥"><a class="header" href="#133-å¸¸è§é—®é¢˜æ’æŸ¥">13.3 å¸¸è§é—®é¢˜æ’æŸ¥</a></h3>
<p><strong>é—®é¢˜1: å°æ–‡ä»¶è¿‡å¤š</strong></p>
<pre><code class="language-bash"># ç°è±¡: æŸ¥è¯¢æ…¢,NameNodeå‹åŠ›å¤§
# è§£å†³:
# 1. åˆå¹¶å°æ–‡ä»¶
SET hive.merge.mapfiles=true;
SET hive.merge.mapredfiles=true;

# 2. ä½¿ç”¨Insertè¦†ç›–
INSERT OVERWRITE TABLE target_table SELECT * FROM source_table;
</code></pre>
<p><strong>é—®é¢˜2: æ•°æ®å€¾æ–œ</strong></p>
<pre><code class="language-sql">-- ç°è±¡: æŸäº›Taskæ‰§è¡Œæ—¶é—´ç‰¹åˆ«é•¿
-- è§£å†³:
SET hive.groupby.skewindata=true;
SET hive.optimize.skewjoin=true;
</code></pre>
<p><strong>é—®é¢˜3: OOMå†…å­˜æº¢å‡º</strong></p>
<pre><code class="language-sql">-- å¢åŠ å†…å­˜
SET mapreduce.map.memory.mb=4096;
SET mapreduce.reduce.memory.mb=4096;
SET mapreduce.map.java.opts=-Xmx3276m;
SET mapreduce.reduce.java.opts=-Xmx3276m;
</code></pre>
<h2 id="14-å®æˆ˜æ¡ˆä¾‹"><a class="header" href="#14-å®æˆ˜æ¡ˆä¾‹">14. å®æˆ˜æ¡ˆä¾‹</a></h2>
<h3 id="141-ç”¨æˆ·è¡Œä¸ºåˆ†æ"><a class="header" href="#141-ç”¨æˆ·è¡Œä¸ºåˆ†æ">14.1 ç”¨æˆ·è¡Œä¸ºåˆ†æ</a></h3>
<pre><code class="language-sql">-- åˆ›å»ºç”¨æˆ·è¡Œä¸ºè¡¨
CREATE TABLE user_behavior (
    user_id STRING,
    item_id STRING,
    category_id STRING,
    behavior STRING,
    timestamp BIGINT
)
PARTITIONED BY (dt STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
STORED AS ORC;

-- æ—¥æ´»ç»Ÿè®¡
SELECT
    dt,
    COUNT(DISTINCT user_id) as dau
FROM user_behavior
WHERE dt &gt;= '2024-01-01'
GROUP BY dt;

-- ç”¨æˆ·ç•™å­˜åˆ†æ
SELECT
    first_date,
    day_diff,
    COUNT(DISTINCT user_id) as retained_users,
    ROUND(COUNT(DISTINCT user_id) / first_value(COUNT(DISTINCT user_id)) OVER (PARTITION BY first_date ORDER BY day_diff), 4) as retention_rate
FROM (
    SELECT
        user_id,
        MIN(dt) OVER (PARTITION BY user_id) as first_date,
        dt,
        DATEDIFF(dt, MIN(dt) OVER (PARTITION BY user_id)) as day_diff
    FROM user_behavior
) t
GROUP BY first_date, day_diff
ORDER BY first_date, day_diff;

-- å•†å“çƒ­åº¦æ’è¡Œ
SELECT
    item_id,
    COUNT(*) as view_count,
    COUNT(DISTINCT user_id) as unique_users
FROM user_behavior
WHERE dt = '2024-01-01'
  AND behavior = 'pv'
GROUP BY item_id
ORDER BY view_count DESC
LIMIT 100;
</code></pre>
<h3 id="142-é”€å”®æ•°æ®åˆ†æ"><a class="header" href="#142-é”€å”®æ•°æ®åˆ†æ">14.2 é”€å”®æ•°æ®åˆ†æ</a></h3>
<pre><code class="language-sql">-- åˆ›å»ºè®¢å•è¡¨
CREATE TABLE orders (
    order_id STRING,
    user_id STRING,
    product_id STRING,
    amount DOUBLE,
    quantity INT,
    order_time TIMESTAMP
)
PARTITIONED BY (year INT, month INT, day INT)
STORED AS ORC;

-- æ¯æ—¥é”€å”®ç»Ÿè®¡
SELECT
    year,
    month,
    day,
    COUNT(DISTINCT order_id) as order_count,
    COUNT(DISTINCT user_id) as buyer_count,
    SUM(amount) as total_amount,
    AVG(amount) as avg_amount
FROM orders
WHERE year = 2024 AND month = 1
GROUP BY year, month, day
ORDER BY year, month, day;

-- ç”¨æˆ·æ¶ˆè´¹åˆ†å±‚
SELECT
    user_level,
    COUNT(*) as user_count,
    SUM(total_amount) as total_sales,
    AVG(total_amount) as avg_sales
FROM (
    SELECT
        user_id,
        SUM(amount) as total_amount,
        CASE
            WHEN SUM(amount) &lt; 1000 THEN 'Bronze'
            WHEN SUM(amount) &lt; 5000 THEN 'Silver'
            WHEN SUM(amount) &lt; 10000 THEN 'Gold'
            ELSE 'Platinum'
        END as user_level
    FROM orders
    WHERE year = 2024
    GROUP BY user_id
) t
GROUP BY user_level;
</code></pre>
<h2 id="15-å­¦ä¹ éªŒè¯æ ‡å‡†"><a class="header" href="#15-å­¦ä¹ éªŒè¯æ ‡å‡†">15. å­¦ä¹ éªŒè¯æ ‡å‡†</a></h2>
<h3 id="-åŸºç¡€èƒ½åŠ›éªŒè¯"><a class="header" href="#-åŸºç¡€èƒ½åŠ›éªŒè¯">âœ… åŸºç¡€èƒ½åŠ›éªŒè¯</a></h3>
<ul>
<li><input disabled="" type="checkbox"/>
ç†è§£Hiveæ¶æ„å’Œå·¥ä½œåŸç†</li>
<li><input disabled="" type="checkbox"/>
èƒ½å¤Ÿå®‰è£…é…ç½®Hiveç¯å¢ƒ</li>
<li><input disabled="" type="checkbox"/>
æŒæ¡HiveQLåŸºæœ¬è¯­æ³•</li>
<li><input disabled="" type="checkbox"/>
èƒ½å¤Ÿåˆ›å»ºå’Œç®¡ç†è¡¨(å†…éƒ¨è¡¨ã€å¤–éƒ¨è¡¨ã€åˆ†åŒºè¡¨)</li>
</ul>
<h3 id="-è¿›é˜¶èƒ½åŠ›éªŒè¯"><a class="header" href="#-è¿›é˜¶èƒ½åŠ›éªŒè¯">âœ… è¿›é˜¶èƒ½åŠ›éªŒè¯</a></h3>
<ul>
<li><input disabled="" type="checkbox"/>
èƒ½å¤Ÿç¼–å†™å¤æ‚çš„HiveQLæŸ¥è¯¢</li>
<li><input disabled="" type="checkbox"/>
æŒæ¡çª—å£å‡½æ•°å’Œèšåˆåˆ†æ</li>
<li><input disabled="" type="checkbox"/>
èƒ½å¤Ÿè¿›è¡Œæ€§èƒ½è°ƒä¼˜</li>
<li><input disabled="" type="checkbox"/>
èƒ½å¤Ÿå¼€å‘UDF/UDAF/UDTF</li>
</ul>
<h3 id="-é«˜çº§èƒ½åŠ›éªŒè¯"><a class="header" href="#-é«˜çº§èƒ½åŠ›éªŒè¯">âœ… é«˜çº§èƒ½åŠ›éªŒè¯</a></h3>
<ul>
<li><input disabled="" type="checkbox"/>
èƒ½å¤Ÿè®¾è®¡é«˜æ•ˆçš„æ•°æ®ä»“åº“æ¨¡å‹</li>
<li><input disabled="" type="checkbox"/>
èƒ½å¤Ÿå¤„ç†æ•°æ®å€¾æ–œé—®é¢˜</li>
<li><input disabled="" type="checkbox"/>
èƒ½å¤Ÿè¿›è¡ŒHiveé›†ç¾¤è¿ç»´</li>
<li><input disabled="" type="checkbox"/>
å…·å¤‡ç”Ÿäº§ç¯å¢ƒæ•…éšœæ’æŸ¥èƒ½åŠ›</li>
</ul>
<h2 id="16-æ‰©å±•èµ„æº"><a class="header" href="#16-æ‰©å±•èµ„æº">16. æ‰©å±•èµ„æº</a></h2>
<h3 id="å®˜æ–¹èµ„æº"><a class="header" href="#å®˜æ–¹èµ„æº">å®˜æ–¹èµ„æº</a></h3>
<ul>
<li>å®˜ç½‘: https://hive.apache.org/</li>
<li>æ–‡æ¡£: https://cwiki.apache.org/confluence/display/Hive/</li>
<li>GitHub: https://github.com/apache/hive</li>
</ul>
<h3 id="å­¦ä¹ å»ºè®®"><a class="header" href="#å­¦ä¹ å»ºè®®">å­¦ä¹ å»ºè®®</a></h3>
<ol>
<li>ä»HiveåŸºç¡€æ¦‚å¿µå¼€å§‹å­¦ä¹ </li>
<li>æŒæ¡HiveQLè¯­æ³•å’Œå‡½æ•°</li>
<li>ç†è§£Hiveå­˜å‚¨å’Œæ‰§è¡Œå¼•æ“</li>
<li>å®è·µæ€§èƒ½ä¼˜åŒ–æŠ€å·§</li>
<li>å­¦ä¹ æ•°æ®ä»“åº“å»ºæ¨¡</li>
</ol>
<h3 id="è¿›é˜¶æ–¹å‘"><a class="header" href="#è¿›é˜¶æ–¹å‘">è¿›é˜¶æ–¹å‘</a></h3>
<ul>
<li>Hive on Tez/Sparkä¼˜åŒ–</li>
<li>Hive LLAPå®æ—¶æŸ¥è¯¢</li>
<li>Hive Metastore Federation</li>
<li>å®æ—¶æ•°ä»“æ¶æ„è®¾è®¡</li>
<li>æ•°æ®æ¹–æŠ€æœ¯(Iceberg/Hudi)</li>
</ul>
<h3 id="ç›¸å…³æŠ€æœ¯"><a class="header" href="#ç›¸å…³æŠ€æœ¯">ç›¸å…³æŠ€æœ¯</a></h3>
<ul>
<li>Impala: å®æ—¶æŸ¥è¯¢å¼•æ“</li>
<li>Presto/Trino: åˆ†å¸ƒå¼SQLå¼•æ“</li>
<li>Spark SQL: ç»Ÿä¸€SQLæ¥å£</li>
<li>ClickHouse: OLAPæ•°æ®åº“</li>
</ul>
<h3 id="æ¨èä¹¦ç±"><a class="header" href="#æ¨èä¹¦ç±">æ¨èä¹¦ç±</a></h3>
<ul>
<li>Programming Hive (O'Reilly)</li>
<li>Hadoopæƒå¨æŒ‡å—</li>
<li>æ•°æ®ä»“åº“å·¥å…·ç®±</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../ç¼–ç¨‹/bigdata/4-ClickHouse.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../ç¼–ç¨‹/bigdata/5-ElasticSearch.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../ç¼–ç¨‹/bigdata/4-ClickHouse.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../ç¼–ç¨‹/bigdata/5-ElasticSearch.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../theme/segmentit.umd.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../theme/searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../../theme/pagetoc.js"></script>



    </div>
    </body>
</html>

