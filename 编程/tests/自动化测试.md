# è‡ªåŠ¨åŒ–æµ‹è¯•å®Œæ•´å­¦ä¹ æŒ‡å—

> **å­¦ä¹ ç›®æ ‡å®šä½**: æœ¬ç¬”è®°é¢å‘0-5å¹´ç»éªŒçš„è½¯ä»¶æµ‹è¯•å·¥ç¨‹å¸ˆã€å¼€å‘å·¥ç¨‹å¸ˆä»¥åŠå¸Œæœ›è½¬å‹è‡ªåŠ¨åŒ–æµ‹è¯•çš„ä»ä¸šè€…
>
> **é¢„æœŸå­¦ä¹ æˆæœ**: é€šè¿‡æœ¬ç¬”è®°çš„å­¦ä¹ ï¼Œèƒ½å¤Ÿç‹¬ç«‹è®¾è®¡ã€å¼€å‘å’Œç»´æŠ¤è‡ªåŠ¨åŒ–æµ‹è¯•æ¡†æ¶ï¼ŒæŒæ¡ä¸»æµæµ‹è¯•å·¥å…·å’Œæœ€ä½³å®è·µ

---

## ğŸ“‹ ç›®å½•å¯¼èˆª

- [ç¬¬ä¸€ç« : è‡ªåŠ¨åŒ–æµ‹è¯•åŸºç¡€](#ç¬¬ä¸€ç« -è‡ªåŠ¨åŒ–æµ‹è¯•åŸºç¡€)
- [ç¬¬äºŒç« : Webè‡ªåŠ¨åŒ–æµ‹è¯•å®æˆ˜](#ç¬¬äºŒç« -webè‡ªåŠ¨åŒ–æµ‹è¯•å®æˆ˜)
- [ç¬¬ä¸‰ç« : APIè‡ªåŠ¨åŒ–æµ‹è¯•](#ç¬¬ä¸‰ç« -apiè‡ªåŠ¨åŒ–æµ‹è¯•)
- [ç¬¬å››ç« : ç§»åŠ¨ç«¯è‡ªåŠ¨åŒ–æµ‹è¯•](#ç¬¬å››ç« -ç§»åŠ¨ç«¯è‡ªåŠ¨åŒ–æµ‹è¯•)
- [ç¬¬äº”ç« : æµ‹è¯•æ¡†æ¶è®¾è®¡ä¸å®ç°](#ç¬¬äº”ç« -æµ‹è¯•æ¡†æ¶è®¾è®¡ä¸å®ç°)
- [ç¬¬å…­ç« : CI/CDé›†æˆ](#ç¬¬å…­ç« -cicdé›†æˆ)
- [ç¬¬ä¸ƒç« : æ€§èƒ½æµ‹è¯•è‡ªåŠ¨åŒ–](#ç¬¬ä¸ƒç« -æ€§èƒ½æµ‹è¯•è‡ªåŠ¨åŒ–)
- [ç¬¬å…«ç« : æµ‹è¯•æŠ¥å‘Šä¸ç›‘æ§](#ç¬¬å…«ç« -æµ‹è¯•æŠ¥å‘Šä¸ç›‘æ§)

---

## ç¬¬ä¸€ç« : è‡ªåŠ¨åŒ–æµ‹è¯•åŸºç¡€

### 1.1 è‡ªåŠ¨åŒ–æµ‹è¯•æ ¸å¿ƒæ¦‚å¿µ

#### 1.1.1 ä»€ä¹ˆæ˜¯è‡ªåŠ¨åŒ–æµ‹è¯•

è‡ªåŠ¨åŒ–æµ‹è¯•æ˜¯æŒ‡ä½¿ç”¨ä¸“é—¨çš„æµ‹è¯•å·¥å…·å’Œè„šæœ¬ï¼Œæ¨¡æ‹Ÿæ‰‹åŠ¨æµ‹è¯•è¿‡ç¨‹ï¼Œè‡ªåŠ¨æ‰§è¡Œæµ‹è¯•ç”¨ä¾‹å¹¶éªŒè¯æµ‹è¯•ç»“æœçš„è¿‡ç¨‹ã€‚

**æ ¸å¿ƒç‰¹å¾**:
- **å¯é‡å¤æ€§**: æµ‹è¯•ç”¨ä¾‹å¯ä»¥å¤šæ¬¡æ‰§è¡Œï¼Œç»“æœä¸€è‡´
- **é«˜æ•ˆæ€§**: èƒ½å¤Ÿå¿«é€Ÿæ‰§è¡Œå¤§é‡æµ‹è¯•ç”¨ä¾‹
- **å‡†ç¡®æ€§**: å‡å°‘äººä¸ºé”™è¯¯ï¼Œæé«˜æµ‹è¯•ç²¾åº¦
- **æŒç»­æ€§**: å¯é›†æˆåˆ°CI/CDæµç¨‹ä¸­æŒç»­æ‰§è¡Œ

#### 1.1.2 è‡ªåŠ¨åŒ–æµ‹è¯•çš„ä»·å€¼ä¸å±€é™

**âœ… ä¼˜åŠ¿**:
1. **æé«˜æµ‹è¯•æ•ˆç‡**: è‡ªåŠ¨åŒ–æµ‹è¯•å¯ä»¥åœ¨çŸ­æ—¶é—´å†…æ‰§è¡Œå¤§é‡æµ‹è¯•ç”¨ä¾‹
2. **é™ä½é•¿æœŸæˆæœ¬**: è™½ç„¶åˆæœŸæŠ•å…¥è¾ƒé«˜ï¼Œä½†é•¿æœŸæ¥çœ‹å¯ä»¥æ˜¾è‘—é™ä½æµ‹è¯•æˆæœ¬
3. **æé«˜æµ‹è¯•è¦†ç›–ç‡**: å¯ä»¥æ‰§è¡Œæ›´å¤šçš„æµ‹è¯•åœºæ™¯å’Œè¾¹ç•Œæ¡ä»¶
4. **æ”¯æŒæŒç»­é›†æˆ**: å¯ä»¥åœ¨ä»£ç æäº¤åè‡ªåŠ¨è§¦å‘æµ‹è¯•
5. **æé«˜äº§å“è´¨é‡**: åŠæ—©å‘ç°ç¼ºé™·ï¼Œå‡å°‘ç”Ÿäº§ç¯å¢ƒé—®é¢˜

**âŒ å±€é™æ€§**:
1. **åˆæœŸæŠ•å…¥é«˜**: éœ€è¦å­¦ä¹ æˆæœ¬ã€æ¡†æ¶æ­å»ºã€ç”¨ä¾‹ç¼–å†™
2. **ç»´æŠ¤æˆæœ¬**: UIå˜åŒ–ã€éœ€æ±‚å˜æ›´éœ€è¦åŒæ­¥æ›´æ–°æµ‹è¯•ç”¨ä¾‹
3. **ä¸é€‚åˆæ¢ç´¢æ€§æµ‹è¯•**: æ— æ³•æ›¿ä»£äººçš„åˆ›é€ æ€§æ€ç»´
4. **æ— æ³•æµ‹è¯•ç”¨æˆ·ä½“éªŒ**: æ— æ³•è¯„ä¼°ç•Œé¢ç¾è§‚åº¦ã€æ˜“ç”¨æ€§ç­‰ä¸»è§‚å› ç´ 
5. **å·¥å…·ä¾èµ–æ€§**: å—é™äºå·¥å…·çš„èƒ½åŠ›å’Œç¨³å®šæ€§

#### 1.1.3 è‡ªåŠ¨åŒ–æµ‹è¯•é€‚ç”¨åœºæ™¯

**ğŸ¯ é€‚åˆè‡ªåŠ¨åŒ–çš„åœºæ™¯**:
- å›å½’æµ‹è¯•ï¼ˆåŠŸèƒ½ç¨³å®šï¼Œé¢‘ç¹æ‰§è¡Œï¼‰
- å†’çƒŸæµ‹è¯•ï¼ˆæ ¸å¿ƒåŠŸèƒ½éªŒè¯ï¼‰
- æ•°æ®é©±åŠ¨æµ‹è¯•ï¼ˆç›¸åŒé€»è¾‘ï¼Œä¸åŒæ•°æ®ï¼‰
- æ€§èƒ½æµ‹è¯•å’Œå‹åŠ›æµ‹è¯•
- APIæ¥å£æµ‹è¯•
- è·¨å¹³å°å…¼å®¹æ€§æµ‹è¯•

**ğŸš« ä¸é€‚åˆè‡ªåŠ¨åŒ–çš„åœºæ™¯**:
- éœ€æ±‚é¢‘ç¹å˜åŠ¨çš„åŠŸèƒ½
- ä¸€æ¬¡æ€§æµ‹è¯•åœºæ™¯
- å¤æ‚çš„ç”¨æˆ·ä½“éªŒæµ‹è¯•
- éœ€è¦äººå·¥åˆ¤æ–­çš„åœºæ™¯
- æŠ•å…¥äº§å‡ºæ¯”è¿‡ä½çš„åœºæ™¯

#### 1.1.4 æµ‹è¯•é‡‘å­—å¡”ç†è®º

æµ‹è¯•é‡‘å­—å¡”ç”±Mike Cohnæå‡ºï¼Œæè¿°äº†ä¸åŒå±‚æ¬¡æµ‹è¯•çš„æ¯”ä¾‹å…³ç³»ï¼š

```
        /\
       /  \      E2E Tests (10%)
      /----\     UIè‡ªåŠ¨åŒ–æµ‹è¯•
     /------\
    /--------\   Integration Tests (20%)
   /----------\  é›†æˆæµ‹è¯•
  /------------\
 /--------------\ Unit Tests (70%)
/----------------\ å•å…ƒæµ‹è¯•
```

**å„å±‚æ¬¡æµ‹è¯•ç‰¹ç‚¹**:

| æµ‹è¯•å±‚æ¬¡ | æ¯”ä¾‹ | æ‰§è¡Œé€Ÿåº¦ | ç»´æŠ¤æˆæœ¬ | åé¦ˆé€Ÿåº¦ | è¦†ç›–èŒƒå›´ |
|---------|------|---------|---------|---------|---------|
| å•å…ƒæµ‹è¯• | 70% | æå¿« | ä½ | ç§’çº§ | ä»£ç çº§ |
| é›†æˆæµ‹è¯• | 20% | è¾ƒå¿« | ä¸­ | åˆ†é’Ÿçº§ | æ¨¡å—çº§ |
| E2Eæµ‹è¯• | 10% | è¾ƒæ…¢ | é«˜ | å°æ—¶çº§ | ä¸šåŠ¡çº§ |

**æœ€ä½³å®è·µå»ºè®®**:
1. ä¼˜å…ˆç¼–å†™å•å…ƒæµ‹è¯•ï¼Œç¡®ä¿ä»£ç è´¨é‡
2. é€‚é‡çš„é›†æˆæµ‹è¯•éªŒè¯æ¨¡å—åä½œ
3. å°‘é‡E2Eæµ‹è¯•è¦†ç›–å…³é”®ä¸šåŠ¡æµç¨‹
4. é¿å…"å€’ç½®é‡‘å­—å¡”"ï¼ˆè¿‡åº¦ä¾èµ–UIæµ‹è¯•ï¼‰

---

### 1.2 æµ‹è¯•ç±»å‹è¯¦è§£

#### 1.2.1 å•å…ƒæµ‹è¯• (Unit Testing)

**å®šä¹‰**: å¯¹è½¯ä»¶ä¸­æœ€å°å¯æµ‹è¯•å•å…ƒï¼ˆå‡½æ•°ã€æ–¹æ³•ã€ç±»ï¼‰è¿›è¡Œæ£€æŸ¥å’ŒéªŒè¯ã€‚

**ç‰¹ç‚¹**:
- æµ‹è¯•ç²’åº¦æœ€å°
- æ‰§è¡Œé€Ÿåº¦æœ€å¿«
- ç”±å¼€å‘äººå‘˜ç¼–å†™
- é«˜åº¦éš”ç¦»ï¼ˆä½¿ç”¨Mock/Stubï¼‰

**å®æˆ˜ç¤ºä¾‹ - Python pytest**:

```python
# calculator.py
class Calculator:
    def add(self, a, b):
        """åŠ æ³•è¿ç®—"""
        return a + b

    def divide(self, a, b):
        """é™¤æ³•è¿ç®—"""
        if b == 0:
            raise ValueError("é™¤æ•°ä¸èƒ½ä¸º0")
        return a / b

# test_calculator.py
import pytest
from calculator import Calculator

class TestCalculator:
    def setup_method(self):
        """æ¯ä¸ªæµ‹è¯•æ–¹æ³•æ‰§è¡Œå‰çš„å‡†å¤‡å·¥ä½œ"""
        self.calc = Calculator()

    def test_add_positive_numbers(self):
        """æµ‹è¯•æ­£æ•°ç›¸åŠ """
        result = self.calc.add(3, 5)
        assert result == 8

    def test_add_negative_numbers(self):
        """æµ‹è¯•è´Ÿæ•°ç›¸åŠ """
        result = self.calc.add(-3, -5)
        assert result == -8

    def test_divide_normal(self):
        """æµ‹è¯•æ­£å¸¸é™¤æ³•"""
        result = self.calc.divide(10, 2)
        assert result == 5.0

    def test_divide_by_zero(self):
        """æµ‹è¯•é™¤ä»¥é›¶å¼‚å¸¸"""
        with pytest.raises(ValueError, match="é™¤æ•°ä¸èƒ½ä¸º0"):
            self.calc.divide(10, 0)

    @pytest.mark.parametrize("a,b,expected", [
        (0, 0, 0),
        (1, 0, 1),
        (100, 200, 300),
        (-10, 10, 0)
    ])
    def test_add_multiple_cases(self, a, b, expected):
        """å‚æ•°åŒ–æµ‹è¯•å¤šä¸ªåœºæ™¯"""
        assert self.calc.add(a, b) == expected
```

**æ‰§è¡Œæµ‹è¯•**:
```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
pytest test_calculator.py -v

# è¿è¡Œç‰¹å®šæµ‹è¯•
pytest test_calculator.py::TestCalculator::test_add_positive_numbers

# ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
pytest --cov=calculator --cov-report=html
```

#### 1.2.2 é›†æˆæµ‹è¯• (Integration Testing)

**å®šä¹‰**: æµ‹è¯•å¤šä¸ªæ¨¡å—æˆ–ç»„ä»¶ä¹‹é—´çš„äº¤äº’å’Œåä½œã€‚

**å®æˆ˜ç¤ºä¾‹ - æ•°æ®åº“é›†æˆæµ‹è¯•**:

```python
# models.py
from sqlalchemy import Column, Integer, String, create_engine
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy.orm import sessionmaker

Base = declarative_base()

class User(Base):
    __tablename__ = 'users'
    id = Column(Integer, primary_key=True)
    username = Column(String(50), unique=True, nullable=False)
    email = Column(String(100), nullable=False)

class UserRepository:
    def __init__(self, session):
        self.session = session

    def create_user(self, username, email):
        user = User(username=username, email=email)
        self.session.add(user)
        self.session.commit()
        return user

    def get_user_by_username(self, username):
        return self.session.query(User).filter_by(username=username).first()

# test_integration.py
import pytest
from sqlalchemy import create_engine
from sqlalchemy.orm import sessionmaker
from models import Base, User, UserRepository

@pytest.fixture(scope='function')
def db_session():
    """åˆ›å»ºæµ‹è¯•æ•°æ®åº“ä¼šè¯"""
    engine = create_engine('sqlite:///:memory:')  # ä½¿ç”¨å†…å­˜æ•°æ®åº“
    Base.metadata.create_all(engine)
    Session = sessionmaker(bind=engine)
    session = Session()

    yield session

    session.close()

class TestUserRepository:
    def test_create_and_retrieve_user(self, db_session):
        """æµ‹è¯•ç”¨æˆ·åˆ›å»ºå’ŒæŸ¥è¯¢"""
        repo = UserRepository(db_session)

        # åˆ›å»ºç”¨æˆ·
        user = repo.create_user("testuser", "test@example.com")
        assert user.id is not None
        assert user.username == "testuser"

        # æŸ¥è¯¢ç”¨æˆ·
        retrieved_user = repo.get_user_by_username("testuser")
        assert retrieved_user is not None
        assert retrieved_user.email == "test@example.com"

    def test_duplicate_username(self, db_session):
        """æµ‹è¯•é‡å¤ç”¨æˆ·å"""
        repo = UserRepository(db_session)
        repo.create_user("testuser", "test1@example.com")

        with pytest.raises(Exception):  # ä¼šè§¦å‘æ•°æ®åº“å”¯ä¸€çº¦æŸå¼‚å¸¸
            repo.create_user("testuser", "test2@example.com")
```

#### 1.2.3 ç«¯åˆ°ç«¯æµ‹è¯• (E2E Testing)

**å®šä¹‰**: ä»ç”¨æˆ·è§†è§’æµ‹è¯•å®Œæ•´çš„ä¸šåŠ¡æµç¨‹ï¼ŒéªŒè¯ç³»ç»Ÿå„ç»„ä»¶çš„ååŒå·¥ä½œã€‚

**å®æˆ˜ç¤ºä¾‹å°†åœ¨Webè‡ªåŠ¨åŒ–æµ‹è¯•ç« èŠ‚è¯¦ç»†è®²è§£**

---

### 1.3 è‡ªåŠ¨åŒ–æµ‹è¯•å­¦ä¹ è·¯å¾„

```mermaid
graph TD
    A[è‡ªåŠ¨åŒ–æµ‹è¯•åŸºç¡€] --> B[ç¼–ç¨‹åŸºç¡€]
    B --> C[é€‰æ‹©æµ‹è¯•é¢†åŸŸ]
    C --> D[Webè‡ªåŠ¨åŒ–]
    C --> E[APIè‡ªåŠ¨åŒ–]
    C --> F[ç§»åŠ¨ç«¯è‡ªåŠ¨åŒ–]
    D --> G[æ¡†æ¶è®¾è®¡]
    E --> G
    F --> G
    G --> H[CI/CDé›†æˆ]
    H --> I[è¿›é˜¶ä¸»é¢˜]
    I --> J[å®é™…é¡¹ç›®åº”ç”¨]
```

**æ¨èå­¦ä¹ æ—¶é—´çº¿**:
- **ç¬¬1-2å‘¨**: è‡ªåŠ¨åŒ–æµ‹è¯•åŸºç¡€ç†è®º + ç¼–ç¨‹è¯­è¨€åŸºç¡€ï¼ˆPython/Javaï¼‰
- **ç¬¬3-6å‘¨**: é€‰æ‹©ä¸€ä¸ªé¢†åŸŸæ·±å…¥å­¦ä¹ ï¼ˆWeb/API/ç§»åŠ¨ç«¯ï¼‰
- **ç¬¬7-8å‘¨**: å­¦ä¹ æµ‹è¯•æ¡†æ¶å’Œè®¾è®¡æ¨¡å¼ï¼ˆPOMã€æ•°æ®é©±åŠ¨ç­‰ï¼‰
- **ç¬¬9-10å‘¨**: CI/CDé›†æˆå’ŒæŒç»­æµ‹è¯•
- **ç¬¬11-12å‘¨**: å®é™…é¡¹ç›®å®è·µå’Œé—®é¢˜è§£å†³

---

## ç¬¬äºŒç« : Webè‡ªåŠ¨åŒ–æµ‹è¯•å®æˆ˜

### 2.1 Selenium WebDriver æ ¸å¿ƒæŠ€æœ¯

#### 2.1.1 Seleniumç®€ä»‹

Seleniumæ˜¯Webè‡ªåŠ¨åŒ–æµ‹è¯•çš„äº‹å®æ ‡å‡†ï¼Œæ”¯æŒå¤šç§æµè§ˆå™¨å’Œç¼–ç¨‹è¯­è¨€ã€‚

**æ ¸å¿ƒç»„ä»¶**:
- **Selenium WebDriver**: æµè§ˆå™¨è‡ªåŠ¨åŒ–API
- **Selenium Grid**: åˆ†å¸ƒå¼æµ‹è¯•æ‰§è¡Œ
- **Selenium IDE**: å½•åˆ¶å›æ”¾å·¥å…·

**æ”¯æŒçš„æµè§ˆå™¨**:
- Chrome/Chromium (ChromeDriver)
- Firefox (GeckoDriver)
- Safari (SafariDriver)
- Edge (EdgeDriver)

#### 2.1.2 ç¯å¢ƒæ­å»º

**Python + Seleniumå®‰è£…**:

```bash
# å®‰è£…Selenium
pip install selenium

# å®‰è£…WebDriverç®¡ç†å·¥å…·
pip install webdriver-manager

# å®‰è£…æµ‹è¯•æ¡†æ¶
pip install pytest pytest-html
```

**ç¤ºä¾‹ä»£ç  - åŸºç¡€ä½¿ç”¨**:

```python
from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
from webdriver_manager.chrome import ChromeDriverManager
from selenium.webdriver.chrome.service import Service

# è‡ªåŠ¨ç®¡ç†ChromeDriver
service = Service(ChromeDriverManager().install())
driver = webdriver.Chrome(service=service)

try:
    # æ‰“å¼€ç½‘é¡µ
    driver.get("https://www.example.com")

    # æœ€å¤§åŒ–çª—å£
    driver.maximize_window()

    # æŸ¥æ‰¾å…ƒç´ å¹¶ç‚¹å‡»
    element = driver.find_element(By.ID, "submit-button")
    element.click()

    # ç­‰å¾…å…ƒç´ å‡ºç°
    wait = WebDriverWait(driver, 10)
    result = wait.until(
        EC.presence_of_element_located((By.CLASS_NAME, "result"))
    )

    print(f"ç»“æœ: {result.text}")

finally:
    driver.quit()
```

#### 2.1.3 å…ƒç´ å®šä½ç­–ç•¥

**8ç§å®šä½æ–¹å¼**:

```python
from selenium.webdriver.common.by import By

# 1. IDå®šä½ï¼ˆæœ€æ¨èï¼Œå”¯ä¸€ä¸”ç¨³å®šï¼‰
element = driver.find_element(By.ID, "username")

# 2. Nameå®šä½
element = driver.find_element(By.NAME, "email")

# 3. Class Nameå®šä½
element = driver.find_element(By.CLASS_NAME, "btn-primary")

# 4. Tag Nameå®šä½
element = driver.find_element(By.TAG_NAME, "button")

# 5. Link Textå®šä½ï¼ˆå®Œæ•´æ–‡æœ¬ï¼‰
element = driver.find_element(By.LINK_TEXT, "ç™»å½•")

# 6. Partial Link Textå®šä½ï¼ˆéƒ¨åˆ†æ–‡æœ¬ï¼‰
element = driver.find_element(By.PARTIAL_LINK_TEXT, "ç™»")

# 7. CSS Selectorå®šä½ï¼ˆæ¨èï¼Œçµæ´»å¼ºå¤§ï¼‰
element = driver.find_element(By.CSS_SELECTOR, "div.container > input[type='text']")

# 8. XPathå®šä½ï¼ˆæœ€çµæ´»ï¼Œä½†æ€§èƒ½è¾ƒå·®ï¼‰
element = driver.find_element(By.XPATH, "//input[@id='username']")
```

**å®šä½å™¨é€‰æ‹©ä¼˜å…ˆçº§**:
1. **ID** > **Name** > **CSS Selector** > **XPath**
2. ä¼˜å…ˆé€‰æ‹©ç¨³å®šçš„å±æ€§ï¼ˆé¿å…åŠ¨æ€ç”Ÿæˆçš„IDï¼‰
3. é¿å…ä½¿ç”¨ç»å¯¹è·¯å¾„XPath

**CSS Selectorå®ç”¨æŠ€å·§**:

```python
# å±æ€§é€‰æ‹©å™¨
driver.find_element(By.CSS_SELECTOR, "input[name='username']")

# ç±»é€‰æ‹©å™¨ç»„åˆ
driver.find_element(By.CSS_SELECTOR, ".form-control.input-lg")

# å­å…ƒç´ é€‰æ‹©
driver.find_element(By.CSS_SELECTOR, "div.header > nav > a")

# ç¬¬nä¸ªå­å…ƒç´ 
driver.find_element(By.CSS_SELECTOR, "ul > li:nth-child(2)")

# å±æ€§åŒ…å«
driver.find_element(By.CSS_SELECTOR, "a[href*='login']")

# å±æ€§å¼€å¤´
driver.find_element(By.CSS_SELECTOR, "img[src^='https://']")

# å±æ€§ç»“å°¾
driver.find_element(By.CSS_SELECTOR, "a[href$='.pdf']")
```

#### 2.1.4 å¸¸è§æ“ä½œ

**è¾“å…¥å’Œç‚¹å‡»**:

```python
from selenium.webdriver.common.keys import Keys

# è¾“å…¥æ–‡æœ¬
input_field = driver.find_element(By.ID, "search")
input_field.send_keys("è‡ªåŠ¨åŒ–æµ‹è¯•")

# æ¸…ç©ºè¾“å…¥æ¡†
input_field.clear()

# æ¨¡æ‹Ÿé”®ç›˜æ“ä½œ
input_field.send_keys("Selenium")
input_field.send_keys(Keys.ENTER)

# ç‚¹å‡»æŒ‰é’®
button = driver.find_element(By.ID, "submit")
button.click()

# åŒå‡»
from selenium.webdriver.common.action_chains import ActionChains
actions = ActionChains(driver)
actions.double_click(button).perform()

# å³é”®ç‚¹å‡»
actions.context_click(button).perform()
```

**ä¸‹æ‹‰æ¡†æ“ä½œ**:

```python
from selenium.webdriver.support.ui import Select

# å®šä½ä¸‹æ‹‰æ¡†
select_element = driver.find_element(By.ID, "country")
select = Select(select_element)

# é€šè¿‡å¯è§æ–‡æœ¬é€‰æ‹©
select.select_by_visible_text("ä¸­å›½")

# é€šè¿‡å€¼é€‰æ‹©
select.select_by_value("cn")

# é€šè¿‡ç´¢å¼•é€‰æ‹©
select.select_by_index(1)

# è·å–æ‰€æœ‰é€‰é¡¹
all_options = select.options
for option in all_options:
    print(option.text)

# è·å–å½“å‰é€‰ä¸­çš„é€‰é¡¹
selected_option = select.first_selected_option
print(selected_option.text)
```

**å¤šçª—å£/æ ‡ç­¾é¡µå¤„ç†**:

```python
# è·å–å½“å‰çª—å£å¥æŸ„
main_window = driver.current_window_handle

# ç‚¹å‡»æ‰“å¼€æ–°çª—å£çš„é“¾æ¥
driver.find_element(By.LINK_TEXT, "æ‰“å¼€æ–°çª—å£").click()

# è·å–æ‰€æœ‰çª—å£å¥æŸ„
all_windows = driver.window_handles

# åˆ‡æ¢åˆ°æ–°çª—å£
for window in all_windows:
    if window != main_window:
        driver.switch_to.window(window)
        break

# åœ¨æ–°çª—å£ä¸­æ“ä½œ
print(driver.title)

# å…³é—­å½“å‰çª—å£
driver.close()

# åˆ‡æ¢å›ä¸»çª—å£
driver.switch_to.window(main_window)
```

**iframeå¤„ç†**:

```python
# åˆ‡æ¢åˆ°iframeï¼ˆé€šè¿‡ç´¢å¼•ï¼‰
driver.switch_to.frame(0)

# åˆ‡æ¢åˆ°iframeï¼ˆé€šè¿‡nameæˆ–idï¼‰
driver.switch_to.frame("iframe_name")

# åˆ‡æ¢åˆ°iframeï¼ˆé€šè¿‡WebElementï¼‰
iframe_element = driver.find_element(By.TAG_NAME, "iframe")
driver.switch_to.frame(iframe_element)

# åœ¨iframeä¸­æ“ä½œ
driver.find_element(By.ID, "button_in_iframe").click()

# åˆ‡æ¢å›ä¸»æ–‡æ¡£
driver.switch_to.default_content()
```

**å¼¹çª—å¤„ç†**:

```python
from selenium.webdriver.common.alert import Alert

# ç‚¹å‡»è§¦å‘å¼¹çª—çš„æŒ‰é’®
driver.find_element(By.ID, "alert-button").click()

# åˆ‡æ¢åˆ°å¼¹çª—
alert = Alert(driver)

# è·å–å¼¹çª—æ–‡æœ¬
print(alert.text)

# æ¥å—å¼¹çª—ï¼ˆç‚¹å‡»ç¡®å®šï¼‰
alert.accept()

# æ‹’ç»å¼¹çª—ï¼ˆç‚¹å‡»å–æ¶ˆï¼‰
# alert.dismiss()

# è¾“å…¥æ–‡æœ¬åˆ°promptå¼¹çª—
# alert.send_keys("è¾“å…¥çš„æ–‡æœ¬")
# alert.accept()
```

#### 2.1.5 ç­‰å¾…æœºåˆ¶

**ä¸‰ç§ç­‰å¾…æ–¹å¼å¯¹æ¯”**:

| ç­‰å¾…ç±»å‹ | ä¼˜ç‚¹ | ç¼ºç‚¹ | ä½¿ç”¨åœºæ™¯ |
|---------|------|------|---------|
| å¼ºåˆ¶ç­‰å¾… | ç®€å• | æµªè´¹æ—¶é—´ï¼Œä¸æ™ºèƒ½ | ä¸æ¨èä½¿ç”¨ |
| éšå¼ç­‰å¾… | å…¨å±€ç”Ÿæ•ˆ | ä¸å¤Ÿçµæ´» | ç®€å•åœºæ™¯ |
| æ˜¾å¼ç­‰å¾… | çµæ´»ï¼Œæ™ºèƒ½ | ä»£ç ç¨å¤æ‚ | æ¨èä½¿ç”¨ |

**å®æˆ˜ä»£ç **:

```python
import time
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
from selenium.webdriver.common.by import By

# 1. å¼ºåˆ¶ç­‰å¾…ï¼ˆä¸æ¨èï¼‰
time.sleep(5)  # æ— è®ºå…ƒç´ æ˜¯å¦åŠ è½½å®Œæˆéƒ½ç­‰å¾…5ç§’

# 2. éšå¼ç­‰å¾…ï¼ˆå…¨å±€è®¾ç½®ï¼‰
driver.implicitly_wait(10)  # æœ€å¤šç­‰å¾…10ç§’ï¼Œæ‰¾åˆ°å…ƒç´ ç«‹å³è¿”å›

# 3. æ˜¾å¼ç­‰å¾…ï¼ˆæ¨èï¼‰
wait = WebDriverWait(driver, 10, poll_frequency=0.5)

# ç­‰å¾…å…ƒç´ å¯è§
element = wait.until(
    EC.visibility_of_element_located((By.ID, "result"))
)

# ç­‰å¾…å…ƒç´ å¯ç‚¹å‡»
element = wait.until(
    EC.element_to_be_clickable((By.ID, "submit"))
)

# ç­‰å¾…å…ƒç´ å‡ºç°
element = wait.until(
    EC.presence_of_element_located((By.CLASS_NAME, "content"))
)

# ç­‰å¾…æ–‡æœ¬å‡ºç°
wait.until(
    EC.text_to_be_present_in_element((By.ID, "status"), "æˆåŠŸ")
)

# ç­‰å¾…URLåŒ…å«ç‰¹å®šæ–‡æœ¬
wait.until(EC.url_contains("dashboard"))

# ç­‰å¾…æ ‡é¢˜åŒ…å«ç‰¹å®šæ–‡æœ¬
wait.until(EC.title_contains("é¦–é¡µ"))

# è‡ªå®šä¹‰ç­‰å¾…æ¡ä»¶
def element_has_text(locator, text):
    def _predicate(driver):
        element = driver.find_element(*locator)
        return text in element.text
    return _predicate

wait.until(element_has_text((By.ID, "message"), "æ¬¢è¿"))
```

#### 2.1.6 å®Œæ•´å®æˆ˜æ¡ˆä¾‹ - ç™»å½•æµ‹è¯•

```python
import pytest
from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
from webdriver_manager.chrome import ChromeDriverManager
from selenium.webdriver.chrome.service import Service

class TestLogin:
    @pytest.fixture(scope="function")
    def driver(self):
        """ä¸ºæ¯ä¸ªæµ‹è¯•æ–¹æ³•åˆ›å»ºç‹¬ç«‹çš„æµè§ˆå™¨å®ä¾‹"""
        service = Service(ChromeDriverManager().install())
        driver = webdriver.Chrome(service=service)
        driver.maximize_window()
        driver.implicitly_wait(10)

        yield driver

        driver.quit()

    def test_login_success(self, driver):
        """æµ‹è¯•æˆåŠŸç™»å½•"""
        # æ‰“å¼€ç™»å½•é¡µé¢
        driver.get("https://example.com/login")

        # è¾“å…¥ç”¨æˆ·å
        username_input = driver.find_element(By.ID, "username")
        username_input.send_keys("testuser")

        # è¾“å…¥å¯†ç 
        password_input = driver.find_element(By.ID, "password")
        password_input.send_keys("Test@123")

        # ç‚¹å‡»ç™»å½•æŒ‰é’®
        login_button = driver.find_element(By.ID, "login-btn")
        login_button.click()

        # éªŒè¯ç™»å½•æˆåŠŸ
        wait = WebDriverWait(driver, 10)
        welcome_msg = wait.until(
            EC.visibility_of_element_located((By.CLASS_NAME, "welcome"))
        )

        assert "æ¬¢è¿" in welcome_msg.text
        assert "dashboard" in driver.current_url

    def test_login_with_wrong_password(self, driver):
        """æµ‹è¯•é”™è¯¯å¯†ç ç™»å½•"""
        driver.get("https://example.com/login")

        driver.find_element(By.ID, "username").send_keys("testuser")
        driver.find_element(By.ID, "password").send_keys("wrongpassword")
        driver.find_element(By.ID, "login-btn").click()

        # éªŒè¯é”™è¯¯æç¤º
        wait = WebDriverWait(driver, 10)
        error_msg = wait.until(
            EC.visibility_of_element_located((By.CLASS_NAME, "error-message"))
        )

        assert "ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯" in error_msg.text

    def test_login_with_empty_username(self, driver):
        """æµ‹è¯•ç©ºç”¨æˆ·åç™»å½•"""
        driver.get("https://example.com/login")

        driver.find_element(By.ID, "password").send_keys("Test@123")
        driver.find_element(By.ID, "login-btn").click()

        # éªŒè¯HTML5éªŒè¯æç¤º
        username_input = driver.find_element(By.ID, "username")
        validation_message = username_input.get_attribute("validationMessage")

        assert "è¯·å¡«å†™æ­¤å­—æ®µ" in validation_message

    @pytest.mark.parametrize("username,password,expected_error", [
        ("", "Test@123", "è¯·è¾“å…¥ç”¨æˆ·å"),
        ("testuser", "", "è¯·è¾“å…¥å¯†ç "),
        ("short", "123", "ç”¨æˆ·åè‡³å°‘6ä¸ªå­—ç¬¦"),
        ("testuser", "weak", "å¯†ç å¼ºåº¦ä¸è¶³"),
    ])
    def test_login_validation(self, driver, username, password, expected_error):
        """å‚æ•°åŒ–æµ‹è¯•ç™»å½•éªŒè¯"""
        driver.get("https://example.com/login")

        if username:
            driver.find_element(By.ID, "username").send_keys(username)
        if password:
            driver.find_element(By.ID, "password").send_keys(password)

        driver.find_element(By.ID, "login-btn").click()

        wait = WebDriverWait(driver, 5)
        error_element = wait.until(
            EC.presence_of_element_located((By.CLASS_NAME, "validation-error"))
        )

        assert expected_error in error_element.text
```

**æ‰§è¡Œæµ‹è¯•**:

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
pytest test_login.py -v

# ç”ŸæˆHTMLæŠ¥å‘Š
pytest test_login.py --html=report.html --self-contained-html

# å¹¶è¡Œæ‰§è¡Œï¼ˆå®‰è£…pytest-xdistï¼‰
pytest test_login.py -n 4
```

---

### 2.2 Playwright - ç°ä»£åŒ–æµ‹è¯•æ¡†æ¶

#### 2.2.1 Playwrightä¼˜åŠ¿

ç›¸æ¯”Seleniumï¼ŒPlaywrightå…·æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š
- **æ›´å¿«çš„æ‰§è¡Œé€Ÿåº¦**: åŸç”Ÿæ”¯æŒæµè§ˆå™¨åè®®
- **è‡ªåŠ¨ç­‰å¾…**: å†…ç½®æ™ºèƒ½ç­‰å¾…æœºåˆ¶
- **æ›´å¥½çš„ç¨³å®šæ€§**: å‡å°‘flakyæµ‹è¯•
- **å¤šæµè§ˆå™¨æ”¯æŒ**: Chromeã€Firefoxã€Safariã€Edge
- **ç§»åŠ¨ç«¯ä»¿çœŸ**: æ”¯æŒç§»åŠ¨è®¾å¤‡æ¨¡æ‹Ÿ
- **ç½‘ç»œæ‹¦æˆª**: å¯ä»¥æ‹¦æˆªå’Œä¿®æ”¹ç½‘ç»œè¯·æ±‚

#### 2.2.2 å¿«é€Ÿå¼€å§‹

**å®‰è£…**:

```bash
pip install playwright pytest-playwright

# å®‰è£…æµè§ˆå™¨
playwright install
```

**åŸºç¡€ç¤ºä¾‹**:

```python
from playwright.sync_api import sync_playwright, expect

def test_basic_navigation():
    with sync_playwright() as p:
        # å¯åŠ¨æµè§ˆå™¨
        browser = p.chromium.launch(headless=False)

        # åˆ›å»ºä¸Šä¸‹æ–‡
        context = browser.new_context()

        # åˆ›å»ºé¡µé¢
        page = context.new_page()

        # å¯¼èˆª
        page.goto("https://www.example.com")

        # ç‚¹å‡»å…ƒç´ 
        page.click("text=More information")

        # æ–­è¨€
        expect(page).to_have_url("https://www.iana.org/domains/reserved")

        # å…³é—­
        browser.close()
```

#### 2.2.3 Playwright pytestæ’ä»¶

```python
import pytest
from playwright.sync_api import Page, expect

def test_homepage_title(page: Page):
    """æµ‹è¯•é¦–é¡µæ ‡é¢˜"""
    page.goto("https://example.com")
    expect(page).to_have_title("Example Domain")

def test_search_functionality(page: Page):
    """æµ‹è¯•æœç´¢åŠŸèƒ½"""
    page.goto("https://example.com/search")

    # è¾“å…¥æœç´¢å…³é”®è¯
    page.fill("input[name='q']", "playwright")

    # ç‚¹å‡»æœç´¢æŒ‰é’®
    page.click("button[type='submit']")

    # ç­‰å¾…ç»“æœåŠ è½½
    page.wait_for_selector(".search-results")

    # éªŒè¯ç»“æœ
    results = page.locator(".search-result")
    expect(results).to_have_count(10)

def test_login_flow(page: Page):
    """æµ‹è¯•ç™»å½•æµç¨‹"""
    page.goto("https://example.com/login")

    # å¡«å†™è¡¨å•
    page.fill("#username", "testuser")
    page.fill("#password", "Test@123")

    # æäº¤è¡¨å•
    page.click("#login-button")

    # éªŒè¯é‡å®šå‘
    expect(page).to_have_url("https://example.com/dashboard")

    # éªŒè¯æ¬¢è¿æ¶ˆæ¯
    welcome = page.locator(".welcome-message")
    expect(welcome).to_contain_text("æ¬¢è¿, testuser")

@pytest.fixture(scope="session")
def browser_context_args(browser_context_args):
    """è‡ªå®šä¹‰æµè§ˆå™¨ä¸Šä¸‹æ–‡é…ç½®"""
    return {
        **browser_context_args,
        "viewport": {
            "width": 1920,
            "height": 1080,
        },
        "locale": "zh-CN",
        "timezone_id": "Asia/Shanghai",
    }
```

**é…ç½®æ–‡ä»¶ - pytest.ini**:

```ini
[pytest]
addopts =
    --browser chromium
    --headed
    --slowmo 500
    --screenshot only-on-failure
    --video retain-on-failure
```

#### 2.2.4 é«˜çº§åŠŸèƒ½

**ç½‘ç»œæ‹¦æˆª**:

```python
def test_api_mocking(page: Page):
    """æ¨¡æ‹ŸAPIå“åº”"""
    # æ‹¦æˆªAPIè¯·æ±‚
    def handle_route(route):
        # è¿”å›æ¨¡æ‹Ÿæ•°æ®
        route.fulfill(
            status=200,
            content_type="application/json",
            body='{"status": "success", "data": [{"id": 1, "name": "æµ‹è¯•æ•°æ®"}]}'
        )

    page.route("**/api/users", handle_route)

    # è®¿é—®é¡µé¢
    page.goto("https://example.com/users")

    # éªŒè¯æ¨¡æ‹Ÿæ•°æ®è¢«ä½¿ç”¨
    user_name = page.locator(".user-name").first
    expect(user_name).to_have_text("æµ‹è¯•æ•°æ®")

def test_network_monitoring(page: Page):
    """ç›‘æ§ç½‘ç»œè¯·æ±‚"""
    requests = []

    # ç›‘å¬è¯·æ±‚
    page.on("request", lambda request: requests.append(request.url))

    page.goto("https://example.com")

    # éªŒè¯ç‰¹å®šè¯·æ±‚è¢«å‘é€
    assert any("analytics" in url for url in requests)
```

**æ–‡ä»¶æ“ä½œ**:

```python
def test_file_upload(page: Page):
    """æµ‹è¯•æ–‡ä»¶ä¸Šä¼ """
    page.goto("https://example.com/upload")

    # é€‰æ‹©æ–‡ä»¶
    page.set_input_files("#file-upload", "test_data/sample.pdf")

    # ç‚¹å‡»ä¸Šä¼ 
    page.click("#upload-button")

    # éªŒè¯ä¸Šä¼ æˆåŠŸ
    success_msg = page.locator(".upload-success")
    expect(success_msg).to_be_visible()

def test_file_download(page: Page):
    """æµ‹è¯•æ–‡ä»¶ä¸‹è½½"""
    page.goto("https://example.com/downloads")

    # å¼€å§‹ç­‰å¾…ä¸‹è½½
    with page.expect_download() as download_info:
        page.click("text=ä¸‹è½½æŠ¥å‘Š")

    download = download_info.value

    # ä¿å­˜æ–‡ä»¶
    download.save_as("downloads/report.pdf")

    # éªŒè¯æ–‡ä»¶å
    assert download.suggested_filename == "report.pdf"
```

**ç§»åŠ¨ç«¯æµ‹è¯•**:

```python
import pytest
from playwright.sync_api import Page

@pytest.fixture
def mobile_context(playwright):
    """åˆ›å»ºç§»åŠ¨è®¾å¤‡ä¸Šä¸‹æ–‡"""
    iphone = playwright.devices["iPhone 12"]
    browser = playwright.chromium.launch()
    context = browser.new_context(**iphone)

    yield context

    context.close()
    browser.close()

def test_mobile_responsive(mobile_context):
    """æµ‹è¯•ç§»åŠ¨ç«¯å“åº”å¼"""
    page = mobile_context.new_page()
    page.goto("https://example.com")

    # éªŒè¯ç§»åŠ¨ç«¯ç‰¹å®šå…ƒç´ 
    mobile_menu = page.locator(".mobile-menu-icon")
    expect(mobile_menu).to_be_visible()

    # ç‚¹å‡»ç§»åŠ¨èœå•
    mobile_menu.click()

    # éªŒè¯èœå•å±•å¼€
    nav_menu = page.locator(".navigation-menu")
    expect(nav_menu).to_be_visible()
```

---

### 2.3 é¡µé¢å¯¹è±¡æ¨¡å¼ (POM)

#### 2.3.1 ä¸ºä»€ä¹ˆéœ€è¦POM

**é—®é¢˜**: ç›´æ¥åœ¨æµ‹è¯•ä¸­æ“ä½œå…ƒç´ å¯¼è‡´ï¼š
- ä»£ç é‡å¤
- ç»´æŠ¤å›°éš¾ï¼ˆUIå˜æ›´éœ€è¦ä¿®æ”¹å¤šå¤„ï¼‰
- å¯è¯»æ€§å·®

**è§£å†³æ–¹æ¡ˆ**: é¡µé¢å¯¹è±¡æ¨¡å¼
- å°†é¡µé¢å…ƒç´ å’Œæ“ä½œå°è£…åˆ°ç±»ä¸­
- æµ‹è¯•ä»£ç åªè°ƒç”¨é¡µé¢å¯¹è±¡çš„æ–¹æ³•
- UIå˜æ›´åªéœ€ä¿®æ”¹é¡µé¢å¯¹è±¡ç±»

#### 2.3.2 POMå®æˆ˜ç¤ºä¾‹

**ç›®å½•ç»“æ„**:

```
project/
â”œâ”€â”€ pages/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ base_page.py
â”‚   â”œâ”€â”€ login_page.py
â”‚   â””â”€â”€ dashboard_page.py
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ test_login.py
â”œâ”€â”€ utils/
â”‚   â””â”€â”€ config.py
â””â”€â”€ conftest.py
```

**åŸºç¡€é¡µé¢ç±»**:

```python
# pages/base_page.py
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC

class BasePage:
    """æ‰€æœ‰é¡µé¢å¯¹è±¡çš„åŸºç±»"""

    def __init__(self, driver):
        self.driver = driver
        self.wait = WebDriverWait(driver, 10)

    def find_element(self, locator):
        """æŸ¥æ‰¾å…ƒç´ """
        return self.wait.until(EC.presence_of_element_located(locator))

    def click(self, locator):
        """ç‚¹å‡»å…ƒç´ """
        element = self.wait.until(EC.element_to_be_clickable(locator))
        element.click()

    def input_text(self, locator, text):
        """è¾“å…¥æ–‡æœ¬"""
        element = self.find_element(locator)
        element.clear()
        element.send_keys(text)

    def get_text(self, locator):
        """è·å–æ–‡æœ¬"""
        element = self.find_element(locator)
        return element.text

    def is_element_visible(self, locator, timeout=10):
        """æ£€æŸ¥å…ƒç´ æ˜¯å¦å¯è§"""
        try:
            WebDriverWait(self.driver, timeout).until(
                EC.visibility_of_element_located(locator)
            )
            return True
        except:
            return False

    def wait_for_url_contains(self, text, timeout=10):
        """ç­‰å¾…URLåŒ…å«ç‰¹å®šæ–‡æœ¬"""
        WebDriverWait(self.driver, timeout).until(
            EC.url_contains(text)
        )
```

**ç™»å½•é¡µé¢å¯¹è±¡**:

```python
# pages/login_page.py
from selenium.webdriver.common.by import By
from pages.base_page import BasePage

class LoginPage(BasePage):
    """ç™»å½•é¡µé¢å¯¹è±¡"""

    # å®šä½å™¨
    USERNAME_INPUT = (By.ID, "username")
    PASSWORD_INPUT = (By.ID, "password")
    LOGIN_BUTTON = (By.ID, "login-btn")
    ERROR_MESSAGE = (By.CLASS_NAME, "error-message")
    REMEMBER_ME_CHECKBOX = (By.ID, "remember-me")

    def __init__(self, driver):
        super().__init__(driver)
        self.url = "https://example.com/login"

    def navigate(self):
        """å¯¼èˆªåˆ°ç™»å½•é¡µé¢"""
        self.driver.get(self.url)
        return self

    def enter_username(self, username):
        """è¾“å…¥ç”¨æˆ·å"""
        self.input_text(self.USERNAME_INPUT, username)
        return self

    def enter_password(self, password):
        """è¾“å…¥å¯†ç """
        self.input_text(self.PASSWORD_INPUT, password)
        return self

    def check_remember_me(self):
        """å‹¾é€‰è®°ä½æˆ‘"""
        self.click(self.REMEMBER_ME_CHECKBOX)
        return self

    def click_login(self):
        """ç‚¹å‡»ç™»å½•æŒ‰é’®"""
        self.click(self.LOGIN_BUTTON)

    def login(self, username, password, remember_me=False):
        """å®Œæ•´ç™»å½•æµç¨‹"""
        self.enter_username(username)
        self.enter_password(password)
        if remember_me:
            self.check_remember_me()
        self.click_login()

    def get_error_message(self):
        """è·å–é”™è¯¯æ¶ˆæ¯"""
        return self.get_text(self.ERROR_MESSAGE)

    def is_error_displayed(self):
        """æ£€æŸ¥é”™è¯¯æ¶ˆæ¯æ˜¯å¦æ˜¾ç¤º"""
        return self.is_element_visible(self.ERROR_MESSAGE)
```

**ä»ªè¡¨æ¿é¡µé¢å¯¹è±¡**:

```python
# pages/dashboard_page.py
from selenium.webdriver.common.by import By
from pages.base_page import BasePage

class DashboardPage(BasePage):
    """ä»ªè¡¨æ¿é¡µé¢å¯¹è±¡"""

    # å®šä½å™¨
    WELCOME_MESSAGE = (By.CLASS_NAME, "welcome")
    USER_MENU = (By.ID, "user-menu")
    LOGOUT_BUTTON = (By.ID, "logout")

    def __init__(self, driver):
        super().__init__(driver)
        self.url = "https://example.com/dashboard"

    def get_welcome_message(self):
        """è·å–æ¬¢è¿æ¶ˆæ¯"""
        return self.get_text(self.WELCOME_MESSAGE)

    def is_logged_in(self):
        """æ£€æŸ¥æ˜¯å¦å·²ç™»å½•"""
        return self.is_element_visible(self.USER_MENU)

    def logout(self):
        """é€€å‡ºç™»å½•"""
        self.click(self.USER_MENU)
        self.click(self.LOGOUT_BUTTON)
```

**æµ‹è¯•ç”¨ä¾‹**:

```python
# tests/test_login.py
import pytest
from pages.login_page import LoginPage
from pages.dashboard_page import DashboardPage

class TestLogin:

    def test_successful_login(self, driver):
        """æµ‹è¯•æˆåŠŸç™»å½•"""
        # åˆ›å»ºé¡µé¢å¯¹è±¡
        login_page = LoginPage(driver)
        dashboard_page = DashboardPage(driver)

        # æ‰§è¡Œç™»å½•
        login_page.navigate().login("testuser", "Test@123")

        # éªŒè¯ç™»å½•æˆåŠŸ
        assert dashboard_page.is_logged_in()
        assert "æ¬¢è¿" in dashboard_page.get_welcome_message()
        assert "dashboard" in driver.current_url

    def test_login_with_invalid_credentials(self, driver):
        """æµ‹è¯•æ— æ•ˆå‡­æ®ç™»å½•"""
        login_page = LoginPage(driver)

        login_page.navigate().login("invalid_user", "wrong_password")

        # éªŒè¯é”™è¯¯æ¶ˆæ¯
        assert login_page.is_error_displayed()
        assert "ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯" in login_page.get_error_message()

    def test_login_with_remember_me(self, driver):
        """æµ‹è¯•è®°ä½æˆ‘åŠŸèƒ½"""
        login_page = LoginPage(driver)
        dashboard_page = DashboardPage(driver)

        # ç™»å½•å¹¶å‹¾é€‰è®°ä½æˆ‘
        login_page.navigate().login("testuser", "Test@123", remember_me=True)

        # éªŒè¯ç™»å½•æˆåŠŸ
        assert dashboard_page.is_logged_in()

        # å…³é—­æµè§ˆå™¨å¹¶é‡æ–°æ‰“å¼€ï¼ˆå®é™…ä¸­éœ€è¦ä¿å­˜cookiesï¼‰
        # ... éªŒè¯ä»ç„¶ç™»å½•çŠ¶æ€
```

**conftest.pyé…ç½®**:

```python
# conftest.py
import pytest
from selenium import webdriver
from webdriver_manager.chrome import ChromeDriverManager
from selenium.webdriver.chrome.service import Service

@pytest.fixture(scope="function")
def driver():
    """ä¸ºæ¯ä¸ªæµ‹è¯•åˆ›å»ºdriver"""
    service = Service(ChromeDriverManager().install())
    driver = webdriver.Chrome(service=service)
    driver.maximize_window()
    driver.implicitly_wait(10)

    yield driver

    driver.quit()

@pytest.fixture(scope="session")
def test_config():
    """æµ‹è¯•é…ç½®"""
    return {
        "base_url": "https://example.com",
        "timeout": 10,
        "browser": "chrome"
    }
```

---

## ç¬¬ä¸‰ç« : APIè‡ªåŠ¨åŒ–æµ‹è¯•

### 3.1 APIæµ‹è¯•åŸºç¡€

#### 3.1.1 ä»€ä¹ˆæ˜¯APIæµ‹è¯•

APIï¼ˆApplication Programming Interfaceï¼‰æµ‹è¯•æ˜¯ç›´æ¥æµ‹è¯•åº”ç”¨ç¨‹åºæ¥å£çš„è¿‡ç¨‹ï¼Œä¸é€šè¿‡ç”¨æˆ·ç•Œé¢ã€‚

**ä¼˜åŠ¿**:
- **æ‰§è¡Œé€Ÿåº¦å¿«**: ä¸éœ€è¦æ¸²æŸ“UI
- **ç¨³å®šæ€§é«˜**: ä¸å—UIå˜åŒ–å½±å“
- **æ˜“äºç»´æŠ¤**: æ¥å£ç›¸å¯¹ç¨³å®š
- **æµ‹è¯•è¦†ç›–ç‡é«˜**: å¯ä»¥æµ‹è¯•å„ç§è¾¹ç•Œæ¡ä»¶

**å¸¸è§APIç±»å‹**:
- **RESTful API**: åŸºäºHTTPåè®®ï¼Œä½¿ç”¨JSON/XMLæ ¼å¼
- **GraphQL API**: çµæ´»çš„æŸ¥è¯¢è¯­è¨€
- **SOAP API**: åŸºäºXMLçš„åè®®
- **gRPC**: é«˜æ€§èƒ½RPCæ¡†æ¶

#### 3.1.2 HTTPæ–¹æ³•ä¸çŠ¶æ€ç 

**å¸¸ç”¨HTTPæ–¹æ³•**:

| æ–¹æ³• | ç”¨é€” | æ˜¯å¦å¹‚ç­‰ | ç¤ºä¾‹ |
|-----|------|---------|------|
| GET | è·å–èµ„æº | æ˜¯ | è·å–ç”¨æˆ·åˆ—è¡¨ |
| POST | åˆ›å»ºèµ„æº | å¦ | åˆ›å»ºæ–°ç”¨æˆ· |
| PUT | å®Œæ•´æ›´æ–°èµ„æº | æ˜¯ | æ›´æ–°ç”¨æˆ·ä¿¡æ¯ |
| PATCH | éƒ¨åˆ†æ›´æ–°èµ„æº | å¦ | æ›´æ–°ç”¨æˆ·å |
| DELETE | åˆ é™¤èµ„æº | æ˜¯ | åˆ é™¤ç”¨æˆ· |

**å¸¸è§HTTPçŠ¶æ€ç **:

| çŠ¶æ€ç  | å«ä¹‰ | è¯´æ˜ |
|-------|------|------|
| 200 | OK | è¯·æ±‚æˆåŠŸ |
| 201 | Created | èµ„æºåˆ›å»ºæˆåŠŸ |
| 204 | No Content | æˆåŠŸä½†æ— è¿”å›å†…å®¹ |
| 400 | Bad Request | è¯·æ±‚å‚æ•°é”™è¯¯ |
| 401 | Unauthorized | æœªæˆæƒ |
| 403 | Forbidden | æ— æƒé™ |
| 404 | Not Found | èµ„æºä¸å­˜åœ¨ |
| 500 | Internal Server Error | æœåŠ¡å™¨é”™è¯¯ |
| 503 | Service Unavailable | æœåŠ¡ä¸å¯ç”¨ |

---

### 3.2 Requestsåº“å®æˆ˜

#### 3.2.1 åŸºç¡€è¯·æ±‚

```python
import requests

# GETè¯·æ±‚
response = requests.get('https://api.example.com/users')
print(f"çŠ¶æ€ç : {response.status_code}")
print(f"å“åº”ä½“: {response.json()}")

# POSTè¯·æ±‚
data = {
    "username": "testuser",
    "email": "test@example.com"
}
response = requests.post('https://api.example.com/users', json=data)
print(f"åˆ›å»ºç»“æœ: {response.json()}")

# PUTè¯·æ±‚
update_data = {
    "email": "newemail@example.com"
}
response = requests.put('https://api.example.com/users/123', json=update_data)

# DELETEè¯·æ±‚
response = requests.delete('https://api.example.com/users/123')
print(f"åˆ é™¤çŠ¶æ€: {response.status_code}")
```

#### 3.2.2 è¯·æ±‚å‚æ•°

```python
# Queryå‚æ•°
params = {
    "page": 1,
    "limit": 10,
    "sort": "created_at"
}
response = requests.get('https://api.example.com/users', params=params)
# å®é™…è¯·æ±‚URL: https://api.example.com/users?page=1&limit=10&sort=created_at

# Headers
headers = {
    "Authorization": "Bearer token123",
    "Content-Type": "application/json",
    "User-Agent": "MyTestClient/1.0"
}
response = requests.get('https://api.example.com/users', headers=headers)

# Cookies
cookies = {"session_id": "abc123"}
response = requests.get('https://api.example.com/profile', cookies=cookies)

# è¶…æ—¶è®¾ç½®
try:
    response = requests.get('https://api.example.com/users', timeout=5)
except requests.Timeout:
    print("è¯·æ±‚è¶…æ—¶")
```

#### 3.2.3 å“åº”å¤„ç†

```python
response = requests.get('https://api.example.com/users')

# çŠ¶æ€ç æ£€æŸ¥
assert response.status_code == 200
response.raise_for_status()  # å¦‚æœçŠ¶æ€ç 4xxæˆ–5xxä¼šæŠ›å‡ºå¼‚å¸¸

# JSONå“åº”
data = response.json()
print(data['users'][0]['name'])

# æ–‡æœ¬å“åº”
html_content = response.text

# äºŒè¿›åˆ¶å“åº”
file_content = response.content

# å“åº”å¤´
print(response.headers['Content-Type'])
print(response.headers['Date'])

# Cookies
print(response.cookies['session_id'])

# å“åº”æ—¶é—´
print(f"å“åº”æ—¶é—´: {response.elapsed.total_seconds()}ç§’")
```

#### 3.2.4 å®Œæ•´æµ‹è¯•ç¤ºä¾‹

```python
# test_api_users.py
import pytest
import requests

BASE_URL = "https://jsonplaceholder.typicode.com"

class TestUserAPI:

    def test_get_all_users(self):
        """æµ‹è¯•è·å–æ‰€æœ‰ç”¨æˆ·"""
        response = requests.get(f"{BASE_URL}/users")

        # éªŒè¯çŠ¶æ€ç 
        assert response.status_code == 200

        # éªŒè¯å“åº”ç±»å‹
        assert response.headers['Content-Type'] == 'application/json; charset=utf-8'

        # éªŒè¯å“åº”æ•°æ®
        users = response.json()
        assert isinstance(users, list)
        assert len(users) == 10

        # éªŒè¯æ•°æ®ç»“æ„
        first_user = users[0]
        assert 'id' in first_user
        assert 'name' in first_user
        assert 'email' in first_user

    def test_get_single_user(self):
        """æµ‹è¯•è·å–å•ä¸ªç”¨æˆ·"""
        user_id = 1
        response = requests.get(f"{BASE_URL}/users/{user_id}")

        assert response.status_code == 200

        user = response.json()
        assert user['id'] == user_id
        assert user['name'] == "Leanne Graham"
        assert '@' in user['email']

    def test_get_nonexistent_user(self):
        """æµ‹è¯•è·å–ä¸å­˜åœ¨çš„ç”¨æˆ·"""
        response = requests.get(f"{BASE_URL}/users/999")
        assert response.status_code == 404

    def test_create_user(self):
        """æµ‹è¯•åˆ›å»ºç”¨æˆ·"""
        new_user = {
            "name": "Test User",
            "username": "testuser",
            "email": "test@example.com"
        }

        response = requests.post(f"{BASE_URL}/users", json=new_user)

        # éªŒè¯åˆ›å»ºæˆåŠŸ
        assert response.status_code == 201

        # éªŒè¯è¿”å›çš„ç”¨æˆ·æ•°æ®
        created_user = response.json()
        assert created_user['name'] == new_user['name']
        assert created_user['email'] == new_user['email']
        assert 'id' in created_user

    def test_update_user(self):
        """æµ‹è¯•æ›´æ–°ç”¨æˆ·"""
        user_id = 1
        update_data = {
            "name": "Updated Name",
            "email": "updated@example.com"
        }

        response = requests.put(f"{BASE_URL}/users/{user_id}", json=update_data)

        assert response.status_code == 200

        updated_user = response.json()
        assert updated_user['name'] == update_data['name']
        assert updated_user['email'] == update_data['email']

    def test_delete_user(self):
        """æµ‹è¯•åˆ é™¤ç”¨æˆ·"""
        user_id = 1
        response = requests.delete(f"{BASE_URL}/users/{user_id}")

        assert response.status_code == 200

    def test_response_time(self):
        """æµ‹è¯•å“åº”æ—¶é—´"""
        response = requests.get(f"{BASE_URL}/users")

        # éªŒè¯å“åº”æ—¶é—´å°äº2ç§’
        assert response.elapsed.total_seconds() < 2

    @pytest.mark.parametrize("user_id", [1, 2, 3, 4, 5])
    def test_multiple_users(self, user_id):
        """å‚æ•°åŒ–æµ‹è¯•å¤šä¸ªç”¨æˆ·"""
        response = requests.get(f"{BASE_URL}/users/{user_id}")

        assert response.status_code == 200
        user = response.json()
        assert user['id'] == user_id
```

---

### 3.3 pytestè¿›é˜¶æŠ€å·§

#### 3.3.1 Fixtureså¤ç”¨

```python
# conftest.py
import pytest
import requests

@pytest.fixture(scope="session")
def api_client():
    """åˆ›å»ºAPIå®¢æˆ·ç«¯"""
    class APIClient:
        def __init__(self, base_url):
            self.base_url = base_url
            self.session = requests.Session()

        def get(self, endpoint, **kwargs):
            return self.session.get(f"{self.base_url}{endpoint}", **kwargs)

        def post(self, endpoint, **kwargs):
            return self.session.post(f"{self.base_url}{endpoint}", **kwargs)

        def put(self, endpoint, **kwargs):
            return self.session.put(f"{self.base_url}{endpoint}", **kwargs)

        def delete(self, endpoint, **kwargs):
            return self.session.delete(f"{self.base_url}{endpoint}", **kwargs)

    client = APIClient("https://jsonplaceholder.typicode.com")
    yield client
    client.session.close()

@pytest.fixture
def auth_token():
    """è·å–è®¤è¯token"""
    # æ¨¡æ‹Ÿç™»å½•è·å–token
    response = requests.post("https://api.example.com/login", json={
        "username": "testuser",
        "password": "Test@123"
    })
    return response.json()['token']

@pytest.fixture
def auth_headers(auth_token):
    """ç”Ÿæˆè®¤è¯è¯·æ±‚å¤´"""
    return {
        "Authorization": f"Bearer {auth_token}",
        "Content-Type": "application/json"
    }

# æµ‹è¯•ä¸­ä½¿ç”¨
def test_with_auth(api_client, auth_headers):
    response = api_client.get("/protected-resource", headers=auth_headers)
    assert response.status_code == 200
```

#### 3.3.2 æ•°æ®é©±åŠ¨æµ‹è¯•

```python
import pytest
import json

# ä»JSONæ–‡ä»¶åŠ è½½æµ‹è¯•æ•°æ®
def load_test_data(filename):
    with open(filename, 'r', encoding='utf-8') as f:
        return json.load(f)

# test_data.json
"""
[
    {
        "name": "æœ‰æ•ˆç”¨æˆ·å",
        "input": {"username": "testuser", "email": "test@example.com"},
        "expected_status": 201
    },
    {
        "name": "æ— æ•ˆé‚®ç®±",
        "input": {"username": "testuser", "email": "invalid-email"},
        "expected_status": 400
    }
]
"""

@pytest.mark.parametrize(
    "test_case",
    load_test_data("test_data.json"),
    ids=lambda tc: tc['name']
)
def test_create_user_with_data_file(api_client, test_case):
    """ä½¿ç”¨å¤–éƒ¨æ•°æ®æ–‡ä»¶æµ‹è¯•"""
    response = api_client.post("/users", json=test_case['input'])
    assert response.status_code == test_case['expected_status']
```

#### 3.3.3 æµ‹è¯•æŠ¥å‘Šå¢å¼º

```python
import pytest
import allure

@allure.feature('ç”¨æˆ·ç®¡ç†')
@allure.story('ç”¨æˆ·åˆ›å»º')
@allure.severity(allure.severity_level.CRITICAL)
def test_create_user_with_allure(api_client):
    """æµ‹è¯•ç”¨æˆ·åˆ›å»º - å¸¦AllureæŠ¥å‘Š"""

    with allure.step("å‡†å¤‡æµ‹è¯•æ•°æ®"):
        user_data = {
            "name": "Test User",
            "email": "test@example.com"
        }
        allure.attach(
            json.dumps(user_data, indent=2),
            name="è¯·æ±‚æ•°æ®",
            attachment_type=allure.attachment_type.JSON
        )

    with allure.step("å‘é€åˆ›å»ºç”¨æˆ·è¯·æ±‚"):
        response = api_client.post("/users", json=user_data)

    with allure.step("éªŒè¯å“åº”"):
        assert response.status_code == 201
        allure.attach(
            response.text,
            name="å“åº”æ•°æ®",
            attachment_type=allure.attachment_type.JSON
        )

        created_user = response.json()
        assert created_user['name'] == user_data['name']
```

**ç”ŸæˆAllureæŠ¥å‘Š**:

```bash
# è¿è¡Œæµ‹è¯•å¹¶ç”Ÿæˆç»“æœ
pytest --alluredir=allure-results

# ç”Ÿæˆå¹¶æ‰“å¼€æŠ¥å‘Š
allure serve allure-results
```

---

### 3.4 APIæµ‹è¯•æ¡†æ¶è®¾è®¡

#### 3.4.1 å®Œæ•´æ¡†æ¶ç»“æ„

```
api_test_framework/
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ config.py
â”‚   â””â”€â”€ environments.json
â”œâ”€â”€ api/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ base_api.py
â”‚   â”œâ”€â”€ user_api.py
â”‚   â””â”€â”€ product_api.py
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ test_users.py
â”‚   â””â”€â”€ test_products.py
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ logger.py
â”‚   â”œâ”€â”€ data_generator.py
â”‚   â””â”€â”€ assertions.py
â”œâ”€â”€ test_data/
â”‚   â”œâ”€â”€ users.json
â”‚   â””â”€â”€ products.json
â”œâ”€â”€ conftest.py
â”œâ”€â”€ pytest.ini
â””â”€â”€ requirements.txt
```

#### 3.4.2 æ ¸å¿ƒä»£ç å®ç°

**config/config.py**:

```python
import json
import os

class Config:
    """é…ç½®ç®¡ç†ç±»"""

    def __init__(self, environment='test'):
        self.environment = environment
        self.load_config()

    def load_config(self):
        """åŠ è½½ç¯å¢ƒé…ç½®"""
        config_file = os.path.join(
            os.path.dirname(__file__),
            'environments.json'
        )

        with open(config_file, 'r') as f:
            configs = json.load(f)

        env_config = configs.get(self.environment, {})

        self.base_url = env_config.get('base_url')
        self.timeout = env_config.get('timeout', 30)
        self.retry_times = env_config.get('retry_times', 3)

    @staticmethod
    def get_instance(environment='test'):
        """è·å–é…ç½®å®ä¾‹"""
        return Config(environment)

# environments.json
"""
{
    "test": {
        "base_url": "https://test-api.example.com",
        "timeout": 30,
        "retry_times": 3
    },
    "staging": {
        "base_url": "https://staging-api.example.com",
        "timeout": 30,
        "retry_times": 3
    },
    "production": {
        "base_url": "https://api.example.com",
        "timeout": 60,
        "retry_times": 1
    }
}
"""
```

**api/base_api.py**:

```python
import requests
from typing import Dict, Any, Optional
import logging

logger = logging.getLogger(__name__)

class BaseAPI:
    """APIåŸºç±»"""

    def __init__(self, base_url: str, timeout: int = 30):
        self.base_url = base_url
        self.timeout = timeout
        self.session = requests.Session()

    def _request(
        self,
        method: str,
        endpoint: str,
        **kwargs
    ) -> requests.Response:
        """
        å‘é€HTTPè¯·æ±‚çš„é€šç”¨æ–¹æ³•

        Args:
            method: HTTPæ–¹æ³•
            endpoint: APIç«¯ç‚¹
            **kwargs: å…¶ä»–è¯·æ±‚å‚æ•°

        Returns:
            Responseå¯¹è±¡
        """
        url = f"{self.base_url}{endpoint}"

        # è®¾ç½®é»˜è®¤è¶…æ—¶
        if 'timeout' not in kwargs:
            kwargs['timeout'] = self.timeout

        logger.info(f"å‘é€{method}è¯·æ±‚: {url}")
        logger.debug(f"è¯·æ±‚å‚æ•°: {kwargs}")

        try:
            response = self.session.request(method, url, **kwargs)
            logger.info(f"å“åº”çŠ¶æ€ç : {response.status_code}")
            logger.debug(f"å“åº”å†…å®¹: {response.text}")
            return response
        except requests.RequestException as e:
            logger.error(f"è¯·æ±‚å¤±è´¥: {str(e)}")
            raise

    def get(self, endpoint: str, **kwargs) -> requests.Response:
        """GETè¯·æ±‚"""
        return self._request('GET', endpoint, **kwargs)

    def post(self, endpoint: str, **kwargs) -> requests.Response:
        """POSTè¯·æ±‚"""
        return self._request('POST', endpoint, **kwargs)

    def put(self, endpoint: str, **kwargs) -> requests.Response:
        """PUTè¯·æ±‚"""
        return self._request('PUT', endpoint, **kwargs)

    def patch(self, endpoint: str, **kwargs) -> requests.Response:
        """PATCHè¯·æ±‚"""
        return self._request('PATCH', endpoint, **kwargs)

    def delete(self, endpoint: str, **kwargs) -> requests.Response:
        """DELETEè¯·æ±‚"""
        return self._request('DELETE', endpoint, **kwargs)

    def set_auth_token(self, token: str):
        """è®¾ç½®è®¤è¯token"""
        self.session.headers.update({
            'Authorization': f'Bearer {token}'
        })

    def close(self):
        """å…³é—­session"""
        self.session.close()
```

**api/user_api.py**:

```python
from api.base_api import BaseAPI
from typing import Dict, List, Optional

class UserAPI(BaseAPI):
    """ç”¨æˆ·APIå°è£…"""

    def get_all_users(self, page: int = 1, limit: int = 10) -> Dict:
        """è·å–æ‰€æœ‰ç”¨æˆ·"""
        params = {'page': page, 'limit': limit}
        response = self.get('/users', params=params)
        return response.json()

    def get_user_by_id(self, user_id: int) -> Dict:
        """æ ¹æ®IDè·å–ç”¨æˆ·"""
        response = self.get(f'/users/{user_id}')
        return response.json()

    def create_user(self, user_data: Dict) -> Dict:
        """åˆ›å»ºç”¨æˆ·"""
        response = self.post('/users', json=user_data)
        response.raise_for_status()
        return response.json()

    def update_user(self, user_id: int, user_data: Dict) -> Dict:
        """æ›´æ–°ç”¨æˆ·"""
        response = self.put(f'/users/{user_id}', json=user_data)
        return response.json()

    def delete_user(self, user_id: int) -> bool:
        """åˆ é™¤ç”¨æˆ·"""
        response = self.delete(f'/users/{user_id}')
        return response.status_code == 200

    def search_users(self, keyword: str) -> List[Dict]:
        """æœç´¢ç”¨æˆ·"""
        params = {'q': keyword}
        response = self.get('/users/search', params=params)
        return response.json()
```

**utils/assertions.py**:

```python
from typing import Any, Dict
import jsonschema

class APIAssertions:
    """APIæ–­è¨€å·¥å…·"""

    @staticmethod
    def assert_status_code(response, expected_code: int):
        """æ–­è¨€çŠ¶æ€ç """
        actual_code = response.status_code
        assert actual_code == expected_code, \
            f"æœŸæœ›çŠ¶æ€ç {expected_code}, å®é™…ä¸º{actual_code}"

    @staticmethod
    def assert_response_time(response, max_time: float):
        """æ–­è¨€å“åº”æ—¶é—´"""
        actual_time = response.elapsed.total_seconds()
        assert actual_time < max_time, \
            f"å“åº”æ—¶é—´{actual_time}ç§’è¶…è¿‡é™åˆ¶{max_time}ç§’"

    @staticmethod
    def assert_json_schema(data: Dict, schema: Dict):
        """æ–­è¨€JSONæ ¼å¼"""
        try:
            jsonschema.validate(instance=data, schema=schema)
        except jsonschema.ValidationError as e:
            raise AssertionError(f"JSONæ ¼å¼ä¸åŒ¹é…: {e.message}")

    @staticmethod
    def assert_contains(data: Any, expected: Any):
        """æ–­è¨€åŒ…å«å…³ç³»"""
        assert expected in data, \
            f"{expected} ä¸åœ¨ {data} ä¸­"

    @staticmethod
    def assert_field_value(data: Dict, field: str, expected_value: Any):
        """æ–­è¨€å­—æ®µå€¼"""
        actual_value = data.get(field)
        assert actual_value == expected_value, \
            f"å­—æ®µ{field}æœŸæœ›å€¼{expected_value}, å®é™…ä¸º{actual_value}"

# JSON Schemaç¤ºä¾‹
USER_SCHEMA = {
    "type": "object",
    "properties": {
        "id": {"type": "integer"},
        "name": {"type": "string"},
        "email": {"type": "string", "format": "email"},
        "created_at": {"type": "string"}
    },
    "required": ["id", "name", "email"]
}
```

**æµ‹è¯•ç”¨ä¾‹**:

```python
# tests/test_users.py
import pytest
from api.user_api import UserAPI
from utils.assertions import APIAssertions, USER_SCHEMA

class TestUserAPI:

    @pytest.fixture(autouse=True)
    def setup(self, api_client):
        """æµ‹è¯•å‡†å¤‡"""
        self.user_api = api_client
        self.assertions = APIAssertions()

    def test_get_all_users_success(self):
        """æµ‹è¯•è·å–æ‰€æœ‰ç”¨æˆ·æˆåŠŸ"""
        # æ‰§è¡Œ
        users = self.user_api.get_all_users(page=1, limit=10)

        # æ–­è¨€
        assert isinstance(users, list)
        assert len(users) <= 10

        # éªŒè¯ç¬¬ä¸€ä¸ªç”¨æˆ·çš„ç»“æ„
        if users:
            self.assertions.assert_json_schema(users[0], USER_SCHEMA)

    def test_create_user_success(self, test_user_data):
        """æµ‹è¯•åˆ›å»ºç”¨æˆ·æˆåŠŸ"""
        # æ‰§è¡Œ
        created_user = self.user_api.create_user(test_user_data)

        # æ–­è¨€
        assert 'id' in created_user
        self.assertions.assert_field_value(
            created_user,
            'name',
            test_user_data['name']
        )

    def test_get_user_by_id_not_found(self):
        """æµ‹è¯•è·å–ä¸å­˜åœ¨çš„ç”¨æˆ·"""
        with pytest.raises(requests.HTTPError):
            self.user_api.get_user_by_id(999999)

    def test_update_user_success(self, existing_user_id):
        """æµ‹è¯•æ›´æ–°ç”¨æˆ·æˆåŠŸ"""
        update_data = {"name": "Updated Name"}

        updated_user = self.user_api.update_user(
            existing_user_id,
            update_data
        )

        self.assertions.assert_field_value(
            updated_user,
            'name',
            "Updated Name"
        )

# conftest.py
@pytest.fixture
def test_user_data():
    """æµ‹è¯•ç”¨æˆ·æ•°æ®"""
    return {
        "name": "Test User",
        "email": f"test_{int(time.time())}@example.com",
        "password": "Test@123"
    }

@pytest.fixture
def existing_user_id(api_client, test_user_data):
    """åˆ›å»ºæµ‹è¯•ç”¨æˆ·å¹¶è¿”å›ID"""
    created_user = api_client.create_user(test_user_data)
    user_id = created_user['id']

    yield user_id

    # æ¸…ç†ï¼šåˆ é™¤æµ‹è¯•ç”¨æˆ·
    api_client.delete_user(user_id)
```

---

## ç¬¬å››ç« : ç§»åŠ¨ç«¯è‡ªåŠ¨åŒ–æµ‹è¯•

### 4.1 Appiumç®€ä»‹

**Appium**æ˜¯å¼€æºçš„ç§»åŠ¨ç«¯è‡ªåŠ¨åŒ–æµ‹è¯•æ¡†æ¶ï¼Œæ”¯æŒï¼š
- iOSåŸç”Ÿåº”ç”¨
- AndroidåŸç”Ÿåº”ç”¨
- æ··åˆåº”ç”¨ï¼ˆHybridï¼‰
- ç§»åŠ¨Webåº”ç”¨

**æ¶æ„**:
```
æµ‹è¯•è„šæœ¬ (Python/Javaç­‰)
        â†“
Appium Server (Node.js)
        â†“
WebDriver Protocol
        â†“
ç§»åŠ¨è®¾å¤‡/æ¨¡æ‹Ÿå™¨
```

### 4.2 Androidè‡ªåŠ¨åŒ–æµ‹è¯•

#### 4.2.1 ç¯å¢ƒå‡†å¤‡

**å®‰è£…è¦æ±‚**:
```bash
# 1. å®‰è£…Java JDK
# 2. å®‰è£…Android SDK
# 3. é…ç½®ç¯å¢ƒå˜é‡
export ANDROID_HOME=/path/to/android-sdk
export PATH=$PATH:$ANDROID_HOME/tools:$ANDROID_HOME/platform-tools

# 4. å®‰è£…Appium
npm install -g appium

# 5. å®‰è£…Appium Pythonå®¢æˆ·ç«¯
pip install Appium-Python-Client
```

#### 4.2.2 åŸºç¡€ç¤ºä¾‹

```python
from appium import webdriver
from appium.options.android import UiAutomator2Options
from appium.webdriver.common.appiumby import AppiumBy
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC

# é…ç½®
options = UiAutomator2Options()
options.platform_name = 'Android'
options.platform_version = '11'
options.device_name = 'Android Emulator'
options.app = '/path/to/app.apk'
options.automation_name = 'UiAutomator2'
options.app_package = 'com.example.app'
options.app_activity = '.MainActivity'

# å¯åŠ¨driver
driver = webdriver.Remote(
    'http://localhost:4723',
    options=options
)

try:
    # ç­‰å¾…å…ƒç´ 
    wait = WebDriverWait(driver, 10)
    element = wait.until(
        EC.presence_of_element_located(
            (AppiumBy.ID, "com.example.app:id/button")
        )
    )

    # ç‚¹å‡»
    element.click()

    # è¾“å…¥æ–‡æœ¬
    input_field = driver.find_element(AppiumBy.ID, "input_field")
    input_field.send_keys("æµ‹è¯•æ–‡æœ¬")

    # æ»‘åŠ¨
    driver.swipe(start_x=500, start_y=1500, end_x=500, end_y=500, duration=800)

finally:
    driver.quit()
```

#### 4.2.3 é«˜çº§æ“ä½œ

```python
# æ»‘åŠ¨æ“ä½œ
from appium.webdriver.common.touch_action import TouchAction

action = TouchAction(driver)
action.press(x=100, y=500).wait(1000).move_to(x=100, y=100).release().perform()

# å¤šç‚¹è§¦æ§
from appium.webdriver.common.multi_action import MultiAction

action1 = TouchAction(driver)
action1.press(x=100, y=100).move_to(x=100, y=500).release()

action2 = TouchAction(driver)
action2.press(x=300, y=100).move_to(x=300, y=500).release()

multi_action = MultiAction(driver)
multi_action.add(action1, action2)
multi_action.perform()

# å¤„ç†Toastæ¶ˆæ¯
toast_element = driver.find_element(
    AppiumBy.XPATH,
    "//*[contains(@text, 'ç™»å½•æˆåŠŸ')]"
)
print(toast_element.text)
```

---

## ç¬¬äº”ç« : æµ‹è¯•æ¡†æ¶è®¾è®¡ä¸å®ç°

### 5.1 æ•°æ®é©±åŠ¨æµ‹è¯•

**æ ¸å¿ƒæ€æƒ³**: å°†æµ‹è¯•æ•°æ®ä¸æµ‹è¯•é€»è¾‘åˆ†ç¦»ï¼Œä½¿ç”¨ç›¸åŒçš„æµ‹è¯•é€»è¾‘æ‰§è¡Œä¸åŒçš„æµ‹è¯•æ•°æ®ã€‚

```python
# data_driven_example.py
import pytest
import csv

def load_csv_data(filename):
    """ä»CSVæ–‡ä»¶åŠ è½½æµ‹è¯•æ•°æ®"""
    with open(filename, 'r', encoding='utf-8') as f:
        reader = csv.DictReader(f)
        return list(reader)

# test_data.csv
"""
username,password,expected_result
validuser,ValidPass@123,success
invaliduser,wrongpass,fail
"",ValidPass@123,fail
validuser,"",fail
"""

@pytest.mark.parametrize(
    "test_case",
    load_csv_data("test_data.csv"),
    ids=lambda tc: f"{tc['username']}/{tc['password']}"
)
def test_login_data_driven(login_page, test_case):
    """æ•°æ®é©±åŠ¨ç™»å½•æµ‹è¯•"""
    login_page.navigate()
    login_page.login(
        test_case['username'],
        test_case['password']
    )

    if test_case['expected_result'] == 'success':
        assert login_page.is_login_successful()
    else:
        assert login_page.is_error_displayed()
```

### 5.2 å…³é”®å­—é©±åŠ¨æµ‹è¯•

**æ ¸å¿ƒæ€æƒ³**: å°†æµ‹è¯•æ­¥éª¤æŠ½è±¡ä¸ºå…³é”®å­—ï¼Œé€šè¿‡ç»„åˆå…³é”®å­—æ„å»ºæµ‹è¯•ç”¨ä¾‹ã€‚

```python
# keyword_framework.py
class KeywordLibrary:
    """å…³é”®å­—åº“"""

    def __init__(self, driver):
        self.driver = driver

    def open_url(self, url):
        """å…³é”®å­—: æ‰“å¼€URL"""
        self.driver.get(url)

    def input_text(self, locator, text):
        """å…³é”®å­—: è¾“å…¥æ–‡æœ¬"""
        element = self.driver.find_element(*locator)
        element.send_keys(text)

    def click_element(self, locator):
        """å…³é”®å­—: ç‚¹å‡»å…ƒç´ """
        element = self.driver.find_element(*locator)
        element.click()

    def verify_text(self, locator, expected_text):
        """å…³é”®å­—: éªŒè¯æ–‡æœ¬"""
        element = self.driver.find_element(*locator)
        assert expected_text in element.text

# æµ‹è¯•æ•°æ®
"""
[
    ["open_url", "https://example.com/login"],
    ["input_text", ("id", "username"), "testuser"],
    ["input_text", ("id", "password"), "Test@123"],
    ["click_element", ("id", "login-btn")],
    ["verify_text", ("class", "welcome"), "æ¬¢è¿"]
]
"""

def execute_keywords(keyword_library, test_steps):
    """æ‰§è¡Œå…³é”®å­—"""
    for step in test_steps:
        keyword = step[0]
        args = step[1:]
        method = getattr(keyword_library, keyword)
        method(*args)
```

---

## ç¬¬å…­ç« : CI/CDé›†æˆ

### 6.1 Jenkinsé›†æˆ

**Jenkinsfileç¤ºä¾‹**:

```groovy
pipeline {
    agent any

    stages {
        stage('Checkout') {
            steps {
                git branch: 'main',
                    url: 'https://github.com/yourrepo/tests.git'
            }
        }

        stage('Install Dependencies') {
            steps {
                sh '''
                    python -m venv venv
                    . venv/bin/activate
                    pip install -r requirements.txt
                '''
            }
        }

        stage('Run Tests') {
            steps {
                sh '''
                    . venv/bin/activate
                    pytest tests/ --html=report.html --self-contained-html
                '''
            }
        }

        stage('Publish Report') {
            steps {
                publishHTML([
                    reportDir: '.',
                    reportFiles: 'report.html',
                    reportName: 'æµ‹è¯•æŠ¥å‘Š'
                ])
            }
        }
    }

    post {
        always {
            junit 'test-results/*.xml'
        }
        failure {
            mail to: 'team@example.com',
                 subject: "æµ‹è¯•å¤±è´¥: ${env.JOB_NAME}",
                 body: "æ„å»º ${env.BUILD_NUMBER} å¤±è´¥"
        }
    }
}
```

### 6.2 GitHub Actions

**.github/workflows/test.yml**:

```yaml
name: è‡ªåŠ¨åŒ–æµ‹è¯•

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]
  schedule:
    - cron: '0 2 * * *'  # æ¯å¤©å‡Œæ™¨2ç‚¹æ‰§è¡Œ

jobs:
  test:
    runs-on: ubuntu-latest

    strategy:
      matrix:
        python-version: [3.8, 3.9, 3.10]

    steps:
    - uses: actions/checkout@v3

    - name: è®¾ç½®Python
      uses: actions/setup-python@v4
      with:
        python-version: ${{ matrix.python-version }}

    - name: å®‰è£…ä¾èµ–
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt

    - name: è¿è¡Œæµ‹è¯•
      run: |
        pytest tests/ -v --html=report.html --self-contained-html

    - name: ä¸Šä¼ æµ‹è¯•æŠ¥å‘Š
      if: always()
      uses: actions/upload-artifact@v3
      with:
        name: test-report-${{ matrix.python-version }}
        path: report.html

    - name: å‘é€é€šçŸ¥
      if: failure()
      uses: 8398a7/action-slack@v3
      with:
        status: ${{ job.status }}
        text: 'æµ‹è¯•å¤±è´¥ï¼Œè¯·æ£€æŸ¥!'
        webhook_url: ${{ secrets.SLACK_WEBHOOK }}
```

---

## ç¬¬ä¸ƒç« : æ€§èƒ½æµ‹è¯•è‡ªåŠ¨åŒ–

### 7.1 JMeteråŸºç¡€

**æµ‹è¯•è®¡åˆ’ç»“æ„**:
```
Test Plan
â”œâ”€â”€ Thread Group (ç”¨æˆ·ç»„)
â”‚   â”œâ”€â”€ HTTP Request (è¯·æ±‚)
â”‚   â”œâ”€â”€ Response Assertion (æ–­è¨€)
â”‚   â””â”€â”€ Listeners (ç›‘å¬å™¨)
â”‚       â”œâ”€â”€ View Results Tree
â”‚       â”œâ”€â”€ Summary Report
â”‚       â””â”€â”€ Aggregate Report
â””â”€â”€ CSV Data Set Config (æ•°æ®é…ç½®)
```

**JMeterè„šæœ¬ç¤ºä¾‹(test_plan.jmx)**:
```xml
<?xml version="1.0" encoding="UTF-8"?>
<jmeterTestPlan version="1.2" properties="5.0">
  <hashTree>
    <TestPlan>
      <stringProp name="TestPlan.comments">APIæ€§èƒ½æµ‹è¯•</stringProp>
      <boolProp name="TestPlan.functional_mode">false</boolProp>
      <boolProp name="TestPlan.serialize_threadgroups">false</boolProp>
    </TestPlan>
    <hashTree>
      <ThreadGroup>
        <stringProp name="ThreadGroup.num_threads">100</stringProp>
        <stringProp name="ThreadGroup.ramp_time">10</stringProp>
        <stringProp name="ThreadGroup.duration">60</stringProp>
      </ThreadGroup>
      <hashTree>
        <HTTPSamplerProxy>
          <stringProp name="HTTPSampler.domain">api.example.com</stringProp>
          <stringProp name="HTTPSampler.port">443</stringProp>
          <stringProp name="HTTPSampler.protocol">https</stringProp>
          <stringProp name="HTTPSampler.path">/api/users</stringProp>
          <stringProp name="HTTPSampler.method">GET</stringProp>
        </HTTPSamplerProxy>
      </hashTree>
    </hashTree>
  </hashTree>
</jmeterTestPlan>
```

**å‘½ä»¤è¡Œæ‰§è¡Œ**:
```bash
# è¿è¡Œæµ‹è¯•
jmeter -n -t test_plan.jmx -l results.jtl -e -o reports/

# -n: éGUIæ¨¡å¼
# -t: æµ‹è¯•è®¡åˆ’æ–‡ä»¶
# -l: ç»“æœæ–‡ä»¶
# -e: ç”ŸæˆHTMLæŠ¥å‘Š
# -o: æŠ¥å‘Šè¾“å‡ºç›®å½•
```

### 7.2 Locust - Pythonæ€§èƒ½æµ‹è¯•

```python
# locustfile.py
from locust import HttpUser, task, between
import random

class WebsiteUser(HttpUser):
    """æ¨¡æ‹Ÿç½‘ç«™ç”¨æˆ·è¡Œä¸º"""

    # ç”¨æˆ·ç­‰å¾…æ—¶é—´ï¼ˆç§’ï¼‰
    wait_time = between(1, 3)

    def on_start(self):
        """ç”¨æˆ·å¼€å§‹æ—¶æ‰§è¡Œï¼ˆç™»å½•ï¼‰"""
        response = self.client.post("/login", json={
            "username": "testuser",
            "password": "Test@123"
        })
        self.token = response.json()['token']

    @task(3)  # æƒé‡3
    def view_homepage(self):
        """è®¿é—®é¦–é¡µ"""
        self.client.get("/", headers=self.get_headers())

    @task(2)  # æƒé‡2
    def view_products(self):
        """æŸ¥çœ‹äº§å“åˆ—è¡¨"""
        self.client.get("/products", headers=self.get_headers())

    @task(1)  # æƒé‡1
    def view_product_detail(self):
        """æŸ¥çœ‹äº§å“è¯¦æƒ…"""
        product_id = random.randint(1, 100)
        self.client.get(
            f"/products/{product_id}",
            headers=self.get_headers(),
            name="/products/[id]"  # åˆ†ç»„ç»Ÿè®¡
        )

    @task(1)
    def search_products(self):
        """æœç´¢äº§å“"""
        keywords = ["phone", "laptop", "camera", "watch"]
        keyword = random.choice(keywords)

        with self.client.get(
            "/search",
            params={"q": keyword},
            headers=self.get_headers(),
            catch_response=True
        ) as response:
            if response.status_code == 200:
                results = response.json()
                if len(results) > 0:
                    response.success()
                else:
                    response.failure("æ²¡æœ‰æœç´¢ç»“æœ")
            else:
                response.failure(f"çŠ¶æ€ç : {response.status_code}")

    def get_headers(self):
        """è·å–è¯·æ±‚å¤´"""
        return {
            "Authorization": f"Bearer {self.token}",
            "Content-Type": "application/json"
        }

# å‹åŠ›æµ‹è¯•åœºæ™¯
class StressTestUser(HttpUser):
    """å‹åŠ›æµ‹è¯•ç”¨æˆ·"""
    wait_time = between(0.5, 1)  # æ›´çŸ­çš„ç­‰å¾…æ—¶é—´

    @task
    def stress_endpoint(self):
        """æŒç»­å‹æµ‹æŸä¸ªç«¯ç‚¹"""
        self.client.get("/api/heavy-operation")
```

**è¿è¡ŒLocust**:

```bash
# Web UIæ¨¡å¼
locust -f locustfile.py --host=https://api.example.com

# æ— UIæ¨¡å¼ï¼ˆé€‚åˆCI/CDï¼‰
locust -f locustfile.py --host=https://api.example.com \
       --users 100 --spawn-rate 10 --run-time 5m \
       --html report.html
```

---

## ç¬¬å…«ç« : æµ‹è¯•æŠ¥å‘Šä¸ç›‘æ§

### 8.1 Allure Report

**å®‰è£…é…ç½®**:

```bash
# å®‰è£…Allureå‘½ä»¤è¡Œå·¥å…·
brew install allure  # macOS
sudo apt-get install allure  # Linux

# å®‰è£…pytest-allureæ’ä»¶
pip install allure-pytest
```

**ä½¿ç”¨ç¤ºä¾‹**:

```python
import allure
import pytest

@allure.epic("ç”µå•†ç³»ç»Ÿ")
@allure.feature("ç”¨æˆ·æ¨¡å—")
class TestUserManagement:

    @allure.story("ç”¨æˆ·æ³¨å†Œ")
    @allure.title("æµ‹è¯•æˆåŠŸæ³¨å†Œç”¨æˆ·")
    @allure.description("éªŒè¯ç”¨æˆ·å¯ä»¥ä½¿ç”¨æœ‰æ•ˆä¿¡æ¯æˆåŠŸæ³¨å†Œ")
    @allure.severity(allure.severity_level.BLOCKER)
    def test_register_success(self):
        with allure.step("å‡†å¤‡ç”¨æˆ·æ•°æ®"):
            user_data = {"username": "newuser", "email": "new@example.com"}
            allure.attach(
                str(user_data),
                name="ç”¨æˆ·æ•°æ®",
                attachment_type=allure.attachment_type.JSON
            )

        with allure.step("å‘é€æ³¨å†Œè¯·æ±‚"):
            response = register_user(user_data)

        with allure.step("éªŒè¯æ³¨å†ŒæˆåŠŸ"):
            assert response.status_code == 201
            assert "id" in response.json()

    @allure.story("ç”¨æˆ·ç™»å½•")
    @pytest.mark.parametrize("username,password,expected", [
        ("validuser", "ValidPass@123", "success"),
        ("invaliduser", "wrongpass", "fail"),
    ], ids=["æœ‰æ•ˆå‡­æ®", "æ— æ•ˆå‡­æ®"])
    def test_login(self, username, password, expected):
        """å‚æ•°åŒ–ç™»å½•æµ‹è¯•"""
        allure.dynamic.title(f"æµ‹è¯•ç™»å½• - {username}")

        result = login(username, password)

        if expected == "success":
            assert result.is_success
        else:
            assert not result.is_success

# ç”ŸæˆæŠ¥å‘Š
# pytest --alluredir=allure-results
# allure serve allure-results
```

**Allureç‰¹æ€§**:
- **Epic/Feature/Story**: ä¸‰çº§åˆ†ç±»
- **Severity**: ä¼˜å…ˆçº§æ ‡è®°ï¼ˆblocker, critical, normal, minor, trivialï¼‰
- **Steps**: æµ‹è¯•æ­¥éª¤
- **Attachments**: é™„ä»¶ï¼ˆæˆªå›¾ã€æ—¥å¿—ã€æ•°æ®ï¼‰
- **Categories**: å¤±è´¥åˆ†ç±»
- **Flaky Tests**: ä¸ç¨³å®šæµ‹è¯•æ ‡è®°

### 8.2 æµ‹è¯•ç›‘æ§ä¸åˆ†æ

**æµ‹è¯•æŒ‡æ ‡æ”¶é›†**:

```python
# test_metrics.py
import time
import psutil
from dataclasses import dataclass
from typing import List

@dataclass
class TestMetrics:
    """æµ‹è¯•æŒ‡æ ‡"""
    test_name: str
    duration: float
    status: str
    memory_usage: float
    cpu_usage: float
    timestamp: str

class MetricsCollector:
    """æŒ‡æ ‡æ”¶é›†å™¨"""

    def __init__(self):
        self.metrics: List[TestMetrics] = []

    def collect(self, test_name: str, func):
        """æ”¶é›†æµ‹è¯•æ‰§è¡ŒæŒ‡æ ‡"""
        start_time = time.time()
        start_memory = psutil.Process().memory_info().rss / 1024 / 1024
        start_cpu = psutil.cpu_percent(interval=0.1)

        try:
            func()
            status = "PASSED"
        except Exception:
            status = "FAILED"
            raise
        finally:
            end_time = time.time()
            end_memory = psutil.Process().memory_info().rss / 1024 / 1024
            end_cpu = psutil.cpu_percent(interval=0.1)

            metrics = TestMetrics(
                test_name=test_name,
                duration=end_time - start_time,
                status=status,
                memory_usage=end_memory - start_memory,
                cpu_usage=(start_cpu + end_cpu) / 2,
                timestamp=time.strftime("%Y-%m-%d %H:%M:%S")
            )

            self.metrics.append(metrics)

    def export_to_csv(self, filename="test_metrics.csv"):
        """å¯¼å‡ºä¸ºCSV"""
        import csv

        with open(filename, 'w', newline='') as f:
            writer = csv.DictWriter(f, fieldnames=[
                'test_name', 'duration', 'status',
                'memory_usage', 'cpu_usage', 'timestamp'
            ])
            writer.writeheader()
            for metric in self.metrics:
                writer.writerow(metric.__dict__)

# ä½¿ç”¨ç¤ºä¾‹
@pytest.fixture(scope="session")
def metrics_collector():
    collector = MetricsCollector()
    yield collector
    collector.export_to_csv()

def test_with_metrics(metrics_collector):
    metrics_collector.collect("test_example", lambda: perform_test())
```

---

## ğŸ“š å­¦ä¹ æˆæœéªŒè¯

### âœ… éªŒè¯æ ‡å‡†

å®Œæˆæœ¬ç¬”è®°å­¦ä¹ åï¼Œä½ åº”è¯¥èƒ½å¤Ÿï¼š

1. **ç†è®ºçŸ¥è¯†** (20%)
   - [ ] è§£é‡Šè‡ªåŠ¨åŒ–æµ‹è¯•çš„ä»·å€¼å’Œå±€é™æ€§
   - [ ] æè¿°æµ‹è¯•é‡‘å­—å¡”çš„å„å±‚æ¬¡åŠå…¶ç‰¹ç‚¹
   - [ ] ç†è§£ä¸åŒæµ‹è¯•ç±»å‹çš„åº”ç”¨åœºæ™¯

2. **å®æˆ˜èƒ½åŠ›** (60%)
   - [ ] ä½¿ç”¨Selenium/Playwrightç¼–å†™Webè‡ªåŠ¨åŒ–æµ‹è¯•
   - [ ] ä½¿ç”¨Requests/pytestç¼–å†™APIè‡ªåŠ¨åŒ–æµ‹è¯•
   - [ ] è®¾è®¡å¹¶å®ç°é¡µé¢å¯¹è±¡æ¨¡å¼ï¼ˆPOMï¼‰
   - [ ] é…ç½®å¹¶è¿è¡ŒCI/CDæµ‹è¯•æµæ°´çº¿
   - [ ] ç”Ÿæˆä¸“ä¸šçš„æµ‹è¯•æŠ¥å‘Š

3. **æ¡†æ¶è®¾è®¡** (20%)
   - [ ] è®¾è®¡å¯ç»´æŠ¤çš„æµ‹è¯•æ¡†æ¶ç»“æ„
   - [ ] å®ç°æ•°æ®é©±åŠ¨å’Œå…³é”®å­—é©±åŠ¨æµ‹è¯•
   - [ ] é›†æˆæµ‹è¯•åˆ°æŒç»­é›†æˆç¯å¢ƒ

### ğŸ¯ å®æˆ˜é¡¹ç›®å»ºè®®

**åˆçº§é¡¹ç›®**:
1. ä¸ºç®€å•ç½‘ç«™ï¼ˆå¦‚ä¸ªäººåšå®¢ï¼‰ç¼–å†™UIè‡ªåŠ¨åŒ–æµ‹è¯•
2. ä¸ºå…¬å…±APIï¼ˆå¦‚JSONPlaceholderï¼‰ç¼–å†™APIæµ‹è¯•å¥—ä»¶

**ä¸­çº§é¡¹ç›®**:
3. ä¸ºç”µå•†ç½‘ç«™æ ¸å¿ƒæµç¨‹ç¼–å†™ç«¯åˆ°ç«¯æµ‹è¯•
4. è®¾è®¡POMæ¶æ„çš„è‡ªåŠ¨åŒ–æµ‹è¯•æ¡†æ¶

**é«˜çº§é¡¹ç›®**:
5. æ„å»ºåŒ…å«Web+API+æ•°æ®åº“çš„å®Œæ•´æµ‹è¯•æ¡†æ¶
6. å®ç°æµ‹è¯•ç»“æœç›‘æ§å’Œåˆ†æç³»ç»Ÿ

---

## ğŸ”— æ‰©å±•èµ„æº

### å®˜æ–¹æ–‡æ¡£
- [Seleniumå®˜æ–¹æ–‡æ¡£](https://www.selenium.dev/documentation/)
- [Playwrightå®˜æ–¹æ–‡æ¡£](https://playwright.dev/python/)
- [Pytestå®˜æ–¹æ–‡æ¡£](https://docs.pytest.org/)
- [Appiumå®˜æ–¹æ–‡æ¡£](http://appium.io/docs/)

### æ¨èä¹¦ç±
- ã€Šè½¯ä»¶æµ‹è¯•çš„è‰ºæœ¯ã€‹ - æµ‹è¯•ç†è®ºåŸºç¡€
- ã€ŠPython Testing with pytestã€‹ - pytestæ·±å…¥å­¦ä¹ 
- ã€ŠSelenium WebDriverå®æˆ˜å®å…¸ã€‹ - Seleniumå®æˆ˜

### åœ¨çº¿èµ„æº
- [Test Automation University](https://testautomationu.applitools.com/) - å…è´¹æµ‹è¯•è¯¾ç¨‹
- [Ministry of Testing](https://www.ministryoftesting.com/) - æµ‹è¯•ç¤¾åŒº
- [Awesome Testing](https://github.com/TheJambo/awesome-testing) - æµ‹è¯•èµ„æºåˆé›†

### å®è·µå¹³å°
- [The Internet](https://the-internet.herokuapp.com/) - Webæµ‹è¯•ç»ƒä¹ ç½‘ç«™
- [Restful-booker](https://restful-booker.herokuapp.com/) - APIæµ‹è¯•ç»ƒä¹ 
- [SauceDemo](https://www.saucedemo.com/) - ç”µå•†æµ‹è¯•ç½‘ç«™

---

## ğŸ’¡ å¸¸è§é—®é¢˜ä¸æœ€ä½³å®è·µ

### Q1: ä»€ä¹ˆæ—¶å€™å¼€å§‹è‡ªåŠ¨åŒ–æµ‹è¯•ï¼Ÿ

**A**: å½“æ»¡è¶³ä»¥ä¸‹æ¡ä»¶æ—¶ï¼š
- åŠŸèƒ½ç›¸å¯¹ç¨³å®šï¼Œä¸é¢‘ç¹å˜æ›´
- éœ€è¦é¢‘ç¹å›å½’æµ‹è¯•
- æœ‰è¶³å¤Ÿçš„æŠ•å…¥æ—¶é—´å’Œèµ„æº
- å›¢é˜Ÿå…·å¤‡åŸºç¡€ç¼–ç¨‹èƒ½åŠ›

### Q2: å¦‚ä½•æé«˜æµ‹è¯•ç¨³å®šæ€§ï¼Ÿ

**A**:
- ä½¿ç”¨æ˜¾å¼ç­‰å¾…è€Œéå›ºå®šç­‰å¾…
- åˆç†ä½¿ç”¨é‡è¯•æœºåˆ¶
- é¿å…ä¾èµ–åŠ¨æ€æ•°æ®
- åšå¥½æµ‹è¯•æ•°æ®éš”ç¦»
- ä½¿ç”¨å”¯ä¸€æ ‡è¯†ç¬¦å®šä½å…ƒç´ 

### Q3: å¦‚ä½•é€‰æ‹©è‡ªåŠ¨åŒ–æµ‹è¯•å·¥å…·ï¼Ÿ

**A**: è€ƒè™‘å› ç´ ï¼š
- é¡¹ç›®æŠ€æœ¯æ ˆ
- å›¢é˜ŸæŠ€èƒ½
- ç¤¾åŒºæ”¯æŒ
- æ–‡æ¡£å®Œå–„åº¦
- å­¦ä¹ æ›²çº¿
- æˆæœ¬é¢„ç®—

### Q4: è‡ªåŠ¨åŒ–æµ‹è¯•è¦†ç›–ç‡å¤šå°‘åˆé€‚ï¼Ÿ

**A**:
- å•å…ƒæµ‹è¯•ï¼š70-80%
- é›†æˆæµ‹è¯•ï¼š20-30%
- E2Eæµ‹è¯•ï¼š10-20%
- ä¸è¿½æ±‚100%è¦†ç›–ç‡
- å…³æ³¨å…³é”®ä¸šåŠ¡æµç¨‹

---

## ğŸ“ æ€»ç»“

è‡ªåŠ¨åŒ–æµ‹è¯•æ˜¯ä¸€ä¸ªæŒç»­å­¦ä¹ å’Œå®è·µçš„è¿‡ç¨‹ã€‚æœ¬ç¬”è®°æ¶µç›–äº†ä»åŸºç¡€åˆ°è¿›é˜¶çš„å…¨é¢å†…å®¹ï¼Œä½†çœŸæ­£çš„æŒæ¡éœ€è¦åœ¨å®é™…é¡¹ç›®ä¸­ä¸æ–­åº”ç”¨å’Œä¼˜åŒ–ã€‚

**å­¦ä¹ è·¯å¾„å›é¡¾**:
1. âœ… æŒæ¡æµ‹è¯•åŸºç¡€ç†è®º
2. âœ… é€‰æ‹©ä¸€ä¸ªé¢†åŸŸæ·±å…¥å­¦ä¹ ï¼ˆWeb/API/ç§»åŠ¨ç«¯ï¼‰
3. âœ… å­¦ä¹ æµ‹è¯•æ¡†æ¶è®¾è®¡æ¨¡å¼
4. âœ… å®è·µCI/CDé›†æˆ
5. âœ… æŒç»­ä¼˜åŒ–å’Œæ”¹è¿›

**æŒç»­æå‡æ–¹å‘**:
- å…³æ³¨æ–°æŠ€æœ¯å’Œå·¥å…·å‘å±•
- å‚ä¸å¼€æºé¡¹ç›®
- åˆ†äº«ç»éªŒå’Œæœ€ä½³å®è·µ
- è€ƒå–ç›¸å…³è®¤è¯ï¼ˆISTQBç­‰ï¼‰

ç¥ä½ åœ¨è‡ªåŠ¨åŒ–æµ‹è¯•çš„é“è·¯ä¸Šä¸æ–­è¿›æ­¥ï¼ğŸš€

---

**ç‰ˆæœ¬ä¿¡æ¯**: v1.0
**æœ€åæ›´æ–°**: 2025-01
**ç»´æŠ¤**: æŒç»­æ›´æ–°ä¸­

**åé¦ˆä¸å»ºè®®**: æ¬¢è¿é€šè¿‡Issuesæå‡ºæ”¹è¿›å»ºè®®