<!DOCTYPE HTML>
<html lang="zh" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>PowerShell è„šæœ¬ç¼–ç¨‹å®Œæ•´å­¦ä¹ æŒ‡å— - å¼€å‘</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../theme/pagetoc.css">
        <link rel="stylesheet" href="../../theme/help-overlay.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>â†</kbd> or <kbd>â†’</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">å¼€å‘</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="æœç´¢æœ¬ä¹¦å†…å®¹..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <!-- Page table of contents -->
                        <div class="sidetoc"><nav class="pagetoc"></nav></div>

                        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="powershell-è„šæœ¬ç¼–ç¨‹å®Œæ•´å­¦ä¹ æŒ‡å—"><a class="header" href="#powershell-è„šæœ¬ç¼–ç¨‹å®Œæ•´å­¦ä¹ æŒ‡å—">PowerShell è„šæœ¬ç¼–ç¨‹å®Œæ•´å­¦ä¹ æŒ‡å—</a></h1>
<h2 id="-å­¦ä¹ è·¯çº¿å›¾"><a class="header" href="#-å­¦ä¹ è·¯çº¿å›¾">ğŸ“‹ å­¦ä¹ è·¯çº¿å›¾</a></h2>
<pre><code>ç¯å¢ƒå‡†å¤‡ â†’ åŸºç¡€è¯­æ³• â†’ æ ¸å¿ƒCmdlet â†’ ç®¡é“å¯¹è±¡ â†’ è„šæœ¬ç¼–ç¨‹ â†’ è¿œç¨‹ç®¡ç† â†’ æ¨¡å—å¼€å‘ â†’ é«˜çº§ç‰¹æ€§ â†’ ç”Ÿäº§å®æˆ˜
  (1å¤©)     (3å¤©)      (3å¤©)      (2å¤©)      (3å¤©)      (2å¤©)      (2å¤©)      (2å¤©)      (æŒç»­)
</code></pre>
<p><strong>ç›®æ ‡ç¾¤ä½“</strong>: Windowsç³»ç»Ÿç®¡ç†å‘˜ã€è¿ç»´å·¥ç¨‹å¸ˆã€è‡ªåŠ¨åŒ–å¼€å‘è€…
<strong>å‰ç½®è¦æ±‚</strong>: äº†è§£åŸºæœ¬çš„Windowsæ“ä½œç³»ç»Ÿå’Œå‘½ä»¤è¡Œ
<strong>å­¦ä¹ å‘¨æœŸ</strong>: 2-3å‘¨ï¼ˆæ¯å¤©2-3å°æ—¶ï¼‰</p>
<hr />
<h2 id="ç¬¬ä¸€ç« ç¯å¢ƒå‡†å¤‡ä¸å¿«é€Ÿå…¥é—¨"><a class="header" href="#ç¬¬ä¸€ç« ç¯å¢ƒå‡†å¤‡ä¸å¿«é€Ÿå…¥é—¨">ç¬¬ä¸€ç« ï¼šç¯å¢ƒå‡†å¤‡ä¸å¿«é€Ÿå…¥é—¨</a></h2>
<h3 id="11-powershellç®€ä»‹"><a class="header" href="#11-powershellç®€ä»‹">1.1 PowerShellç®€ä»‹</a></h3>
<p><strong>ä»€ä¹ˆæ˜¯PowerShell</strong>
PowerShellæ˜¯Microsoftå¼€å‘çš„ä»»åŠ¡è‡ªåŠ¨åŒ–å’Œé…ç½®ç®¡ç†æ¡†æ¶ï¼Œç”±å‘½ä»¤è¡ŒShellå’Œè„šæœ¬è¯­è¨€ç»„æˆã€‚å®ƒåŸºäº.NET Frameworkæ„å»ºï¼Œæä¾›å¯¹ç³»ç»Ÿçš„å…¨é¢è®¿é—®å’Œç®¡ç†èƒ½åŠ›ã€‚</p>
<p><strong>PowerShellçš„ä¼˜åŠ¿</strong></p>
<ul>
<li>âœ… é¢å‘å¯¹è±¡ï¼šç®¡é“ä¼ é€’å¯¹è±¡è€Œéæ–‡æœ¬</li>
<li>âœ… .NETé›†æˆï¼šç›´æ¥è®¿é—®.NETç±»åº“</li>
<li>âœ… ä¸€è‡´æ€§ï¼šç»Ÿä¸€çš„Cmdletå‘½åè§„èŒƒ</li>
<li>âœ… å¯æ‰©å±•ï¼šæ¨¡å—åŒ–è®¾è®¡ï¼Œæ˜“äºæ‰©å±•</li>
<li>âœ… è·¨å¹³å°ï¼šPowerShell Coreæ”¯æŒWindows/Linux/macOS</li>
<li>âœ… è¿œç¨‹ç®¡ç†ï¼šå†…ç½®å¼ºå¤§çš„è¿œç¨‹ç®¡ç†èƒ½åŠ›</li>
</ul>
<p><strong>PowerShellç‰ˆæœ¬æ¼”è¿›</strong></p>
<div class="table-wrapper"><table><thead><tr><th>ç‰ˆæœ¬</th><th>å‘å¸ƒæ—¶é—´</th><th>ä¸»è¦ç‰¹æ€§</th></tr></thead><tbody>
<tr><td>Windows PowerShell 1.0</td><td>2006</td><td>åŸºç¡€Shellå’Œè„šæœ¬èƒ½åŠ›</td></tr>
<tr><td>Windows PowerShell 2.0</td><td>2009</td><td>è¿œç¨‹ç®¡ç†ã€åå°ä½œä¸š</td></tr>
<tr><td>Windows PowerShell 3.0</td><td>2012</td><td>å·¥ä½œæµã€ä¼šè¯é…ç½®</td></tr>
<tr><td>Windows PowerShell 5.1</td><td>2016</td><td>ç±»å®šä¹‰ã€PackageManagement</td></tr>
<tr><td>PowerShell Core 6.0</td><td>2018</td><td>è·¨å¹³å°ã€å¼€æº</td></tr>
<tr><td>PowerShell 7.0+</td><td>2020+</td><td>å¹¶è¡Œå¤„ç†ã€ç®¡é“é“¾æ“ä½œ</td></tr>
</tbody></table>
</div>
<h3 id="12-å®‰è£…ä¸é…ç½®"><a class="header" href="#12-å®‰è£…ä¸é…ç½®">1.2 å®‰è£…ä¸é…ç½®</a></h3>
<p><strong>Windowsç³»ç»Ÿ</strong></p>
<pre><code class="language-powershell"># æŸ¥çœ‹å½“å‰PowerShellç‰ˆæœ¬
$PSVersionTable.PSVersion

# Windows 10/11è‡ªå¸¦PowerShell 5.1
# ä½ç½®: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

# å®‰è£…PowerShell 7+ï¼ˆæ¨èï¼‰
# æ–¹æ³•1: ä½¿ç”¨winget
winget install --id Microsoft.Powershell --source winget

# æ–¹æ³•2: ä½¿ç”¨MSIå®‰è£…åŒ…
# è®¿é—® https://github.com/PowerShell/PowerShell/releases
# ä¸‹è½½å¹¶å®‰è£… PowerShell-7.x.x-win-x64.msi

# æ–¹æ³•3: ä½¿ç”¨Chocolatey
choco install powershell-core

# éªŒè¯å®‰è£…
pwsh --version
</code></pre>
<p><strong>Linuxç³»ç»Ÿ</strong></p>
<pre><code class="language-bash"># Ubuntu/Debian
wget https://packages.microsoft.com/config/ubuntu/20.04/packages-microsoft-prod.deb
sudo dpkg -i packages-microsoft-prod.deb
sudo apt-get update
sudo apt-get install -y powershell

# CentOS/RHEL
curl https://packages.microsoft.com/config/rhel/7/prod.repo | sudo tee /etc/yum.repos.d/microsoft.repo
sudo yum install -y powershell

# å¯åŠ¨PowerShell
pwsh
</code></pre>
<p><strong>macOSç³»ç»Ÿ</strong></p>
<pre><code class="language-bash"># ä½¿ç”¨Homebrew
brew install --cask powershell

# å¯åŠ¨PowerShell
pwsh
</code></pre>
<p><strong>æ‰§è¡Œç­–ç•¥é…ç½®</strong></p>
<pre><code class="language-powershell"># æŸ¥çœ‹å½“å‰æ‰§è¡Œç­–ç•¥
Get-ExecutionPolicy

# æ‰§è¡Œç­–ç•¥è¯´æ˜
# Restricted    - ä¸å…è®¸è¿è¡Œè„šæœ¬ï¼ˆé»˜è®¤ï¼‰
# AllSigned     - åªèƒ½è¿è¡Œç­¾åè„šæœ¬
# RemoteSigned  - æœ¬åœ°è„šæœ¬å¯è¿è¡Œï¼Œä¸‹è½½çš„è„šæœ¬éœ€ç­¾åï¼ˆæ¨èï¼‰
# Unrestricted  - å…è®¸æ‰€æœ‰è„šæœ¬è¿è¡Œ
# Bypass        - ä¸é˜»æ­¢ä»»ä½•è„šæœ¬

# è®¾ç½®æ‰§è¡Œç­–ç•¥ï¼ˆéœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser

# ä¸´æ—¶ç»•è¿‡æ‰§è¡Œç­–ç•¥
powershell.exe -ExecutionPolicy Bypass -File script.ps1
</code></pre>
<p><strong>é…ç½®æ–‡ä»¶ï¼ˆProfileï¼‰</strong></p>
<pre><code class="language-powershell"># æŸ¥çœ‹é…ç½®æ–‡ä»¶è·¯å¾„
$PROFILE | Format-List -Force

# å››ä¸ªé…ç½®æ–‡ä»¶ä½ç½®
# AllUsersAllHosts       - æ‰€æœ‰ç”¨æˆ·æ‰€æœ‰ä¸»æœº
# AllUsersCurrentHost    - æ‰€æœ‰ç”¨æˆ·å½“å‰ä¸»æœº
# CurrentUserAllHosts    - å½“å‰ç”¨æˆ·æ‰€æœ‰ä¸»æœº
# CurrentUserCurrentHost - å½“å‰ç”¨æˆ·å½“å‰ä¸»æœºï¼ˆé»˜è®¤ï¼‰

# åˆ›å»ºé…ç½®æ–‡ä»¶
if (!(Test-Path -Path $PROFILE)) {
    New-Item -ItemType File -Path $PROFILE -Force
}

# ç¼–è¾‘é…ç½®æ–‡ä»¶
notepad $PROFILE

# é…ç½®æ–‡ä»¶ç¤ºä¾‹å†…å®¹
# è®¾ç½®é»˜è®¤ç¼–ç 
$PSDefaultParameterValues['*:Encoding'] = 'utf8'

# è‡ªå®šä¹‰æç¤ºç¬¦
function prompt {
    "PS $(Get-Location)&gt; "
}

# å®šä¹‰åˆ«å
Set-Alias -Name np -Value notepad
Set-Alias -Name ll -Value Get-ChildItem

# å¯¼å…¥å¸¸ç”¨æ¨¡å—
Import-Module PSReadLine

# è®¾ç½®PSReadLineé€‰é¡¹
Set-PSReadLineOption -PredictionSource History
Set-PSReadLineOption -HistorySearchCursorMovesToEnd
</code></pre>
<h3 id="13-ç¬¬ä¸€ä¸ªpowershellè„šæœ¬"><a class="header" href="#13-ç¬¬ä¸€ä¸ªpowershellè„šæœ¬">1.3 ç¬¬ä¸€ä¸ªPowerShellè„šæœ¬</a></h3>
<p><strong>Hello Worldè„šæœ¬</strong></p>
<pre><code class="language-powershell"># hello.ps1 - ç¬¬ä¸€ä¸ªPowerShellè„šæœ¬

# è¾“å‡ºæ–‡æœ¬
Write-Host "Hello, PowerShell World!" -ForegroundColor Green

# æ˜¾ç¤ºç³»ç»Ÿä¿¡æ¯
Write-Host "`n=== ç³»ç»Ÿä¿¡æ¯ ===" -ForegroundColor Cyan
Write-Host "è®¡ç®—æœºå: $env:COMPUTERNAME"
Write-Host "ç”¨æˆ·å: $env:USERNAME"
Write-Host "å½“å‰æ—¶é—´: $(Get-Date -Format 'yyyy-MM-dd HH:mm:ss')"
Write-Host "PowerShellç‰ˆæœ¬: $($PSVersionTable.PSVersion)"
Write-Host "å½“å‰ç›®å½•: $PWD"

# æš‚åœï¼ˆç­‰å¾…ç”¨æˆ·æŒ‰é”®ï¼‰
Read-Host "`næŒ‰å›è½¦é”®é€€å‡º"
</code></pre>
<p><strong>è¿è¡Œè„šæœ¬</strong></p>
<pre><code class="language-powershell"># æ–¹æ³•1: ç›¸å¯¹è·¯å¾„
.\hello.ps1

# æ–¹æ³•2: ç»å¯¹è·¯å¾„
C:\Scripts\hello.ps1

# æ–¹æ³•3: ä½¿ç”¨&amp;è°ƒç”¨è¿ç®—ç¬¦
&amp; "C:\Scripts\hello.ps1"

# æ–¹æ³•4: ä½¿ç”¨ç‚¹æºæ“ä½œï¼ˆåœ¨å½“å‰ä½œç”¨åŸŸæ‰§è¡Œï¼‰
. .\hello.ps1
</code></pre>
<hr />
<h2 id="ç¬¬äºŒç« åŸºç¡€è¯­æ³•"><a class="header" href="#ç¬¬äºŒç« åŸºç¡€è¯­æ³•">ç¬¬äºŒç« ï¼šåŸºç¡€è¯­æ³•</a></h2>
<h3 id="21-å˜é‡"><a class="header" href="#21-å˜é‡">2.1 å˜é‡</a></h3>
<p><strong>å˜é‡å®šä¹‰ä¸ä½¿ç”¨</strong></p>
<pre><code class="language-powershell"># åŸºæœ¬å˜é‡å®šä¹‰
$name = "å¼ ä¸‰"
$age = 25
$salary = 8000.50
$isActive = $true

# PowerShellå˜é‡ä¸éœ€è¦å£°æ˜ç±»å‹
# ä½†å¯ä»¥æŒ‡å®šç±»å‹
[string]$city = "åŒ—äº¬"
[int]$count = 100
[datetime]$today = Get-Date

# æŸ¥çœ‹å˜é‡å€¼
$name
Write-Host "å§“å: $name"

# å˜é‡æ‹¼æ¥
$fullInfo = "å§“å: $name, å¹´é¾„: $age, åŸå¸‚: $city"
Write-Host $fullInfo

# å˜é‡ä½œç”¨åŸŸ
$globalVar = "å…¨å±€å˜é‡"          # è„šæœ¬ä½œç”¨åŸŸ
function Test {
    $localVar = "å±€éƒ¨å˜é‡"       # å‡½æ•°ä½œç”¨åŸŸ
    $global:globalVar = "ä¿®æ”¹å…¨å±€"
}
</code></pre>
<p><strong>ç‰¹æ®Šå˜é‡</strong></p>
<pre><code class="language-powershell"># è‡ªåŠ¨å˜é‡
$PSVersionTable    # PowerShellç‰ˆæœ¬ä¿¡æ¯
$HOME              # ç”¨æˆ·ä¸»ç›®å½•
$PWD               # å½“å‰å·¥ä½œç›®å½•
$PROFILE           # é…ç½®æ–‡ä»¶è·¯å¾„
$_                 # å½“å‰ç®¡é“å¯¹è±¡
$?                 # ä¸Šä¸€ä¸ªå‘½ä»¤æ‰§è¡ŒçŠ¶æ€
$LASTEXITCODE      # ä¸Šä¸€ä¸ªç¨‹åºé€€å‡ºä»£ç 
$args              # å‡½æ•°å‚æ•°æ•°ç»„
$Error             # é”™è¯¯å¯¹è±¡æ•°ç»„

# ç¯å¢ƒå˜é‡
$env:PATH          # ç³»ç»ŸPATH
$env:COMPUTERNAME  # è®¡ç®—æœºå
$env:USERNAME      # ç”¨æˆ·å
$env:TEMP          # ä¸´æ—¶ç›®å½•

# åå¥½å˜é‡
$ErrorActionPreference = "Stop"     # é”™è¯¯æ—¶åœæ­¢
$VerbosePreference = "Continue"     # æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯
$DebugPreference = "Continue"       # æ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯
</code></pre>
<h3 id="22-æ•°æ®ç±»å‹"><a class="header" href="#22-æ•°æ®ç±»å‹">2.2 æ•°æ®ç±»å‹</a></h3>
<p><strong>å­—ç¬¦ä¸²</strong></p>
<pre><code class="language-powershell"># å•å¼•å·å­—ç¬¦ä¸²ï¼ˆå­—é¢å€¼ï¼‰
$str1 = 'Hello, World!'
$str1 = 'Price: $100'  # ä¸ä¼šè§£æå˜é‡

# åŒå¼•å·å­—ç¬¦ä¸²ï¼ˆå¯è§£æå˜é‡ï¼‰
$name = "PowerShell"
$str2 = "Hello, $name!"

# Here-Stringï¼ˆå¤šè¡Œå­—ç¬¦ä¸²ï¼‰
$multiline = @"
è¿™æ˜¯ç¬¬ä¸€è¡Œ
è¿™æ˜¯ç¬¬äºŒè¡Œ
å˜é‡å€¼: $name
"@

# å­—ç¬¦ä¸²æ“ä½œ
$text = "PowerShell"
$text.Length                    # é•¿åº¦: 10
$text.ToUpper()                 # å¤§å†™: POWERSHELL
$text.ToLower()                 # å°å†™: powershell
$text.Substring(0, 5)           # æˆªå–: Power
$text.Replace("Shell", "Core")  # æ›¿æ¢: PowerCore
$text.Contains("Shell")         # åŒ…å«: True
$text.StartsWith("Power")       # å¼€å¤´: True
$text.EndsWith("Shell")         # ç»“å°¾: True
$text.Split("e")                # åˆ†å‰²: Pow rSh ll

# å­—ç¬¦ä¸²æ ¼å¼åŒ–
$name = "å¼ ä¸‰"
$age = 25
"å§“å: {0}, å¹´é¾„: {1}" -f $name, $age
"å§“å: $name, å¹´é¾„: $age"

# å­—ç¬¦ä¸²æ¯”è¾ƒï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰
"abc" -eq "ABC"                 # True
"abc" -ceq "ABC"                # False (åŒºåˆ†å¤§å°å†™)
"abc" -like "a*"                # True (é€šé…ç¬¦)
"abc" -match "^a"               # True (æ­£åˆ™)
</code></pre>
<p><strong>æ•°ç»„</strong></p>
<pre><code class="language-powershell"># åˆ›å»ºæ•°ç»„
$array1 = @(1, 2, 3, 4, 5)
$array2 = 1..10                 # èŒƒå›´æ“ä½œç¬¦
$array3 = @("apple", "banana", "orange")
$empty = @()                    # ç©ºæ•°ç»„

# è®¿é—®å…ƒç´ 
$array1[0]                      # ç¬¬ä¸€ä¸ªå…ƒç´ : 1
$array1[-1]                     # æœ€åä¸€ä¸ªå…ƒç´ : 5
$array1[0..2]                   # èŒƒå›´: 1, 2, 3
$array1[0,2,4]                  # æŒ‡å®šç´¢å¼•: 1, 3, 5

# æ•°ç»„æ“ä½œ
$array1.Length                  # é•¿åº¦: 5
$array1 += 6                    # è¿½åŠ å…ƒç´ 
$array1 = $array1 + $array2     # åˆå¹¶æ•°ç»„
$array1 -contains 3             # åŒ…å«åˆ¤æ–­: True
$array1 -join ", "              # è¿æ¥: "1, 2, 3, 4, 5"

# éå†æ•°ç»„
foreach ($item in $array3) {
    Write-Host "æ°´æœ: $item"
}

# æ•°ç»„è¿‡æ»¤
$numbers = 1..10
$evens = $numbers | Where-Object { $_ % 2 -eq 0 }

# æ•°ç»„æ’åº
$sorted = $array1 | Sort-Object
$descending = $array1 | Sort-Object -Descending
</code></pre>
<p><strong>å“ˆå¸Œè¡¨ï¼ˆå­—å…¸ï¼‰</strong></p>
<pre><code class="language-powershell"># åˆ›å»ºå“ˆå¸Œè¡¨
$user = @{
    Name = "å¼ ä¸‰"
    Age = 25
    City = "åŒ—äº¬"
    Email = "zhangsan@example.com"
}

# è®¿é—®å€¼
$user.Name
$user["Name"]
$user.Age

# æ·»åŠ /ä¿®æ”¹é”®å€¼å¯¹
$user.Phone = "13800138000"
$user["Department"] = "IT"
$user.Age = 26

# åˆ é™¤é”®
$user.Remove("Phone")

# éå†å“ˆå¸Œè¡¨
foreach ($key in $user.Keys) {
    Write-Host "$key : $($user[$key])"
}

# æœ‰åºå“ˆå¸Œè¡¨
$ordered = [ordered]@{
    First = 1
    Second = 2
    Third = 3
}
</code></pre>
<p><strong>è‡ªå®šä¹‰å¯¹è±¡</strong></p>
<pre><code class="language-powershell"># ä½¿ç”¨PSCustomObject
$employee = [PSCustomObject]@{
    Name = "æå››"
    Age = 30
    Department = "Sales"
    Salary = 8000
}

# è®¿é—®å±æ€§
$employee.Name
$employee.Department

# æ·»åŠ æ–¹æ³•
$employee | Add-Member -MemberType ScriptMethod -Name GetInfo -Value {
    return "å§“å: $($this.Name), éƒ¨é—¨: $($this.Department)"
}

$employee.GetInfo()

# åˆ›å»ºå¯¹è±¡æ•°ç»„
$employees = @(
    [PSCustomObject]@{Name="å¼ ä¸‰"; Age=25; Dept="IT"}
    [PSCustomObject]@{Name="æå››"; Age=30; Dept="Sales"}
    [PSCustomObject]@{Name="ç‹äº”"; Age=28; Dept="HR"}
)

# ç­›é€‰å’Œæ’åº
$employees | Where-Object Age -gt 26
$employees | Sort-Object Age
$employees | Select-Object Name, Dept
</code></pre>
<h3 id="23-è¿ç®—ç¬¦"><a class="header" href="#23-è¿ç®—ç¬¦">2.3 è¿ç®—ç¬¦</a></h3>
<p><strong>ç®—æœ¯è¿ç®—ç¬¦</strong></p>
<pre><code class="language-powershell"># åŸºæœ¬è¿ç®—
10 + 5          # åŠ æ³•: 15
10 - 5          # å‡æ³•: 5
10 * 5          # ä¹˜æ³•: 50
10 / 5          # é™¤æ³•: 2
10 % 3          # å–æ¨¡: 1

# èµ‹å€¼è¿ç®—
$x = 10
$x += 5         # $x = 15
$x -= 3         # $x = 12
$x *= 2         # $x = 24
$x /= 4         # $x = 6
$x++            # $x = 7
$x--            # $x = 6
</code></pre>
<p><strong>æ¯”è¾ƒè¿ç®—ç¬¦</strong></p>
<pre><code class="language-powershell"># æ•°å€¼æ¯”è¾ƒ
5 -eq 5         # ç­‰äº: True
5 -ne 6         # ä¸ç­‰äº: True
5 -gt 3         # å¤§äº: True
5 -ge 5         # å¤§äºç­‰äº: True
5 -lt 10        # å°äº: True
5 -le 5         # å°äºç­‰äº: True

# å­—ç¬¦ä¸²æ¯”è¾ƒï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰
"abc" -eq "ABC"             # True
"abc" -ne "xyz"             # True
"abc" -ceq "ABC"            # False (åŒºåˆ†å¤§å°å†™)

# åŒ¹é…è¿ç®—ç¬¦
"PowerShell" -like "Power*"         # True
"PowerShell" -notlike "Bash*"       # True
"PowerShell" -match "^Power"        # True (æ­£åˆ™)
"test@email.com" -match '\w+@\w+'  # True
</code></pre>
<p><strong>é€»è¾‘è¿ç®—ç¬¦</strong></p>
<pre><code class="language-powershell"># é€»è¾‘ä¸æˆ–é
($true -and $true)          # True
($true -or $false)          # True
(-not $false)               # True
!$false                     # True

# ç»„åˆæ¡ä»¶
($age -gt 18) -and ($age -lt 65)
($role -eq "Admin") -or ($role -eq "Manager")
</code></pre>
<hr />
<h2 id="ç¬¬ä¸‰ç« æ ¸å¿ƒcmdlet"><a class="header" href="#ç¬¬ä¸‰ç« æ ¸å¿ƒcmdlet">ç¬¬ä¸‰ç« ï¼šæ ¸å¿ƒCmdlet</a></h2>
<h3 id="31-æ–‡ä»¶ç³»ç»Ÿæ“ä½œ"><a class="header" href="#31-æ–‡ä»¶ç³»ç»Ÿæ“ä½œ">3.1 æ–‡ä»¶ç³»ç»Ÿæ“ä½œ</a></h3>
<p><strong>Get-ChildItemï¼ˆåˆ—å‡ºæ–‡ä»¶ï¼‰</strong></p>
<pre><code class="language-powershell"># åŸºæœ¬ç”¨æ³•ï¼ˆåˆ«å: ls, dir, gciï¼‰
Get-ChildItem
Get-ChildItem C:\Users

# é€’å½’åˆ—å‡º
Get-ChildItem -Path C:\Scripts -Recurse

# ç­›é€‰æ–‡ä»¶
Get-ChildItem -Path C:\Scripts -Filter *.ps1
Get-ChildItem -Path C:\Scripts -Include *.ps1, *.psm1 -Recurse
Get-ChildItem -Path C:\Scripts -Exclude *.txt

# åªæ˜¾ç¤ºç›®å½•
Get-ChildItem -Directory

# åªæ˜¾ç¤ºæ–‡ä»¶
Get-ChildItem -File

# åŒ…å«éšè—æ–‡ä»¶
Get-ChildItem -Force

# å®æˆ˜ç¤ºä¾‹ï¼šæŸ¥æ‰¾å¤§æ–‡ä»¶
Get-ChildItem -Path C:\ -Recurse -File |
    Where-Object Length -gt 100MB |
    Sort-Object Length -Descending |
    Select-Object -First 10 FullName, @{Name="Size(MB)"; Expression={[math]::Round($_.Length/1MB, 2)}}
</code></pre>
<p><strong>New-Itemï¼ˆåˆ›å»ºé¡¹ï¼‰</strong></p>
<pre><code class="language-powershell"># åˆ›å»ºç›®å½•
New-Item -Path "C:\Scripts\NewFolder" -ItemType Directory

# åˆ›å»ºæ–‡ä»¶
New-Item -Path "C:\Scripts\test.txt" -ItemType File

# åˆ›å»ºå¹¶å†™å…¥å†…å®¹
New-Item -Path "C:\Scripts\config.txt" -ItemType File -Value "Config content"

# å¼ºåˆ¶åˆ›å»ºï¼ˆè¦†ç›–ï¼‰
New-Item -Path "C:\Scripts\test.txt" -ItemType File -Force

# åˆ›å»ºå¤šçº§ç›®å½•
New-Item -Path "C:\Scripts\Level1\Level2\Level3" -ItemType Directory -Force
</code></pre>
<p><strong>Copy-Itemï¼ˆå¤åˆ¶ï¼‰</strong></p>
<pre><code class="language-powershell"># å¤åˆ¶æ–‡ä»¶
Copy-Item -Path "source.txt" -Destination "dest.txt"

# å¤åˆ¶ç›®å½•
Copy-Item -Path "C:\Source" -Destination "C:\Dest" -Recurse

# å¤åˆ¶å¤šä¸ªæ–‡ä»¶
Copy-Item -Path "C:\Scripts\*.ps1" -Destination "D:\Backup\"

# å¼ºåˆ¶è¦†ç›–
Copy-Item -Path "source.txt" -Destination "dest.txt" -Force
</code></pre>
<p><strong>Move-Itemï¼ˆç§»åŠ¨ï¼‰</strong></p>
<pre><code class="language-powershell"># ç§»åŠ¨æ–‡ä»¶
Move-Item -Path "old.txt" -Destination "new.txt"

# ç§»åŠ¨ç›®å½•
Move-Item -Path "C:\OldFolder" -Destination "C:\NewFolder"

# é‡å‘½åï¼ˆç§»åŠ¨åˆ°ç›¸åŒç›®å½•ï¼‰
Move-Item -Path "old_name.txt" -Destination "new_name.txt"
</code></pre>
<p><strong>Remove-Itemï¼ˆåˆ é™¤ï¼‰</strong></p>
<pre><code class="language-powershell"># åˆ é™¤æ–‡ä»¶
Remove-Item -Path "file.txt"

# åˆ é™¤ç›®å½•ï¼ˆé€’å½’ï¼‰
Remove-Item -Path "C:\Folder" -Recurse

# å¼ºåˆ¶åˆ é™¤
Remove-Item -Path "C:\Folder" -Recurse -Force

# åˆ é™¤å‰ç¡®è®¤
Remove-Item -Path "important.txt" -Confirm

# åˆ é™¤åŒ¹é…çš„æ–‡ä»¶
Remove-Item -Path "C:\Temp\*.tmp"
</code></pre>
<p><strong>Test-Pathï¼ˆæµ‹è¯•è·¯å¾„ï¼‰</strong></p>
<pre><code class="language-powershell"># æµ‹è¯•æ–‡ä»¶æ˜¯å¦å­˜åœ¨
if (Test-Path -Path "C:\file.txt") {
    Write-Host "æ–‡ä»¶å­˜åœ¨"
}

# æµ‹è¯•ç›®å½•æ˜¯å¦å­˜åœ¨
Test-Path -Path "C:\Folder" -PathType Container

# æµ‹è¯•æ–‡ä»¶ç±»å‹
Test-Path -Path "C:\file.txt" -PathType Leaf
</code></pre>
<h3 id="32-è¿›ç¨‹ç®¡ç†"><a class="header" href="#32-è¿›ç¨‹ç®¡ç†">3.2 è¿›ç¨‹ç®¡ç†</a></h3>
<p><strong>Get-Processï¼ˆè·å–è¿›ç¨‹ï¼‰</strong></p>
<pre><code class="language-powershell"># åˆ—å‡ºæ‰€æœ‰è¿›ç¨‹
Get-Process

# æŒ‰åç§°æŸ¥æ‰¾
Get-Process -Name "chrome"
Get-Process chrome  # ç®€å†™

# æŒ‰IDæŸ¥æ‰¾
Get-Process -Id 1234

# æŸ¥æ‰¾å¤šä¸ªè¿›ç¨‹
Get-Process -Name chrome, firefox, notepad

# æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯
Get-Process | Select-Object Name, Id, CPU, WorkingSet

# å®æˆ˜ç¤ºä¾‹ï¼šæŸ¥æ‰¾å ç”¨å†…å­˜æœ€å¤šçš„è¿›ç¨‹
Get-Process |
    Sort-Object WorkingSet -Descending |
    Select-Object -First 10 Name, Id,
        @{Name="Memory(MB)"; Expression={[math]::Round($_.WorkingSet/1MB, 2)}}
</code></pre>
<p><strong>Stop-Processï¼ˆåœæ­¢è¿›ç¨‹ï¼‰</strong></p>
<pre><code class="language-powershell"># æŒ‰åç§°åœæ­¢
Stop-Process -Name "notepad"

# æŒ‰IDåœæ­¢
Stop-Process -Id 1234

# å¼ºåˆ¶åœæ­¢
Stop-Process -Name "chrome" -Force

# åœæ­¢å¤šä¸ªè¿›ç¨‹
Get-Process -Name "chrome" | Stop-Process
</code></pre>
<p><strong>Start-Processï¼ˆå¯åŠ¨è¿›ç¨‹ï¼‰</strong></p>
<pre><code class="language-powershell"># å¯åŠ¨ç¨‹åº
Start-Process "notepad.exe"

# å¯åŠ¨å¹¶æŒ‡å®šå‚æ•°
Start-Process "notepad.exe" -ArgumentList "C:\file.txt"

# ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ
Start-Process "powershell.exe" -Verb RunAs

# ç­‰å¾…è¿›ç¨‹ç»“æŸ
Start-Process "notepad.exe" -Wait

# å¯åŠ¨å¹¶éšè—çª—å£
Start-Process "cmd.exe" -WindowStyle Hidden
</code></pre>
<h3 id="33-æœåŠ¡ç®¡ç†"><a class="header" href="#33-æœåŠ¡ç®¡ç†">3.3 æœåŠ¡ç®¡ç†</a></h3>
<p><strong>Get-Serviceï¼ˆè·å–æœåŠ¡ï¼‰</strong></p>
<pre><code class="language-powershell"># åˆ—å‡ºæ‰€æœ‰æœåŠ¡
Get-Service

# æŒ‰åç§°æŸ¥æ‰¾
Get-Service -Name "wuauserv"

# ä½¿ç”¨é€šé…ç¬¦
Get-Service -Name "win*"

# æŒ‰çŠ¶æ€ç­›é€‰
Get-Service | Where-Object Status -eq "Running"
Get-Service | Where-Object Status -eq "Stopped"

# æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯
Get-Service | Select-Object Name, DisplayName, Status, StartType
</code></pre>
<p><strong>Start-Service / Stop-Serviceï¼ˆå¯åŠ¨/åœæ­¢æœåŠ¡ï¼‰</strong></p>
<pre><code class="language-powershell"># å¯åŠ¨æœåŠ¡
Start-Service -Name "wuauserv"

# åœæ­¢æœåŠ¡
Stop-Service -Name "wuauserv"

# é‡å¯æœåŠ¡
Restart-Service -Name "wuauserv"

# è®¾ç½®æœåŠ¡å¯åŠ¨ç±»å‹
Set-Service -Name "wuauserv" -StartupType Automatic
# å¯åŠ¨ç±»å‹: Automatic, Manual, Disabled
</code></pre>
<h3 id="34-ç½‘ç»œæ“ä½œ"><a class="header" href="#34-ç½‘ç»œæ“ä½œ">3.4 ç½‘ç»œæ“ä½œ</a></h3>
<p><strong>Test-Connectionï¼ˆPingï¼‰</strong></p>
<pre><code class="language-powershell"># åŸºæœ¬ping
Test-Connection -ComputerName "www.baidu.com"

# æŒ‡å®šæ¬¡æ•°
Test-Connection -ComputerName "192.168.1.1" -Count 4

# é™é»˜æ¨¡å¼ï¼ˆä»…è¿”å›å¸ƒå°”å€¼ï¼‰
Test-Connection -ComputerName "8.8.8.8" -Quiet

# Pingå¤šå°ä¸»æœº
"www.baidu.com", "www.bing.com" | Test-Connection -Count 2
</code></pre>
<p><strong>Invoke-WebRequestï¼ˆHTTPè¯·æ±‚ï¼‰</strong></p>
<pre><code class="language-powershell"># GETè¯·æ±‚
$response = Invoke-WebRequest -Uri "https://api.github.com"
$response.StatusCode
$response.Content

# POSTè¯·æ±‚
$body = @{
    name = "test"
    value = "123"
} | ConvertTo-Json

Invoke-WebRequest -Uri "https://api.example.com/data" -Method POST -Body $body -ContentType "application/json"

# ä¸‹è½½æ–‡ä»¶
Invoke-WebRequest -Uri "https://example.com/file.zip" -OutFile "C:\Downloads\file.zip"

# ä½¿ç”¨ä»£ç†
Invoke-WebRequest -Uri "https://example.com" -Proxy "http://proxy:8080"
</code></pre>
<hr />
<h2 id="ç¬¬å››ç« ç®¡é“ä¸å¯¹è±¡"><a class="header" href="#ç¬¬å››ç« ç®¡é“ä¸å¯¹è±¡">ç¬¬å››ç« ï¼šç®¡é“ä¸å¯¹è±¡</a></h2>
<h3 id="41-ç®¡é“åŸºç¡€"><a class="header" href="#41-ç®¡é“åŸºç¡€">4.1 ç®¡é“åŸºç¡€</a></h3>
<p><strong>ç†è§£PowerShellç®¡é“</strong></p>
<pre><code class="language-powershell"># Bashç®¡é“ï¼ˆä¼ é€’æ–‡æœ¬ï¼‰
# ls -l | grep ".txt"

# PowerShellç®¡é“ï¼ˆä¼ é€’å¯¹è±¡ï¼‰
Get-ChildItem | Where-Object Extension -eq ".txt"

# æŸ¥çœ‹ç®¡é“å¯¹è±¡ç±»å‹
Get-Process | Get-Member

# å¯¹è±¡å±æ€§å’Œæ–¹æ³•
$proc = Get-Process -Name "powershell" | Select-Object -First 1
$proc.Name          # å±æ€§
$proc.Kill()        # æ–¹æ³•
</code></pre>
<p><strong>å¸¸ç”¨ç®¡é“Cmdlet</strong></p>
<pre><code class="language-powershell"># Where-Objectï¼ˆç­›é€‰ï¼‰
Get-Process | Where-Object CPU -gt 100
Get-Service | Where-Object {$_.Status -eq "Running" -and $_.StartType -eq "Automatic"}

# Select-Objectï¼ˆé€‰æ‹©å±æ€§ï¼‰
Get-Process | Select-Object Name, Id, CPU
Get-Process | Select-Object -First 5
Get-Process | Select-Object -Last 3
Get-Process | Select-Object -Unique Name

# Sort-Objectï¼ˆæ’åºï¼‰
Get-Process | Sort-Object CPU
Get-Process | Sort-Object CPU -Descending
Get-Process | Sort-Object CPU, WorkingSet

# ForEach-Objectï¼ˆå¾ªç¯å¤„ç†ï¼‰
Get-ChildItem | ForEach-Object {
    Write-Host "æ–‡ä»¶: $($_.Name), å¤§å°: $($_.Length)"
}

# ç®€å†™å½¢å¼
Get-Process | ForEach-Object Name
Get-Process | % { $_.Name }  # % æ˜¯ ForEach-Object çš„åˆ«å

# Group-Objectï¼ˆåˆ†ç»„ï¼‰
Get-Service | Group-Object Status
Get-Process | Group-Object Company

# Measure-Objectï¼ˆç»Ÿè®¡ï¼‰
Get-ChildItem | Measure-Object -Property Length -Sum -Average -Maximum -Minimum
</code></pre>
<h3 id="42-å¯¹è±¡æ“ä½œ"><a class="header" href="#42-å¯¹è±¡æ“ä½œ">4.2 å¯¹è±¡æ“ä½œ</a></h3>
<p><strong>åˆ›å»ºå’Œæ“ä½œè‡ªå®šä¹‰å¯¹è±¡</strong></p>
<pre><code class="language-powershell"># åˆ›å»ºå¯¹è±¡
$server = [PSCustomObject]@{
    Name = "Server01"
    IP = "192.168.1.100"
    Status = "Online"
    LastChecked = Get-Date
}

# è®¿é—®å±æ€§
$server.Name
$server.IP

# ä¿®æ”¹å±æ€§
$server.Status = "Offline"

# æ·»åŠ å±æ€§
$server | Add-Member -MemberType NoteProperty -Name "Location" -Value "åŒ—äº¬"

# æ·»åŠ æ–¹æ³•
$server | Add-Member -MemberType ScriptMethod -Name "GetInfo" -Value {
    return "æœåŠ¡å™¨: $($this.Name), IP: $($this.IP), çŠ¶æ€: $($this.Status)"
}

$server.GetInfo()
</code></pre>
<p><strong>å¯¹è±¡è½¬æ¢</strong></p>
<pre><code class="language-powershell"># å¯¹è±¡è½¬JSON
$data = @{
    Name = "Test"
    Value = 123
    Items = @("A", "B", "C")
}

$json = $data | ConvertTo-Json
Write-Host $json

# JSONè½¬å¯¹è±¡
$jsonString = '{"Name":"Test","Value":123}'
$obj = $jsonString | ConvertFrom-Json
$obj.Name

# å¯¹è±¡è½¬CSV
$processes = Get-Process | Select-Object -First 5 Name, Id, CPU
$processes | Export-Csv -Path "processes.csv" -NoTypeInformation

# CSVè½¬å¯¹è±¡
$data = Import-Csv -Path "processes.csv"

# å¯¹è±¡è½¬HTML
$services = Get-Service | Select-Object -First 10
$services | ConvertTo-Html | Out-File "services.html"

# å¯¹è±¡è½¬XML
$data | Export-Clixml -Path "data.xml"
$imported = Import-Clixml -Path "data.xml"
</code></pre>
<p><strong>å®æˆ˜æ¡ˆä¾‹ï¼šç³»ç»Ÿä¿¡æ¯æ”¶é›†</strong></p>
<pre><code class="language-powershell"># system_info.ps1 - æ”¶é›†ç³»ç»Ÿä¿¡æ¯å¹¶ç”ŸæˆæŠ¥å‘Š

# æ”¶é›†å„ç±»ä¿¡æ¯
$computerInfo = [PSCustomObject]@{
    ComputerName = $env:COMPUTERNAME
    OSVersion = (Get-CimInstance Win32_OperatingSystem).Caption
    Manufacturer = (Get-CimInstance Win32_ComputerSystem).Manufacturer
    Model = (Get-CimInstance Win32_ComputerSystem).Model
    Processor = (Get-CimInstance Win32_Processor).Name
    TotalRAM = [math]::Round((Get-CimInstance Win32_ComputerSystem).TotalPhysicalMemory/1GB, 2)
    FreeRAM = [math]::Round((Get-CimInstance Win32_OperatingSystem).FreePhysicalMemory/1MB, 2)
    DiskInfo = Get-CimInstance Win32_LogicalDisk -Filter "DriveType=3" |
        Select-Object DeviceID,
            @{Name="Size(GB)"; Expression={[math]::Round($_.Size/1GB, 2)}},
            @{Name="Free(GB)"; Expression={[math]::Round($_.FreeSpace/1GB, 2)}},
            @{Name="UsedPercent"; Expression={[math]::Round(($_.Size - $_.FreeSpace)/$_.Size * 100, 2)}}
    Services = (Get-Service | Where-Object Status -eq "Running").Count
    Processes = (Get-Process).Count
    CollectionTime = Get-Date -Format "yyyy-MM-dd HH:mm:ss"
}

# è¾“å‡ºä¸ºJSON
$computerInfo | ConvertTo-Json -Depth 3 | Out-File "system_info.json"

# è¾“å‡ºä¸ºHTMLæŠ¥å‘Š
$html = $computerInfo | ConvertTo-Html -Title "ç³»ç»Ÿä¿¡æ¯æŠ¥å‘Š" -PreContent "&lt;h1&gt;ç³»ç»Ÿä¿¡æ¯æŠ¥å‘Š&lt;/h1&gt;"
$html | Out-File "system_info.html"

Write-Host "ç³»ç»Ÿä¿¡æ¯å·²æ”¶é›†å®Œæˆ" -ForegroundColor Green
</code></pre>
<hr />
<h2 id="ç¬¬äº”ç« è„šæœ¬ç¼–ç¨‹"><a class="header" href="#ç¬¬äº”ç« è„šæœ¬ç¼–ç¨‹">ç¬¬äº”ç« ï¼šè„šæœ¬ç¼–ç¨‹</a></h2>
<h3 id="51-æ§åˆ¶ç»“æ„"><a class="header" href="#51-æ§åˆ¶ç»“æ„">5.1 æ§åˆ¶ç»“æ„</a></h3>
<p><strong>If-Elseæ¡ä»¶è¯­å¥</strong></p>
<pre><code class="language-powershell"># åŸºæœ¬ifè¯­å¥
$age = 20

if ($age -ge 18) {
    Write-Host "æˆå¹´äºº"
}

# if-else
if ($age -ge 18) {
    Write-Host "æˆå¹´äºº"
} else {
    Write-Host "æœªæˆå¹´"
}

# if-elseif-else
if ($age -ge 60) {
    Write-Host "è€å¹´äºº"
} elseif ($age -ge 18) {
    Write-Host "æˆå¹´äºº"
} elseif ($age -ge 13) {
    Write-Host "é’å°‘å¹´"
} else {
    Write-Host "å„¿ç«¥"
}

# å¤æ‚æ¡ä»¶
$role = "Admin"
$isActive = $true

if (($role -eq "Admin") -and $isActive) {
    Write-Host "ç®¡ç†å‘˜å·²æ¿€æ´»"
}

# ä½¿ç”¨-notæˆ–!
if (-not (Test-Path "C:\file.txt")) {
    Write-Host "æ–‡ä»¶ä¸å­˜åœ¨"
}
</code></pre>
<p><strong>Switchè¯­å¥</strong></p>
<pre><code class="language-powershell"># åŸºæœ¬switch
$day = "Monday"

switch ($day) {
    "Monday"    { Write-Host "æ˜ŸæœŸä¸€" }
    "Tuesday"   { Write-Host "æ˜ŸæœŸäºŒ" }
    "Wednesday" { Write-Host "æ˜ŸæœŸä¸‰" }
    default     { Write-Host "å…¶ä»–" }
}

# Switch with å¤šä¸ªæ¡ä»¶
$number = 5

switch ($number) {
    {$_ -lt 0}       { Write-Host "è´Ÿæ•°" }
    {$_ -eq 0}       { Write-Host "é›¶" }
    {$_ -gt 0}       { Write-Host "æ­£æ•°" }
    {$_ % 2 -eq 0}   { Write-Host "å¶æ•°" }
    {$_ % 2 -ne 0}   { Write-Host "å¥‡æ•°" }
}

# Switch with æ­£åˆ™è¡¨è¾¾å¼
$email = "test@example.com"

switch -Regex ($email) {
    '@gmail\.com$'   { Write-Host "Gmailç”¨æˆ·" }
    '@.*\.com$'      { Write-Host "comåŸŸå" }
    '^\w+@\w+\.\w+$' { Write-Host "æœ‰æ•ˆé‚®ç®±æ ¼å¼" }
}

# Switch with æ–‡ä»¶
switch -File "C:\config.txt" {
    {$_ -match "^#"}     { continue }  # è·³è¿‡æ³¨é‡Š
    {$_ -match "^$"}     { continue }  # è·³è¿‡ç©ºè¡Œ
    {$_ -match "^\w+="}  { Write-Host "é…ç½®: $_" }
}
</code></pre>
<h3 id="52-å¾ªç¯ç»“æ„"><a class="header" href="#52-å¾ªç¯ç»“æ„">5.2 å¾ªç¯ç»“æ„</a></h3>
<p><strong>Forå¾ªç¯</strong></p>
<pre><code class="language-powershell"># åŸºæœ¬forå¾ªç¯
for ($i = 0; $i -lt 10; $i++) {
    Write-Host "è®¡æ•°: $i"
}

# æ­¥é•¿å¾ªç¯
for ($i = 0; $i -le 100; $i += 10) {
    Write-Host $i
}

# å€’åºå¾ªç¯
for ($i = 10; $i -ge 0; $i--) {
    Write-Host $i
}
</code></pre>
<p><strong>ForEachå¾ªç¯</strong></p>
<pre><code class="language-powershell"># éå†æ•°ç»„
$fruits = @("apple", "banana", "orange")

foreach ($fruit in $fruits) {
    Write-Host "æ°´æœ: $fruit"
}

# éå†æ–‡ä»¶
foreach ($file in Get-ChildItem "C:\Scripts" -Filter "*.ps1") {
    Write-Host "è„šæœ¬: $($file.Name)"
}

# éå†å“ˆå¸Œè¡¨
$user = @{
    Name = "å¼ ä¸‰"
    Age = 25
    City = "åŒ—äº¬"
}

foreach ($key in $user.Keys) {
    Write-Host "$key = $($user[$key])"
}
</code></pre>
<p><strong>Whileå¾ªç¯</strong></p>
<pre><code class="language-powershell"># åŸºæœ¬while
$count = 0

while ($count -lt 5) {
    Write-Host "è®¡æ•°: $count"
    $count++
}

# æ— é™å¾ªç¯ï¼ˆéœ€è¦breaké€€å‡ºï¼‰
while ($true) {
    $input = Read-Host "è¾“å…¥å‘½ä»¤ (qé€€å‡º)"
    if ($input -eq "q") {
        break
    }
    Write-Host "æ‚¨è¾“å…¥äº†: $input"
}
</code></pre>
<p><strong>Do-While / Do-Untilå¾ªç¯</strong></p>
<pre><code class="language-powershell"># Do-Whileï¼ˆè‡³å°‘æ‰§è¡Œä¸€æ¬¡ï¼‰
$i = 0
do {
    Write-Host "i = $i"
    $i++
} while ($i -lt 5)

# Do-Untilï¼ˆæ¡ä»¶ä¸ºå‡æ—¶ç»§ç»­ï¼‰
$i = 0
do {
    Write-Host "i = $i"
    $i++
} until ($i -ge 5)
</code></pre>
<p><strong>Breakå’ŒContinue</strong></p>
<pre><code class="language-powershell"># Break - è·³å‡ºå¾ªç¯
for ($i = 0; $i -lt 10; $i++) {
    if ($i -eq 5) {
        break
    }
    Write-Host $i
}

# Continue - è·³è¿‡å½“å‰è¿­ä»£
for ($i = 0; $i -lt 10; $i++) {
    if ($i % 2 -eq 0) {
        continue
    }
    Write-Host "å¥‡æ•°: $i"
}
</code></pre>
<h3 id="53-å‡½æ•°"><a class="header" href="#53-å‡½æ•°">5.3 å‡½æ•°</a></h3>
<p><strong>å‡½æ•°å®šä¹‰</strong></p>
<pre><code class="language-powershell"># åŸºæœ¬å‡½æ•°
function Say-Hello {
    Write-Host "Hello, World!"
}

Say-Hello

# å¸¦å‚æ•°çš„å‡½æ•°
function Greet {
    param(
        [string]$Name
    )
    Write-Host "Hello, $Name!"
}

Greet -Name "å¼ ä¸‰"

# å¸¦è¿”å›å€¼çš„å‡½æ•°
function Add-Numbers {
    param(
        [int]$Num1,
        [int]$Num2
    )
    return $Num1 + $Num2
}

$result = Add-Numbers -Num1 10 -Num2 20
Write-Host "ç»“æœ: $result"
</code></pre>
<p><strong>é«˜çº§å‡½æ•°</strong></p>
<pre><code class="language-powershell"># å¸¦å®Œæ•´å‚æ•°å®šä¹‰çš„é«˜çº§å‡½æ•°
function Get-UserInfo {
    [CmdletBinding()]
    param(
        [Parameter(Mandatory=$true)]
        [string]$Username,

        [Parameter(Mandatory=$false)]
        [int]$Age = 0,

        [Parameter()]
        [ValidateSet("IT", "HR", "Sales")]
        [string]$Department = "IT",

        [switch]$Detailed
    )

    $info = [PSCustomObject]@{
        Username = $Username
        Age = $Age
        Department = $Department
    }

    if ($Detailed) {
        $info | Add-Member -NotePropertyName "CreatedDate" -NotePropertyValue (Get-Date)
    }

    return $info
}

# ä½¿ç”¨ç¤ºä¾‹
Get-UserInfo -Username "zhangsan" -Age 25 -Department "IT" -Detailed
</code></pre>
<p><strong>å‚æ•°éªŒè¯</strong></p>
<pre><code class="language-powershell">function Test-Parameters {
    param(
        # å¿…éœ€å‚æ•°
        [Parameter(Mandatory=$true)]
        [string]$Name,

        # èŒƒå›´éªŒè¯
        [ValidateRange(18, 65)]
        [int]$Age,

        # é•¿åº¦éªŒè¯
        [ValidateLength(6, 20)]
        [string]$Password,

        # æ¨¡å¼éªŒè¯
        [ValidatePattern('^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$')]
        [string]$Email,

        # é›†åˆéªŒè¯
        [ValidateSet("Red", "Green", "Blue")]
        [string]$Color,

        # è„šæœ¬éªŒè¯
        [ValidateScript({Test-Path $_})]
        [string]$FilePath
    )

    Write-Host "å‚æ•°éªŒè¯é€šè¿‡"
}
</code></pre>
<p><strong>ç®¡é“æ”¯æŒ</strong></p>
<pre><code class="language-powershell">function Process-Item {
    [CmdletBinding()]
    param(
        [Parameter(ValueFromPipeline=$true)]
        [string]$InputObject
    )

    begin {
        Write-Host "å¼€å§‹å¤„ç†"
    }

    process {
        Write-Host "å¤„ç†: $InputObject"
    }

    end {
        Write-Host "å¤„ç†å®Œæˆ"
    }
}

# ä½¿ç”¨ç®¡é“
"Item1", "Item2", "Item3" | Process-Item
</code></pre>
<h3 id="54-é”™è¯¯å¤„ç†"><a class="header" href="#54-é”™è¯¯å¤„ç†">5.4 é”™è¯¯å¤„ç†</a></h3>
<p><strong>Try-Catch-Finally</strong></p>
<pre><code class="language-powershell"># åŸºæœ¬é”™è¯¯å¤„ç†
try {
    Get-Content "C:\nonexistent.txt" -ErrorAction Stop
} catch {
    Write-Host "å‘ç”Ÿé”™è¯¯: $($_.Exception.Message)" -ForegroundColor Red
}

# æ•è·ç‰¹å®šå¼‚å¸¸
try {
    $result = 1 / 0
} catch [System.DivideByZeroException] {
    Write-Host "é™¤æ•°ä¸èƒ½ä¸ºé›¶"
} catch {
    Write-Host "å…¶ä»–é”™è¯¯: $_"
}

# Finallyå—ï¼ˆæ€»æ˜¯æ‰§è¡Œï¼‰
try {
    $file = [System.IO.File]::OpenRead("C:\file.txt")
    # å¤„ç†æ–‡ä»¶
} catch {
    Write-Host "æ–‡ä»¶å¤„ç†é”™è¯¯: $_"
} finally {
    if ($file) {
        $file.Close()
        Write-Host "æ–‡ä»¶å·²å…³é—­"
    }
}
</code></pre>
<p><strong>é”™è¯¯å¤„ç†é¦–é€‰é¡¹</strong></p>
<pre><code class="language-powershell"># ErrorActionPreference å˜é‡
$ErrorActionPreference = "Stop"      # é‡é”™å³åœ
$ErrorActionPreference = "Continue"  # æ˜¾ç¤ºé”™è¯¯ä½†ç»§ç»­ï¼ˆé»˜è®¤ï¼‰
$ErrorActionPreference = "SilentlyContinue"  # é™é»˜å¿½ç•¥é”™è¯¯
$ErrorActionPreference = "Inquire"   # è¯¢é—®ç”¨æˆ·

# å•ä¸ªCmdletçš„ErrorAction
Get-Content "nonexistent.txt" -ErrorAction SilentlyContinue
Get-Content "nonexistent.txt" -ErrorAction Stop

# é”™è¯¯å˜é‡
Get-Content "nonexistent.txt" -ErrorAction SilentlyContinue -ErrorVariable err
if ($err) {
    Write-Host "æ•è·åˆ°é”™è¯¯: $err"
}

# è®¿é—®é”™è¯¯å¯¹è±¡
$Error[0]                    # æœ€è¿‘çš„é”™è¯¯
$Error.Count                 # é”™è¯¯æ•°é‡
$Error.Clear()               # æ¸…ç©ºé”™è¯¯
</code></pre>
<p><strong>å®æˆ˜æ¡ˆä¾‹ï¼šå¥å£®çš„æ–‡ä»¶å¤„ç†å‡½æ•°</strong></p>
<pre><code class="language-powershell">function Copy-FileSafe {
    [CmdletBinding()]
    param(
        [Parameter(Mandatory=$true)]
        [ValidateScript({Test-Path $_})]
        [string]$Source,

        [Parameter(Mandatory=$true)]
        [string]$Destination,

        [switch]$Force
    )

    try {
        # éªŒè¯æºæ–‡ä»¶
        if (-not (Test-Path $Source)) {
            throw "æºæ–‡ä»¶ä¸å­˜åœ¨: $Source"
        }

        # æ£€æŸ¥ç›®æ ‡ç›®å½•
        $destDir = Split-Path $Destination -Parent
        if (-not (Test-Path $destDir)) {
            New-Item -Path $destDir -ItemType Directory -Force | Out-Null
            Write-Verbose "å·²åˆ›å»ºç›®æ ‡ç›®å½•: $destDir"
        }

        # æ£€æŸ¥ç›®æ ‡æ–‡ä»¶æ˜¯å¦å­˜åœ¨
        if ((Test-Path $Destination) -and -not $Force) {
            $response = Read-Host "ç›®æ ‡æ–‡ä»¶å·²å­˜åœ¨ï¼Œæ˜¯å¦è¦†ç›–? (Y/N)"
            if ($response -ne "Y") {
                Write-Host "æ“ä½œå·²å–æ¶ˆ"
                return
            }
        }

        # æ‰§è¡Œå¤åˆ¶
        Copy-Item -Path $Source -Destination $Destination -Force
        Write-Host "æ–‡ä»¶å·²æˆåŠŸå¤åˆ¶åˆ°: $Destination" -ForegroundColor Green

        # éªŒè¯å¤åˆ¶ç»“æœ
        $sourceHash = (Get-FileHash $Source).Hash
        $destHash = (Get-FileHash $Destination).Hash

        if ($sourceHash -eq $destHash) {
            Write-Verbose "æ–‡ä»¶å®Œæ•´æ€§éªŒè¯é€šè¿‡"
        } else {
            throw "æ–‡ä»¶å¤åˆ¶åå“ˆå¸Œå€¼ä¸åŒ¹é…"
        }

    } catch {
        Write-Error "å¤åˆ¶æ–‡ä»¶æ—¶å‘ç”Ÿé”™è¯¯: $($_.Exception.Message)"
        throw
    }
}

# ä½¿ç”¨ç¤ºä¾‹
Copy-FileSafe -Source "C:\source.txt" -Destination "D:\backup\source.txt" -Verbose
</code></pre>
<hr />
<h2 id="ç¬¬å…­ç« è¿œç¨‹ç®¡ç†"><a class="header" href="#ç¬¬å…­ç« è¿œç¨‹ç®¡ç†">ç¬¬å…­ç« ï¼šè¿œç¨‹ç®¡ç†</a></h2>
<h3 id="61-powershell-remotingé…ç½®"><a class="header" href="#61-powershell-remotingé…ç½®">6.1 PowerShell Remotingé…ç½®</a></h3>
<p><strong>å¯ç”¨è¿œç¨‹ç®¡ç†</strong></p>
<pre><code class="language-powershell"># åœ¨ç›®æ ‡è®¡ç®—æœºä¸Šå¯ç”¨è¿œç¨‹ç®¡ç†ï¼ˆéœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰
Enable-PSRemoting -Force

# é…ç½®è¯´æ˜
# 1. å¯åŠ¨WinRMæœåŠ¡
# 2. å°†WinRMæœåŠ¡è®¾ä¸ºè‡ªåŠ¨å¯åŠ¨
# 3. åˆ›å»ºHTTPç›‘å¬å™¨
# 4. é…ç½®é˜²ç«å¢™è§„åˆ™

# éªŒè¯é…ç½®
Test-WSMan -ComputerName localhost

# æŸ¥çœ‹WinRMé…ç½®
Get-Item WSMan:\localhost\Client\TrustedHosts

# æ·»åŠ ä¿¡ä»»çš„ä¸»æœºï¼ˆéåŸŸç¯å¢ƒï¼‰
Set-Item WSMan:\localhost\Client\TrustedHosts -Value "192.168.1.100" -Force
# æˆ–æ·»åŠ æ‰€æœ‰ä¸»æœºï¼ˆä¸æ¨èï¼‰
Set-Item WSMan:\localhost\Client\TrustedHosts -Value "*" -Force
</code></pre>
<h3 id="62-è¿œç¨‹ä¼šè¯"><a class="header" href="#62-è¿œç¨‹ä¼šè¯">6.2 è¿œç¨‹ä¼šè¯</a></h3>
<p><strong>ä¸€å¯¹ä¸€è¿œç¨‹ä¼šè¯</strong></p>
<pre><code class="language-powershell"># è¿›å…¥äº¤äº’å¼è¿œç¨‹ä¼šè¯
Enter-PSSession -ComputerName "Server01"

# ä½¿ç”¨å‡­æ®
$cred = Get-Credential
Enter-PSSession -ComputerName "Server01" -Credential $cred

# æ‰§è¡Œå‘½ä»¤åé€€å‡º
Exit-PSSession

# æˆ–æŒ‰ Ctrl+C é€€å‡º
</code></pre>
<p><strong>ä¸€å¯¹å¤šè¿œç¨‹æ‰§è¡Œ</strong></p>
<pre><code class="language-powershell"># åœ¨å•å°è®¡ç®—æœºä¸Šæ‰§è¡Œå‘½ä»¤
Invoke-Command -ComputerName "Server01" -ScriptBlock {
    Get-Service | Where-Object Status -eq "Running"
}

# åœ¨å¤šå°è®¡ç®—æœºä¸Šæ‰§è¡Œ
$servers = "Server01", "Server02", "Server03"
Invoke-Command -ComputerName $servers -ScriptBlock {
    Get-Process | Where-Object CPU -gt 100
}

# ä¼ é€’å‚æ•°
Invoke-Command -ComputerName "Server01" -ScriptBlock {
    param($ServiceName)
    Get-Service -Name $ServiceName
} -ArgumentList "wuauserv"

# æ‰§è¡Œæœ¬åœ°è„šæœ¬
Invoke-Command -ComputerName "Server01" -FilePath "C:\Scripts\Check-System.ps1"

# ä½¿ç”¨å‡­æ®
$cred = Get-Credential
Invoke-Command -ComputerName "Server01" -Credential $cred -ScriptBlock {
    Get-EventLog -LogName System -Newest 10
}
</code></pre>
<p><strong>æŒä¹…ä¼šè¯</strong></p>
<pre><code class="language-powershell"># åˆ›å»ºæŒä¹…ä¼šè¯
$session = New-PSSession -ComputerName "Server01"

# åœ¨ä¼šè¯ä¸­æ‰§è¡Œå¤šä¸ªå‘½ä»¤
Invoke-Command -Session $session -ScriptBlock {
    $env:COMPUTERNAME
}

Invoke-Command -Session $session -ScriptBlock {
    Get-Service
}

# å¤åˆ¶æ–‡ä»¶åˆ°è¿œç¨‹
Copy-Item -Path "C:\local\file.txt" -Destination "C:\remote\" -ToSession $session

# ä»è¿œç¨‹å¤åˆ¶æ–‡ä»¶
Copy-Item -Path "C:\remote\file.txt" -Destination "C:\local\" -FromSession $session

# æ–­å¼€ä¼šè¯ï¼ˆä½†ä¸å…³é—­ï¼‰
Disconnect-PSSession -Session $session

# é‡æ–°è¿æ¥
$session = Get-PSSession -ComputerName "Server01"
Connect-PSSession -Session $session

# å…³é—­ä¼šè¯
Remove-PSSession -Session $session
</code></pre>
<h3 id="63-å®æˆ˜æ¡ˆä¾‹æ‰¹é‡æœåŠ¡å™¨ç®¡ç†"><a class="header" href="#63-å®æˆ˜æ¡ˆä¾‹æ‰¹é‡æœåŠ¡å™¨ç®¡ç†">6.3 å®æˆ˜æ¡ˆä¾‹ï¼šæ‰¹é‡æœåŠ¡å™¨ç®¡ç†</a></h3>
<p><strong>æ‰¹é‡æ£€æŸ¥æœåŠ¡å™¨çŠ¶æ€</strong></p>
<pre><code class="language-powershell"># server_health_check.ps1

param(
    [Parameter(Mandatory=$true)]
    [string[]]$Servers,

    [PSCredential]$Credential
)

$results = @()

foreach ($server in $Servers) {
    Write-Host "æ£€æŸ¥æœåŠ¡å™¨: $server" -ForegroundColor Cyan

    try {
        $info = Invoke-Command -ComputerName $server -Credential $Credential -ScriptBlock {
            # CPUä½¿ç”¨ç‡
            $cpu = (Get-CimInstance Win32_Processor).LoadPercentage

            # å†…å­˜ä½¿ç”¨ç‡
            $os = Get-CimInstance Win32_OperatingSystem
            $memPercent = [math]::Round(($os.TotalVisibleMemorySize - $os.FreePhysicalMemory) / $os.TotalVisibleMemorySize * 100, 2)

            # ç£ç›˜ä½¿ç”¨ç‡
            $disks = Get-CimInstance Win32_LogicalDisk -Filter "DriveType=3" | ForEach-Object {
                [PSCustomObject]@{
                    Drive = $_.DeviceID
                    UsedPercent = [math]::Round(($_.Size - $_.FreeSpace) / $_.Size * 100, 2)
                }
            }

            # è¿è¡ŒæœåŠ¡æ•°
            $services = (Get-Service | Where-Object Status -eq "Running").Count

            [PSCustomObject]@{
                ComputerName = $env:COMPUTERNAME
                CPU = $cpu
                MemoryPercent = $memPercent
                Disks = $disks
                RunningServices = $services
                CheckTime = Get-Date -Format "yyyy-MM-dd HH:mm:ss"
                Status = "Online"
            }
        } -ErrorAction Stop

        $results += $info

        # å‘Šè­¦æ£€æŸ¥
        if ($info.CPU -gt 80) {
            Write-Warning "$server - CPUä½¿ç”¨ç‡è¿‡é«˜: $($info.CPU)%"
        }
        if ($info.MemoryPercent -gt 90) {
            Write-Warning "$server - å†…å­˜ä½¿ç”¨ç‡è¿‡é«˜: $($info.MemoryPercent)%"
        }

    } catch {
        Write-Error "æ— æ³•è¿æ¥åˆ° $server : $_"
        $results += [PSCustomObject]@{
            ComputerName = $server
            Status = "Offline"
            CheckTime = Get-Date -Format "yyyy-MM-dd HH:mm:ss"
            Error = $_.Exception.Message
        }
    }
}

# ç”ŸæˆæŠ¥å‘Š
$results | Export-Csv -Path "ServerHealthReport_$(Get-Date -Format 'yyyyMMdd_HHmmss').csv" -NoTypeInformation
$results | Format-Table -AutoSize

Write-Host "`næ£€æŸ¥å®Œæˆï¼æŠ¥å‘Šå·²ä¿å­˜ã€‚" -ForegroundColor Green
</code></pre>
<p><strong>æ‰¹é‡éƒ¨ç½²é…ç½®</strong></p>
<pre><code class="language-powershell"># deploy_config.ps1

param(
    [string[]]$Servers,
    [string]$ConfigFile,
    [PSCredential]$Credential
)

# è¯»å–é…ç½®æ–‡ä»¶
$configContent = Get-Content $ConfigFile -Raw

# åˆ›å»ºä¼šè¯
$sessions = New-PSSession -ComputerName $Servers -Credential $Credential

try {
    # æ‰¹é‡æ‰§è¡Œéƒ¨ç½²
    Invoke-Command -Session $sessions -ScriptBlock {
        param($Config)

        # åˆ›å»ºç›®æ ‡ç›®å½•
        $targetDir = "C:\AppConfig"
        if (-not (Test-Path $targetDir)) {
            New-Item -Path $targetDir -ItemType Directory -Force
        }

        # å†™å…¥é…ç½®æ–‡ä»¶
        $Config | Out-File -FilePath "$targetDir\app.config" -Force

        # é‡å¯ç›¸å…³æœåŠ¡
        Restart-Service -Name "MyAppService" -Force

        Write-Output "$env:COMPUTERNAME - é…ç½®éƒ¨ç½²å®Œæˆ"

    } -ArgumentList $configContent

    Write-Host "æ‰€æœ‰æœåŠ¡å™¨éƒ¨ç½²å®Œæˆ" -ForegroundColor Green

} finally {
    # æ¸…ç†ä¼šè¯
    Remove-PSSession -Session $sessions
}
</code></pre>
<hr />
<h2 id="ç¬¬ä¸ƒç« æ¨¡å—ä¸åŒ…ç®¡ç†"><a class="header" href="#ç¬¬ä¸ƒç« æ¨¡å—ä¸åŒ…ç®¡ç†">ç¬¬ä¸ƒç« ï¼šæ¨¡å—ä¸åŒ…ç®¡ç†</a></h2>
<h3 id="71-æ¨¡å—åŸºç¡€"><a class="header" href="#71-æ¨¡å—åŸºç¡€">7.1 æ¨¡å—åŸºç¡€</a></h3>
<p><strong>æŸ¥æ‰¾å’Œå¯¼å…¥æ¨¡å—</strong></p>
<pre><code class="language-powershell"># åˆ—å‡ºå¯ç”¨æ¨¡å—
Get-Module -ListAvailable

# æŸ¥çœ‹å·²å¯¼å…¥çš„æ¨¡å—
Get-Module

# å¯¼å…¥æ¨¡å—
Import-Module ActiveDirectory
Import-Module -Name "C:\MyModule\MyModule.psm1"

# æŸ¥çœ‹æ¨¡å—ä¸­çš„å‘½ä»¤
Get-Command -Module ActiveDirectory

# ç§»é™¤æ¨¡å—
Remove-Module ActiveDirectory
</code></pre>
<p><strong>åˆ›å»ºç®€å•æ¨¡å—</strong></p>
<pre><code class="language-powershell"># MyTools.psm1

function Get-SystemInfo {
    [PSCustomObject]@{
        ComputerName = $env:COMPUTERNAME
        OSVersion = (Get-CimInstance Win32_OperatingSystem).Caption
        PowerShellVersion = $PSVersionTable.PSVersion
        Uptime = (Get-CimInstance Win32_OperatingSystem).LastBootUpTime
    }
}

function Test-IsAdmin {
    $currentPrincipal = New-Object Security.Principal.WindowsPrincipal([Security.Principal.WindowsIdentity]::GetCurrent())
    $currentPrincipal.IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)
}

# å¯¼å‡ºå‡½æ•°
Export-ModuleMember -Function Get-SystemInfo, Test-IsAdmin
</code></pre>
<p><strong>æ¨¡å—æ¸…å•</strong></p>
<pre><code class="language-powershell"># åˆ›å»ºæ¨¡å—æ¸…å•
New-ModuleManifest -Path "MyTools.psd1" `
    -RootModule "MyTools.psm1" `
    -ModuleVersion "1.0.0" `
    -Author "Your Name" `
    -Description "My PowerShell Tools" `
    -PowerShellVersion "5.1" `
    -FunctionsToExport @("Get-SystemInfo", "Test-IsAdmin")
</code></pre>
<h3 id="72-powershell-gallery"><a class="header" href="#72-powershell-gallery">7.2 PowerShell Gallery</a></h3>
<p><strong>ä½¿ç”¨PowerShell Gallery</strong></p>
<pre><code class="language-powershell"># æŸ¥æ‰¾æ¨¡å—
Find-Module -Name "PSReadLine"
Find-Module -Tag "Active Directory"

# å®‰è£…æ¨¡å—
Install-Module -Name PSReadLine -Scope CurrentUser

# ä»¥ç®¡ç†å‘˜èº«ä»½å®‰è£…ï¼ˆå…¨å±€ï¼‰
Install-Module -Name PSReadLine -Scope AllUsers

# æ›´æ–°æ¨¡å—
Update-Module -Name PSReadLine

# å¸è½½æ¨¡å—
Uninstall-Module -Name PSReadLine

# æŸ¥çœ‹å·²å®‰è£…æ¨¡å—
Get-InstalledModule
</code></pre>
<p><strong>å¸¸ç”¨æ¨¡å—æ¨è</strong></p>
<pre><code class="language-powershell"># PSReadLine - å¢å¼ºå‘½ä»¤è¡Œç¼–è¾‘
Install-Module -Name PSReadLine -Force

# Posh-Git - Gité›†æˆ
Install-Module -Name posh-git -Force

# PowerShellGet - æ¨¡å—ç®¡ç†ï¼ˆå†…ç½®ï¼‰

# Az - Azureç®¡ç†
Install-Module -Name Az -AllowClobber -Scope CurrentUser

# SqlServer - SQL Serverç®¡ç†
Install-Module -Name SqlServer
</code></pre>
<hr />
<h2 id="ç¬¬å…«ç« é«˜çº§ç‰¹æ€§"><a class="header" href="#ç¬¬å…«ç« é«˜çº§ç‰¹æ€§">ç¬¬å…«ç« ï¼šé«˜çº§ç‰¹æ€§</a></h2>
<h3 id="81-æ­£åˆ™è¡¨è¾¾å¼"><a class="header" href="#81-æ­£åˆ™è¡¨è¾¾å¼">8.1 æ­£åˆ™è¡¨è¾¾å¼</a></h3>
<p><strong>æ­£åˆ™è¡¨è¾¾å¼åŸºç¡€</strong></p>
<pre><code class="language-powershell"># -match æ“ä½œç¬¦
"Hello123" -match "^\w+\d+$"  # True

# æ•è·ç»„
$text = "Email: test@example.com"
if ($text -match "(\w+)@(\w+\.\w+)") {
    $Matches[0]  # å®Œæ•´åŒ¹é…: test@example.com
    $Matches[1]  # ç¬¬ä¸€ç»„: test
    $Matches[2]  # ç¬¬äºŒç»„: example.com
}

# Select-Stringï¼ˆç±»ä¼¼grepï¼‰
Get-Content "log.txt" | Select-String -Pattern "error" -CaseSensitive

# æ›¿æ¢
"Hello World" -replace "World", "PowerShell"

# æ­£åˆ™æ›¿æ¢
$text = "Phone: 123-456-7890"
$text -replace "(\d{3})-(\d{3})-(\d{4})", "($1) $2-$3"
# ç»“æœ: Phone: (123) 456-7890
</code></pre>
<p><strong>å®æˆ˜æ¡ˆä¾‹ï¼šæ—¥å¿—åˆ†æ</strong></p>
<pre><code class="language-powershell"># analyze_log.ps1

param(
    [string]$LogFile
)

# åŒ¹é…æ¨¡å¼
$errorPattern = '\[ERROR\].*'
$warningPattern = '\[WARNING\].*'
$ipPattern = '\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}'

# è¯»å–æ—¥å¿—
$content = Get-Content $LogFile

# ç»Ÿè®¡é”™è¯¯å’Œè­¦å‘Š
$errors = $content | Select-String -Pattern $errorPattern -AllMatches
$warnings = $content | Select-String -Pattern $warningPattern -AllMatches

Write-Host "é”™è¯¯æ•°é‡: $($errors.Count)" -ForegroundColor Red
Write-Host "è­¦å‘Šæ•°é‡: $($warnings.Count)" -ForegroundColor Yellow

# æå–æ‰€æœ‰IPåœ°å€
$ips = $content | Select-String -Pattern $ipPattern -AllMatches |
    ForEach-Object { $_.Matches.Value } |
    Group-Object |
    Sort-Object Count -Descending

Write-Host "`nTOP 10 IPåœ°å€:" -ForegroundColor Cyan
$ips | Select-Object -First 10 Count, Name | Format-Table -AutoSize
</code></pre>
<h3 id="82-å¹¶è¡Œå¤„ç†"><a class="header" href="#82-å¹¶è¡Œå¤„ç†">8.2 å¹¶è¡Œå¤„ç†</a></h3>
<p><strong>ForEach-Object -Parallelï¼ˆPowerShell 7+ï¼‰</strong></p>
<pre><code class="language-powershell"># ä¸²è¡Œå¤„ç†
$servers = 1..10 | ForEach-Object { "Server$_" }

$results = $servers | ForEach-Object {
    Start-Sleep -Seconds 2
    Test-Connection -ComputerName $_ -Count 1 -Quiet
}

# å¹¶è¡Œå¤„ç†
$results = $servers | ForEach-Object -Parallel {
    Start-Sleep -Seconds 2
    Test-Connection -ComputerName $_ -Count 1 -Quiet
} -ThrottleLimit 5

# å¹¶è¡Œå¤„ç†æ—¶ä½¿ç”¨å¤–éƒ¨å˜é‡
$timeout = 5

$results = $servers | ForEach-Object -Parallel {
    Test-Connection -ComputerName $_ -Count 1 -Quiet -TimeoutSeconds $using:timeout
}
</code></pre>
<p><strong>åå°ä½œä¸š</strong></p>
<pre><code class="language-powershell"># å¯åŠ¨åå°ä½œä¸š
$job = Start-Job -ScriptBlock {
    Get-Process | Where-Object CPU -gt 100
}

# æŸ¥çœ‹ä½œä¸šçŠ¶æ€
Get-Job

# ç­‰å¾…ä½œä¸šå®Œæˆ
Wait-Job -Job $job

# è·å–ä½œä¸šç»“æœ
$result = Receive-Job -Job $job

# åˆ é™¤ä½œä¸š
Remove-Job -Job $job

# æ‰¹é‡ä½œä¸š
$servers = "Server01", "Server02", "Server03"

$jobs = $servers | ForEach-Object {
    Start-Job -ScriptBlock {
        param($Server)
        Test-Connection -ComputerName $Server -Count 4
    } -ArgumentList $_
}

# ç­‰å¾…æ‰€æœ‰ä½œä¸šå®Œæˆ
Wait-Job -Job $jobs

# æ”¶é›†ç»“æœ
$results = $jobs | Receive-Job

# æ¸…ç†
$jobs | Remove-Job
</code></pre>
<h3 id="83-neté›†æˆ"><a class="header" href="#83-neté›†æˆ">8.3 .NETé›†æˆ</a></h3>
<p><strong>è°ƒç”¨.NETç±»</strong></p>
<pre><code class="language-powershell"># ä½¿ç”¨ [ç±»å‹] è¯­æ³•
[System.DateTime]::Now
[System.Math]::Pi
[System.Math]::Round(3.14159, 2)

# åˆ›å»º.NETå¯¹è±¡
$uri = New-Object System.Uri("https://www.example.com")
$uri.Host
$uri.Scheme

# ä½¿ç”¨ç±»å‹åŠ é€Ÿå™¨
[datetime]::Now
[math]::Sqrt(16)
[string]::IsNullOrEmpty($var)

# è°ƒç”¨é™æ€æ–¹æ³•
[System.IO.Path]::GetFileName("C:\Folder\file.txt")
[System.IO.Path]::GetExtension("file.txt")
[System.IO.Directory]::Exists("C:\Folder")

# æ–‡ä»¶æ“ä½œ
$content = [System.IO.File]::ReadAllText("C:\file.txt")
[System.IO.File]::WriteAllText("C:\output.txt", "Content")

# æ­£åˆ™è¡¨è¾¾å¼
$regex = [regex]::new("^\d+$")
$regex.IsMatch("12345")
</code></pre>
<p><strong>Windows Forms</strong></p>
<pre><code class="language-powershell"># åŠ è½½ç¨‹åºé›†
Add-Type -AssemblyName System.Windows.Forms

# åˆ›å»ºçª—ä½“
$form = New-Object System.Windows.Forms.Form
$form.Text = "PowerShell GUI"
$form.Size = New-Object System.Drawing.Size(300, 200)
$form.StartPosition = "CenterScreen"

# æ·»åŠ æŒ‰é’®
$button = New-Object System.Windows.Forms.Button
$button.Location = New-Object System.Drawing.Point(75, 70)
$button.Size = New-Object System.Drawing.Size(150, 30)
$button.Text = "ç‚¹å‡»æˆ‘"
$button.Add_Click({
    [System.Windows.Forms.MessageBox]::Show("ä½ ç‚¹å‡»äº†æŒ‰é’®ï¼")
})

$form.Controls.Add($button)

# æ˜¾ç¤ºçª—ä½“
$form.ShowDialog()
</code></pre>
<hr />
<h2 id="ç¬¬ä¹ç« å®é™…åº”ç”¨"><a class="header" href="#ç¬¬ä¹ç« å®é™…åº”ç”¨">ç¬¬ä¹ç« ï¼šå®é™…åº”ç”¨</a></h2>
<h3 id="91-æ–‡ä»¶ç®¡ç†å·¥å…·"><a class="header" href="#91-æ–‡ä»¶ç®¡ç†å·¥å…·">9.1 æ–‡ä»¶ç®¡ç†å·¥å…·</a></h3>
<p><strong>æ‰¹é‡æ–‡ä»¶é‡å‘½å</strong></p>
<pre><code class="language-powershell"># rename_files.ps1

param(
    [string]$Path = ".",
    [string]$Pattern,
    [string]$Replacement,
    [switch]$WhatIf
)

Get-ChildItem -Path $Path -Filter $Pattern | ForEach-Object {
    $newName = $_.Name -replace $Pattern, $Replacement

    if ($WhatIf) {
        Write-Host "æ¨¡æ‹Ÿ: $($_.Name) -&gt; $newName"
    } else {
        Rename-Item -Path $_.FullName -NewName $newName
        Write-Host "å·²é‡å‘½å: $($_.Name) -&gt; $newName" -ForegroundColor Green
    }
}
</code></pre>
<p><strong>æ–‡ä»¶æ•´ç†å·¥å…·</strong></p>
<pre><code class="language-powershell"># organize_files.ps1

param(
    [string]$SourcePath = ".",
    [string]$DestinationPath = ".\Organized"
)

# åˆ›å»ºç›®æ ‡ç›®å½•
$categories = @{
    "Images" = @("*.jpg", "*.jpeg", "*.png", "*.gif", "*.bmp")
    "Documents" = @("*.doc", "*.docx", "*.pdf", "*.txt", "*.xlsx")
    "Videos" = @("*.mp4", "*.avi", "*.mkv", "*.mov")
    "Archives" = @("*.zip", "*.rar", "*.7z", "*.tar", "*.gz")
    "Scripts" = @("*.ps1", "*.bat", "*.cmd", "*.sh")
}

foreach ($category in $categories.Keys) {
    $targetDir = Join-Path $DestinationPath $category
    New-Item -Path $targetDir -ItemType Directory -Force | Out-Null
}

# æ•´ç†æ–‡ä»¶
foreach ($category in $categories.Keys) {
    $targetDir = Join-Path $DestinationPath $category

    foreach ($pattern in $categories[$category]) {
        Get-ChildItem -Path $SourcePath -Filter $pattern -File | ForEach-Object {
            $destination = Join-Path $targetDir $_.Name

            Move-Item -Path $_.FullName -Destination $destination
            Write-Host "å·²ç§»åŠ¨: $($_.Name) -&gt; $category" -ForegroundColor Cyan
        }
    }
}

Write-Host "`næ–‡ä»¶æ•´ç†å®Œæˆï¼" -ForegroundColor Green
</code></pre>
<h3 id="92-ç³»ç»Ÿç›‘æ§è„šæœ¬"><a class="header" href="#92-ç³»ç»Ÿç›‘æ§è„šæœ¬">9.2 ç³»ç»Ÿç›‘æ§è„šæœ¬</a></h3>
<p><strong>è¿›ç¨‹ç›‘æ§</strong></p>
<pre><code class="language-powershell"># process_monitor.ps1

param(
    [string]$ProcessName,
    [int]$CheckInterval = 10,
    [string]$LogFile = "process_monitor.log"
)

function Write-Log {
    param([string]$Message)
    $timestamp = Get-Date -Format "yyyy-MM-dd HH:mm:ss"
    "$timestamp - $Message" | Out-File -FilePath $LogFile -Append
    Write-Host "[$timestamp] $Message"
}

Write-Log "å¼€å§‹ç›‘æ§è¿›ç¨‹: $ProcessName"

while ($true) {
    $process = Get-Process -Name $ProcessName -ErrorAction SilentlyContinue

    if ($process) {
        Write-Log "è¿›ç¨‹è¿è¡Œä¸­ - CPU: $([math]::Round($process.CPU, 2))s, å†…å­˜: $([math]::Round($process.WorkingSet/1MB, 2))MB"
    } else {
        Write-Log "è­¦å‘Š: è¿›ç¨‹æœªè¿è¡Œï¼Œå°è¯•é‡å¯..."

        try {
            Start-Process -FilePath "$ProcessName.exe"
            Write-Log "è¿›ç¨‹å·²é‡å¯"
        } catch {
            Write-Log "é”™è¯¯: æ— æ³•é‡å¯è¿›ç¨‹ - $_"
        }
    }

    Start-Sleep -Seconds $CheckInterval
}
</code></pre>
<p><strong>ç£ç›˜ç©ºé—´ç›‘æ§</strong></p>
<pre><code class="language-powershell"># disk_monitor.ps1

param(
    [int]$ThresholdPercent = 90,
    [string]$EmailTo,
    [string]$SmtpServer
)

function Send-Alert {
    param(
        [string]$Subject,
        [string]$Body
    )

    if ($EmailTo -and $SmtpServer) {
        Send-MailMessage -To $EmailTo `
            -From "diskmonitor@company.com" `
            -Subject $Subject `
            -Body $Body `
            -SmtpServer $SmtpServer
    }
}

# æ£€æŸ¥æ‰€æœ‰ç£ç›˜
$disks = Get-CimInstance Win32_LogicalDisk -Filter "DriveType=3"

foreach ($disk in $disks) {
    $usedPercent = [math]::Round(($disk.Size - $disk.FreeSpace) / $disk.Size * 100, 2)

    Write-Host "$($disk.DeviceID) - å·²ä½¿ç”¨: $usedPercent%" -ForegroundColor $(
        if ($usedPercent -gt $ThresholdPercent) { "Red" }
        elseif ($usedPercent -gt 80) { "Yellow" }
        else { "Green" }
    )

    if ($usedPercent -gt $ThresholdPercent) {
        $message = @"
è­¦å‘Šï¼šç£ç›˜ç©ºé—´ä¸è¶³

é©±åŠ¨å™¨: $($disk.DeviceID)
æ€»å®¹é‡: $([math]::Round($disk.Size/1GB, 2)) GB
å‰©ä½™ç©ºé—´: $([math]::Round($disk.FreeSpace/1GB, 2)) GB
ä½¿ç”¨ç‡: $usedPercent%

è¯·åŠæ—¶æ¸…ç†ç£ç›˜ç©ºé—´ï¼
"@

        Write-Warning $message
        Send-Alert -Subject "ç£ç›˜ç©ºé—´å‘Šè­¦ - $($disk.DeviceID)" -Body $message
    }
}
</code></pre>
<h3 id="93-active-directoryç®¡ç†"><a class="header" href="#93-active-directoryç®¡ç†">9.3 Active Directoryç®¡ç†</a></h3>
<p><strong>æ‰¹é‡åˆ›å»ºç”¨æˆ·</strong></p>
<pre><code class="language-powershell"># create_users.ps1

Import-Module ActiveDirectory

$users = Import-Csv -Path "users.csv"

foreach ($user in $users) {
    $params = @{
        Name = $user.Name
        GivenName = $user.FirstName
        Surname = $user.LastName
        SamAccountName = $user.Username
        UserPrincipalName = "$($user.Username)@domain.com"
        Path = "OU=Users,DC=domain,DC=com"
        AccountPassword = (ConvertTo-SecureString "P@ssw0rd123" -AsPlainText -Force)
        Enabled = $true
        ChangePasswordAtLogon = $true
    }

    try {
        New-ADUser @params
        Write-Host "å·²åˆ›å»ºç”¨æˆ·: $($user.Name)" -ForegroundColor Green

        # æ·»åŠ åˆ°ç»„
        if ($user.Group) {
            Add-ADGroupMember -Identity $user.Group -Members $user.Username
            Write-Host "  å·²æ·»åŠ åˆ°ç»„: $($user.Group)"
        }
    } catch {
        Write-Error "åˆ›å»ºç”¨æˆ·å¤±è´¥: $($user.Name) - $_"
    }
}
</code></pre>
<p><strong>ç”¨æˆ·æŠ¥å‘Š</strong></p>
<pre><code class="language-powershell"># user_report.ps1

Import-Module ActiveDirectory

# è·å–æ‰€æœ‰ç”¨æˆ·
$users = Get-ADUser -Filter * -Properties *

# ç”ŸæˆæŠ¥å‘Š
$report = $users | ForEach-Object {
    [PSCustomObject]@{
        ç”¨æˆ·å = $_.SamAccountName
        å§“å = $_.Name
        é‚®ç®± = $_.EmailAddress
        éƒ¨é—¨ = $_.Department
        èŒä½ = $_.Title
        åˆ›å»ºæ—¥æœŸ = $_.Created
        æœ€åç™»å½• = $_.LastLogonDate
        å¯†ç è¿‡æœŸ = $_.PasswordExpired
        è´¦æˆ·çŠ¶æ€ = if ($_.Enabled) { "å¯ç”¨" } else { "ç¦ç”¨" }
    }
}

# å¯¼å‡ºæŠ¥å‘Š
$report | Export-Csv -Path "AD_Users_Report_$(Get-Date -Format 'yyyyMMdd').csv" -NoTypeInformation -Encoding UTF8
$report | Out-GridView -Title "Active Directory ç”¨æˆ·æŠ¥å‘Š"

Write-Host "æŠ¥å‘Šå·²ç”Ÿæˆ" -ForegroundColor Green
</code></pre>
<h3 id="94-è‡ªåŠ¨åŒ–å¤‡ä»½"><a class="header" href="#94-è‡ªåŠ¨åŒ–å¤‡ä»½">9.4 è‡ªåŠ¨åŒ–å¤‡ä»½</a></h3>
<p><strong>æ•°æ®åº“å¤‡ä»½</strong></p>
<pre><code class="language-powershell"># backup_database.ps1

param(
    [string]$ServerInstance = "localhost",
    [string]$Database,
    [string]$BackupPath = "C:\Backups",
    [int]$RetentionDays = 7
)

Import-Module SqlServer

# åˆ›å»ºå¤‡ä»½ç›®å½•
if (-not (Test-Path $BackupPath)) {
    New-Item -Path $BackupPath -ItemType Directory -Force
}

# ç”Ÿæˆå¤‡ä»½æ–‡ä»¶å
$timestamp = Get-Date -Format "yyyyMMdd_HHmmss"
$backupFile = Join-Path $BackupPath "${Database}_${timestamp}.bak"

try {
    # æ‰§è¡Œå¤‡ä»½
    Backup-SqlDatabase -ServerInstance $ServerInstance `
        -Database $Database `
        -BackupFile $backupFile `
        -CompressionOption On

    Write-Host "æ•°æ®åº“å¤‡ä»½æˆåŠŸ: $backupFile" -ForegroundColor Green

    # æ¸…ç†æ—§å¤‡ä»½
    Get-ChildItem -Path $BackupPath -Filter "*.bak" |
        Where-Object LastWriteTime -lt (Get-Date).AddDays(-$RetentionDays) |
        ForEach-Object {
            Remove-Item $_.FullName -Force
            Write-Host "å·²åˆ é™¤æ—§å¤‡ä»½: $($_.Name)"
        }

} catch {
    Write-Error "å¤‡ä»½å¤±è´¥: $_"
    exit 1
}
</code></pre>
<hr />
<h2 id="ç¬¬åç« å­¦ä¹ éªŒè¯ä¸è¿›é˜¶"><a class="header" href="#ç¬¬åç« å­¦ä¹ éªŒè¯ä¸è¿›é˜¶">ç¬¬åç« ï¼šå­¦ä¹ éªŒè¯ä¸è¿›é˜¶</a></h2>
<h3 id="å­¦ä¹ æˆæœéªŒè¯æ ‡å‡†"><a class="header" href="#å­¦ä¹ æˆæœéªŒè¯æ ‡å‡†">å­¦ä¹ æˆæœéªŒè¯æ ‡å‡†</a></h3>
<p>å®Œæˆæœ¬è¯¾ç¨‹å­¦ä¹ åï¼Œä½ åº”è¯¥èƒ½å¤Ÿç‹¬ç«‹å®Œæˆä»¥ä¸‹ä»»åŠ¡ï¼š</p>
<ol>
<li>
<p><strong>åŸºç¡€è„šæœ¬ç¼–å†™</strong>ï¼ˆå¿…é¡»æŒæ¡ï¼‰</p>
<ul>
<li><input disabled="" type="checkbox"/>
ç¼–å†™åŒ…å«å˜é‡ã€æ¡ä»¶ã€å¾ªç¯çš„è„šæœ¬</li>
<li><input disabled="" type="checkbox"/>
æ­£ç¡®ä½¿ç”¨ç®¡é“å’Œå¯¹è±¡</li>
<li><input disabled="" type="checkbox"/>
å®ç°åŸºæœ¬çš„é”™è¯¯å¤„ç†</li>
</ul>
</li>
<li>
<p><strong>æ–‡ä»¶å’Œç³»ç»Ÿæ“ä½œ</strong>ï¼ˆå¿…é¡»æŒæ¡ï¼‰</p>
<ul>
<li><input disabled="" type="checkbox"/>
ä½¿ç”¨Cmdletè¿›è¡Œæ–‡ä»¶ç³»ç»Ÿæ“ä½œ</li>
<li><input disabled="" type="checkbox"/>
ç®¡ç†è¿›ç¨‹å’ŒæœåŠ¡</li>
<li><input disabled="" type="checkbox"/>
å®ç°ç³»ç»Ÿç›‘æ§è„šæœ¬</li>
</ul>
</li>
<li>
<p><strong>è¿œç¨‹ç®¡ç†</strong>ï¼ˆé‡è¦ï¼‰</p>
<ul>
<li><input disabled="" type="checkbox"/>
é…ç½®å’Œä½¿ç”¨PowerShell Remoting</li>
<li><input disabled="" type="checkbox"/>
æ‰¹é‡ç®¡ç†è¿œç¨‹æœåŠ¡å™¨</li>
<li><input disabled="" type="checkbox"/>
ä½¿ç”¨ä¼šè¯è¿›è¡Œå¤æ‚ä»»åŠ¡</li>
</ul>
</li>
<li>
<p><strong>ç”Ÿäº§çº§è„šæœ¬</strong>ï¼ˆè¿›é˜¶ï¼‰</p>
<ul>
<li><input disabled="" type="checkbox"/>
ç¼–å†™å¸¦å‚æ•°éªŒè¯çš„é«˜çº§å‡½æ•°</li>
<li><input disabled="" type="checkbox"/>
å®ç°å®Œå–„çš„é”™è¯¯å¤„ç†æœºåˆ¶</li>
<li><input disabled="" type="checkbox"/>
åˆ›å»ºå¯å¤ç”¨çš„æ¨¡å—</li>
</ul>
</li>
<li>
<p><strong>ç»¼åˆå®æˆ˜é¡¹ç›®</strong>ï¼ˆéªŒè¯ï¼‰</p>
<ul>
<li><input disabled="" type="checkbox"/>
ç¼–å†™ä¸€ä¸ªå®Œæ•´çš„ç³»ç»Ÿç®¡ç†å·¥å…·</li>
<li><input disabled="" type="checkbox"/>
å®ç°è‡ªåŠ¨åŒ–è¿ç»´è„šæœ¬</li>
<li><input disabled="" type="checkbox"/>
å¼€å‘Active Directoryç®¡ç†å·¥å…·</li>
</ul>
</li>
</ol>
<h3 id="å¸¸è§é”™è¯¯ä¸è§£å†³æ–¹æ¡ˆ"><a class="header" href="#å¸¸è§é”™è¯¯ä¸è§£å†³æ–¹æ¡ˆ">å¸¸è§é”™è¯¯ä¸è§£å†³æ–¹æ¡ˆ</a></h3>
<div class="table-wrapper"><table><thead><tr><th>é”™è¯¯ç±»å‹</th><th>å¸¸è§åŸå› </th><th>è§£å†³æ–¹æ¡ˆ</th></tr></thead><tbody>
<tr><td>æ‰§è¡Œç­–ç•¥é˜»æ­¢</td><td>é»˜è®¤ç­–ç•¥ä¸ºRestricted</td><td><code>Set-ExecutionPolicy RemoteSigned</code></td></tr>
<tr><td>æƒé™ä¸è¶³</td><td>éœ€è¦ç®¡ç†å‘˜æƒé™</td><td>ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡ŒPowerShell</td></tr>
<tr><td>è¿œç¨‹è¿æ¥å¤±è´¥</td><td>æœªå¯ç”¨PSRemoting</td><td><code>Enable-PSRemoting -Force</code></td></tr>
<tr><td>æ¨¡å—æœªæ‰¾åˆ°</td><td>æ¨¡å—æœªå®‰è£…æˆ–æœªå¯¼å…¥</td><td><code>Install-Module</code>æˆ–<code>Import-Module</code></td></tr>
<tr><td>å¯¹è±¡å±æ€§è®¿é—®é”™è¯¯</td><td>å¯¹è±¡ä¸ºnull</td><td>ä½¿ç”¨<code>?.</code>å®‰å…¨å¯¼èˆªï¼ˆPS7+ï¼‰</td></tr>
<tr><td>ç¼–ç é—®é¢˜</td><td>é»˜è®¤ç¼–ç ä¸æ˜¯UTF-8</td><td>æŒ‡å®š<code>-Encoding UTF8</code></td></tr>
</tbody></table>
</div>
<h3 id="æœ€ä½³å®è·µæ¸…å•"><a class="header" href="#æœ€ä½³å®è·µæ¸…å•">æœ€ä½³å®è·µæ¸…å•</a></h3>
<ul>
<li>âœ… ä½¿ç”¨<code>[CmdletBinding()]</code>åˆ›å»ºé«˜çº§å‡½æ•°</li>
<li>âœ… ä¸ºå‚æ•°æ·»åŠ éªŒè¯å±æ€§</li>
<li>âœ… ä½¿ç”¨<code>Try-Catch-Finally</code>å¤„ç†é”™è¯¯</li>
<li>âœ… ä½¿ç”¨<code>Write-Verbose</code>å’Œ<code>Write-Debug</code>æä¾›è¯Šæ–­ä¿¡æ¯</li>
<li>âœ… éµå¾ªåŠ¨è¯-åè¯å‘½åçº¦å®š</li>
<li>âœ… ä½¿ç”¨<code>PSCustomObject</code>è€Œä¸æ˜¯å“ˆå¸Œè¡¨è¿”å›æ•°æ®</li>
<li>âœ… ä¸ºè„šæœ¬æ·»åŠ è¯¦ç»†çš„æ³¨é‡Šå’Œå¸®åŠ©æ–‡æ¡£</li>
<li>âœ… ä½¿ç”¨<code>$PSCmdlet.ShouldProcess()</code>æ”¯æŒ<code>-WhatIf</code></li>
<li>âœ… å¯¼å‡ºæ¨¡å—æ—¶æ˜ç¡®æŒ‡å®šè¦å¯¼å‡ºçš„å‡½æ•°</li>
<li>âœ… ä½¿ç”¨ç‰ˆæœ¬æ§åˆ¶ç®¡ç†è„šæœ¬ä»£ç </li>
</ul>
<h3 id="powershell-vs-bashå¯¹æ¯”"><a class="header" href="#powershell-vs-bashå¯¹æ¯”">PowerShell vs Bashå¯¹æ¯”</a></h3>
<div class="table-wrapper"><table><thead><tr><th>ç‰¹æ€§</th><th>PowerShell</th><th>Bash</th></tr></thead><tbody>
<tr><td>ç®¡é“ä¼ é€’</td><td>å¯¹è±¡</td><td>æ–‡æœ¬</td></tr>
<tr><td>è·¨å¹³å°</td><td>Windows/Linux/macOS</td><td>ä¸»è¦æ˜¯Unix/Linux</td></tr>
<tr><td>é›†æˆèƒ½åŠ›</td><td>.NET Framework</td><td>Unixå·¥å…·</td></tr>
<tr><td>è¿œç¨‹ç®¡ç†</td><td>å†…ç½®PSRemoting</td><td>SSH</td></tr>
<tr><td>å­¦ä¹ æ›²çº¿</td><td>ä¸­ç­‰</td><td>ç›¸å¯¹å¹³ç¼“</td></tr>
<tr><td>é¢å‘å¯¹è±¡</td><td>æ˜¯</td><td>å¦</td></tr>
<tr><td>æ€§èƒ½</td><td>è‰¯å¥½</td><td>ä¼˜ç§€</td></tr>
<tr><td>IDEæ”¯æŒ</td><td>VS Code, PowerShell ISE</td><td>VS Code, Vim</td></tr>
</tbody></table>
</div>
<h3 id="è¿›é˜¶å­¦ä¹ èµ„æº"><a class="header" href="#è¿›é˜¶å­¦ä¹ èµ„æº">è¿›é˜¶å­¦ä¹ èµ„æº</a></h3>
<p><strong>å®˜æ–¹æ–‡æ¡£</strong></p>
<ul>
<li><a href="https://docs.microsoft.com/powershell/">PowerShell Documentation</a></li>
<li><a href="https://www.powershellgallery.com/">PowerShell Gallery</a></li>
</ul>
<p><strong>æ¨èä¹¦ç±</strong></p>
<ul>
<li>ã€ŠPowerShellå®æˆ˜æŒ‡å—ã€‹</li>
<li>ã€ŠWindows PowerShell Cookbookã€‹</li>
<li>ã€ŠLearn PowerShell Scripting in a Month of Lunchesã€‹</li>
</ul>
<p><strong>åœ¨çº¿èµ„æº</strong></p>
<ul>
<li><a href="https://powershell.org/">PowerShell.org</a></li>
<li><a href="https://www.reddit.com/r/PowerShell/">Reddit r/PowerShell</a></li>
<li><a href="https://ss64.com/ps/">SS64 PowerShell</a></li>
</ul>
<p><strong>å·¥å…·æ¨è</strong></p>
<ul>
<li>Visual Studio Code + PowerShellæ‰©å±•</li>
<li>PowerShell ISEï¼ˆWindowsï¼‰</li>
<li>PSScriptAnalyzerï¼ˆä»£ç åˆ†æï¼‰</li>
<li>Pesterï¼ˆæµ‹è¯•æ¡†æ¶ï¼‰</li>
</ul>
<h3 id="ä¸‹ä¸€æ­¥å­¦ä¹ å»ºè®®"><a class="header" href="#ä¸‹ä¸€æ­¥å­¦ä¹ å»ºè®®">ä¸‹ä¸€æ­¥å­¦ä¹ å»ºè®®</a></h3>
<ol>
<li>
<p><strong>æ·±å…¥Windowsç®¡ç†</strong></p>
<ul>
<li>å­¦ä¹ Desired State Configuration (DSC)</li>
<li>æŒæ¡Windows Management Instrumentation (WMI)</li>
<li>äº†è§£Windowsæ€§èƒ½è®¡æ•°å™¨</li>
</ul>
</li>
<li>
<p><strong>äº‘å¹³å°ç®¡ç†</strong></p>
<ul>
<li>Azure PowerShell (Azæ¨¡å—)</li>
<li>AWS Tools for PowerShell</li>
<li>Google Cloud PowerShell</li>
</ul>
</li>
<li>
<p><strong>DevOpsé›†æˆ</strong></p>
<ul>
<li>Azure DevOpsé›†æˆ</li>
<li>Gité›†æˆå’Œè‡ªåŠ¨åŒ–</li>
<li>CI/CDç®¡é“è„šæœ¬</li>
</ul>
</li>
<li>
<p><strong>å®‰å…¨å¼ºåŒ–</strong></p>
<ul>
<li>PowerShell Constrained Language Mode</li>
<li>Just Enough Administration (JEA)</li>
<li>AppLockerç­–ç•¥</li>
</ul>
</li>
</ol>
<hr />
<h2 id="æ€»ç»“"><a class="header" href="#æ€»ç»“">æ€»ç»“</a></h2>
<p>PowerShellæ˜¯Windowsç³»ç»Ÿç®¡ç†å’Œè‡ªåŠ¨åŒ–çš„å¼ºå¤§å·¥å…·ï¼Œä¹Ÿæ˜¯è·¨å¹³å°ç®¡ç†çš„é‡è¦é€‰æ‹©ã€‚é€šè¿‡æœ¬æ•™ç¨‹çš„å­¦ä¹ ï¼Œä½ åº”è¯¥å·²ç»æŒæ¡äº†ï¼š</p>
<ul>
<li>âœ… PowerShellçš„åŸºç¡€è¯­æ³•å’Œæ ¸å¿ƒæ¦‚å¿µ</li>
<li>âœ… é¢å‘å¯¹è±¡çš„ç®¡é“å’Œå¯¹è±¡æ“ä½œ</li>
<li>âœ… è„šæœ¬ç¼–ç¨‹å’Œå‡½æ•°å¼€å‘</li>
<li>âœ… è¿œç¨‹ç®¡ç†å’Œæ‰¹é‡æ“ä½œ</li>
<li>âœ… æ¨¡å—å¼€å‘å’Œä»£ç å¤ç”¨</li>
<li>âœ… ç”Ÿäº§ç¯å¢ƒè„šæœ¬å¼€å‘å®è·µ</li>
</ul>
<p><strong>è®°ä½</strong>ï¼šPowerShellçš„å¼ºå¤§åœ¨äºå…¶é¢å‘å¯¹è±¡çš„è®¾è®¡å’Œä¸.NETçš„æ·±åº¦é›†æˆã€‚æŒæ¡äº†PowerShellï¼Œä½ å°†èƒ½å¤Ÿé«˜æ•ˆåœ°è‡ªåŠ¨åŒ–å‡ ä¹æ‰€æœ‰Windowsç®¡ç†ä»»åŠ¡ï¼Œå¹¶é€æ­¥æ‰©å±•åˆ°è·¨å¹³å°ç¯å¢ƒã€‚</p>
<p><strong>ç¥ä½ å­¦ä¹ é¡ºåˆ©ï¼</strong> ğŸš€</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../ç¼–ç¨‹/script/makefile.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../ç¼–ç¨‹/script/xmake.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../ç¼–ç¨‹/script/makefile.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../ç¼–ç¨‹/script/xmake.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../theme/segmentit.umd.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../theme/searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../../theme/pagetoc.js"></script>



    </div>
    </body>
</html>

