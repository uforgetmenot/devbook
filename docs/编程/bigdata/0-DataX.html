<!DOCTYPE HTML>
<html lang="zh" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>DataX å­¦ä¹ ç¬”è®° - å¼€å‘</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../theme/pagetoc.css">
        <link rel="stylesheet" href="../../theme/help-overlay.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>â†</kbd> or <kbd>â†’</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">å¼€å‘</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="æœç´¢æœ¬ä¹¦å†…å®¹..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <!-- Page table of contents -->
                        <div class="sidetoc"><nav class="pagetoc"></nav></div>

                        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="datax-å­¦ä¹ ç¬”è®°"><a class="header" href="#datax-å­¦ä¹ ç¬”è®°">DataX å­¦ä¹ ç¬”è®°</a></h1>
<h2 id="-å­¦ä¹ ç›®æ ‡"><a class="header" href="#-å­¦ä¹ ç›®æ ‡">ğŸ“‹ å­¦ä¹ ç›®æ ‡</a></h2>
<ul>
<li>æŒæ¡DataXçš„æ ¸å¿ƒæ¦‚å¿µå’Œæ¶æ„åŸç†</li>
<li>ç†Ÿç»ƒé…ç½®å’Œä½¿ç”¨DataXè¿›è¡Œæ•°æ®åŒæ­¥</li>
<li>æŒæ¡å„ç§Readerå’ŒWriteræ’ä»¶çš„ä½¿ç”¨</li>
<li>èƒ½å¤Ÿè¿›è¡Œæ€§èƒ½è°ƒä¼˜å’Œæ•…éšœæ’æŸ¥</li>
<li>å…·å¤‡è‡ªå®šä¹‰æ’ä»¶å¼€å‘èƒ½åŠ›</li>
</ul>
<h2 id="1-datax-åŸºç¡€æ¦‚å¿µ"><a class="header" href="#1-datax-åŸºç¡€æ¦‚å¿µ">1. DataX åŸºç¡€æ¦‚å¿µ</a></h2>
<h3 id="11-ä»€ä¹ˆæ˜¯-datax"><a class="header" href="#11-ä»€ä¹ˆæ˜¯-datax">1.1 ä»€ä¹ˆæ˜¯ DataX</a></h3>
<p>DataXæ˜¯é˜¿é‡Œå·´å·´å¼€æºçš„å¼‚æ„æ•°æ®æºç¦»çº¿åŒæ­¥å·¥å…·,è‡´åŠ›äºå®ç°åŒ…æ‹¬å…³ç³»å‹æ•°æ®åº“(MySQLã€Oracleç­‰)ã€HDFSã€Hiveã€ODPSã€HBaseã€FTPç­‰å„ç§å¼‚æ„æ•°æ®æºä¹‹é—´ç¨³å®šé«˜æ•ˆçš„æ•°æ®åŒæ­¥åŠŸèƒ½ã€‚</p>
<p><strong>æ ¸å¿ƒç‰¹ç‚¹:</strong></p>
<ul>
<li>å¼‚æ„æ•°æ®æºæ”¯æŒ: æ”¯æŒ20+ç§æ•°æ®æº</li>
<li>é«˜æ€§èƒ½: é€šè¿‡æ¡†æ¶ä¼˜åŒ–,å•æœºä¼ è¾“é€Ÿåº¦å¯è¾¾300MB/s+</li>
<li>å¯æ‰©å±•: æ”¯æŒè‡ªå®šä¹‰Readerå’ŒWriteræ’ä»¶</li>
<li>å¼ºä¸€è‡´æ€§: æ”¯æŒæ•°æ®å®Œæ•´æ€§æ ¡éªŒ</li>
</ul>
<h3 id="12-datax-æ¶æ„åŸç†"><a class="header" href="#12-datax-æ¶æ„åŸç†">1.2 DataX æ¶æ„åŸç†</a></h3>
<pre><code>+----------+      +----------+      +----------+
|  Reader  | ---&gt; | Channel  | ---&gt; |  Writer  |
+----------+      +----------+      +----------+
     â†‘                 â†‘                  â†‘
     |                 |                  |
+----+----+      +-----+-----+      +-----+----+
| MySQL   |      | Memory   |      | HDFS    |
| Oracle  |      | Buffer   |      | HBase   |
| MongoDB |      | Queue    |      | ES      |
+----------+      +----------+      +----------+
</code></pre>
<p><strong>æ ¸å¿ƒç»„ä»¶:</strong></p>
<ul>
<li>Reader: æ•°æ®é‡‡é›†æ¨¡å—,è´Ÿè´£ä»æ•°æ®æºè¯»å–æ•°æ®</li>
<li>Writer: æ•°æ®å†™å…¥æ¨¡å—,è´Ÿè´£å°†æ•°æ®å†™å…¥ç›®æ ‡å­˜å‚¨</li>
<li>Channel: æ•°æ®ä¼ è¾“é€šé“,è¿æ¥Readerå’ŒWriter</li>
<li>Framework: è°ƒåº¦æ¡†æ¶,æ§åˆ¶ä»»åŠ¡æ‰§è¡Œ</li>
</ul>
<h3 id="13-æ”¯æŒçš„æ•°æ®æºç±»å‹"><a class="header" href="#13-æ”¯æŒçš„æ•°æ®æºç±»å‹">1.3 æ”¯æŒçš„æ•°æ®æºç±»å‹</a></h3>
<p><strong>å…³ç³»å‹æ•°æ®åº“:</strong></p>
<ul>
<li>MySQL/PostgreSQL/Oracle/SQL Server</li>
<li>DB2/RDBMS/Sybase/Teradata</li>
</ul>
<p><strong>NoSQLæ•°æ®åº“:</strong></p>
<ul>
<li>MongoDB/HBase/Cassandra/Redis</li>
</ul>
<p><strong>å¤§æ•°æ®å­˜å‚¨:</strong></p>
<ul>
<li>HDFS/Hive/MaxCompute(ODPS)</li>
</ul>
<p><strong>æ–‡ä»¶ç³»ç»Ÿ:</strong></p>
<ul>
<li>FTP/SFTP/OSS/Local File</li>
<li>TXT/Excel/JSONæ ¼å¼</li>
</ul>
<h2 id="2-datax-ç¯å¢ƒæ­å»º"><a class="header" href="#2-datax-ç¯å¢ƒæ­å»º">2. DataX ç¯å¢ƒæ­å»º</a></h2>
<h3 id="21-ç³»ç»Ÿè¦æ±‚"><a class="header" href="#21-ç³»ç»Ÿè¦æ±‚">2.1 ç³»ç»Ÿè¦æ±‚</a></h3>
<ul>
<li>JDK 1.8+</li>
<li>Python 2.7 æˆ– Python 3.x</li>
<li>Linux/Windows/MacOS</li>
</ul>
<h3 id="22-å®‰è£…é…ç½®"><a class="header" href="#22-å®‰è£…é…ç½®">2.2 å®‰è£…é…ç½®</a></h3>
<p><strong>ä¸‹è½½å®‰è£…:</strong></p>
<pre><code class="language-bash"># 1. ä¸‹è½½DataX
wget http://datax-opensource.oss-cn-hangzhou.aliyuncs.com/datax.tar.gz

# 2. è§£å‹
tar -xzvf datax.tar.gz
cd datax

# 3. éªŒè¯å®‰è£…
python bin/datax.py job/job.json
</code></pre>
<p><strong>Windowså®‰è£…:</strong></p>
<pre><code class="language-bash"># 1. ä¸‹è½½å¹¶è§£å‹datax.zip
# 2. è¿è¡Œæµ‹è¯•
python bin\datax.py job\job.json
</code></pre>
<h3 id="23-ç›®å½•ç»“æ„è¯´æ˜"><a class="header" href="#23-ç›®å½•ç»“æ„è¯´æ˜">2.3 ç›®å½•ç»“æ„è¯´æ˜</a></h3>
<pre><code>datax/
â”œâ”€â”€ bin/                # å¯åŠ¨è„šæœ¬
â”‚   â”œâ”€â”€ datax.py       # ä¸»ç¨‹åºå…¥å£
â”‚   â””â”€â”€ datax_env.sh   # ç¯å¢ƒé…ç½®
â”œâ”€â”€ conf/              # å…¨å±€é…ç½®
â”‚   â””â”€â”€ core.json      # æ ¸å¿ƒé…ç½®æ–‡ä»¶
â”œâ”€â”€ job/               # ä»»åŠ¡é…ç½®ç¤ºä¾‹
â”œâ”€â”€ plugin/            # æ’ä»¶ç›®å½•
â”‚   â”œâ”€â”€ reader/        # Readeræ’ä»¶
â”‚   â””â”€â”€ writer/        # Writeræ’ä»¶
â””â”€â”€ lib/               # ä¾èµ–åº“
</code></pre>
<h3 id="24-æ ¸å¿ƒé…ç½®æ–‡ä»¶"><a class="header" href="#24-æ ¸å¿ƒé…ç½®æ–‡ä»¶">2.4 æ ¸å¿ƒé…ç½®æ–‡ä»¶</a></h3>
<p><strong>conf/core.json:</strong></p>
<pre><code class="language-json">{
  "core": {
    "transport": {
      "channel": {
        "speed": {
          "byte": 1048576,        // å­—èŠ‚é€Ÿåº¦é™åˆ¶
          "record": 10000         // è®°å½•é€Ÿåº¦é™åˆ¶
        }
      }
    },
    "container": {
      "job": {
        "reportInterval": 10000   // æŠ¥å‘Šé—´éš”(æ¯«ç§’)
      },
      "taskGroup": {
        "channel": 5              // é€šé“æ•°(å¹¶å‘æ•°)
      }
    }
  }
}
</code></pre>
<h2 id="3-datax-é…ç½®æ–‡ä»¶è¯¦è§£"><a class="header" href="#3-datax-é…ç½®æ–‡ä»¶è¯¦è§£">3. DataX é…ç½®æ–‡ä»¶è¯¦è§£</a></h2>
<h3 id="31-json-é…ç½®ç»“æ„"><a class="header" href="#31-json-é…ç½®ç»“æ„">3.1 JSON é…ç½®ç»“æ„</a></h3>
<pre><code class="language-json">{
  "job": {
    "setting": {
      "speed": {
        "channel": 3
      }
    },
    "content": [
      {
        "reader": {
          "name": "mysqlreader",
          "parameter": {}
        },
        "writer": {
          "name": "hdfswriter",
          "parameter": {}
        }
      }
    ]
  }
}
</code></pre>
<h3 id="32-job-é…ç½®å‚æ•°"><a class="header" href="#32-job-é…ç½®å‚æ•°">3.2 Job é…ç½®å‚æ•°</a></h3>
<p><strong>speedé…ç½®:</strong></p>
<pre><code class="language-json">"speed": {
  "channel": 5,           // å¹¶å‘é€šé“æ•°
  "byte": 1048576,        // å­—èŠ‚é™é€Ÿ(æ¯é€šé“)
  "record": 10000,        // è®°å½•é™é€Ÿ(æ¯é€šé“)
  "batchSize": 1024       // æ‰¹æ¬¡å¤§å°
}
</code></pre>
<p><strong>errorLimité…ç½®:</strong></p>
<pre><code class="language-json">"errorLimit": {
  "record": 0,            // å…è®¸çš„é”™è¯¯è®°å½•æ•°
  "percentage": 0.02      // å…è®¸çš„é”™è¯¯ç™¾åˆ†æ¯”
}
</code></pre>
<h2 id="4-å¸¸ç”¨-reader-æ’ä»¶"><a class="header" href="#4-å¸¸ç”¨-reader-æ’ä»¶">4. å¸¸ç”¨ Reader æ’ä»¶</a></h2>
<h3 id="41-mysql-reader"><a class="header" href="#41-mysql-reader">4.1 MySQL Reader</a></h3>
<pre><code class="language-json">{
  "name": "mysqlreader",
  "parameter": {
    "username": "root",
    "password": "password",
    "column": ["id", "name", "age"],
    "connection": [
      {
        "table": ["user_table"],
        "jdbcUrl": ["jdbc:mysql://localhost:3306/test"]
      }
    ],
    "where": "age &gt; 18",
    "splitPk": "id"
  }
}
</code></pre>
<p><strong>å…³é”®å‚æ•°:</strong></p>
<ul>
<li><code>splitPk</code>: åˆ‡åˆ†é”®,ç”¨äºå¹¶è¡Œè¯»å–</li>
<li><code>where</code>: è¿‡æ»¤æ¡ä»¶</li>
<li><code>querySql</code>: è‡ªå®šä¹‰æŸ¥è¯¢SQL(ä¸column/tableäº’æ–¥)</li>
</ul>
<h3 id="42-hdfs-reader"><a class="header" href="#42-hdfs-reader">4.2 HDFS Reader</a></h3>
<pre><code class="language-json">{
  "name": "hdfsreader",
  "parameter": {
    "path": "/user/hive/warehouse/table",
    "defaultFS": "hdfs://namenode:9000",
    "fileType": "text",
    "column": [
      {"index": 0, "type": "long"},
      {"index": 1, "type": "string"}
    ],
    "fieldDelimiter": ","
  }
}
</code></pre>
<h3 id="43-mongodb-reader"><a class="header" href="#43-mongodb-reader">4.3 MongoDB Reader</a></h3>
<pre><code class="language-json">{
  "name": "mongodbreader",
  "parameter": {
    "address": ["127.0.0.1:27017"],
    "userName": "admin",
    "userPassword": "password",
    "dbName": "test",
    "collectionName": "users",
    "column": [
      {"name": "_id", "type": "string"},
      {"name": "name", "type": "string"},
      {"name": "age", "type": "int"}
    ]
  }
}
</code></pre>
<h2 id="5-å¸¸ç”¨-writer-æ’ä»¶"><a class="header" href="#5-å¸¸ç”¨-writer-æ’ä»¶">5. å¸¸ç”¨ Writer æ’ä»¶</a></h2>
<h3 id="51-mysql-writer"><a class="header" href="#51-mysql-writer">5.1 MySQL Writer</a></h3>
<pre><code class="language-json">{
  "name": "mysqlwriter",
  "parameter": {
    "username": "root",
    "password": "password",
    "column": ["id", "name", "age"],
    "connection": [
      {
        "table": ["target_table"],
        "jdbcUrl": "jdbc:mysql://localhost:3306/target"
      }
    ],
    "preSql": ["truncate table target_table"],
    "postSql": ["analyze table target_table"],
    "writeMode": "insert"
  }
}
</code></pre>
<p><strong>writeModeé€‰é¡¹:</strong></p>
<ul>
<li><code>insert</code>: æ’å…¥æ¨¡å¼</li>
<li><code>replace</code>: æ›¿æ¢æ¨¡å¼(ä¸»é”®å†²çªæ—¶æ›¿æ¢)</li>
<li><code>update</code>: æ›´æ–°æ¨¡å¼</li>
</ul>
<h3 id="52-hdfs-writer"><a class="header" href="#52-hdfs-writer">5.2 HDFS Writer</a></h3>
<pre><code class="language-json">{
  "name": "hdfswriter",
  "parameter": {
    "defaultFS": "hdfs://namenode:9000",
    "fileType": "text",
    "path": "/user/output",
    "fileName": "data",
    "column": [
      {"name": "id", "type": "long"},
      {"name": "name", "type": "string"}
    ],
    "writeMode": "append",
    "fieldDelimiter": "\t",
    "compress": "gzip"
  }
}
</code></pre>
<h2 id="6-æ•°æ®ä¼ è¾“ä¼˜åŒ–"><a class="header" href="#6-æ•°æ®ä¼ è¾“ä¼˜åŒ–">6. æ•°æ®ä¼ è¾“ä¼˜åŒ–</a></h2>
<h3 id="61-å¹¶å‘æ§åˆ¶"><a class="header" href="#61-å¹¶å‘æ§åˆ¶">6.1 å¹¶å‘æ§åˆ¶</a></h3>
<pre><code class="language-json">"setting": {
  "speed": {
    "channel": 10,        // å¢åŠ é€šé“æ•°æé«˜å¹¶å‘
    "byte": 10485760      // 10MB/s per channel
  }
}
</code></pre>
<p><strong>å¹¶å‘è°ƒä¼˜ç­–ç•¥:</strong></p>
<ul>
<li>æ ¹æ®æºç«¯/ç›®æ ‡ç«¯æ€§èƒ½è°ƒæ•´channelæ•°</li>
<li>è€ƒè™‘ç½‘ç»œå¸¦å®½é™åˆ¶</li>
<li>é¿å…å¯¹æºåº“é€ æˆè¿‡å¤§å‹åŠ›</li>
</ul>
<h3 id="62-åˆ†ç‰‡ç­–ç•¥"><a class="header" href="#62-åˆ†ç‰‡ç­–ç•¥">6.2 åˆ†ç‰‡ç­–ç•¥</a></h3>
<pre><code class="language-json">"splitPk": "id",          // ä½¿ç”¨ä¸»é”®åˆ†ç‰‡
"where": "id % 10 = 0"    // æ‰‹åŠ¨åˆ†ç‰‡
</code></pre>
<h3 id="63-é€Ÿåº¦é™åˆ¶"><a class="header" href="#63-é€Ÿåº¦é™åˆ¶">6.3 é€Ÿåº¦é™åˆ¶</a></h3>
<pre><code class="language-json">"speed": {
  "throttle": true,
  "byte": 1048576,        // é™é€Ÿ1MB/s
  "record": 10000         // é™é€Ÿ10000æ¡/s
}
</code></pre>
<h3 id="64-é”™è¯¯å¤„ç†"><a class="header" href="#64-é”™è¯¯å¤„ç†">6.4 é”™è¯¯å¤„ç†</a></h3>
<pre><code class="language-json">"errorLimit": {
  "record": 100,          // æœ€å¤šå…è®¸100æ¡é”™è¯¯
  "percentage": 0.1       // é”™è¯¯ç‡ä¸è¶…è¿‡10%
}
</code></pre>
<h2 id="7-å®æˆ˜æ¡ˆä¾‹"><a class="header" href="#7-å®æˆ˜æ¡ˆä¾‹">7. å®æˆ˜æ¡ˆä¾‹</a></h2>
<h3 id="71-mysqlåˆ°hdfsç¦»çº¿åŒæ­¥"><a class="header" href="#71-mysqlåˆ°hdfsç¦»çº¿åŒæ­¥">7.1 MySQLåˆ°HDFSç¦»çº¿åŒæ­¥</a></h3>
<pre><code class="language-json">{
  "job": {
    "setting": {
      "speed": {"channel": 5}
    },
    "content": [
      {
        "reader": {
          "name": "mysqlreader",
          "parameter": {
            "username": "root",
            "password": "pass",
            "connection": [{
              "jdbcUrl": ["jdbc:mysql://localhost:3306/db"],
              "table": ["order_table"]
            }],
            "column": ["order_id", "user_id", "amount", "create_time"],
            "splitPk": "order_id"
          }
        },
        "writer": {
          "name": "hdfswriter",
          "parameter": {
            "defaultFS": "hdfs://namenode:9000",
            "fileType": "text",
            "path": "/data/order/${bizdate}",
            "fileName": "order",
            "column": [
              {"name": "order_id", "type": "bigint"},
              {"name": "user_id", "type": "bigint"},
              {"name": "amount", "type": "decimal"},
              {"name": "create_time", "type": "string"}
            ],
            "writeMode": "append",
            "fieldDelimiter": "\t",
            "compress": "gzip"
          }
        }
      }
    ]
  }
}
</code></pre>
<p><strong>æ‰§è¡Œå‘½ä»¤:</strong></p>
<pre><code class="language-bash">python bin/datax.py job/mysql_to_hdfs.json
</code></pre>
<h3 id="72-å¢é‡åŒæ­¥"><a class="header" href="#72-å¢é‡åŒæ­¥">7.2 å¢é‡åŒæ­¥</a></h3>
<pre><code class="language-json">{
  "reader": {
    "name": "mysqlreader",
    "parameter": {
      "where": "update_time &gt;= '$yesterday' and update_time &lt; '$today'",
      "splitPk": "id"
    }
  }
}
</code></pre>
<p><strong>ä½¿ç”¨Shellè„šæœ¬ä¼ å‚:</strong></p>
<pre><code class="language-bash">#!/bin/bash
YESTERDAY=$(date -d "1 day ago" +%Y-%m-%d)
TODAY=$(date +%Y-%m-%d)

# æ›¿æ¢é…ç½®æ–‡ä»¶ä¸­çš„å˜é‡
sed -e "s/\$yesterday/$YESTERDAY/g" \
    -e "s/\$today/$TODAY/g" \
    job_template.json &gt; job_$TODAY.json

# æ‰§è¡Œä»»åŠ¡
python bin/datax.py job_$TODAY.json
</code></pre>
<h3 id="73-æ•°æ®è½¬æ¢"><a class="header" href="#73-æ•°æ®è½¬æ¢">7.3 æ•°æ®è½¬æ¢</a></h3>
<pre><code class="language-json">{
  "transformer": [
    {
      "name": "dx_groovy",
      "parameter": {
        "code": "return record.get(0) * 100"  // å°†ç¬¬ä¸€åˆ—æ•°æ®ä¹˜ä»¥100
      }
    }
  ]
}
</code></pre>
<h2 id="8-æ•…éšœæ’æŸ¥ä¸è°ƒä¼˜"><a class="header" href="#8-æ•…éšœæ’æŸ¥ä¸è°ƒä¼˜">8. æ•…éšœæ’æŸ¥ä¸è°ƒä¼˜</a></h2>
<h3 id="81-å¸¸è§é”™è¯¯åˆ†æ"><a class="header" href="#81-å¸¸è§é”™è¯¯åˆ†æ">8.1 å¸¸è§é”™è¯¯åˆ†æ</a></h3>
<p><strong>é”™è¯¯1: å†…å­˜æº¢å‡º</strong></p>
<pre><code>java.lang.OutOfMemoryError: Java heap space
</code></pre>
<p>è§£å†³æ–¹æ¡ˆ:</p>
<pre><code class="language-bash"># ä¿®æ”¹bin/datax.pyä¸­çš„JVMå‚æ•°
-Xms1g -Xmx4g
</code></pre>
<p><strong>é”™è¯¯2: è¿æ¥è¶…æ—¶</strong></p>
<pre><code>Connection timeout
</code></pre>
<p>è§£å†³æ–¹æ¡ˆ:</p>
<ul>
<li>æ£€æŸ¥ç½‘ç»œè¿é€šæ€§</li>
<li>å¢åŠ è¶…æ—¶æ—¶é—´</li>
<li>æ£€æŸ¥é˜²ç«å¢™è®¾ç½®</li>
</ul>
<p><strong>é”™è¯¯3: è„æ•°æ®</strong></p>
<pre><code>Dirty data exception
</code></pre>
<p>è§£å†³æ–¹æ¡ˆ:</p>
<ul>
<li>ä½¿ç”¨<code>errorLimit</code>å®¹å¿éƒ¨åˆ†é”™è¯¯</li>
<li>æ£€æŸ¥æºæ•°æ®è´¨é‡</li>
<li>ä½¿ç”¨<code>where</code>æ¡ä»¶è¿‡æ»¤</li>
</ul>
<h3 id="82-æ€§èƒ½è°ƒä¼˜æŠ€å·§"><a class="header" href="#82-æ€§èƒ½è°ƒä¼˜æŠ€å·§">8.2 æ€§èƒ½è°ƒä¼˜æŠ€å·§</a></h3>
<p><strong>1. åˆç†è®¾ç½®å¹¶å‘åº¦:</strong></p>
<pre><code class="language-json">"speed": {
  "channel": 8  // æ ¹æ®æœºå™¨é…ç½®è°ƒæ•´,ä¸€èˆ¬ä¸ºCPUæ ¸å¿ƒæ•°
}
</code></pre>
<p><strong>2. ä½¿ç”¨æ‰¹é‡æäº¤:</strong></p>
<pre><code class="language-json">"batchSize": 2048  // å¢å¤§æ‰¹æ¬¡å¤§å°
</code></pre>
<p><strong>3. å¯ç”¨å‹ç¼©:</strong></p>
<pre><code class="language-json">"compress": "gzip"  // å‡å°‘ç½‘ç»œä¼ è¾“
</code></pre>
<p><strong>4. ä¼˜åŒ–åˆ†ç‰‡é”®:</strong></p>
<pre><code class="language-json">"splitPk": "id"  // é€‰æ‹©åˆ†å¸ƒå‡åŒ€çš„å­—æ®µ
</code></pre>
<h3 id="83-ç›‘æ§ä¸æ—¥å¿—"><a class="header" href="#83-ç›‘æ§ä¸æ—¥å¿—">8.3 ç›‘æ§ä¸æ—¥å¿—</a></h3>
<pre><code class="language-bash"># æŸ¥çœ‹å®æ—¶æ—¥å¿—
tail -f datax/log/datax.log

# æŸ¥çœ‹ä»»åŠ¡ç»Ÿè®¡
grep "ä»»åŠ¡å¯åŠ¨" datax/log/datax.log
grep "ä»»åŠ¡ç»“æŸ" datax/log/datax.log
</code></pre>
<h2 id="9-æœ€ä½³å®è·µ"><a class="header" href="#9-æœ€ä½³å®è·µ">9. æœ€ä½³å®è·µ</a></h2>
<h3 id="91-é…ç½®ç®¡ç†"><a class="header" href="#91-é…ç½®ç®¡ç†">9.1 é…ç½®ç®¡ç†</a></h3>
<ul>
<li>ä½¿ç”¨é…ç½®æ¨¡æ¿,é€šè¿‡å‚æ•°æ›¿æ¢ç”Ÿæˆå…·ä½“ä»»åŠ¡</li>
<li>å°†æ•æ„Ÿä¿¡æ¯(å¯†ç )ä½¿ç”¨ç¯å¢ƒå˜é‡</li>
<li>ç‰ˆæœ¬æ§åˆ¶ä»»åŠ¡é…ç½®æ–‡ä»¶</li>
</ul>
<h3 id="92-ä»»åŠ¡è°ƒåº¦"><a class="header" href="#92-ä»»åŠ¡è°ƒåº¦">9.2 ä»»åŠ¡è°ƒåº¦</a></h3>
<ul>
<li>ç»“åˆAirflow/Oozieè¿›è¡Œä»»åŠ¡è°ƒåº¦</li>
<li>è®¾ç½®åˆç†çš„é‡è¯•ç­–ç•¥</li>
<li>ç›‘æ§ä»»åŠ¡æ‰§è¡ŒçŠ¶æ€</li>
</ul>
<h3 id="93-æ•°æ®è´¨é‡ä¿è¯"><a class="header" href="#93-æ•°æ®è´¨é‡ä¿è¯">9.3 æ•°æ®è´¨é‡ä¿è¯</a></h3>
<ul>
<li>ä½¿ç”¨<code>preSql</code>æ¸…ç†ç›®æ ‡è¡¨</li>
<li>ä½¿ç”¨<code>postSql</code>è¿›è¡Œæ•°æ®æ ¡éªŒ</li>
<li>è®°å½•åŒæ­¥æ—¥å¿—ä¾¿äºå®¡è®¡</li>
</ul>
<h2 id="10-å­¦ä¹ éªŒè¯æ ‡å‡†"><a class="header" href="#10-å­¦ä¹ éªŒè¯æ ‡å‡†">10. å­¦ä¹ éªŒè¯æ ‡å‡†</a></h2>
<h3 id="-åŸºç¡€èƒ½åŠ›éªŒè¯"><a class="header" href="#-åŸºç¡€èƒ½åŠ›éªŒè¯">âœ… åŸºç¡€èƒ½åŠ›éªŒè¯</a></h3>
<ul>
<li><input disabled="" type="checkbox"/>
èƒ½å¤Ÿç‹¬ç«‹å®‰è£…é…ç½®DataXç¯å¢ƒ</li>
<li><input disabled="" type="checkbox"/>
èƒ½å¤Ÿç¼–å†™MySQLåˆ°MySQLçš„åŒæ­¥é…ç½®</li>
<li><input disabled="" type="checkbox"/>
ç†è§£Readerã€Writerã€Channelçš„ä½œç”¨</li>
</ul>
<h3 id="-è¿›é˜¶èƒ½åŠ›éªŒè¯"><a class="header" href="#-è¿›é˜¶èƒ½åŠ›éªŒè¯">âœ… è¿›é˜¶èƒ½åŠ›éªŒè¯</a></h3>
<ul>
<li><input disabled="" type="checkbox"/>
èƒ½å¤Ÿé…ç½®è‡³å°‘5ç§ä¸åŒæ•°æ®æºçš„åŒæ­¥</li>
<li><input disabled="" type="checkbox"/>
èƒ½å¤Ÿå¤„ç†å¢é‡åŒæ­¥åœºæ™¯</li>
<li><input disabled="" type="checkbox"/>
èƒ½å¤Ÿè¿›è¡Œæ€§èƒ½è°ƒä¼˜,è¾¾åˆ°100MB/s+</li>
</ul>
<h3 id="-é«˜çº§èƒ½åŠ›éªŒè¯"><a class="header" href="#-é«˜çº§èƒ½åŠ›éªŒè¯">âœ… é«˜çº§èƒ½åŠ›éªŒè¯</a></h3>
<ul>
<li><input disabled="" type="checkbox"/>
èƒ½å¤Ÿå¼€å‘è‡ªå®šä¹‰Reader/Writeræ’ä»¶</li>
<li><input disabled="" type="checkbox"/>
èƒ½å¤Ÿè§£å†³å¤æ‚çš„æ•°æ®è½¬æ¢éœ€æ±‚</li>
<li><input disabled="" type="checkbox"/>
èƒ½å¤Ÿè®¾è®¡å®Œæ•´çš„æ•°æ®åŒæ­¥æ–¹æ¡ˆ</li>
</ul>
<h2 id="11-æ‰©å±•èµ„æº"><a class="header" href="#11-æ‰©å±•èµ„æº">11. æ‰©å±•èµ„æº</a></h2>
<h3 id="å®˜æ–¹èµ„æº"><a class="header" href="#å®˜æ–¹èµ„æº">å®˜æ–¹èµ„æº</a></h3>
<ul>
<li>GitHub: https://github.com/alibaba/DataX</li>
<li>å®˜æ–¹æ–‡æ¡£: https://github.com/alibaba/DataX/blob/master/userGuid.md</li>
</ul>
<h3 id="å­¦ä¹ å»ºè®®"><a class="header" href="#å­¦ä¹ å»ºè®®">å­¦ä¹ å»ºè®®</a></h3>
<ol>
<li>ä»ç®€å•çš„MySQLåŒæ­¥å¼€å§‹å®è·µ</li>
<li>é€æ­¥å°è¯•ä¸åŒç±»å‹çš„æ•°æ®æº</li>
<li>å­¦ä¹ æºç äº†è§£æ’ä»¶å¼€å‘æœºåˆ¶</li>
<li>ç»“åˆå®é™…ä¸šåŠ¡åœºæ™¯è¿›è¡Œä¼˜åŒ–</li>
</ol>
<h3 id="è¿›é˜¶æ–¹å‘"><a class="header" href="#è¿›é˜¶æ–¹å‘">è¿›é˜¶æ–¹å‘</a></h3>
<ul>
<li>å­¦ä¹ Flink CDCå®ç°å®æ—¶æ•°æ®åŒæ­¥</li>
<li>å­¦ä¹ Canalå®ç°MySQLå¢é‡è®¢é˜…</li>
<li>å­¦ä¹ Sqoopè¿›è¡ŒHadoopç”Ÿæ€æ•°æ®äº¤æ¢</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../ç¼–ç¨‹/android/TaroJS.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../ç¼–ç¨‹/bigdata/1-ApacheNiFi.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../ç¼–ç¨‹/android/TaroJS.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../ç¼–ç¨‹/bigdata/1-ApacheNiFi.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../theme/segmentit.umd.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../theme/searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../../theme/pagetoc.js"></script>



    </div>
    </body>
</html>

