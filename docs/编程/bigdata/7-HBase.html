<!DOCTYPE HTML>
<html lang="zh" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Apache HBase å­¦ä¹ ç¬”è®° - å¼€å‘</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../theme/pagetoc.css">
        <link rel="stylesheet" href="../../theme/help-overlay.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>â†</kbd> or <kbd>â†’</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">å¼€å‘</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="æœç´¢æœ¬ä¹¦å†…å®¹..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <!-- Page table of contents -->
                        <div class="sidetoc"><nav class="pagetoc"></nav></div>

                        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="apache-hbase-å­¦ä¹ ç¬”è®°"><a class="header" href="#apache-hbase-å­¦ä¹ ç¬”è®°">Apache HBase å­¦ä¹ ç¬”è®°</a></h1>
<h2 id="-å­¦ä¹ ç›®æ ‡"><a class="header" href="#-å­¦ä¹ ç›®æ ‡">ğŸ“‹ å­¦ä¹ ç›®æ ‡</a></h2>
<ul>
<li>æ·±å…¥ç†è§£HBaseæ¶æ„å’Œæ•°æ®æ¨¡å‹</li>
<li>æŒæ¡HBase Shellå’ŒJava APIæ“ä½œ</li>
<li>ç†Ÿç»ƒè¿›è¡ŒRowKeyè®¾è®¡å’Œè¡¨è®¾è®¡</li>
<li>ç†è§£Regionåˆ†è£‚å’Œè´Ÿè½½å‡è¡¡æœºåˆ¶</li>
<li>æŒæ¡HBaseæ€§èƒ½ä¼˜åŒ–æŠ€å·§</li>
<li>å…·å¤‡HBaseé›†ç¾¤è¿ç»´å’Œæ•…éšœæ’æŸ¥èƒ½åŠ›</li>
</ul>
<h2 id="1-hbase-åŸºç¡€æ¦‚å¿µ"><a class="header" href="#1-hbase-åŸºç¡€æ¦‚å¿µ">1. HBase åŸºç¡€æ¦‚å¿µ</a></h2>
<h3 id="11-ä»€ä¹ˆæ˜¯-hbase"><a class="header" href="#11-ä»€ä¹ˆæ˜¯-hbase">1.1 ä»€ä¹ˆæ˜¯ HBase</a></h3>
<p>Apache HBaseæ˜¯ä¸€ä¸ªé«˜å¯é ã€é«˜æ€§èƒ½ã€é¢å‘åˆ—ã€å¯ä¼¸ç¼©çš„åˆ†å¸ƒå¼å­˜å‚¨ç³»ç»Ÿ,åŸºäºGoogle Bigtableè®ºæ–‡å®ç°,æ„å»ºåœ¨Hadoop HDFSä¹‹ä¸Šã€‚</p>
<p><strong>æ ¸å¿ƒç‰¹ç‚¹:</strong></p>
<ul>
<li>æµ·é‡æ•°æ®å­˜å‚¨(PBçº§åˆ«)</li>
<li>åˆ—å¼å­˜å‚¨</li>
<li>å®æ—¶éšæœºè¯»å†™</li>
<li>å¼ºä¸€è‡´æ€§</li>
<li>è‡ªåŠ¨åˆ†ç‰‡</li>
<li>é«˜å¯ç”¨æ€§</li>
</ul>
<p><strong>åº”ç”¨åœºæ™¯:</strong></p>
<ul>
<li>æ—¶åºæ•°æ®å­˜å‚¨</li>
<li>æ—¥å¿—æ•°æ®å­˜å‚¨</li>
<li>æ¨èç³»ç»Ÿ</li>
<li>ç”¨æˆ·ç”»åƒ</li>
<li>æ¶ˆæ¯ç³»ç»Ÿ</li>
<li>ç‰©è”ç½‘æ•°æ®</li>
</ul>
<h3 id="12-hbase-ä¸å…³ç³»å‹æ•°æ®åº“å¯¹æ¯”"><a class="header" href="#12-hbase-ä¸å…³ç³»å‹æ•°æ®åº“å¯¹æ¯”">1.2 HBase ä¸å…³ç³»å‹æ•°æ®åº“å¯¹æ¯”</a></h3>
<div class="table-wrapper"><table><thead><tr><th>ç‰¹æ€§</th><th>HBase</th><th>MySQL</th><th>Oracle</th></tr></thead><tbody>
<tr><td>æ•°æ®æ¨¡å‹</td><td>åˆ—å¼å­˜å‚¨</td><td>è¡Œå¼å­˜å‚¨</td><td>è¡Œå¼å­˜å‚¨</td></tr>
<tr><td>æ•°æ®è§„æ¨¡</td><td>PBçº§</td><td>TBçº§</td><td>TBçº§</td></tr>
<tr><td>äº‹åŠ¡æ”¯æŒ</td><td>è¡Œçº§äº‹åŠ¡</td><td>å®Œæ•´ACID</td><td>å®Œæ•´ACID</td></tr>
<tr><td>æŸ¥è¯¢è¯­è¨€</td><td>API/Shell</td><td>SQL</td><td>SQL</td></tr>
<tr><td>æ‰©å±•æ€§</td><td>æ°´å¹³æ‰©å±•</td><td>å‚ç›´æ‰©å±•</td><td>å‚ç›´æ‰©å±•</td></tr>
<tr><td>é€‚ç”¨åœºæ™¯</td><td>å¤§æ•°æ®OLTP</td><td>OLTP</td><td>OLTP/OLAP</td></tr>
</tbody></table>
</div>
<h3 id="13-hbase-æ•°æ®æ¨¡å‹"><a class="header" href="#13-hbase-æ•°æ®æ¨¡å‹">1.3 HBase æ•°æ®æ¨¡å‹</a></h3>
<p><strong>é€»è¾‘è§†å›¾:</strong></p>
<pre><code>RowKey    | Column Family: cf1            | Column Family: cf2
          | col1      | col2             | col1      | col2
-------------------------------------------------------------
row1      | value1    | value2           | value3    | value4
row2      | value5    | value6           | value7    | value8
</code></pre>
<p><strong>ç‰©ç†å­˜å‚¨:</strong></p>
<pre><code>æŒ‰åˆ—æ—åˆ†åˆ«å­˜å‚¨:
Region: cf1
  row1:cf1:col1 -&gt; value1
  row1:cf1:col2 -&gt; value2
  row2:cf1:col1 -&gt; value5

Region: cf2
  row1:cf2:col1 -&gt; value3
  row1:cf2:col2 -&gt; value4
</code></pre>
<p><strong>æ ¸å¿ƒæ¦‚å¿µ:</strong></p>
<ul>
<li><strong>RowKey</strong>: è¡Œé”®,è¡¨çš„ä¸»é”®,æŒ‰å­—å…¸åºæ’åº</li>
<li><strong>Column Family</strong>: åˆ—æ—,åˆ—çš„é›†åˆ</li>
<li><strong>Column Qualifier</strong>: åˆ—é™å®šç¬¦,åˆ—æ—ä¸­çš„å…·ä½“åˆ—</li>
<li><strong>Cell</strong>: å•å…ƒæ ¼,ç”±{row, column, timestamp}å”¯ä¸€ç¡®å®š</li>
<li><strong>Timestamp</strong>: æ—¶é—´æˆ³,ç”¨äºç‰ˆæœ¬æ§åˆ¶</li>
<li><strong>Version</strong>: ç‰ˆæœ¬,æ¯ä¸ªcellå¯ä»¥ä¿å­˜å¤šä¸ªç‰ˆæœ¬</li>
</ul>
<h2 id="2-hbase-æ¶æ„è®¾è®¡"><a class="header" href="#2-hbase-æ¶æ„è®¾è®¡">2. HBase æ¶æ„è®¾è®¡</a></h2>
<h3 id="21-æ•´ä½“æ¶æ„"><a class="header" href="#21-æ•´ä½“æ¶æ„">2.1 æ•´ä½“æ¶æ„</a></h3>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             HBase Client                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚          â”‚          â”‚
â”Œâ”€â”€â”€â–¼â”€â”€â”  â”Œâ”€â”€â”€â–¼â”€â”€â”€â”  â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚HMasterâ”‚  â”‚ZooKeeperâ”‚ â”‚RegionServerâ”‚
â”‚       â”‚  â”‚         â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â” â”‚
â”‚       â”‚  â”‚  /hbase â”‚ â”‚  â”‚Regionâ”‚ â”‚
â”‚       â”‚  â”‚  /meta  â”‚ â”‚  â”‚Regionâ”‚ â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â”‚  â”‚Regionâ”‚ â”‚
    â”‚           â”‚      â”‚  â””â”€â”€â”€â”€â”€â”˜ â”‚
    â”‚           â”‚      â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
         â”‚    HDFS     â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>æ ¸å¿ƒç»„ä»¶:</strong></p>
<ul>
<li><strong>HMaster</strong>: ä¸»èŠ‚ç‚¹,è´Ÿè´£ç®¡ç†Regionåˆ†é…ã€è¡¨ç®¡ç†</li>
<li><strong>RegionServer</strong>: åŒºåŸŸæœåŠ¡å™¨,è´Ÿè´£æ•°æ®è¯»å†™</li>
<li><strong>ZooKeeper</strong>: åè°ƒæœåŠ¡,å­˜å‚¨å…ƒæ•°æ®</li>
<li><strong>HDFS</strong>: åº•å±‚å­˜å‚¨</li>
</ul>
<h3 id="22-hmaster-èŒè´£"><a class="header" href="#22-hmaster-èŒè´£">2.2 HMaster èŒè´£</a></h3>
<pre><code class="language-yaml">ä¸»è¦èŒè´£:
  - ç®¡ç†RegionServer:
      ç›‘æ§RegionServerçŠ¶æ€
      æ•…éšœè½¬ç§»å’Œæ¢å¤
  - ç®¡ç†Region:
      Regionåˆ†é…å’Œè¿ç§»
      è´Ÿè½½å‡è¡¡
  - ç®¡ç†è¡¨:
      åˆ›å»º/åˆ é™¤/ä¿®æ”¹è¡¨
      ç®¡ç†å‘½åç©ºé—´
  - å…ƒæ•°æ®ç®¡ç†:
      ç®¡ç†è¡¨å®šä¹‰
      ç®¡ç†Regionåˆ†å¸ƒä¿¡æ¯
</code></pre>
<h3 id="23-regionserver-æ¶æ„"><a class="header" href="#23-regionserver-æ¶æ„">2.3 RegionServer æ¶æ„</a></h3>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        RegionServer             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ Region  â”‚  â”‚ Region  â”‚      â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â” â”‚      â”‚
â”‚  â”‚ â”‚Storeâ”‚ â”‚  â”‚ â”‚Storeâ”‚ â”‚      â”‚
â”‚  â”‚ â”‚(CF) â”‚ â”‚  â”‚ â”‚(CF) â”‚ â”‚      â”‚
â”‚  â”‚ â””â”€â”€â”¬â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”¬â”€â”€â”˜ â”‚      â”‚
â”‚  â”‚ â”Œâ”€â”€â–¼â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â–¼â”€â”€â” â”‚      â”‚
â”‚  â”‚ â”‚MemStâ”‚ â”‚  â”‚ â”‚MemStâ”‚ â”‚      â”‚
â”‚  â”‚ â”‚ore  â”‚ â”‚  â”‚ â”‚ore  â”‚ â”‚      â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”˜ â”‚      â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â” â”‚      â”‚
â”‚  â”‚ â”‚HFileâ”‚ â”‚  â”‚ â”‚HFileâ”‚ â”‚      â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”˜ â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚        WAL (HLog)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”
    â”‚  HDFS   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>Regionç»„æˆ:</strong></p>
<ul>
<li><strong>MemStore</strong>: å†…å­˜ç¼“å†²åŒº,å†™å…¥å…ˆè¿›å†…å­˜</li>
<li><strong>HFile</strong>: ç£ç›˜å­˜å‚¨æ–‡ä»¶,å­˜å‚¨åœ¨HDFS</li>
<li><strong>WAL</strong>: Write Ahead Log,é¢„å†™æ—¥å¿—</li>
</ul>
<h3 id="24-æ•°æ®è¯»å†™æµç¨‹"><a class="header" href="#24-æ•°æ®è¯»å†™æµç¨‹">2.4 æ•°æ®è¯»å†™æµç¨‹</a></h3>
<p><strong>å†™å…¥æµç¨‹:</strong></p>
<pre><code>1. Clientè¿æ¥ZooKeeperè·å–metaè¡¨ä½ç½®
2. Clientä»metaè¡¨è·å–ç›®æ ‡Regionæ‰€åœ¨RegionServer
3. Clientå‘RegionServerå‘é€Putè¯·æ±‚
4. RegionServerå†™WALæ—¥å¿—
5. RegionServerå†™MemStore
6. è¿”å›æˆåŠŸ
7. (åå°)MemStoreè¾¾åˆ°é˜ˆå€¼æ—¶flushåˆ°HFile
8. (åå°)HFileè¾¾åˆ°ä¸€å®šæ•°é‡æ—¶è¿›è¡ŒCompaction
</code></pre>
<p><strong>è¯»å–æµç¨‹:</strong></p>
<pre><code>1. Clientè¿æ¥ZooKeeperè·å–metaè¡¨ä½ç½®
2. Clientä»metaè¡¨è·å–ç›®æ ‡Regionæ‰€åœ¨RegionServer
3. Clientå‘RegionServerå‘é€Getè¯·æ±‚
4. å…ˆæŸ¥è¯¢BlockCache
5. å†æŸ¥è¯¢MemStore
6. æœ€åæŸ¥è¯¢HFile
7. åˆå¹¶ç»“æœè¿”å›ç»™Client
</code></pre>
<h2 id="3-hbase-å®‰è£…éƒ¨ç½²"><a class="header" href="#3-hbase-å®‰è£…éƒ¨ç½²">3. HBase å®‰è£…éƒ¨ç½²</a></h2>
<h3 id="31-ç¯å¢ƒå‡†å¤‡"><a class="header" href="#31-ç¯å¢ƒå‡†å¤‡">3.1 ç¯å¢ƒå‡†å¤‡</a></h3>
<p><strong>ç³»ç»Ÿè¦æ±‚:</strong></p>
<ul>
<li>Java 8+</li>
<li>Hadoop 2.x/3.x (HDFS)</li>
<li>ZooKeeper 3.4+</li>
<li>æœ€å°å†…å­˜: 4GB</li>
</ul>
<h3 id="32-å•æœºæ¨¡å¼å®‰è£…"><a class="header" href="#32-å•æœºæ¨¡å¼å®‰è£…">3.2 å•æœºæ¨¡å¼å®‰è£…</a></h3>
<pre><code class="language-bash"># 1. ä¸‹è½½HBase
wget https://dlcdn.apache.org/hbase/2.5.5/hbase-2.5.5-bin.tar.gz

# 2. è§£å‹
tar -xzvf hbase-2.5.5-bin.tar.gz
cd hbase-2.5.5

# 3. é…ç½®ç¯å¢ƒå˜é‡
export HBASE_HOME=/opt/hbase-2.5.5
export PATH=$PATH:$HBASE_HOME/bin

# 4. é…ç½®hbase-env.sh
export JAVA_HOME=/usr/lib/jvm/java-8-openjdk
export HBASE_MANAGES_ZK=true

# 5. é…ç½®hbase-site.xml
cat &gt; conf/hbase-site.xml &lt;&lt;EOF
&lt;configuration&gt;
  &lt;property&gt;
    &lt;name&gt;hbase.rootdir&lt;/name&gt;
    &lt;value&gt;file:///tmp/hbase&lt;/value&gt;
  &lt;/property&gt;
  &lt;property&gt;
    &lt;name&gt;hbase.zookeeper.property.dataDir&lt;/name&gt;
    &lt;value&gt;/tmp/zookeeper&lt;/value&gt;
  &lt;/property&gt;
&lt;/configuration&gt;
EOF

# 6. å¯åŠ¨HBase
./bin/start-hbase.sh

# 7. éªŒè¯
./bin/hbase shell
</code></pre>
<h3 id="33-å®Œå…¨åˆ†å¸ƒå¼éƒ¨ç½²"><a class="header" href="#33-å®Œå…¨åˆ†å¸ƒå¼éƒ¨ç½²">3.3 å®Œå…¨åˆ†å¸ƒå¼éƒ¨ç½²</a></h3>
<p><strong>hbase-site.xmlé…ç½®:</strong></p>
<pre><code class="language-xml">&lt;configuration&gt;
  &lt;!-- HDFSè·¯å¾„ --&gt;
  &lt;property&gt;
    &lt;name&gt;hbase.rootdir&lt;/name&gt;
    &lt;value&gt;hdfs://namenode:9000/hbase&lt;/value&gt;
  &lt;/property&gt;

  &lt;!-- ZooKeeperé›†ç¾¤ --&gt;
  &lt;property&gt;
    &lt;name&gt;hbase.zookeeper.quorum&lt;/name&gt;
    &lt;value&gt;zk1,zk2,zk3&lt;/value&gt;
  &lt;/property&gt;

  &lt;property&gt;
    &lt;name&gt;hbase.zookeeper.property.dataDir&lt;/name&gt;
    &lt;value&gt;/data/zookeeper&lt;/value&gt;
  &lt;/property&gt;

  &lt;!-- é›†ç¾¤æ¨¡å¼ --&gt;
  &lt;property&gt;
    &lt;name&gt;hbase.cluster.distributed&lt;/name&gt;
    &lt;value&gt;true&lt;/value&gt;
  &lt;/property&gt;

  &lt;!-- Masterç«¯å£ --&gt;
  &lt;property&gt;
    &lt;name&gt;hbase.master.port&lt;/name&gt;
    &lt;value&gt;16000&lt;/value&gt;
  &lt;/property&gt;

  &lt;!-- RegionServerç«¯å£ --&gt;
  &lt;property&gt;
    &lt;name&gt;hbase.regionserver.port&lt;/name&gt;
    &lt;value&gt;16020&lt;/value&gt;
  &lt;/property&gt;
&lt;/configuration&gt;
</code></pre>
<p><strong>regionserversé…ç½®:</strong></p>
<pre><code class="language-bash"># conf/regionservers
node1
node2
node3
</code></pre>
<p><strong>å¯åŠ¨é›†ç¾¤:</strong></p>
<pre><code class="language-bash"># å¯åŠ¨HBaseé›†ç¾¤
./bin/start-hbase.sh

# å¯åŠ¨Backup Master
./bin/hbase-daemon.sh start master

# æŸ¥çœ‹çŠ¶æ€
jps
# è¾“å‡º:
# HMaster
# HRegionServer
</code></pre>
<h2 id="4-hbase-shell-æ“ä½œ"><a class="header" href="#4-hbase-shell-æ“ä½œ">4. HBase Shell æ“ä½œ</a></h2>
<h3 id="41-è¿æ¥-hbase-shell"><a class="header" href="#41-è¿æ¥-hbase-shell">4.1 è¿æ¥ HBase Shell</a></h3>
<pre><code class="language-bash"># å¯åŠ¨Shell
hbase shell

# æŸ¥çœ‹å¸®åŠ©
help

# æŸ¥çœ‹ç‰ˆæœ¬
version

# æŸ¥çœ‹çŠ¶æ€
status
status 'simple'
status 'detailed'
</code></pre>
<h3 id="42-è¡¨æ“ä½œ"><a class="header" href="#42-è¡¨æ“ä½œ">4.2 è¡¨æ“ä½œ</a></h3>
<p><strong>åˆ›å»ºè¡¨:</strong></p>
<pre><code class="language-ruby"># åˆ›å»ºè¡¨(å•åˆ—æ—)
create 'users', 'info'

# åˆ›å»ºè¡¨(å¤šåˆ—æ—)
create 'users', 'info', 'data'

# åˆ›å»ºè¡¨å¹¶è®¾ç½®å‚æ•°
create 'users',
  {NAME =&gt; 'info', VERSIONS =&gt; 5, COMPRESSION =&gt; 'SNAPPY'},
  {NAME =&gt; 'data', VERSIONS =&gt; 3, TTL =&gt; 86400}

# é¢„åˆ†åŒºåˆ›å»ºè¡¨
create 'users', 'info', SPLITS =&gt; ['1000', '2000', '3000']
</code></pre>
<p><strong>æŸ¥çœ‹è¡¨:</strong></p>
<pre><code class="language-ruby"># åˆ—å‡ºæ‰€æœ‰è¡¨
list

# æŸ¥çœ‹è¡¨ç»“æ„
describe 'users'

# æŸ¥çœ‹è¡¨æ˜¯å¦å­˜åœ¨
exists 'users'

# æŸ¥çœ‹è¡¨æ˜¯å¦å¯ç”¨
is_enabled 'users'
</code></pre>
<p><strong>ä¿®æ”¹è¡¨:</strong></p>
<pre><code class="language-ruby"># ç¦ç”¨è¡¨
disable 'users'

# ä¿®æ”¹åˆ—æ—
alter 'users', {NAME =&gt; 'info', VERSIONS =&gt; 10}

# æ·»åŠ åˆ—æ—
alter 'users', {NAME =&gt; 'address'}

# åˆ é™¤åˆ—æ—
alter 'users', {NAME =&gt; 'address', METHOD =&gt; 'delete'}

# å¯ç”¨è¡¨
enable 'users'
</code></pre>
<p><strong>åˆ é™¤è¡¨:</strong></p>
<pre><code class="language-ruby"># ç¦ç”¨è¡¨
disable 'users'

# åˆ é™¤è¡¨
drop 'users'
</code></pre>
<h3 id="43-æ•°æ®æ“ä½œ"><a class="header" href="#43-æ•°æ®æ“ä½œ">4.3 æ•°æ®æ“ä½œ</a></h3>
<p><strong>æ’å…¥æ•°æ®:</strong></p>
<pre><code class="language-ruby"># æ’å…¥å•æ¡æ•°æ®
put 'users', 'row1', 'info:name', 'Alice'
put 'users', 'row1', 'info:age', '25'
put 'users', 'row1', 'data:score', '95'

# æ’å…¥å¤šåˆ—
put 'users', 'row2', 'info:name', 'Bob'
put 'users', 'row2', 'info:age', '30'
</code></pre>
<p><strong>æŸ¥è¯¢æ•°æ®:</strong></p>
<pre><code class="language-ruby"># æŸ¥è¯¢å•è¡Œ
get 'users', 'row1'

# æŸ¥è¯¢æŒ‡å®šåˆ—æ—
get 'users', 'row1', 'info'

# æŸ¥è¯¢æŒ‡å®šåˆ—
get 'users', 'row1', 'info:name'

# æŸ¥è¯¢æŒ‡å®šç‰ˆæœ¬
get 'users', 'row1', {COLUMN =&gt; 'info:name', VERSIONS =&gt; 3}

# æ‰«æå…¨è¡¨
scan 'users'

# æ‰«ææŒ‡å®šèŒƒå›´
scan 'users', {STARTROW =&gt; 'row1', STOPROW =&gt; 'row3'}

# å¸¦è¿‡æ»¤å™¨æ‰«æ
scan 'users', {FILTER =&gt; "ValueFilter(=, 'binary:Alice')"}

# é™åˆ¶è¿”å›æ¡æ•°
scan 'users', {LIMIT =&gt; 10}
</code></pre>
<p><strong>æ›´æ–°æ•°æ®:</strong></p>
<pre><code class="language-ruby"># æ›´æ–°(å®é™…æ˜¯æ’å…¥æ–°ç‰ˆæœ¬)
put 'users', 'row1', 'info:age', '26'
</code></pre>
<p><strong>åˆ é™¤æ•°æ®:</strong></p>
<pre><code class="language-ruby"># åˆ é™¤æŒ‡å®šåˆ—
delete 'users', 'row1', 'info:age'

# åˆ é™¤æ•´è¡Œ
deleteall 'users', 'row1'

# æ¸…ç©ºè¡¨
truncate 'users'
</code></pre>
<p><strong>è®¡æ•°æ“ä½œ:</strong></p>
<pre><code class="language-ruby"># ç»Ÿè®¡è¡Œæ•°
count 'users'

# å¿«é€Ÿç»Ÿè®¡(ä¼°ç®—)
count 'users', CACHE =&gt; 1000
</code></pre>
<h2 id="5-hbase-java-api"><a class="header" href="#5-hbase-java-api">5. HBase Java API</a></h2>
<h3 id="51-mavenä¾èµ–"><a class="header" href="#51-mavenä¾èµ–">5.1 Mavenä¾èµ–</a></h3>
<pre><code class="language-xml">&lt;dependency&gt;
    &lt;groupId&gt;org.apache.hbase&lt;/groupId&gt;
    &lt;artifactId&gt;hbase-client&lt;/artifactId&gt;
    &lt;version&gt;2.5.5&lt;/version&gt;
&lt;/dependency&gt;

&lt;dependency&gt;
    &lt;groupId&gt;org.apache.hbase&lt;/groupId&gt;
    &lt;artifactId&gt;hbase-common&lt;/artifactId&gt;
    &lt;version&gt;2.5.5&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
<h3 id="52-è¿æ¥ç®¡ç†"><a class="header" href="#52-è¿æ¥ç®¡ç†">5.2 è¿æ¥ç®¡ç†</a></h3>
<pre><code class="language-java">import org.apache.hadoop.conf.Configuration;
import org.apache.hadoop.hbase.HBaseConfiguration;
import org.apache.hadoop.hbase.client.Connection;
import org.apache.hadoop.hbase.client.ConnectionFactory;

public class HBaseConnection {

    private static Connection connection;

    public static Connection getConnection() throws IOException {
        if (connection == null || connection.isClosed()) {
            Configuration conf = HBaseConfiguration.create();
            conf.set("hbase.zookeeper.quorum", "localhost:2181");
            conf.set("hbase.zookeeper.property.clientPort", "2181");
            connection = ConnectionFactory.createConnection(conf);
        }
        return connection;
    }

    public static void closeConnection() throws IOException {
        if (connection != null &amp;&amp; !connection.isClosed()) {
            connection.close();
        }
    }
}
</code></pre>
<h3 id="53-è¡¨æ“ä½œ-api"><a class="header" href="#53-è¡¨æ“ä½œ-api">5.3 è¡¨æ“ä½œ API</a></h3>
<p><strong>åˆ›å»ºè¡¨:</strong></p>
<pre><code class="language-java">import org.apache.hadoop.hbase.TableName;
import org.apache.hadoop.hbase.client.Admin;
import org.apache.hadoop.hbase.client.ColumnFamilyDescriptorBuilder;
import org.apache.hadoop.hbase.client.TableDescriptorBuilder;

public class TableOperations {

    public static void createTable(String tableName, String... columnFamilies)
            throws IOException {
        Connection conn = HBaseConnection.getConnection();
        Admin admin = conn.getAdmin();

        TableName table = TableName.valueOf(tableName);

        if (admin.tableExists(table)) {
            System.out.println("Table already exists!");
            return;
        }

        TableDescriptorBuilder builder = TableDescriptorBuilder.newBuilder(table);

        for (String cf : columnFamilies) {
            ColumnFamilyDescriptorBuilder cfBuilder =
                ColumnFamilyDescriptorBuilder.newBuilder(cf.getBytes());
            cfBuilder.setMaxVersions(5);
            builder.setColumnFamily(cfBuilder.build());
        }

        admin.createTable(builder.build());
        System.out.println("Table created successfully!");

        admin.close();
    }

    public static void deleteTable(String tableName) throws IOException {
        Connection conn = HBaseConnection.getConnection();
        Admin admin = conn.getAdmin();

        TableName table = TableName.valueOf(tableName);

        if (!admin.tableExists(table)) {
            System.out.println("Table does not exist!");
            return;
        }

        admin.disableTable(table);
        admin.deleteTable(table);
        System.out.println("Table deleted successfully!");

        admin.close();
    }
}
</code></pre>
<h3 id="54-æ•°æ®æ“ä½œ-api"><a class="header" href="#54-æ•°æ®æ“ä½œ-api">5.4 æ•°æ®æ“ä½œ API</a></h3>
<p><strong>Put æ“ä½œ:</strong></p>
<pre><code class="language-java">import org.apache.hadoop.hbase.TableName;
import org.apache.hadoop.hbase.client.Put;
import org.apache.hadoop.hbase.client.Table;
import org.apache.hadoop.hbase.util.Bytes;

public class DataOperations {

    public static void putData(String tableName, String rowKey,
                                String cf, String column, String value)
            throws IOException {
        Connection conn = HBaseConnection.getConnection();
        Table table = conn.getTable(TableName.valueOf(tableName));

        Put put = new Put(Bytes.toBytes(rowKey));
        put.addColumn(
            Bytes.toBytes(cf),
            Bytes.toBytes(column),
            Bytes.toBytes(value)
        );

        table.put(put);
        System.out.println("Data inserted successfully!");

        table.close();
    }

    // æ‰¹é‡æ’å…¥
    public static void batchPut(String tableName, List&lt;Put&gt; puts)
            throws IOException {
        Connection conn = HBaseConnection.getConnection();
        Table table = conn.getTable(TableName.valueOf(tableName));

        table.put(puts);
        System.out.println("Batch insert completed!");

        table.close();
    }
}
</code></pre>
<p><strong>Get æ“ä½œ:</strong></p>
<pre><code class="language-java">import org.apache.hadoop.hbase.client.Get;
import org.apache.hadoop.hbase.client.Result;
import org.apache.hadoop.hbase.Cell;
import org.apache.hadoop.hbase.CellUtil;

public class GetData {

    public static void getData(String tableName, String rowKey)
            throws IOException {
        Connection conn = HBaseConnection.getConnection();
        Table table = conn.getTable(TableName.valueOf(tableName));

        Get get = new Get(Bytes.toBytes(rowKey));

        // æŒ‡å®šåˆ—æ—
        // get.addFamily(Bytes.toBytes("info"));

        // æŒ‡å®šåˆ—
        // get.addColumn(Bytes.toBytes("info"), Bytes.toBytes("name"));

        Result result = table.get(get);

        for (Cell cell : result.rawCells()) {
            System.out.println("RowKey: " + Bytes.toString(CellUtil.cloneRow(cell)));
            System.out.println("CF: " + Bytes.toString(CellUtil.cloneFamily(cell)));
            System.out.println("Column: " + Bytes.toString(CellUtil.cloneQualifier(cell)));
            System.out.println("Value: " + Bytes.toString(CellUtil.cloneValue(cell)));
            System.out.println("Timestamp: " + cell.getTimestamp());
        }

        table.close();
    }
}
</code></pre>
<p><strong>Scan æ“ä½œ:</strong></p>
<pre><code class="language-java">import org.apache.hadoop.hbase.client.Scan;
import org.apache.hadoop.hbase.client.ResultScanner;

public class ScanData {

    public static void scanTable(String tableName) throws IOException {
        Connection conn = HBaseConnection.getConnection();
        Table table = conn.getTable(TableName.valueOf(tableName));

        Scan scan = new Scan();

        // è®¾ç½®èµ·å§‹è¡Œå’Œç»“æŸè¡Œ
        // scan.withStartRow(Bytes.toBytes("row1"));
        // scan.withStopRow(Bytes.toBytes("row100"));

        // è®¾ç½®ç¼“å­˜
        scan.setCaching(100);

        ResultScanner scanner = table.getScanner(scan);

        for (Result result : scanner) {
            for (Cell cell : result.rawCells()) {
                System.out.println("RowKey: " +
                    Bytes.toString(CellUtil.cloneRow(cell)));
                System.out.println("Value: " +
                    Bytes.toString(CellUtil.cloneValue(cell)));
            }
        }

        scanner.close();
        table.close();
    }
}
</code></pre>
<p><strong>Delete æ“ä½œ:</strong></p>
<pre><code class="language-java">import org.apache.hadoop.hbase.client.Delete;

public class DeleteData {

    public static void deleteData(String tableName, String rowKey)
            throws IOException {
        Connection conn = HBaseConnection.getConnection();
        Table table = conn.getTable(TableName.valueOf(tableName));

        Delete delete = new Delete(Bytes.toBytes(rowKey));

        // åˆ é™¤æŒ‡å®šåˆ—
        // delete.addColumn(Bytes.toBytes("info"), Bytes.toBytes("age"));

        // åˆ é™¤æŒ‡å®šåˆ—æ—
        // delete.addFamily(Bytes.toBytes("info"));

        table.delete(delete);
        System.out.println("Data deleted successfully!");

        table.close();
    }
}
</code></pre>
<h3 id="55-è¿‡æ»¤å™¨ä½¿ç”¨"><a class="header" href="#55-è¿‡æ»¤å™¨ä½¿ç”¨">5.5 è¿‡æ»¤å™¨ä½¿ç”¨</a></h3>
<pre><code class="language-java">import org.apache.hadoop.hbase.filter.*;
import org.apache.hadoop.hbase.util.Bytes;

public class FilterExample {

    public static void scanWithFilter(String tableName) throws IOException {
        Connection conn = HBaseConnection.getConnection();
        Table table = conn.getTable(TableName.valueOf(tableName));

        Scan scan = new Scan();

        // 1. RowKeyè¿‡æ»¤å™¨
        Filter rowFilter = new PrefixFilter(Bytes.toBytes("row"));
        scan.setFilter(rowFilter);

        // 2. åˆ—å€¼è¿‡æ»¤å™¨
        Filter valueFilter = new SingleColumnValueFilter(
            Bytes.toBytes("info"),
            Bytes.toBytes("age"),
            CompareOperator.GREATER,
            Bytes.toBytes("25")
        );

        // 3. ç»„åˆè¿‡æ»¤å™¨
        FilterList filterList = new FilterList(FilterList.Operator.MUST_PASS_ALL);
        filterList.addFilter(rowFilter);
        filterList.addFilter(valueFilter);
        scan.setFilter(filterList);

        // 4. é¡µé¢è¿‡æ»¤å™¨
        Filter pageFilter = new PageFilter(10);

        ResultScanner scanner = table.getScanner(scan);

        for (Result result : scanner) {
            System.out.println("RowKey: " +
                Bytes.toString(result.getRow()));
        }

        scanner.close();
        table.close();
    }
}
</code></pre>
<h2 id="6-hbase-é«˜çº§ç‰¹æ€§"><a class="header" href="#6-hbase-é«˜çº§ç‰¹æ€§">6. HBase é«˜çº§ç‰¹æ€§</a></h2>
<h3 id="61-region-åˆ†è£‚"><a class="header" href="#61-region-åˆ†è£‚">6.1 Region åˆ†è£‚</a></h3>
<p><strong>è‡ªåŠ¨åˆ†è£‚:</strong></p>
<pre><code class="language-xml">&lt;!-- hbase-site.xml --&gt;
&lt;property&gt;
  &lt;name&gt;hbase.hregion.max.filesize&lt;/name&gt;
  &lt;value&gt;10737418240&lt;/value&gt; &lt;!-- 10GB --&gt;
&lt;/property&gt;
</code></pre>
<p><strong>é¢„åˆ†åŒº:</strong></p>
<pre><code class="language-java">// åˆ›å»ºé¢„åˆ†åŒºè¡¨
byte[][] splitKeys = new byte[][]{
    Bytes.toBytes("1000"),
    Bytes.toBytes("2000"),
    Bytes.toBytes("3000"),
    Bytes.toBytes("4000")
};

admin.createTable(tableDescriptor, splitKeys);
</code></pre>
<p><strong>æ‰‹åŠ¨åˆ†è£‚:</strong></p>
<pre><code class="language-ruby"># HBase Shell
split 'users', 'row5000'
</code></pre>
<h3 id="62-region-åˆå¹¶"><a class="header" href="#62-region-åˆå¹¶">6.2 Region åˆå¹¶</a></h3>
<pre><code class="language-bash"># åˆå¹¶ç›¸é‚»Region
./bin/hbase org.apache.hadoop.hbase.util.Merge &lt;table_name&gt; &lt;region1&gt; &lt;region2&gt;
</code></pre>
<h3 id="63-åå¤„ç†å™¨-coprocessor"><a class="header" href="#63-åå¤„ç†å™¨-coprocessor">6.3 åå¤„ç†å™¨ (Coprocessor)</a></h3>
<p><strong>Observeråå¤„ç†å™¨:</strong></p>
<pre><code class="language-java">import org.apache.hadoop.hbase.coprocessor.ObserverContext;
import org.apache.hadoop.hbase.coprocessor.RegionCoprocessor;
import org.apache.hadoop.hbase.coprocessor.RegionCoprocessorEnvironment;
import org.apache.hadoop.hbase.coprocessor.RegionObserver;

public class MyCoprocessor implements RegionCoprocessor, RegionObserver {

    @Override
    public void prePut(ObserverContext&lt;RegionCoprocessorEnvironment&gt; c,
                       Put put, WALEdit edit, Durability durability)
            throws IOException {
        // Putæ“ä½œå‰çš„é€»è¾‘
        System.out.println("Before Put: " + Bytes.toString(put.getRow()));
    }

    @Override
    public void postPut(ObserverContext&lt;RegionCoprocessorEnvironment&gt; c,
                        Put put, WALEdit edit, Durability durability)
            throws IOException {
        // Putæ“ä½œåçš„é€»è¾‘
        System.out.println("After Put: " + Bytes.toString(put.getRow()));
    }
}
</code></pre>
<p><strong>åŠ è½½åå¤„ç†å™¨:</strong></p>
<pre><code class="language-ruby"># HBase Shell
alter 'users', METHOD =&gt; 'table_att',
  'coprocessor' =&gt; 'hdfs:///coprocessors/mycoprocessor.jar|com.example.MyCoprocessor|1001|'
</code></pre>
<h3 id="64-bulkload-æ‰¹é‡å¯¼å…¥"><a class="header" href="#64-bulkload-æ‰¹é‡å¯¼å…¥">6.4 BulkLoad æ‰¹é‡å¯¼å…¥</a></h3>
<pre><code class="language-java">import org.apache.hadoop.hbase.mapreduce.HFileOutputFormat2;
import org.apache.hadoop.hbase.mapreduce.LoadIncrementalHFiles;
import org.apache.hadoop.mapreduce.Job;

public class BulkLoadExample {

    public static void bulkLoad(String inputPath, String tableName)
            throws Exception {
        Configuration conf = HBaseConfiguration.create();
        Connection conn = ConnectionFactory.createConnection(conf);

        Job job = Job.getInstance(conf);
        job.setJarByClass(BulkLoadExample.class);

        Table table = conn.getTable(TableName.valueOf(tableName));
        RegionLocator regionLocator = conn.getRegionLocator(TableName.valueOf(tableName));

        // é…ç½®è¾“å‡ºæ ¼å¼
        HFileOutputFormat2.configureIncrementalLoad(
            job, table, regionLocator
        );

        // è®¾ç½®è¾“å…¥è¾“å‡ºè·¯å¾„
        FileInputFormat.addInputPath(job, new Path(inputPath));
        FileOutputFormat.setOutputPath(job, new Path("/tmp/hfiles"));

        // è¿è¡ŒMapReduceä½œä¸š
        job.waitForCompletion(true);

        // åŠ è½½HFilesåˆ°HBase
        LoadIncrementalHFiles loader = new LoadIncrementalHFiles(conf);
        loader.doBulkLoad(new Path("/tmp/hfiles"), (Admin) conn.getAdmin(), table, regionLocator);

        table.close();
        conn.close();
    }
}
</code></pre>
<h3 id="65-å¿«ç…§-snapshot"><a class="header" href="#65-å¿«ç…§-snapshot">6.5 å¿«ç…§ (Snapshot)</a></h3>
<pre><code class="language-ruby"># åˆ›å»ºå¿«ç…§
snapshot 'users', 'users_snapshot_20240101'

# åˆ—å‡ºå¿«ç…§
list_snapshots

# ä»å¿«ç…§æ¢å¤
disable 'users'
restore_snapshot 'users_snapshot_20240101'
enable 'users'

# å…‹éš†å¿«ç…§
clone_snapshot 'users_snapshot_20240101', 'users_backup'

# åˆ é™¤å¿«ç…§
delete_snapshot 'users_snapshot_20240101'
</code></pre>
<h2 id="7-hbase-æ€§èƒ½ä¼˜åŒ–"><a class="header" href="#7-hbase-æ€§èƒ½ä¼˜åŒ–">7. HBase æ€§èƒ½ä¼˜åŒ–</a></h2>
<h3 id="71-rowkey-è®¾è®¡"><a class="header" href="#71-rowkey-è®¾è®¡">7.1 RowKey è®¾è®¡</a></h3>
<p><strong>è®¾è®¡åŸåˆ™:</strong></p>
<pre><code>1. æ•£åˆ—æ€§: é¿å…çƒ­ç‚¹é—®é¢˜
   ä¸å¥½: timestamp + userId
   å¥½: MD5(userId)[0:4] + timestamp + userId

2. å”¯ä¸€æ€§: ç¡®ä¿RowKeyå”¯ä¸€

3. é•¿åº¦: å»ºè®®10-100å­—èŠ‚

4. æœ‰åºæ€§: åˆ©ç”¨æ’åºç‰¹æ€§
</code></pre>
<p><strong>å¸¸è§è®¾è®¡æ¨¡å¼:</strong></p>
<pre><code class="language-java">// 1. åè½¬æ—¶é—´æˆ³ (æœ€æ–°æ•°æ®ä¼˜å…ˆ)
String rowKey = userId + "_" + (Long.MAX_VALUE - timestamp);

// 2. æ•£åˆ—å‰ç¼€
String rowKey = MD5(userId).substring(0, 4) + "_" + userId + "_" + timestamp;

// 3. åˆ†æ¡¶
int bucket = userId.hashCode() % 100;
String rowKey = String.format("%02d", bucket) + "_" + userId + "_" + timestamp;
</code></pre>
<h3 id="72-åˆ—æ—è®¾è®¡"><a class="header" href="#72-åˆ—æ—è®¾è®¡">7.2 åˆ—æ—è®¾è®¡</a></h3>
<pre><code>è®¾è®¡åŸåˆ™:
1. åˆ—æ—æ•°é‡: å»ºè®®1-3ä¸ª,ä¸è¶…è¿‡5ä¸ª
2. åˆ—æ—åç§°: çŸ­åç§°èŠ‚çœå­˜å‚¨ç©ºé—´
3. æ•°æ®ç‰¹æ€§: ç›¸åŒè®¿é—®æ¨¡å¼çš„åˆ—æ”¾åœ¨åŒä¸€åˆ—æ—
</code></pre>
<h3 id="73-é¢„åˆ†åŒº"><a class="header" href="#73-é¢„åˆ†åŒº">7.3 é¢„åˆ†åŒº</a></h3>
<pre><code class="language-java">// æ–¹æ³•1: å‡åŒ€åˆ†åŒº
public static byte[][] getHexSplits(String startKey, String endKey, int numRegions) {
    byte[][] splits = new byte[numRegions - 1][];
    BigInteger lowestKey = new BigInteger(startKey, 16);
    BigInteger highestKey = new BigInteger(endKey, 16);
    BigInteger range = highestKey.subtract(lowestKey);
    BigInteger regionIncrement = range.divide(BigInteger.valueOf(numRegions));

    for (int i = 1; i &lt; numRegions; i++) {
        BigInteger key = lowestKey.add(regionIncrement.multiply(BigInteger.valueOf(i)));
        splits[i - 1] = Bytes.toBytes(key.toString(16));
    }

    return splits;
}

// æ–¹æ³•2: åŸºäºæ•°æ®åˆ†å¸ƒ
byte[][] splits = new byte[][]{
    Bytes.toBytes("user_1000"),
    Bytes.toBytes("user_5000"),
    Bytes.toBytes("user_10000")
};
</code></pre>
<h3 id="74-å†™å…¥ä¼˜åŒ–"><a class="header" href="#74-å†™å…¥ä¼˜åŒ–">7.4 å†™å…¥ä¼˜åŒ–</a></h3>
<pre><code class="language-xml">&lt;!-- å†™ç¼“å†²é…ç½® --&gt;
&lt;property&gt;
  &lt;name&gt;hbase.client.write.buffer&lt;/name&gt;
  &lt;value&gt;2097152&lt;/value&gt; &lt;!-- 2MB --&gt;
&lt;/property&gt;

&lt;!-- è‡ªåŠ¨åˆ·æ–° --&gt;
&lt;property&gt;
  &lt;name&gt;hbase.regionserver.optionalcacheflushinterval&lt;/name&gt;
  &lt;value&gt;3600000&lt;/value&gt; &lt;!-- 1å°æ—¶ --&gt;
&lt;/property&gt;
</code></pre>
<p><strong>æ‰¹é‡å†™å…¥:</strong></p>
<pre><code class="language-java">// ä½¿ç”¨æ‰¹é‡Put
List&lt;Put&gt; puts = new ArrayList&lt;&gt;();
for (int i = 0; i &lt; 10000; i++) {
    Put put = new Put(Bytes.toBytes("row" + i));
    put.addColumn(Bytes.toBytes("info"), Bytes.toBytes("name"), Bytes.toBytes("user" + i));
    puts.add(put);

    // åˆ†æ‰¹æäº¤
    if (puts.size() &gt;= 1000) {
        table.put(puts);
        puts.clear();
    }
}

if (!puts.isEmpty()) {
    table.put(puts);
}
</code></pre>
<h3 id="75-è¯»å–ä¼˜åŒ–"><a class="header" href="#75-è¯»å–ä¼˜åŒ–">7.5 è¯»å–ä¼˜åŒ–</a></h3>
<p><strong>BlockCacheé…ç½®:</strong></p>
<pre><code class="language-xml">&lt;property&gt;
  &lt;name&gt;hfile.block.cache.size&lt;/name&gt;
  &lt;value&gt;0.4&lt;/value&gt; &lt;!-- 40% heap --&gt;
&lt;/property&gt;
</code></pre>
<p><strong>å¸ƒéš†è¿‡æ»¤å™¨:</strong></p>
<pre><code class="language-java">ColumnFamilyDescriptorBuilder cfBuilder =
    ColumnFamilyDescriptorBuilder.newBuilder(Bytes.toBytes("info"));
cfBuilder.setBloomFilterType(BloomType.ROW);
</code></pre>
<p><strong>æ‰«æä¼˜åŒ–:</strong></p>
<pre><code class="language-java">Scan scan = new Scan();
// è®¾ç½®ç¼“å­˜è¡Œæ•°
scan.setCaching(100);
// è®¾ç½®æ‰¹é‡å¤§å°
scan.setBatch(10);
// åªè¿”å›æŒ‡å®šåˆ—
scan.addColumn(Bytes.toBytes("info"), Bytes.toBytes("name"));
</code></pre>
<h3 id="76-å‹ç¼©ä¼˜åŒ–"><a class="header" href="#76-å‹ç¼©ä¼˜åŒ–">7.6 å‹ç¼©ä¼˜åŒ–</a></h3>
<pre><code class="language-java">ColumnFamilyDescriptorBuilder cfBuilder =
    ColumnFamilyDescriptorBuilder.newBuilder(Bytes.toBytes("info"));

// è®¾ç½®å‹ç¼©ç®—æ³•
cfBuilder.setCompressionType(Compression.Algorithm.SNAPPY);

// å¯ç”¨å‹ç¼©æ ‡ç­¾
cfBuilder.setCompressTags(true);
</code></pre>
<p><strong>å‹ç¼©ç®—æ³•å¯¹æ¯”:</strong></p>
<div class="table-wrapper"><table><thead><tr><th>ç®—æ³•</th><th>å‹ç¼©æ¯”</th><th>CPUå¼€é”€</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody>
<tr><td>NONE</td><td>æ— </td><td>æ— </td><td>æµ‹è¯•ç¯å¢ƒ</td></tr>
<tr><td>SNAPPY</td><td>ä¸­</td><td>ä½</td><td>é€šç”¨åœºæ™¯(æ¨è)</td></tr>
<tr><td>LZO</td><td>ä¸­</td><td>ä½</td><td>é€šç”¨åœºæ™¯</td></tr>
<tr><td>GZIP</td><td>é«˜</td><td>é«˜</td><td>å†·æ•°æ®</td></tr>
<tr><td>LZ4</td><td>ä½</td><td>å¾ˆä½</td><td>çƒ­æ•°æ®</td></tr>
</tbody></table>
</div>
<h3 id="77-compaction-ä¼˜åŒ–"><a class="header" href="#77-compaction-ä¼˜åŒ–">7.7 Compaction ä¼˜åŒ–</a></h3>
<pre><code class="language-xml">&lt;!-- Major Compactioné—´éš” --&gt;
&lt;property&gt;
  &lt;name&gt;hbase.hregion.majorcompaction&lt;/name&gt;
  &lt;value&gt;604800000&lt;/value&gt; &lt;!-- 7å¤© --&gt;
&lt;/property&gt;

&lt;!-- æœ€å°Compactionæ–‡ä»¶æ•° --&gt;
&lt;property&gt;
  &lt;name&gt;hbase.hstore.compaction.min&lt;/name&gt;
  &lt;value&gt;3&lt;/value&gt;
&lt;/property&gt;

&lt;!-- æœ€å¤§Compactionæ–‡ä»¶æ•° --&gt;
&lt;property&gt;
  &lt;name&gt;hbase.hstore.compaction.max&lt;/name&gt;
  &lt;value&gt;10&lt;/value&gt;
&lt;/property&gt;
</code></pre>
<p><strong>æ‰‹åŠ¨Compaction:</strong></p>
<pre><code class="language-ruby"># Minor Compaction
compact 'users'

# Major Compaction
major_compact 'users'
</code></pre>
<h2 id="8-hbase-è¿ç»´ç®¡ç†"><a class="header" href="#8-hbase-è¿ç»´ç®¡ç†">8. HBase è¿ç»´ç®¡ç†</a></h2>
<h3 id="81-é›†ç¾¤ç›‘æ§"><a class="header" href="#81-é›†ç¾¤ç›‘æ§">8.1 é›†ç¾¤ç›‘æ§</a></h3>
<p><strong>Web UI:</strong></p>
<pre><code>HMaster Web UI: http://master:16010
RegionServer Web UI: http://regionserver:16030
</code></pre>
<p><strong>ç›‘æ§æŒ‡æ ‡:</strong></p>
<pre><code class="language-bash"># æŸ¥çœ‹é›†ç¾¤çŠ¶æ€
echo "status 'detailed'" | hbase shell

# æŸ¥çœ‹è¡¨è¯¦æƒ…
echo "describe 'users'" | hbase shell

# æŸ¥çœ‹Regionåˆ†å¸ƒ
./bin/hbase hbck -details
</code></pre>
<p><strong>JMXç›‘æ§:</strong></p>
<pre><code class="language-xml">&lt;!-- hbase-env.sh --&gt;
export HBASE_JMX_BASE="-Dcom.sun.management.jmxremote.ssl=false \
  -Dcom.sun.management.jmxremote.authenticate=false \
  -Dcom.sun.management.jmxremote.port=10101"
</code></pre>
<h3 id="82-å¤‡ä»½ä¸æ¢å¤"><a class="header" href="#82-å¤‡ä»½ä¸æ¢å¤">8.2 å¤‡ä»½ä¸æ¢å¤</a></h3>
<p><strong>ä½¿ç”¨Export/Import:</strong></p>
<pre><code class="language-bash"># å¯¼å‡ºè¡¨
hbase org.apache.hadoop.hbase.mapreduce.Export \
  users /backup/users_20240101

# å¯¼å…¥è¡¨
hbase org.apache.hadoop.hbase.mapreduce.Import \
  users /backup/users_20240101
</code></pre>
<p><strong>ä½¿ç”¨CopyTable:</strong></p>
<pre><code class="language-bash"># å¤åˆ¶è¡¨åˆ°å¦ä¸€ä¸ªé›†ç¾¤
hbase org.apache.hadoop.hbase.mapreduce.CopyTable \
  --peer.adr=backup-cluster:2181:/hbase \
  --new.name=users_backup \
  users
</code></pre>
<p><strong>ä½¿ç”¨Snapshot:</strong></p>
<pre><code class="language-ruby"># åˆ›å»ºå¿«ç…§
snapshot 'users', 'users_snapshot'

# å¯¼å‡ºå¿«ç…§åˆ°HDFS
hbase org.apache.hadoop.hbase.snapshot.ExportSnapshot \
  -snapshot users_snapshot \
  -copy-to hdfs://backup-cluster/hbase
</code></pre>
<h3 id="83-æ•…éšœæ’æŸ¥"><a class="header" href="#83-æ•…éšœæ’æŸ¥">8.3 æ•…éšœæ’æŸ¥</a></h3>
<p><strong>å¸¸è§é—®é¢˜:</strong></p>
<p><strong>é—®é¢˜1: RegionServerå®•æœº</strong></p>
<pre><code class="language-bash"># æ£€æŸ¥æ—¥å¿—
tail -f $HBASE_HOME/logs/hbase-*-regionserver-*.log

# æ‰‹åŠ¨åˆ†é…Region
./bin/hbase hbck -repair

# é‡å¯RegionServer
./bin/hbase-daemon.sh restart regionserver
</code></pre>
<p><strong>é—®é¢˜2: Regioné•¿æ—¶é—´å¤„äºRITçŠ¶æ€</strong></p>
<pre><code class="language-bash"># æŸ¥çœ‹RIT Region
./bin/hbase hbck -details

# å¼ºåˆ¶åˆ†é…Region
assign 'region_name'

# æˆ–ä½¿ç”¨hbckä¿®å¤
./bin/hbase hbck -fixAssignments
</code></pre>
<p><strong>é—®é¢˜3: HBaseå“åº”æ…¢</strong></p>
<pre><code class="language-bash"># æ£€æŸ¥GC
jstat -gcutil &lt;pid&gt; 1000

# æ£€æŸ¥BlockCacheå‘½ä¸­ç‡
# åœ¨Web UIæŸ¥çœ‹: Metrics -&gt; BlockCache

# æ£€æŸ¥Compactioné˜Ÿåˆ—
# åœ¨Web UIæŸ¥çœ‹: RegionServer -&gt; Compaction Queue

# ä¼˜åŒ–å»ºè®®:
# 1. å¢åŠ å†…å­˜
# 2. ä¼˜åŒ–RowKeyè®¾è®¡
# 3. å¯ç”¨å¸ƒéš†è¿‡æ»¤å™¨
# 4. å¢åŠ Regionæ•°é‡
</code></pre>
<h3 id="84-æ—¥å¿—åˆ†æ"><a class="header" href="#84-æ—¥å¿—åˆ†æ">8.4 æ—¥å¿—åˆ†æ</a></h3>
<pre><code class="language-bash"># Masteræ—¥å¿—
$HBASE_HOME/logs/hbase-*-master-*.log

# RegionServeræ—¥å¿—
$HBASE_HOME/logs/hbase-*-regionserver-*.log

# æŸ¥æ‰¾ERROR
grep ERROR $HBASE_HOME/logs/*.log

# æŸ¥æ‰¾æ…¢æŸ¥è¯¢
grep "responseTooSlow" $HBASE_HOME/logs/*.log
</code></pre>
<h2 id="9-hbase-ä¸å…¶ä»–ç»„ä»¶é›†æˆ"><a class="header" href="#9-hbase-ä¸å…¶ä»–ç»„ä»¶é›†æˆ">9. HBase ä¸å…¶ä»–ç»„ä»¶é›†æˆ</a></h2>
<h3 id="91-hbase--spark"><a class="header" href="#91-hbase--spark">9.1 HBase + Spark</a></h3>
<pre><code class="language-scala">import org.apache.hadoop.hbase.spark.HBaseContext
import org.apache.hadoop.hbase.client.{Result, Scan}
import org.apache.spark.SparkContext

val sc = new SparkContext(sparkConf)
val hbaseContext = new HBaseContext(sc, config)

// è¯»å–HBaseæ•°æ®
val scan = new Scan()
val rdd = hbaseContext.hbaseRDD(
  TableName.valueOf("users"),
  scan
)

rdd.foreach { case (key, result) =&gt;
  println(s"RowKey: ${Bytes.toString(key.get())}")
}

// å†™å…¥HBaseæ•°æ®
val puts = sc.parallelize(1 to 1000).map { i =&gt;
  val put = new Put(Bytes.toBytes(s"row$i"))
  put.addColumn(Bytes.toBytes("info"), Bytes.toBytes("name"), Bytes.toBytes(s"user$i"))
  put
}

hbaseContext.bulkPut(puts, TableName.valueOf("users"))
</code></pre>
<h3 id="92-hbase--phoenix"><a class="header" href="#92-hbase--phoenix">9.2 HBase + Phoenix</a></h3>
<p><strong>å®‰è£…Phoenix:</strong></p>
<pre><code class="language-bash"># 1. ä¸‹è½½Phoenix
wget https://dlcdn.apache.org/phoenix/phoenix-5.1.3/phoenix-hbase-2.5-5.1.3-bin.tar.gz

# 2. æ‹·è´jaråˆ°HBase lib
cp phoenix-server-hbase-*.jar $HBASE_HOME/lib/

# 3. é‡å¯HBase

# 4. å¯åŠ¨Phoenixå®¢æˆ·ç«¯
./bin/sqlline.py localhost:2181
</code></pre>
<p><strong>ä½¿ç”¨Phoenix:</strong></p>
<pre><code class="language-sql">-- åˆ›å»ºè¡¨
CREATE TABLE users (
    id VARCHAR PRIMARY KEY,
    name VARCHAR,
    age INTEGER,
    city VARCHAR
);

-- æ’å…¥æ•°æ®
UPSERT INTO users VALUES ('1', 'Alice', 25, 'Beijing');

-- æŸ¥è¯¢æ•°æ®
SELECT * FROM users WHERE age &gt; 20;

-- åˆ›å»ºç´¢å¼•
CREATE INDEX idx_age ON users (age);

-- åˆ›å»ºè§†å›¾(æ˜ å°„å·²æœ‰HBaseè¡¨)
CREATE VIEW hbase_users (
    rowkey VARCHAR PRIMARY KEY,
    "info"."name" VARCHAR,
    "info"."age" INTEGER
);
</code></pre>
<h3 id="93-hbase--hive"><a class="header" href="#93-hbase--hive">9.3 HBase + Hive</a></h3>
<pre><code class="language-sql">-- åˆ›å»ºHiveå¤–éƒ¨è¡¨æ˜ å°„HBase
CREATE EXTERNAL TABLE hive_hbase_users (
    key STRING,
    name STRING,
    age INT
)
STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'
WITH SERDEPROPERTIES (
    "hbase.columns.mapping" = ":key,info:name,info:age"
)
TBLPROPERTIES (
    "hbase.table.name" = "users"
);

-- æŸ¥è¯¢HBaseæ•°æ®
SELECT * FROM hive_hbase_users WHERE age &gt; 25;

-- æ’å…¥æ•°æ®åˆ°HBase
INSERT INTO hive_hbase_users VALUES ('row1', 'Alice', 25);
</code></pre>
<h2 id="10-hbase-æœ€ä½³å®è·µ"><a class="header" href="#10-hbase-æœ€ä½³å®è·µ">10. HBase æœ€ä½³å®è·µ</a></h2>
<h3 id="101-æ•°æ®å»ºæ¨¡æœ€ä½³å®è·µ"><a class="header" href="#101-æ•°æ®å»ºæ¨¡æœ€ä½³å®è·µ">10.1 æ•°æ®å»ºæ¨¡æœ€ä½³å®è·µ</a></h3>
<p><strong>1. RowKeyè®¾è®¡:</strong></p>
<pre><code>âœ“ ä½¿ç”¨æ•£åˆ—å‰ç¼€é¿å…çƒ­ç‚¹
âœ“ åè½¬æ—¶é—´æˆ³å®ç°å€’åºæ’åˆ—
âœ“ æ§åˆ¶RowKeyé•¿åº¦(10-100å­—èŠ‚)
âœ— é¿å…ä½¿ç”¨é€’å¢æ•°å­—ä½œä¸ºRowKey
âœ— é¿å…ä½¿ç”¨æ—¶é—´æˆ³ä½œä¸ºRowKeyå‰ç¼€
</code></pre>
<p><strong>2. åˆ—æ—è®¾è®¡:</strong></p>
<pre><code>âœ“ åˆ—æ—æ•°é‡æ§åˆ¶åœ¨1-3ä¸ª
âœ“ åˆ—æ—åç§°ä½¿ç”¨çŸ­åç§°(1-2å­—ç¬¦)
âœ“ å°†è®¿é—®æ¨¡å¼ç›¸åŒçš„åˆ—æ”¾åœ¨åŒä¸€åˆ—æ—
âœ— é¿å…åˆ›å»ºè¿‡å¤šåˆ—æ—
âœ— é¿å…åˆ—æ—ä¸­æ•°æ®é‡å·®å¼‚è¿‡å¤§
</code></pre>
<p><strong>3. ç‰ˆæœ¬ç®¡ç†:</strong></p>
<pre><code>âœ“ æ ¹æ®ä¸šåŠ¡éœ€æ±‚è®¾ç½®åˆç†çš„ç‰ˆæœ¬æ•°
âœ“ ä½¿ç”¨TTLè‡ªåŠ¨æ¸…ç†è¿‡æœŸæ•°æ®
âœ— é¿å…ä¿å­˜è¿‡å¤šç‰ˆæœ¬
</code></pre>
<h3 id="102-æ€§èƒ½è°ƒä¼˜æœ€ä½³å®è·µ"><a class="header" href="#102-æ€§èƒ½è°ƒä¼˜æœ€ä½³å®è·µ">10.2 æ€§èƒ½è°ƒä¼˜æœ€ä½³å®è·µ</a></h3>
<p><strong>1. å†™å…¥ä¼˜åŒ–:</strong></p>
<pre><code class="language-java">// æ‰¹é‡å†™å…¥
table.setAutoFlushTo(false);
table.setWriteBufferSize(2 * 1024 * 1024); // 2MB

List&lt;Put&gt; puts = new ArrayList&lt;&gt;();
for (...) {
    puts.add(put);
    if (puts.size() &gt;= 1000) {
        table.put(puts);
        puts.clear();
    }
}
</code></pre>
<p><strong>2. è¯»å–ä¼˜åŒ–:</strong></p>
<pre><code class="language-java">// ä½¿ç”¨æ‰«æç¼“å­˜
Scan scan = new Scan();
scan.setCaching(1000);
scan.setBatch(100);

// ä½¿ç”¨å¸ƒéš†è¿‡æ»¤å™¨
cfDescriptor.setBloomFilterType(BloomType.ROW);

// å¯ç”¨BlockCache
scan.setCacheBlocks(true);
</code></pre>
<p><strong>3. é¢„åˆ†åŒº:</strong></p>
<pre><code class="language-ruby">create 'users', 'info', SPLITS =&gt; ['1000', '2000', '3000', '4000']
</code></pre>
<h3 id="103-è¿ç»´æœ€ä½³å®è·µ"><a class="header" href="#103-è¿ç»´æœ€ä½³å®è·µ">10.3 è¿ç»´æœ€ä½³å®è·µ</a></h3>
<pre><code class="language-yaml">ç›‘æ§æŒ‡æ ‡:
  - RegionServer JVMå†…å­˜ä½¿ç”¨
  - BlockCacheå‘½ä¸­ç‡
  - Compactioné˜Ÿåˆ—é•¿åº¦
  - Regionæ•°é‡å’Œå¤§å°
  - è¯·æ±‚å»¶è¿Ÿ(P99)

å®šæœŸä»»åŠ¡:
  - æ¯å‘¨æ‰§è¡ŒMajor Compaction
  - æ¯å¤©æ£€æŸ¥é›†ç¾¤å¥åº·çŠ¶æ€
  - å®šæœŸå¤‡ä»½é‡è¦è¡¨
  - å®šæœŸæ¸…ç†è¿‡æœŸæ•°æ®

å®¹é‡è§„åˆ’:
  - é¢„ä¼°æ•°æ®å¢é•¿é‡
  - æå‰æ‰©å®¹
  - ç›‘æ§ç£ç›˜ä½¿ç”¨ç‡
</code></pre>
<h3 id="104-å®‰å…¨æœ€ä½³å®è·µ"><a class="header" href="#104-å®‰å…¨æœ€ä½³å®è·µ">10.4 å®‰å…¨æœ€ä½³å®è·µ</a></h3>
<pre><code class="language-xml">&lt;!-- å¯ç”¨Kerberosè®¤è¯ --&gt;
&lt;property&gt;
  &lt;name&gt;hbase.security.authentication&lt;/name&gt;
  &lt;value&gt;kerberos&lt;/value&gt;
&lt;/property&gt;

&lt;!-- å¯ç”¨æˆæƒ --&gt;
&lt;property&gt;
  &lt;name&gt;hbase.security.authorization&lt;/name&gt;
  &lt;value&gt;true&lt;/value&gt;
&lt;/property&gt;

&lt;!-- å¯ç”¨ACL --&gt;
&lt;property&gt;
  &lt;name&gt;hbase.coprocessor.master.classes&lt;/name&gt;
  &lt;value&gt;org.apache.hadoop.hbase.security.access.AccessController&lt;/value&gt;
&lt;/property&gt;
</code></pre>
<p><strong>è®¾ç½®æƒé™:</strong></p>
<pre><code class="language-ruby"># æˆäºˆç”¨æˆ·è¯»æƒé™
grant 'user1', 'R', 'users'

# æˆäºˆç”¨æˆ·å†™æƒé™
grant 'user1', 'W', 'users'

# æˆäºˆç”¨æˆ·å®Œå…¨æƒé™
grant 'user1', 'RWXCA', 'users'

# æŸ¥çœ‹æƒé™
user_permission 'users'

# æ’¤é”€æƒé™
revoke 'user1', 'users'
</code></pre>
<h2 id="11-å­¦ä¹ éªŒè¯æ ‡å‡†"><a class="header" href="#11-å­¦ä¹ éªŒè¯æ ‡å‡†">11. å­¦ä¹ éªŒè¯æ ‡å‡†</a></h2>
<h3 id="-åŸºç¡€èƒ½åŠ›éªŒè¯"><a class="header" href="#-åŸºç¡€èƒ½åŠ›éªŒè¯">âœ… åŸºç¡€èƒ½åŠ›éªŒè¯</a></h3>
<ul>
<li><input disabled="" type="checkbox"/>
ç†è§£HBaseæ¶æ„å’Œæ•°æ®æ¨¡å‹</li>
<li><input disabled="" type="checkbox"/>
èƒ½å¤Ÿä½¿ç”¨HBase Shellè¿›è¡ŒåŸºæœ¬æ“ä½œ</li>
<li><input disabled="" type="checkbox"/>
æŒæ¡Java APIè¿›è¡ŒCRUDæ“ä½œ</li>
<li><input disabled="" type="checkbox"/>
ç†è§£Regionåˆ†è£‚å’Œåˆå¹¶æœºåˆ¶</li>
</ul>
<h3 id="-è¿›é˜¶èƒ½åŠ›éªŒè¯"><a class="header" href="#-è¿›é˜¶èƒ½åŠ›éªŒè¯">âœ… è¿›é˜¶èƒ½åŠ›éªŒè¯</a></h3>
<ul>
<li><input disabled="" type="checkbox"/>
èƒ½å¤Ÿè®¾è®¡åˆç†çš„RowKeyå’Œåˆ—æ—</li>
<li><input disabled="" type="checkbox"/>
æŒæ¡é¢„åˆ†åŒºå’Œæ€§èƒ½ä¼˜åŒ–æŠ€å·§</li>
<li><input disabled="" type="checkbox"/>
èƒ½å¤Ÿä½¿ç”¨è¿‡æ»¤å™¨è¿›è¡Œå¤æ‚æŸ¥è¯¢</li>
<li><input disabled="" type="checkbox"/>
ç†è§£åå¤„ç†å™¨å’ŒBulkLoad</li>
</ul>
<h3 id="-é«˜çº§èƒ½åŠ›éªŒè¯"><a class="header" href="#-é«˜çº§èƒ½åŠ›éªŒè¯">âœ… é«˜çº§èƒ½åŠ›éªŒè¯</a></h3>
<ul>
<li><input disabled="" type="checkbox"/>
èƒ½å¤Ÿéƒ¨ç½²å’Œç®¡ç†HBaseé›†ç¾¤</li>
<li><input disabled="" type="checkbox"/>
èƒ½å¤Ÿè¿›è¡Œæ€§èƒ½è°ƒä¼˜å’Œæ•…éšœæ’æŸ¥</li>
<li><input disabled="" type="checkbox"/>
æŒæ¡HBaseä¸å…¶ä»–ç»„ä»¶çš„é›†æˆ</li>
<li><input disabled="" type="checkbox"/>
å…·å¤‡ç”Ÿäº§ç¯å¢ƒè¿ç»´èƒ½åŠ›</li>
</ul>
<h2 id="12-æ‰©å±•èµ„æº"><a class="header" href="#12-æ‰©å±•èµ„æº">12. æ‰©å±•èµ„æº</a></h2>
<h3 id="å®˜æ–¹èµ„æº"><a class="header" href="#å®˜æ–¹èµ„æº">å®˜æ–¹èµ„æº</a></h3>
<ul>
<li>å®˜ç½‘: https://hbase.apache.org/</li>
<li>æ–‡æ¡£: https://hbase.apache.org/book.html</li>
<li>GitHub: https://github.com/apache/hbase</li>
</ul>
<h3 id="å­¦ä¹ å»ºè®®"><a class="header" href="#å­¦ä¹ å»ºè®®">å­¦ä¹ å»ºè®®</a></h3>
<ol>
<li>ä»HBaseæ•°æ®æ¨¡å‹å¼€å§‹ç†è§£</li>
<li>æŒæ¡HBase ShellåŸºæœ¬æ“ä½œ</li>
<li>å­¦ä¹ Java APIç¼–ç¨‹</li>
<li>å®è·µRowKeyè®¾è®¡å’Œä¼˜åŒ–</li>
<li>å­¦ä¹ é›†ç¾¤éƒ¨ç½²å’Œè¿ç»´</li>
</ol>
<h3 id="è¿›é˜¶æ–¹å‘"><a class="header" href="#è¿›é˜¶æ–¹å‘">è¿›é˜¶æ–¹å‘</a></h3>
<ul>
<li>HBaseå†…æ ¸åŸç†</li>
<li>LSMæ ‘å’ŒCompactionæœºåˆ¶</li>
<li>Phoenix SQLå¼•æ“</li>
<li>æ—¶åºæ•°æ®åº“OpenTSDB</li>
<li>HBaseäºŒçº§ç´¢å¼•</li>
</ul>
<h3 id="ç›¸å…³æŠ€æœ¯"><a class="header" href="#ç›¸å…³æŠ€æœ¯">ç›¸å…³æŠ€æœ¯</a></h3>
<ul>
<li>Apache Phoenix: SQL on HBase</li>
<li>OpenTSDB: æ—¶åºæ•°æ®åº“</li>
<li>Apache Kylin: OLAPå¼•æ“</li>
<li>Elasticsearch: æœç´¢å¼•æ“</li>
</ul>
<h3 id="æ¨èä¹¦ç±"><a class="header" href="#æ¨èä¹¦ç±">æ¨èä¹¦ç±</a></h3>
<ul>
<li>HBaseæƒå¨æŒ‡å—</li>
<li>HBaseå®æˆ˜</li>
<li>HBaseåŸç†ä¸å®è·µ</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../ç¼–ç¨‹/bigdata/6-Airflow.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../ç¼–ç¨‹/bigdata/8-MapReduce.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../ç¼–ç¨‹/bigdata/6-Airflow.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../ç¼–ç¨‹/bigdata/8-MapReduce.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../theme/segmentit.umd.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../theme/searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../../theme/pagetoc.js"></script>



    </div>
    </body>
</html>

